(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();var Dr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zc(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Xc={},ln={};ln.byteLength=eu;ln.toByteArray=ru;ln.fromByteArray=su;var Ut=[],lt=[],Jc=typeof Uint8Array<"u"?Uint8Array:Array,Bi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var xr=0,Qc=Bi.length;xr<Qc;++xr)Ut[xr]=Bi[xr],lt[Bi.charCodeAt(xr)]=xr;lt["-".charCodeAt(0)]=62;lt["_".charCodeAt(0)]=63;function Fo(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function eu(r){var e=Fo(r),t=e[0],n=e[1];return(t+n)*3/4-n}function tu(r,e,t){return(e+t)*3/4-t}function ru(r){var e,t=Fo(r),n=t[0],i=t[1],o=new Jc(tu(r,n,i)),l=0,u=i>0?n-4:n,y;for(y=0;y<u;y+=4)e=lt[r.charCodeAt(y)]<<18|lt[r.charCodeAt(y+1)]<<12|lt[r.charCodeAt(y+2)]<<6|lt[r.charCodeAt(y+3)],o[l++]=e>>16&255,o[l++]=e>>8&255,o[l++]=e&255;return i===2&&(e=lt[r.charCodeAt(y)]<<2|lt[r.charCodeAt(y+1)]>>4,o[l++]=e&255),i===1&&(e=lt[r.charCodeAt(y)]<<10|lt[r.charCodeAt(y+1)]<<4|lt[r.charCodeAt(y+2)]>>2,o[l++]=e>>8&255,o[l++]=e&255),o}function nu(r){return Ut[r>>18&63]+Ut[r>>12&63]+Ut[r>>6&63]+Ut[r&63]}function iu(r,e,t){for(var n,i=[],o=e;o<t;o+=3)n=(r[o]<<16&16711680)+(r[o+1]<<8&65280)+(r[o+2]&255),i.push(nu(n));return i.join("")}function su(r){for(var e,t=r.length,n=t%3,i=[],o=16383,l=0,u=t-n;l<u;l+=o)i.push(iu(r,l,l+o>u?u:l+o));return n===1?(e=r[t-1],i.push(Ut[e>>2]+Ut[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],i.push(Ut[e>>10]+Ut[e>>4&63]+Ut[e<<2&63]+"=")),i.join("")}var hn={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */hn.read=function(r,e,t,n,i){var o,l,u=i*8-n-1,y=(1<<u)-1,b=y>>1,I=-7,B=t?i-1:0,N=t?-1:1,S=r[e+B];for(B+=N,o=S&(1<<-I)-1,S>>=-I,I+=u;I>0;o=o*256+r[e+B],B+=N,I-=8);for(l=o&(1<<-I)-1,o>>=-I,I+=n;I>0;l=l*256+r[e+B],B+=N,I-=8);if(o===0)o=1-b;else{if(o===y)return l?NaN:(S?-1:1)*(1/0);l=l+Math.pow(2,n),o=o-b}return(S?-1:1)*l*Math.pow(2,o-n)};hn.write=function(r,e,t,n,i,o){var l,u,y,b=o*8-i-1,I=(1<<b)-1,B=I>>1,N=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,S=n?0:o-1,w=n?1:-1,k=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,l=I):(l=Math.floor(Math.log(e)/Math.LN2),e*(y=Math.pow(2,-l))<1&&(l--,y*=2),l+B>=1?e+=N/y:e+=N*Math.pow(2,1-B),e*y>=2&&(l++,y/=2),l+B>=I?(u=0,l=I):l+B>=1?(u=(e*y-1)*Math.pow(2,i),l=l+B):(u=e*Math.pow(2,B-1)*Math.pow(2,i),l=0));i>=8;r[t+S]=u&255,S+=w,u/=256,i-=8);for(l=l<<i|u,b+=i;b>0;r[t+S]=l&255,S+=w,l/=256,b-=8);r[t+S-w]|=k*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(r){const e=ln,t=hn,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=u,r.SlowBuffer=j,r.INSPECT_MAX_BYTES=50;const i=2147483647;r.kMaxLength=i,u.TYPED_ARRAY_SUPPORT=o(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const d=new Uint8Array(1),c={foo:function(){return 42}};return Object.setPrototypeOf(c,Uint8Array.prototype),Object.setPrototypeOf(d,c),d.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function l(d){if(d>i)throw new RangeError('The value "'+d+'" is invalid for option "size"');const c=new Uint8Array(d);return Object.setPrototypeOf(c,u.prototype),c}function u(d,c,f){if(typeof d=="number"){if(typeof c=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return B(d)}return y(d,c,f)}u.poolSize=8192;function y(d,c,f){if(typeof d=="string")return N(d,c);if(ArrayBuffer.isView(d))return w(d);if(d==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d);if(C(d,ArrayBuffer)||d&&C(d.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(C(d,SharedArrayBuffer)||d&&C(d.buffer,SharedArrayBuffer)))return k(d,c,f);if(typeof d=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const E=d.valueOf&&d.valueOf();if(E!=null&&E!==d)return u.from(E,c,f);const F=D(d);if(F)return F;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof d[Symbol.toPrimitive]=="function")return u.from(d[Symbol.toPrimitive]("string"),c,f);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d)}u.from=function(d,c,f){return y(d,c,f)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array);function b(d){if(typeof d!="number")throw new TypeError('"size" argument must be of type number');if(d<0)throw new RangeError('The value "'+d+'" is invalid for option "size"')}function I(d,c,f){return b(d),d<=0?l(d):c!==void 0?typeof f=="string"?l(d).fill(c,f):l(d).fill(c):l(d)}u.alloc=function(d,c,f){return I(d,c,f)};function B(d){return b(d),l(d<0?0:K(d)|0)}u.allocUnsafe=function(d){return B(d)},u.allocUnsafeSlow=function(d){return B(d)};function N(d,c){if((typeof c!="string"||c==="")&&(c="utf8"),!u.isEncoding(c))throw new TypeError("Unknown encoding: "+c);const f=q(d,c)|0;let E=l(f);const F=E.write(d,c);return F!==f&&(E=E.slice(0,F)),E}function S(d){const c=d.length<0?0:K(d.length)|0,f=l(c);for(let E=0;E<c;E+=1)f[E]=d[E]&255;return f}function w(d){if(C(d,Uint8Array)){const c=new Uint8Array(d);return k(c.buffer,c.byteOffset,c.byteLength)}return S(d)}function k(d,c,f){if(c<0||d.byteLength<c)throw new RangeError('"offset" is outside of buffer bounds');if(d.byteLength<c+(f||0))throw new RangeError('"length" is outside of buffer bounds');let E;return c===void 0&&f===void 0?E=new Uint8Array(d):f===void 0?E=new Uint8Array(d,c):E=new Uint8Array(d,c,f),Object.setPrototypeOf(E,u.prototype),E}function D(d){if(u.isBuffer(d)){const c=K(d.length)|0,f=l(c);return f.length===0||d.copy(f,0,0,c),f}if(d.length!==void 0)return typeof d.length!="number"||se(d.length)?l(0):S(d);if(d.type==="Buffer"&&Array.isArray(d.data))return S(d.data)}function K(d){if(d>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return d|0}function j(d){return+d!=d&&(d=0),u.alloc(+d)}u.isBuffer=function(c){return c!=null&&c._isBuffer===!0&&c!==u.prototype},u.compare=function(c,f){if(C(c,Uint8Array)&&(c=u.from(c,c.offset,c.byteLength)),C(f,Uint8Array)&&(f=u.from(f,f.offset,f.byteLength)),!u.isBuffer(c)||!u.isBuffer(f))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(c===f)return 0;let E=c.length,F=f.length;for(let H=0,$=Math.min(E,F);H<$;++H)if(c[H]!==f[H]){E=c[H],F=f[H];break}return E<F?-1:F<E?1:0},u.isEncoding=function(c){switch(String(c).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(c,f){if(!Array.isArray(c))throw new TypeError('"list" argument must be an Array of Buffers');if(c.length===0)return u.alloc(0);let E;if(f===void 0)for(f=0,E=0;E<c.length;++E)f+=c[E].length;const F=u.allocUnsafe(f);let H=0;for(E=0;E<c.length;++E){let $=c[E];if(C($,Uint8Array))H+$.length>F.length?(u.isBuffer($)||($=u.from($)),$.copy(F,H)):Uint8Array.prototype.set.call(F,$,H);else if(u.isBuffer($))$.copy(F,H);else throw new TypeError('"list" argument must be an Array of Buffers');H+=$.length}return F};function q(d,c){if(u.isBuffer(d))return d.length;if(ArrayBuffer.isView(d)||C(d,ArrayBuffer))return d.byteLength;if(typeof d!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof d);const f=d.length,E=arguments.length>2&&arguments[2]===!0;if(!E&&f===0)return 0;let F=!1;for(;;)switch(c){case"ascii":case"latin1":case"binary":return f;case"utf8":case"utf-8":return s(d).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f*2;case"hex":return f>>>1;case"base64":return x(d).length;default:if(F)return E?-1:s(d).length;c=(""+c).toLowerCase(),F=!0}}u.byteLength=q;function ie(d,c,f){let E=!1;if((c===void 0||c<0)&&(c=0),c>this.length||((f===void 0||f>this.length)&&(f=this.length),f<=0)||(f>>>=0,c>>>=0,f<=c))return"";for(d||(d="utf8");;)switch(d){case"hex":return ee(this,c,f);case"utf8":case"utf-8":return P(this,c,f);case"ascii":return W(this,c,f);case"latin1":case"binary":return G(this,c,f);case"base64":return T(this,c,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return le(this,c,f);default:if(E)throw new TypeError("Unknown encoding: "+d);d=(d+"").toLowerCase(),E=!0}}u.prototype._isBuffer=!0;function M(d,c,f){const E=d[c];d[c]=d[f],d[f]=E}u.prototype.swap16=function(){const c=this.length;if(c%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let f=0;f<c;f+=2)M(this,f,f+1);return this},u.prototype.swap32=function(){const c=this.length;if(c%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let f=0;f<c;f+=4)M(this,f,f+3),M(this,f+1,f+2);return this},u.prototype.swap64=function(){const c=this.length;if(c%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let f=0;f<c;f+=8)M(this,f,f+7),M(this,f+1,f+6),M(this,f+2,f+5),M(this,f+3,f+4);return this},u.prototype.toString=function(){const c=this.length;return c===0?"":arguments.length===0?P(this,0,c):ie.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(c){if(!u.isBuffer(c))throw new TypeError("Argument must be a Buffer");return this===c?!0:u.compare(this,c)===0},u.prototype.inspect=function(){let c="";const f=r.INSPECT_MAX_BYTES;return c=this.toString("hex",0,f).replace(/(.{2})/g,"$1 ").trim(),this.length>f&&(c+=" ... "),"<Buffer "+c+">"},n&&(u.prototype[n]=u.prototype.inspect),u.prototype.compare=function(c,f,E,F,H){if(C(c,Uint8Array)&&(c=u.from(c,c.offset,c.byteLength)),!u.isBuffer(c))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof c);if(f===void 0&&(f=0),E===void 0&&(E=c?c.length:0),F===void 0&&(F=0),H===void 0&&(H=this.length),f<0||E>c.length||F<0||H>this.length)throw new RangeError("out of range index");if(F>=H&&f>=E)return 0;if(F>=H)return-1;if(f>=E)return 1;if(f>>>=0,E>>>=0,F>>>=0,H>>>=0,this===c)return 0;let $=H-F,xe=E-f;const ve=Math.min($,xe),_e=this.slice(F,H),me=c.slice(f,E);for(let Ue=0;Ue<ve;++Ue)if(_e[Ue]!==me[Ue]){$=_e[Ue],xe=me[Ue];break}return $<xe?-1:xe<$?1:0};function Y(d,c,f,E,F){if(d.length===0)return-1;if(typeof f=="string"?(E=f,f=0):f>2147483647?f=2147483647:f<-2147483648&&(f=-2147483648),f=+f,se(f)&&(f=F?0:d.length-1),f<0&&(f=d.length+f),f>=d.length){if(F)return-1;f=d.length-1}else if(f<0)if(F)f=0;else return-1;if(typeof c=="string"&&(c=u.from(c,E)),u.isBuffer(c))return c.length===0?-1:z(d,c,f,E,F);if(typeof c=="number")return c=c&255,typeof Uint8Array.prototype.indexOf=="function"?F?Uint8Array.prototype.indexOf.call(d,c,f):Uint8Array.prototype.lastIndexOf.call(d,c,f):z(d,[c],f,E,F);throw new TypeError("val must be string, number or Buffer")}function z(d,c,f,E,F){let H=1,$=d.length,xe=c.length;if(E!==void 0&&(E=String(E).toLowerCase(),E==="ucs2"||E==="ucs-2"||E==="utf16le"||E==="utf-16le")){if(d.length<2||c.length<2)return-1;H=2,$/=2,xe/=2,f/=2}function ve(me,Ue){return H===1?me[Ue]:me.readUInt16BE(Ue*H)}let _e;if(F){let me=-1;for(_e=f;_e<$;_e++)if(ve(d,_e)===ve(c,me===-1?0:_e-me)){if(me===-1&&(me=_e),_e-me+1===xe)return me*H}else me!==-1&&(_e-=_e-me),me=-1}else for(f+xe>$&&(f=$-xe),_e=f;_e>=0;_e--){let me=!0;for(let Ue=0;Ue<xe;Ue++)if(ve(d,_e+Ue)!==ve(c,Ue)){me=!1;break}if(me)return _e}return-1}u.prototype.includes=function(c,f,E){return this.indexOf(c,f,E)!==-1},u.prototype.indexOf=function(c,f,E){return Y(this,c,f,E,!0)},u.prototype.lastIndexOf=function(c,f,E){return Y(this,c,f,E,!1)};function J(d,c,f,E){f=Number(f)||0;const F=d.length-f;E?(E=Number(E),E>F&&(E=F)):E=F;const H=c.length;E>H/2&&(E=H/2);let $;for($=0;$<E;++$){const xe=parseInt(c.substr($*2,2),16);if(se(xe))return $;d[f+$]=xe}return $}function re(d,c,f,E){return A(s(c,d.length-f),d,f,E)}function Z(d,c,f,E){return A(a(c),d,f,E)}function ye(d,c,f,E){return A(x(c),d,f,E)}function he(d,c,f,E){return A(p(c,d.length-f),d,f,E)}u.prototype.write=function(c,f,E,F){if(f===void 0)F="utf8",E=this.length,f=0;else if(E===void 0&&typeof f=="string")F=f,E=this.length,f=0;else if(isFinite(f))f=f>>>0,isFinite(E)?(E=E>>>0,F===void 0&&(F="utf8")):(F=E,E=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const H=this.length-f;if((E===void 0||E>H)&&(E=H),c.length>0&&(E<0||f<0)||f>this.length)throw new RangeError("Attempt to write outside buffer bounds");F||(F="utf8");let $=!1;for(;;)switch(F){case"hex":return J(this,c,f,E);case"utf8":case"utf-8":return re(this,c,f,E);case"ascii":case"latin1":case"binary":return Z(this,c,f,E);case"base64":return ye(this,c,f,E);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return he(this,c,f,E);default:if($)throw new TypeError("Unknown encoding: "+F);F=(""+F).toLowerCase(),$=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function T(d,c,f){return c===0&&f===d.length?e.fromByteArray(d):e.fromByteArray(d.slice(c,f))}function P(d,c,f){f=Math.min(d.length,f);const E=[];let F=c;for(;F<f;){const H=d[F];let $=null,xe=H>239?4:H>223?3:H>191?2:1;if(F+xe<=f){let ve,_e,me,Ue;switch(xe){case 1:H<128&&($=H);break;case 2:ve=d[F+1],(ve&192)===128&&(Ue=(H&31)<<6|ve&63,Ue>127&&($=Ue));break;case 3:ve=d[F+1],_e=d[F+2],(ve&192)===128&&(_e&192)===128&&(Ue=(H&15)<<12|(ve&63)<<6|_e&63,Ue>2047&&(Ue<55296||Ue>57343)&&($=Ue));break;case 4:ve=d[F+1],_e=d[F+2],me=d[F+3],(ve&192)===128&&(_e&192)===128&&(me&192)===128&&(Ue=(H&15)<<18|(ve&63)<<12|(_e&63)<<6|me&63,Ue>65535&&Ue<1114112&&($=Ue))}}$===null?($=65533,xe=1):$>65535&&($-=65536,E.push($>>>10&1023|55296),$=56320|$&1023),E.push($),F+=xe}return X(E)}const V=4096;function X(d){const c=d.length;if(c<=V)return String.fromCharCode.apply(String,d);let f="",E=0;for(;E<c;)f+=String.fromCharCode.apply(String,d.slice(E,E+=V));return f}function W(d,c,f){let E="";f=Math.min(d.length,f);for(let F=c;F<f;++F)E+=String.fromCharCode(d[F]&127);return E}function G(d,c,f){let E="";f=Math.min(d.length,f);for(let F=c;F<f;++F)E+=String.fromCharCode(d[F]);return E}function ee(d,c,f){const E=d.length;(!c||c<0)&&(c=0),(!f||f<0||f>E)&&(f=E);let F="";for(let H=c;H<f;++H)F+=pe[d[H]];return F}function le(d,c,f){const E=d.slice(c,f);let F="";for(let H=0;H<E.length-1;H+=2)F+=String.fromCharCode(E[H]+E[H+1]*256);return F}u.prototype.slice=function(c,f){const E=this.length;c=~~c,f=f===void 0?E:~~f,c<0?(c+=E,c<0&&(c=0)):c>E&&(c=E),f<0?(f+=E,f<0&&(f=0)):f>E&&(f=E),f<c&&(f=c);const F=this.subarray(c,f);return Object.setPrototypeOf(F,u.prototype),F};function oe(d,c,f){if(d%1!==0||d<0)throw new RangeError("offset is not uint");if(d+c>f)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(c,f,E){c=c>>>0,f=f>>>0,E||oe(c,f,this.length);let F=this[c],H=1,$=0;for(;++$<f&&(H*=256);)F+=this[c+$]*H;return F},u.prototype.readUintBE=u.prototype.readUIntBE=function(c,f,E){c=c>>>0,f=f>>>0,E||oe(c,f,this.length);let F=this[c+--f],H=1;for(;f>0&&(H*=256);)F+=this[c+--f]*H;return F},u.prototype.readUint8=u.prototype.readUInt8=function(c,f){return c=c>>>0,f||oe(c,1,this.length),this[c]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(c,f){return c=c>>>0,f||oe(c,2,this.length),this[c]|this[c+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(c,f){return c=c>>>0,f||oe(c,2,this.length),this[c]<<8|this[c+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(c,f){return c=c>>>0,f||oe(c,4,this.length),(this[c]|this[c+1]<<8|this[c+2]<<16)+this[c+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(c,f){return c=c>>>0,f||oe(c,4,this.length),this[c]*16777216+(this[c+1]<<16|this[c+2]<<8|this[c+3])},u.prototype.readBigUInt64LE=ge(function(c){c=c>>>0,R(c,"offset");const f=this[c],E=this[c+7];(f===void 0||E===void 0)&&O(c,this.length-8);const F=f+this[++c]*2**8+this[++c]*2**16+this[++c]*2**24,H=this[++c]+this[++c]*2**8+this[++c]*2**16+E*2**24;return BigInt(F)+(BigInt(H)<<BigInt(32))}),u.prototype.readBigUInt64BE=ge(function(c){c=c>>>0,R(c,"offset");const f=this[c],E=this[c+7];(f===void 0||E===void 0)&&O(c,this.length-8);const F=f*2**24+this[++c]*2**16+this[++c]*2**8+this[++c],H=this[++c]*2**24+this[++c]*2**16+this[++c]*2**8+E;return(BigInt(F)<<BigInt(32))+BigInt(H)}),u.prototype.readIntLE=function(c,f,E){c=c>>>0,f=f>>>0,E||oe(c,f,this.length);let F=this[c],H=1,$=0;for(;++$<f&&(H*=256);)F+=this[c+$]*H;return H*=128,F>=H&&(F-=Math.pow(2,8*f)),F},u.prototype.readIntBE=function(c,f,E){c=c>>>0,f=f>>>0,E||oe(c,f,this.length);let F=f,H=1,$=this[c+--F];for(;F>0&&(H*=256);)$+=this[c+--F]*H;return H*=128,$>=H&&($-=Math.pow(2,8*f)),$},u.prototype.readInt8=function(c,f){return c=c>>>0,f||oe(c,1,this.length),this[c]&128?(255-this[c]+1)*-1:this[c]},u.prototype.readInt16LE=function(c,f){c=c>>>0,f||oe(c,2,this.length);const E=this[c]|this[c+1]<<8;return E&32768?E|4294901760:E},u.prototype.readInt16BE=function(c,f){c=c>>>0,f||oe(c,2,this.length);const E=this[c+1]|this[c]<<8;return E&32768?E|4294901760:E},u.prototype.readInt32LE=function(c,f){return c=c>>>0,f||oe(c,4,this.length),this[c]|this[c+1]<<8|this[c+2]<<16|this[c+3]<<24},u.prototype.readInt32BE=function(c,f){return c=c>>>0,f||oe(c,4,this.length),this[c]<<24|this[c+1]<<16|this[c+2]<<8|this[c+3]},u.prototype.readBigInt64LE=ge(function(c){c=c>>>0,R(c,"offset");const f=this[c],E=this[c+7];(f===void 0||E===void 0)&&O(c,this.length-8);const F=this[c+4]+this[c+5]*2**8+this[c+6]*2**16+(E<<24);return(BigInt(F)<<BigInt(32))+BigInt(f+this[++c]*2**8+this[++c]*2**16+this[++c]*2**24)}),u.prototype.readBigInt64BE=ge(function(c){c=c>>>0,R(c,"offset");const f=this[c],E=this[c+7];(f===void 0||E===void 0)&&O(c,this.length-8);const F=(f<<24)+this[++c]*2**16+this[++c]*2**8+this[++c];return(BigInt(F)<<BigInt(32))+BigInt(this[++c]*2**24+this[++c]*2**16+this[++c]*2**8+E)}),u.prototype.readFloatLE=function(c,f){return c=c>>>0,f||oe(c,4,this.length),t.read(this,c,!0,23,4)},u.prototype.readFloatBE=function(c,f){return c=c>>>0,f||oe(c,4,this.length),t.read(this,c,!1,23,4)},u.prototype.readDoubleLE=function(c,f){return c=c>>>0,f||oe(c,8,this.length),t.read(this,c,!0,52,8)},u.prototype.readDoubleBE=function(c,f){return c=c>>>0,f||oe(c,8,this.length),t.read(this,c,!1,52,8)};function fe(d,c,f,E,F,H){if(!u.isBuffer(d))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>F||c<H)throw new RangeError('"value" argument is out of bounds');if(f+E>d.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(c,f,E,F){if(c=+c,f=f>>>0,E=E>>>0,!F){const xe=Math.pow(2,8*E)-1;fe(this,c,f,E,xe,0)}let H=1,$=0;for(this[f]=c&255;++$<E&&(H*=256);)this[f+$]=c/H&255;return f+E},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(c,f,E,F){if(c=+c,f=f>>>0,E=E>>>0,!F){const xe=Math.pow(2,8*E)-1;fe(this,c,f,E,xe,0)}let H=E-1,$=1;for(this[f+H]=c&255;--H>=0&&($*=256);)this[f+H]=c/$&255;return f+E},u.prototype.writeUint8=u.prototype.writeUInt8=function(c,f,E){return c=+c,f=f>>>0,E||fe(this,c,f,1,255,0),this[f]=c&255,f+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(c,f,E){return c=+c,f=f>>>0,E||fe(this,c,f,2,65535,0),this[f]=c&255,this[f+1]=c>>>8,f+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(c,f,E){return c=+c,f=f>>>0,E||fe(this,c,f,2,65535,0),this[f]=c>>>8,this[f+1]=c&255,f+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(c,f,E){return c=+c,f=f>>>0,E||fe(this,c,f,4,4294967295,0),this[f+3]=c>>>24,this[f+2]=c>>>16,this[f+1]=c>>>8,this[f]=c&255,f+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(c,f,E){return c=+c,f=f>>>0,E||fe(this,c,f,4,4294967295,0),this[f]=c>>>24,this[f+1]=c>>>16,this[f+2]=c>>>8,this[f+3]=c&255,f+4};function Q(d,c,f,E,F){v(c,E,F,d,f,7);let H=Number(c&BigInt(4294967295));d[f++]=H,H=H>>8,d[f++]=H,H=H>>8,d[f++]=H,H=H>>8,d[f++]=H;let $=Number(c>>BigInt(32)&BigInt(4294967295));return d[f++]=$,$=$>>8,d[f++]=$,$=$>>8,d[f++]=$,$=$>>8,d[f++]=$,f}function g(d,c,f,E,F){v(c,E,F,d,f,7);let H=Number(c&BigInt(4294967295));d[f+7]=H,H=H>>8,d[f+6]=H,H=H>>8,d[f+5]=H,H=H>>8,d[f+4]=H;let $=Number(c>>BigInt(32)&BigInt(4294967295));return d[f+3]=$,$=$>>8,d[f+2]=$,$=$>>8,d[f+1]=$,$=$>>8,d[f]=$,f+8}u.prototype.writeBigUInt64LE=ge(function(c,f=0){return Q(this,c,f,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=ge(function(c,f=0){return g(this,c,f,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(c,f,E,F){if(c=+c,f=f>>>0,!F){const ve=Math.pow(2,8*E-1);fe(this,c,f,E,ve-1,-ve)}let H=0,$=1,xe=0;for(this[f]=c&255;++H<E&&($*=256);)c<0&&xe===0&&this[f+H-1]!==0&&(xe=1),this[f+H]=(c/$>>0)-xe&255;return f+E},u.prototype.writeIntBE=function(c,f,E,F){if(c=+c,f=f>>>0,!F){const ve=Math.pow(2,8*E-1);fe(this,c,f,E,ve-1,-ve)}let H=E-1,$=1,xe=0;for(this[f+H]=c&255;--H>=0&&($*=256);)c<0&&xe===0&&this[f+H+1]!==0&&(xe=1),this[f+H]=(c/$>>0)-xe&255;return f+E},u.prototype.writeInt8=function(c,f,E){return c=+c,f=f>>>0,E||fe(this,c,f,1,127,-128),c<0&&(c=255+c+1),this[f]=c&255,f+1},u.prototype.writeInt16LE=function(c,f,E){return c=+c,f=f>>>0,E||fe(this,c,f,2,32767,-32768),this[f]=c&255,this[f+1]=c>>>8,f+2},u.prototype.writeInt16BE=function(c,f,E){return c=+c,f=f>>>0,E||fe(this,c,f,2,32767,-32768),this[f]=c>>>8,this[f+1]=c&255,f+2},u.prototype.writeInt32LE=function(c,f,E){return c=+c,f=f>>>0,E||fe(this,c,f,4,2147483647,-2147483648),this[f]=c&255,this[f+1]=c>>>8,this[f+2]=c>>>16,this[f+3]=c>>>24,f+4},u.prototype.writeInt32BE=function(c,f,E){return c=+c,f=f>>>0,E||fe(this,c,f,4,2147483647,-2147483648),c<0&&(c=4294967295+c+1),this[f]=c>>>24,this[f+1]=c>>>16,this[f+2]=c>>>8,this[f+3]=c&255,f+4},u.prototype.writeBigInt64LE=ge(function(c,f=0){return Q(this,c,f,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=ge(function(c,f=0){return g(this,c,f,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ne(d,c,f,E,F,H){if(f+E>d.length)throw new RangeError("Index out of range");if(f<0)throw new RangeError("Index out of range")}function ue(d,c,f,E,F){return c=+c,f=f>>>0,F||ne(d,c,f,4),t.write(d,c,f,E,23,4),f+4}u.prototype.writeFloatLE=function(c,f,E){return ue(this,c,f,!0,E)},u.prototype.writeFloatBE=function(c,f,E){return ue(this,c,f,!1,E)};function de(d,c,f,E,F){return c=+c,f=f>>>0,F||ne(d,c,f,8),t.write(d,c,f,E,52,8),f+8}u.prototype.writeDoubleLE=function(c,f,E){return de(this,c,f,!0,E)},u.prototype.writeDoubleBE=function(c,f,E){return de(this,c,f,!1,E)},u.prototype.copy=function(c,f,E,F){if(!u.isBuffer(c))throw new TypeError("argument should be a Buffer");if(E||(E=0),!F&&F!==0&&(F=this.length),f>=c.length&&(f=c.length),f||(f=0),F>0&&F<E&&(F=E),F===E||c.length===0||this.length===0)return 0;if(f<0)throw new RangeError("targetStart out of bounds");if(E<0||E>=this.length)throw new RangeError("Index out of range");if(F<0)throw new RangeError("sourceEnd out of bounds");F>this.length&&(F=this.length),c.length-f<F-E&&(F=c.length-f+E);const H=F-E;return this===c&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(f,E,F):Uint8Array.prototype.set.call(c,this.subarray(E,F),f),H},u.prototype.fill=function(c,f,E,F){if(typeof c=="string"){if(typeof f=="string"?(F=f,f=0,E=this.length):typeof E=="string"&&(F=E,E=this.length),F!==void 0&&typeof F!="string")throw new TypeError("encoding must be a string");if(typeof F=="string"&&!u.isEncoding(F))throw new TypeError("Unknown encoding: "+F);if(c.length===1){const $=c.charCodeAt(0);(F==="utf8"&&$<128||F==="latin1")&&(c=$)}}else typeof c=="number"?c=c&255:typeof c=="boolean"&&(c=Number(c));if(f<0||this.length<f||this.length<E)throw new RangeError("Out of range index");if(E<=f)return this;f=f>>>0,E=E===void 0?this.length:E>>>0,c||(c=0);let H;if(typeof c=="number")for(H=f;H<E;++H)this[H]=c;else{const $=u.isBuffer(c)?c:u.from(c,F),xe=$.length;if(xe===0)throw new TypeError('The value "'+c+'" is invalid for argument "value"');for(H=0;H<E-f;++H)this[H+f]=$[H%xe]}return this};const te={};function ae(d,c,f){te[d]=class extends f{constructor(){super(),Object.defineProperty(this,"message",{value:c.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${d}]`,this.stack,delete this.name}get code(){return d}set code(F){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:F,writable:!0})}toString(){return`${this.name} [${d}]: ${this.message}`}}}ae("ERR_BUFFER_OUT_OF_BOUNDS",function(d){return d?`${d} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ae("ERR_INVALID_ARG_TYPE",function(d,c){return`The "${d}" argument must be of type number. Received type ${typeof c}`},TypeError),ae("ERR_OUT_OF_RANGE",function(d,c,f){let E=`The value of "${d}" is out of range.`,F=f;return Number.isInteger(f)&&Math.abs(f)>2**32?F=m(String(f)):typeof f=="bigint"&&(F=String(f),(f>BigInt(2)**BigInt(32)||f<-(BigInt(2)**BigInt(32)))&&(F=m(F)),F+="n"),E+=` It must be ${c}. Received ${F}`,E},RangeError);function m(d){let c="",f=d.length;const E=d[0]==="-"?1:0;for(;f>=E+4;f-=3)c=`_${d.slice(f-3,f)}${c}`;return`${d.slice(0,f)}${c}`}function _(d,c,f){R(c,"offset"),(d[c]===void 0||d[c+f]===void 0)&&O(c,d.length-(f+1))}function v(d,c,f,E,F,H){if(d>f||d<c){const $=typeof c=="bigint"?"n":"";let xe;throw H>3?c===0||c===BigInt(0)?xe=`>= 0${$} and < 2${$} ** ${(H+1)*8}${$}`:xe=`>= -(2${$} ** ${(H+1)*8-1}${$}) and < 2 ** ${(H+1)*8-1}${$}`:xe=`>= ${c}${$} and <= ${f}${$}`,new te.ERR_OUT_OF_RANGE("value",xe,d)}_(E,F,H)}function R(d,c){if(typeof d!="number")throw new te.ERR_INVALID_ARG_TYPE(c,"number",d)}function O(d,c,f){throw Math.floor(d)!==d?(R(d,f),new te.ERR_OUT_OF_RANGE(f||"offset","an integer",d)):c<0?new te.ERR_BUFFER_OUT_OF_BOUNDS:new te.ERR_OUT_OF_RANGE(f||"offset",`>= ${f?1:0} and <= ${c}`,d)}const L=/[^+/0-9A-Za-z-_]/g;function h(d){if(d=d.split("=")[0],d=d.trim().replace(L,""),d.length<2)return"";for(;d.length%4!==0;)d=d+"=";return d}function s(d,c){c=c||1/0;let f;const E=d.length;let F=null;const H=[];for(let $=0;$<E;++$){if(f=d.charCodeAt($),f>55295&&f<57344){if(!F){if(f>56319){(c-=3)>-1&&H.push(239,191,189);continue}else if($+1===E){(c-=3)>-1&&H.push(239,191,189);continue}F=f;continue}if(f<56320){(c-=3)>-1&&H.push(239,191,189),F=f;continue}f=(F-55296<<10|f-56320)+65536}else F&&(c-=3)>-1&&H.push(239,191,189);if(F=null,f<128){if((c-=1)<0)break;H.push(f)}else if(f<2048){if((c-=2)<0)break;H.push(f>>6|192,f&63|128)}else if(f<65536){if((c-=3)<0)break;H.push(f>>12|224,f>>6&63|128,f&63|128)}else if(f<1114112){if((c-=4)<0)break;H.push(f>>18|240,f>>12&63|128,f>>6&63|128,f&63|128)}else throw new Error("Invalid code point")}return H}function a(d){const c=[];for(let f=0;f<d.length;++f)c.push(d.charCodeAt(f)&255);return c}function p(d,c){let f,E,F;const H=[];for(let $=0;$<d.length&&!((c-=2)<0);++$)f=d.charCodeAt($),E=f>>8,F=f%256,H.push(F),H.push(E);return H}function x(d){return e.toByteArray(h(d))}function A(d,c,f,E){let F;for(F=0;F<E&&!(F+f>=c.length||F>=d.length);++F)c[F+f]=d[F];return F}function C(d,c){return d instanceof c||d!=null&&d.constructor!=null&&d.constructor.name!=null&&d.constructor.name===c.name}function se(d){return d!==d}const pe=function(){const d="0123456789abcdef",c=new Array(256);for(let f=0;f<16;++f){const E=f*16;for(let F=0;F<16;++F)c[E+F]=d[f]+d[F]}return c}();function ge(d){return typeof BigInt>"u"?Ee:d}function Ee(){throw new Error("BigInt not supported")}})(Xc);var Ps;(function(r){r[r.SysFatal=1]="SysFatal",r[r.SysTransient=2]="SysTransient",r[r.DestinationInvalid=3]="DestinationInvalid",r[r.CanisterReject=4]="CanisterReject",r[r.CanisterError=5]="CanisterError"})(Ps||(Ps={}));const ou="modulepreload",au=function(r){return"/"+r},Ls={},cu=function(e,t,n){if(!t||t.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(t.map(o=>{if(o=au(o),o in Ls)return;Ls[o]=!0;const l=o.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(!!n)for(let I=i.length-1;I>=0;I--){const B=i[I];if(B.href===o&&(!l||B.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${u}`))return;const b=document.createElement("link");if(b.rel=l?"stylesheet":ou,l||(b.as="script",b.crossOrigin=""),b.href=o,document.head.appendChild(b),l)return new Promise((I,B)=>{b.addEventListener("load",I),b.addEventListener("error",()=>B(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e()).catch(o=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o})},ei="abcdefghijklmnopqrstuvwxyz234567",kr=Object.create(null);for(let r=0;r<ei.length;r++)kr[ei[r]]=r;kr[0]=kr.o;kr[1]=kr.i;function uu(r){let e=0,t=0,n="";function i(o){return e<0?t|=o>>-e:t=o<<e&248,e>3?(e-=8,1):(e<4&&(n+=ei[t>>3],e+=5),0)}for(let o=0;o<r.length;)o+=i(r[o]);return n+(e<0?ei[t>>3]:"")}function fu(r){let e=0,t=0;const n=new Uint8Array(r.length*4/3|0);let i=0;function o(l){let u=kr[l.toLowerCase()];if(u===void 0)throw new Error(`Invalid character: ${JSON.stringify(l)}`);u<<=3,t|=u>>>e,e+=5,e>=8&&(n[i++]=t,e-=8,e>0?t=u<<5-e&255:t=0)}for(const l of r)o(l);return n.slice(0,i)}const lu=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function hu(r){const e=new Uint8Array(r);let t=-1;for(let n=0;n<e.length;n++){const o=(e[n]^t)&255;t=lu[o]^t>>>8}return(t^-1)>>>0}function du(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Po(r,...e){if(!du(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function Ms(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function pu(r,e){Po(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const _r=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ai(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Et(r,e){return r<<32-e|r>>>e}typeof Uint8Array.from([]).toHex=="function"&&Uint8Array.fromHex;function yu(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function Lo(r){return typeof r=="string"&&(r=yu(r)),Po(r),r}class wu{clone(){return this._cloneInto()}}function ys(r){const e=n=>r().update(Lo(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function Mo(r=32){if(_r&&typeof _r.getRandomValues=="function")return _r.getRandomValues(new Uint8Array(r));if(_r&&typeof _r.randomBytes=="function")return Uint8Array.from(_r.randomBytes(r));throw new Error("crypto.getRandomValues must be defined")}function gu(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const i=BigInt(32),o=BigInt(4294967295),l=Number(t>>i&o),u=Number(t&o),y=n?4:0,b=n?0:4;r.setUint32(e+y,l,n),r.setUint32(e+b,u,n)}function bu(r,e,t){return r&e^~r&t}function mu(r,e,t){return r&e^r&t^e&t}class Do extends wu{constructor(e,t,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(e),this.view=Ai(this.buffer)}update(e){Ms(this);const{view:t,buffer:n,blockLen:i}=this;e=Lo(e);const o=e.length;for(let l=0;l<o;){const u=Math.min(i-this.pos,o-l);if(u===i){const y=Ai(e);for(;i<=o-l;l+=i)this.process(y,l);continue}n.set(e.subarray(l,l+u),this.pos),this.pos+=u,l+=u,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ms(this),pu(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:i,isLE:o}=this;let{pos:l}=this;t[l++]=128,this.buffer.subarray(l).fill(0),this.padOffset>i-l&&(this.process(n,0),l=0);for(let B=l;B<i;B++)t[B]=0;gu(n,i-8,BigInt(this.length*8),o),this.process(n,0);const u=Ai(e),y=this.outputLen;if(y%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const b=y/4,I=this.get();if(b>I.length)throw new Error("_sha2: outputLen bigger than state");for(let B=0;B<b;B++)u.setUint32(4*B,I[B],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:i,finished:o,destroyed:l,pos:u}=this;return e.length=i,e.pos=u,e.finished=o,e.destroyed=l,i%t&&e.buffer.set(n),e}}const xu=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ht=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Vt=new Uint32Array(64);class ko extends Do{constructor(e=32){super(64,e,8,!1),this.A=Ht[0]|0,this.B=Ht[1]|0,this.C=Ht[2]|0,this.D=Ht[3]|0,this.E=Ht[4]|0,this.F=Ht[5]|0,this.G=Ht[6]|0,this.H=Ht[7]|0}get(){const{A:e,B:t,C:n,D:i,E:o,F:l,G:u,H:y}=this;return[e,t,n,i,o,l,u,y]}set(e,t,n,i,o,l,u,y){this.A=e|0,this.B=t|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=l|0,this.G=u|0,this.H=y|0}process(e,t){for(let B=0;B<16;B++,t+=4)Vt[B]=e.getUint32(t,!1);for(let B=16;B<64;B++){const N=Vt[B-15],S=Vt[B-2],w=Et(N,7)^Et(N,18)^N>>>3,k=Et(S,17)^Et(S,19)^S>>>10;Vt[B]=k+Vt[B-7]+w+Vt[B-16]|0}let{A:n,B:i,C:o,D:l,E:u,F:y,G:b,H:I}=this;for(let B=0;B<64;B++){const N=Et(u,6)^Et(u,11)^Et(u,25),S=I+N+bu(u,y,b)+xu[B]+Vt[B]|0,k=(Et(n,2)^Et(n,13)^Et(n,22))+mu(n,i,o)|0;I=b,b=y,y=u,u=l+S|0,l=o,o=i,i=n,n=S+k|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,l=l+this.D|0,u=u+this.E|0,y=y+this.F|0,b=b+this.G|0,I=I+this.H|0,this.set(n,i,o,l,u,y,b,I)}roundClean(){Vt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class _u extends ko{constructor(){super(28),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868}}const ws=ys(()=>new ko),Eu=ys(()=>new _u);function Iu(r){return Eu.create().update(new Uint8Array(r)).digest()}const xn="__principal__",vu=2,Ds=4,Bu="aaaaa-aa",Au=r=>{var e;return new Uint8Array(((e=r.match(/.{1,2}/g))!==null&&e!==void 0?e:[]).map(t=>parseInt(t,16)))},Su=r=>r.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),"");let Ne=class On{constructor(e){this._arr=e,this._isPrincipal=!0}static anonymous(){return new this(new Uint8Array([Ds]))}static managementCanister(){return this.fromText(Bu)}static selfAuthenticating(e){const t=Iu(e);return new this(new Uint8Array([...t,vu]))}static from(e){if(typeof e=="string")return On.fromText(e);if(Object.getPrototypeOf(e)===Uint8Array.prototype)return new On(e);if(typeof e=="object"&&e!==null&&e._isPrincipal===!0)return new On(e._arr);throw new Error(`Impossible to convert ${JSON.stringify(e)} to Principal.`)}static fromHex(e){return new this(Au(e))}static fromText(e){let t=e;if(e.includes(xn)){const l=JSON.parse(e);xn in l&&(t=l[xn])}const n=t.toLowerCase().replace(/-/g,"");let i=fu(n);i=i.slice(4,i.length);const o=new this(i);if(o.toText()!==t)throw new Error(`Principal "${o.toText()}" does not have a valid checksum (original value "${t}" may not be a valid Principal ID).`);return o}static fromUint8Array(e){return new this(e)}isAnonymous(){return this._arr.byteLength===1&&this._arr[0]===Ds}toUint8Array(){return this._arr}toHex(){return Su(this._arr).toUpperCase()}toText(){const e=new ArrayBuffer(4);new DataView(e).setUint32(0,hu(this._arr));const n=new Uint8Array(e),i=Uint8Array.from(this._arr),o=new Uint8Array([...n,...i]),u=uu(o).match(/.{1,5}/g);if(!u)throw new Error;return u.join("-")}toString(){return this.toText()}toJSON(){return{[xn]:this.toText()}}compareTo(e){for(let t=0;t<Math.min(this._arr.length,e._arr.length);t++){if(this._arr[t]<e._arr[t])return"lt";if(this._arr[t]>e._arr[t])return"gt"}return this._arr.length<e._arr.length?"lt":this._arr.length>e._arr.length?"gt":"eq"}ltEq(e){const t=this.compareTo(e);return t=="lt"||t=="eq"}gtEq(e){const t=this.compareTo(e);return t=="gt"||t=="eq"}};function xt(...r){const e=new Uint8Array(r.reduce((n,i)=>n+i.byteLength,0));let t=0;for(const n of r)e.set(new Uint8Array(n),t),t+=n.byteLength;return e.buffer}function Ge(r){return[...new Uint8Array(r)].map(e=>e.toString(16).padStart(2,"0")).join("")}const Tu=new RegExp(/^[0-9a-fA-F]+$/);function $t(r){if(!Tu.test(r))throw new Error("Invalid hexadecimal string.");const e=[...r].reduce((t,n,i)=>(t[i/2|0]=(t[i/2|0]||"")+n,t),[]).map(t=>Number.parseInt(t,16));return new Uint8Array(e).buffer}function Co(r,e){if(r.byteLength!==e.byteLength)return r.byteLength-e.byteLength;const t=new Uint8Array(r),n=new Uint8Array(e);for(let i=0;i<t.length;i++)if(t[i]!==n[i])return t[i]-n[i];return 0}function dn(r,e){return Co(r,e)===0}function Qr(r){return new DataView(r.buffer,r.byteOffset,r.byteLength).buffer}function Dt(r){return r instanceof Uint8Array?Qr(r):r instanceof ArrayBuffer?r:Array.isArray(r)?Qr(new Uint8Array(r)):"buffer"in r?Dt(r.buffer):Qr(new Uint8Array(r))}class Ke extends Error{constructor(e){super(e),this.message=e,this.name="AgentError",this.__proto__=Ke.prototype,Object.setPrototypeOf(this,Ke.prototype)}}function Oe(...r){const e=new Uint8Array(r.reduce((n,i)=>n+i.byteLength,0));let t=0;for(const n of r)e.set(new Uint8Array(n),t),t+=n.byteLength;return e}class Gr{constructor(e,t=(e==null?void 0:e.byteLength)||0){this._buffer=Cr(e||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,t)}save(){return this._view}restore(e){this._view=e}get buffer(){return Cr(this._view.slice())}get byteLength(){return this._view.byteLength}read(e){const t=this._view.subarray(0,e);return this._view=this._view.subarray(e),t.slice().buffer}readUint8(){const e=this._view[0];return this._view=this._view.subarray(1),e}write(e){const t=new Uint8Array(e),n=this._view.byteLength;this._view.byteOffset+this._view.byteLength+t.byteLength>=this._buffer.byteLength?this.alloc(t.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+t.byteLength),this._view.set(t,n)}get end(){return this._view.byteLength===0}alloc(e){const t=new ArrayBuffer((this._buffer.byteLength+e)*1.2|0),n=new Uint8Array(t,0,this._view.byteLength+e);n.set(this._view),this._buffer=t,this._view=n}}function Si(r){return new DataView(r.buffer,r.byteOffset,r.byteLength).buffer}function Cr(r){return r instanceof Uint8Array?Si(r):r instanceof ArrayBuffer?r:Array.isArray(r)?Si(new Uint8Array(r)):"buffer"in r?Cr(r.buffer):Si(new Uint8Array(r))}function Nu(r){const t=new TextEncoder().encode(r);let n=0;for(const i of t)n=(n*223+i)%2**32;return n}function Ot(r){if(/^_\d+_$/.test(r)||/^_0x[0-9a-fA-F]+_$/.test(r)){const e=+r.slice(1,-1);if(Number.isSafeInteger(e)&&e>=0&&e<2**32)return e}return Nu(r)}function $o(){throw new Error("unexpected end of buffer")}function pr(r,e){return r.byteLength<e&&$o(),r.read(e)}function yr(r){const e=r.readUint8();return e===void 0&&$o(),e}function ke(r){if(typeof r=="number"&&(r=BigInt(r)),r<BigInt(0))throw new Error("Cannot leb encode negative values.");const e=(r===BigInt(0)?0:Math.ceil(Math.log2(Number(r))))+1,t=new Gr(new ArrayBuffer(e),0);for(;;){const n=Number(r&BigInt(127));if(r/=BigInt(128),r===BigInt(0)){t.write(new Uint8Array([n]));break}else t.write(new Uint8Array([n|128]))}return t.buffer}function Ye(r){let e=BigInt(1),t=BigInt(0),n;do n=yr(r),t+=BigInt(n&127).valueOf()*e,e*=BigInt(128);while(n>=128);return t}function je(r){typeof r=="number"&&(r=BigInt(r));const e=r<BigInt(0);e&&(r=-r-BigInt(1));const t=(r===BigInt(0)?0:Math.ceil(Math.log2(Number(r))))+1,n=new Gr(new ArrayBuffer(t),0);for(;;){const o=i(r);if(r/=BigInt(128),e&&r===BigInt(0)&&o&64||!e&&r===BigInt(0)&&!(o&64)){n.write(new Uint8Array([o]));break}else n.write(new Uint8Array([o|128]))}function i(o){const l=o%BigInt(128);return Number(e?BigInt(128)-l-BigInt(1):l)}return n.buffer}function Wt(r){const e=new Uint8Array(r.buffer);let t=0;for(;t<e.byteLength;t++)if(e[t]<128){if(!(e[t]&64))return Ye(r);break}const n=new Uint8Array(pr(r,t+1));let i=BigInt(0);for(let o=n.byteLength-1;o>=0;o--)i=i*BigInt(128)+BigInt(128-(n[o]&127)-1);return-i-BigInt(1)}function Uu(r,e){if(BigInt(r)<BigInt(0))throw new Error("Cannot write negative values.");return qo(r,e)}function qo(r,e){r=BigInt(r);const t=new Gr(new ArrayBuffer(Math.min(1,e)),0);let n=0,i=BigInt(256),o=BigInt(0),l=Number(r%i);for(t.write(new Uint8Array([l]));++n<e;)r<0&&o===BigInt(0)&&l!==0&&(o=BigInt(1)),l=Number((r/i-o)%BigInt(256)),t.write(new Uint8Array([l])),i*=BigInt(256);return t.buffer}function Go(r,e){let t=BigInt(yr(r)),n=BigInt(1),i=0;for(;++i<e;){n*=BigInt(256);const o=BigInt(yr(r));t=t+n*o}return t}function Ou(r,e){let t=Go(r,e);const n=BigInt(2)**(BigInt(8)*BigInt(e-1)+BigInt(7));return t>=n&&(t-=n*BigInt(2)),t}function Yi(r){const e=BigInt(r);if(r<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<e}const Rn="DIDL",ks=400;function on(r,e,t){return r.map((n,i)=>t(n,e[i]))}class Ru{constructor(){this._typs=[],this._idx=new Map}has(e){return this._idx.has(e.name)}add(e,t){const n=this._typs.length;this._idx.set(e.name,n),this._typs.push(t)}merge(e,t){const n=this._idx.get(e.name),i=this._idx.get(t);if(n===void 0)throw new Error("Missing type index for "+e);if(i===void 0)throw new Error("Missing type index for "+t);this._typs[n]=this._typs[i],this._typs.splice(i,1),this._idx.delete(t)}encode(){const e=ke(this._typs.length),t=Oe(...this._typs);return Oe(e,t)}indexOf(e){if(!this._idx.has(e))throw new Error("Missing type index for "+e);return je(this._idx.get(e)||0)}}class Fu{visitType(e,t){throw new Error("Not implemented")}visitPrimitive(e,t){return this.visitType(e,t)}visitEmpty(e,t){return this.visitPrimitive(e,t)}visitBool(e,t){return this.visitPrimitive(e,t)}visitNull(e,t){return this.visitPrimitive(e,t)}visitReserved(e,t){return this.visitPrimitive(e,t)}visitText(e,t){return this.visitPrimitive(e,t)}visitNumber(e,t){return this.visitPrimitive(e,t)}visitInt(e,t){return this.visitNumber(e,t)}visitNat(e,t){return this.visitNumber(e,t)}visitFloat(e,t){return this.visitPrimitive(e,t)}visitFixedInt(e,t){return this.visitNumber(e,t)}visitFixedNat(e,t){return this.visitNumber(e,t)}visitPrincipal(e,t){return this.visitPrimitive(e,t)}visitConstruct(e,t){return this.visitType(e,t)}visitVec(e,t,n){return this.visitConstruct(e,n)}visitOpt(e,t,n){return this.visitConstruct(e,n)}visitRecord(e,t,n){return this.visitConstruct(e,n)}visitTuple(e,t,n){const i=t.map((o,l)=>[`_${l}_`,o]);return this.visitRecord(e,i,n)}visitVariant(e,t,n){return this.visitConstruct(e,n)}visitRec(e,t,n){return this.visitConstruct(t,n)}visitFunc(e,t){return this.visitConstruct(e,t)}visitService(e,t){return this.visitConstruct(e,t)}}class yi{display(){return this.name}valueToString(e){return $e(e)}buildTypeTable(e){e.has(this)||this._buildTypeTableImpl(e)}}class dt extends yi{checkType(e){if(this.name!==e.name)throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`);return e}_buildTypeTableImpl(e){}}class or extends yi{checkType(e){if(e instanceof Gt){const t=e.getType();if(typeof t>"u")throw new Error("type mismatch with uninitialized type");return t}throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`)}encodeType(e){return e.indexOf(this.name)}}class Ho extends dt{accept(e,t){return e.visitEmpty(this,t)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return je(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class Vo extends yi{checkType(e){throw new Error("Method not implemented for unknown.")}accept(e,t){throw e.visitType(this,t)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(e,t){let n=t.decodeValue(e,t);Object(n)!==n&&(n=Object(n));let i;return t instanceof Gt?i=()=>t.getType():i=()=>t,Object.defineProperty(n,"type",{value:i,writable:!0,enumerable:!1,configurable:!0}),n}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class Ko extends dt{accept(e,t){return e.visitBool(this,t)}covariant(e){if(typeof e=="boolean")return!0;throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(e){return new Uint8Array([e?1:0])}encodeType(){return je(-2)}decodeValue(e,t){switch(this.checkType(t),yr(e)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class ti extends dt{accept(e,t){return e.visitNull(this,t)}covariant(e){if(e===null)return!0;throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return je(-1)}decodeValue(e,t){return this.checkType(t),null}get name(){return"null"}}class $r extends dt{accept(e,t){return e.visitReserved(this,t)}covariant(e){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return je(-16)}decodeValue(e,t){return t.name!==this.name&&t.decodeValue(e,t),null}get name(){return"reserved"}}class jo extends dt{accept(e,t){return e.visitText(this,t)}covariant(e){if(typeof e=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(e){const t=new TextEncoder().encode(e),n=ke(t.byteLength);return Oe(n,t)}encodeType(){return je(-15)}decodeValue(e,t){this.checkType(t);const n=Ye(e),i=pr(e,Number(n));return new TextDecoder("utf8",{fatal:!0}).decode(i)}get name(){return"text"}valueToString(e){return'"'+e+'"'}}class zo extends dt{accept(e,t){return e.visitInt(this,t)}covariant(e){if(typeof e=="bigint"||Number.isInteger(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(e){return je(e)}encodeType(){return je(-4)}decodeValue(e,t){return this.checkType(t),Wt(e)}get name(){return"int"}valueToString(e){return e.toString()}}class Wo extends dt{accept(e,t){return e.visitNat(this,t)}covariant(e){if(typeof e=="bigint"&&e>=BigInt(0)||Number.isInteger(e)&&e>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(e){return ke(e)}encodeType(){return je(-3)}decodeValue(e,t){return this.checkType(t),Ye(e)}get name(){return"nat"}valueToString(e){return e.toString()}}class gs extends dt{constructor(e){if(super(),this._bits=e,e!==32&&e!==64)throw new Error("not a valid float type")}accept(e,t){return e.visitFloat(this,t)}covariant(e){if(typeof e=="number"||e instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(e){const t=new ArrayBuffer(this._bits/8),n=new DataView(t);return this._bits===32?n.setFloat32(0,e,!0):n.setFloat64(0,e,!0),t}encodeType(){const e=this._bits===32?-13:-14;return je(e)}decodeValue(e,t){this.checkType(t);const n=pr(e,this._bits/8),i=new DataView(n);return this._bits===32?i.getFloat32(0,!0):i.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(e){return e.toString()}}class wr extends dt{constructor(e){super(),this._bits=e}accept(e,t){return e.visitFixedInt(this,t)}covariant(e){const t=Yi(this._bits-1)*BigInt(-1),n=Yi(this._bits-1)-BigInt(1);let i=!1;if(typeof e=="bigint")i=e>=t&&e<=n;else if(Number.isInteger(e)){const o=BigInt(e);i=o>=t&&o<=n}else i=!1;if(i)return!0;throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(e){return qo(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return je(-9-e)}decodeValue(e,t){this.checkType(t);const n=Ou(e,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`int${this._bits}`}valueToString(e){return e.toString()}}class nr extends dt{constructor(e){super(),this._bits=e}accept(e,t){return e.visitFixedNat(this,t)}covariant(e){const t=Yi(this._bits);let n=!1;if(typeof e=="bigint"&&e>=BigInt(0)?n=e<t:Number.isInteger(e)&&e>=0?n=BigInt(e)<t:n=!1,n)return!0;throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(e){return Uu(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return je(-5-e)}decodeValue(e,t){this.checkType(t);const n=Go(e,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`nat${this._bits}`}valueToString(e){return e.toString()}}class wi extends or{constructor(e){super(),this._type=e,this._blobOptimization=!1,e instanceof nr&&e._bits===8&&(this._blobOptimization=!0)}accept(e,t){return e.visitVec(this,this._type,t)}covariant(e){const t=this._type instanceof nr?this._type._bits:this._type instanceof wr?this._type._bits:0;if(ArrayBuffer.isView(e)&&t==e.BYTES_PER_ELEMENT*8||Array.isArray(e)&&e.every((n,i)=>{try{return this._type.covariant(n)}catch(o){throw new Error(`Invalid ${this.display()} argument: 

index ${i} -> ${o.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(e){const t=ke(e.length);if(this._blobOptimization)return Oe(t,new Uint8Array(e));if(ArrayBuffer.isView(e))return Oe(t,new Uint8Array(e.buffer));const n=new Gr(new ArrayBuffer(t.byteLength+e.length),0);n.write(t);for(const i of e){const o=this._type.encodeValue(i);n.write(new Uint8Array(o))}return n.buffer}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const t=je(-19),n=this._type.encodeType(e);e.add(this,Oe(t,n))}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof wi))throw new Error("Not a vector type");const i=Number(Ye(e));if(this._type instanceof nr){if(this._type._bits==8)return new Uint8Array(e.read(i));if(this._type._bits==16)return new Uint16Array(e.read(i*2));if(this._type._bits==32)return new Uint32Array(e.read(i*4));if(this._type._bits==64)return new BigUint64Array(e.read(i*8))}if(this._type instanceof wr){if(this._type._bits==8)return new Int8Array(e.read(i));if(this._type._bits==16)return new Int16Array(e.read(i*2));if(this._type._bits==32)return new Int32Array(e.read(i*4));if(this._type._bits==64)return new BigInt64Array(e.read(i*8))}const o=[];for(let l=0;l<i;l++)o.push(this._type.decodeValue(e,n._type));return o}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(e){return"vec {"+e.map(n=>this._type.valueToString(n)).join("; ")+"}"}}class gr extends or{constructor(e){super(),this._type=e}accept(e,t){return e.visitOpt(this,this._type,t)}covariant(e){try{if(Array.isArray(e)&&(e.length===0||e.length===1&&this._type.covariant(e[0])))return!0}catch(t){throw new Error(`Invalid ${this.display()} argument: ${$e(e)} 

-> ${t.message}`)}throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(e){return e.length===0?new Uint8Array([0]):Oe(new Uint8Array([1]),this._type.encodeValue(e[0]))}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const t=je(-18),n=this._type.encodeType(e);e.add(this,Oe(t,n))}decodeValue(e,t){if(t instanceof ti)return[];if(t instanceof $r)return[];let n=t;if(t instanceof Gt){const i=t.getType();if(typeof i>"u")throw new Error("type mismatch with uninitialized type");n=i}if(n instanceof gr)switch(yr(e)){case 0:return[];case 1:{const i=e.save();try{return[this._type.decodeValue(e,n._type)]}catch{return e.restore(i),n._type.decodeValue(e,n._type),[]}}default:throw new Error("Not an option value")}else{if(this._type instanceof ti||this._type instanceof gr||this._type instanceof $r)return n.decodeValue(e,n),[];{const i=e.save();try{return[this._type.decodeValue(e,t)]}catch{return e.restore(i),n.decodeValue(e,t),[]}}}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(e){return e.length===0?"null":`opt ${this._type.valueToString(e[0])}`}}class pn extends or{constructor(e={}){super(),this._fields=Object.entries(e).sort((t,n)=>Ot(t[0])-Ot(n[0]))}accept(e,t){return e.visitRecord(this,this._fields,t)}tryAsTuple(){const e=[];for(let t=0;t<this._fields.length;t++){const[n,i]=this._fields[t];if(n!==`_${t}_`)return null;e.push(i)}return e}covariant(e){if(typeof e=="object"&&this._fields.every(([t,n])=>{if(!e.hasOwnProperty(t))throw new Error(`Record is missing key "${t}".`);try{return n.covariant(e[t])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

field ${t} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(e){const t=this._fields.map(([i])=>e[i]),n=on(this._fields,t,([,i],o)=>i.encodeValue(o));return Oe(...n)}_buildTypeTableImpl(e){this._fields.forEach(([o,l])=>l.buildTypeTable(e));const t=je(-20),n=ke(this._fields.length),i=this._fields.map(([o,l])=>Oe(ke(Ot(o)),l.encodeType(e)));e.add(this,Oe(t,n,Oe(...i)))}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof pn))throw new Error("Not a record type");const i={};let o=0,l=0;for(;l<n._fields.length;){const[u,y]=n._fields[l];if(o>=this._fields.length){y.decodeValue(e,y),l++;continue}const[b,I]=this._fields[o],B=Ot(this._fields[o][0]),N=Ot(u);if(B===N)i[b]=I.decodeValue(e,y),o++,l++;else if(N>B)if(I instanceof gr||I instanceof $r)i[b]=[],o++;else throw new Error("Cannot find required field "+b);else y.decodeValue(e,y),l++}for(const[u,y]of this._fields.slice(o))if(y instanceof gr||y instanceof $r)i[u]=[];else throw new Error("Cannot find required field "+u);return i}get name(){return`record {${this._fields.map(([t,n])=>t+":"+n.name).join("; ")}}`}display(){return`record {${this._fields.map(([t,n])=>t+":"+n.display()).join("; ")}}`}valueToString(e){const t=this._fields.map(([i])=>e[i]);return`record {${on(this._fields,t,([i,o],l)=>i+"="+o.valueToString(l)).join("; ")}}`}}class gi extends pn{constructor(e){const t={};e.forEach((n,i)=>t["_"+i+"_"]=n),super(t),this._components=e}accept(e,t){return e.visitTuple(this,this._components,t)}covariant(e){if(Array.isArray(e)&&e.length>=this._fields.length&&this._components.every((t,n)=>{try{return t.covariant(e[n])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

index ${n} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(e){const t=on(this._components,e,(n,i)=>n.encodeValue(i));return Oe(...t)}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof gi))throw new Error("not a tuple type");if(n._components.length<this._components.length)throw new Error("tuple mismatch");const i=[];for(const[o,l]of n._components.entries())o>=this._components.length?l.decodeValue(e,l):i.push(this._components[o].decodeValue(e,l));return i}display(){return`record {${this._components.map(t=>t.display()).join("; ")}}`}valueToString(e){return`record {${on(this._components,e,(n,i)=>n.valueToString(i)).join("; ")}}`}}class bi extends or{constructor(e={}){super(),this._fields=Object.entries(e).sort((t,n)=>Ot(t[0])-Ot(n[0]))}accept(e,t){return e.visitVariant(this,this._fields,t)}covariant(e){if(typeof e=="object"&&Object.entries(e).length===1&&this._fields.every(([t,n])=>{try{return!e.hasOwnProperty(t)||n.covariant(e[t])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

variant ${t} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(e){for(let t=0;t<this._fields.length;t++){const[n,i]=this._fields[t];if(e.hasOwnProperty(n)){const o=ke(t),l=i.encodeValue(e[n]);return Oe(o,l)}}throw Error("Variant has no data: "+e)}_buildTypeTableImpl(e){this._fields.forEach(([,o])=>{o.buildTypeTable(e)});const t=je(-21),n=ke(this._fields.length),i=this._fields.map(([o,l])=>Oe(ke(Ot(o)),l.encodeType(e)));e.add(this,Oe(t,n,...i))}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof bi))throw new Error("Not a variant type");const i=Number(Ye(e));if(i>=n._fields.length)throw Error("Invalid variant index: "+i);const[o,l]=n._fields[i];for(const[u,y]of this._fields)if(Ot(o)===Ot(u)){const b=y.decodeValue(e,l);return{[u]:b}}throw new Error("Cannot find field hash "+o)}get name(){return`variant {${this._fields.map(([t,n])=>t+":"+n.name).join("; ")}}`}display(){return`variant {${this._fields.map(([t,n])=>t+(n.name==="null"?"":`:${n.display()}`)).join("; ")}}`}valueToString(e){for(const[t,n]of this._fields)if(e.hasOwnProperty(t)){const i=n.valueToString(e[t]);return i==="null"?`variant {${t}}`:`variant {${t}=${i}}`}throw new Error("Variant has no data: "+e)}}class Gt extends or{constructor(){super(...arguments),this._id=Gt._counter++,this._type=void 0}accept(e,t){if(!this._type)throw Error("Recursive type uninitialized.");return e.visitRec(this,this._type,t)}fill(e){this._type=e}getType(){return this._type}covariant(e){if(this._type&&this._type.covariant(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(e)}_buildTypeTableImpl(e){if(!this._type)throw Error("Recursive type uninitialized.");e.add(this,new Uint8Array([])),this._type.buildTypeTable(e),e.merge(this,this._type.name)}decodeValue(e,t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(e,t)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`${this.name}.${this._type.name}`}valueToString(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(e)}}Gt._counter=0;function bs(r){if(yr(r)!==1)throw new Error("Cannot decode principal");const t=Number(Ye(r));return Ne.fromUint8Array(new Uint8Array(pr(r,t)))}class Yo extends dt{accept(e,t){return e.visitPrincipal(this,t)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(e){const t=e.toUint8Array(),n=ke(t.byteLength);return Oe(new Uint8Array([1]),n,t)}encodeType(){return je(-24)}decodeValue(e,t){return this.checkType(t),bs(e)}get name(){return"principal"}valueToString(e){return`${this.name} "${e.toText()}"`}}class ms extends or{constructor(e,t,n=[]){super(),this.argTypes=e,this.retTypes=t,this.annotations=n}static argsToString(e,t){if(e.length!==t.length)throw new Error("arity mismatch");return"("+e.map((n,i)=>n.valueToString(t[i])).join(", ")+")"}accept(e,t){return e.visitFunc(this,t)}covariant(e){if(Array.isArray(e)&&e.length===2&&e[0]&&e[0]._isPrincipal&&typeof e[1]=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue([e,t]){const n=e.toUint8Array(),i=ke(n.byteLength),o=Oe(new Uint8Array([1]),i,n),l=new TextEncoder().encode(t),u=ke(l.byteLength);return Oe(new Uint8Array([1]),o,u,l)}_buildTypeTableImpl(e){this.argTypes.forEach(b=>b.buildTypeTable(e)),this.retTypes.forEach(b=>b.buildTypeTable(e));const t=je(-22),n=ke(this.argTypes.length),i=Oe(...this.argTypes.map(b=>b.encodeType(e))),o=ke(this.retTypes.length),l=Oe(...this.retTypes.map(b=>b.encodeType(e))),u=ke(this.annotations.length),y=Oe(...this.annotations.map(b=>this.encodeAnnotation(b)));e.add(this,Oe(t,n,i,o,l,u,y))}decodeValue(e){if(yr(e)!==1)throw new Error("Cannot decode function reference");const n=bs(e),i=Number(Ye(e)),o=pr(e,i),u=new TextDecoder("utf8",{fatal:!0}).decode(o);return[n,u]}get name(){const e=this.argTypes.map(i=>i.name).join(", "),t=this.retTypes.map(i=>i.name).join(", "),n=" "+this.annotations.join(" ");return`(${e}) -> (${t})${n}`}valueToString([e,t]){return`func "${e.toText()}".${t}`}display(){const e=this.argTypes.map(i=>i.display()).join(", "),t=this.retTypes.map(i=>i.display()).join(", "),n=" "+this.annotations.join(" ");return`(${e})  (${t})${n}`}encodeAnnotation(e){if(e==="query")return new Uint8Array([1]);if(e==="oneway")return new Uint8Array([2]);if(e==="composite_query")return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class Zo extends or{constructor(e){super(),this._fields=Object.entries(e).sort((t,n)=>t[0]<n[0]?-1:t[0]>n[0]?1:0)}accept(e,t){return e.visitService(this,t)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${$e(e)}`)}encodeValue(e){const t=e.toUint8Array(),n=ke(t.length);return Oe(new Uint8Array([1]),n,t)}_buildTypeTableImpl(e){this._fields.forEach(([o,l])=>l.buildTypeTable(e));const t=je(-23),n=ke(this._fields.length),i=this._fields.map(([o,l])=>{const u=new TextEncoder().encode(o),y=ke(u.length);return Oe(y,u,l.encodeType(e))});e.add(this,Oe(t,n,...i))}decodeValue(e){return bs(e)}get name(){return`service {${this._fields.map(([t,n])=>t+":"+n.name).join("; ")}}`}valueToString(e){return`service "${e.toText()}"`}}function $e(r){const e=JSON.stringify(r,(t,n)=>typeof n=="bigint"?`BigInt(${n})`:n);return e&&e.length>ks?e.substring(0,ks-3)+"...":e}function Pu(r,e){if(e.length<r.length)throw Error("Wrong number of message arguments");const t=new Ru;r.forEach(y=>y.buildTypeTable(t));const n=new TextEncoder().encode(Rn),i=t.encode(),o=ke(e.length),l=Oe(...r.map(y=>y.encodeType(t))),u=Oe(...on(r,e,(y,b)=>{try{y.covariant(b)}catch(I){throw new Error(I.message+`

`)}return y.encodeValue(b)}));return Oe(n,i,o,l,u)}function Lu(r,e){const t=new Gr(e);if(e.byteLength<Rn.length)throw new Error("Message length smaller than magic number");const n=pr(t,Rn.length),i=new TextDecoder().decode(n);if(i!==Rn)throw new Error("Wrong magic number: "+JSON.stringify(i));function o(S){const w=[],k=Number(Ye(S));for(let j=0;j<k;j++){const q=Number(Wt(S));switch(q){case-18:case-19:{const ie=Number(Wt(S));w.push([q,ie]);break}case-20:case-21:{const ie=[];let M=Number(Ye(S)),Y;for(;M--;){const z=Number(Ye(S));if(z>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if(typeof Y=="number"&&Y>=z)throw new Error("field id collision or not sorted");Y=z;const J=Number(Wt(S));ie.push([z,J])}w.push([q,ie]);break}case-22:{const ie=[];let M=Number(Ye(S));for(;M--;)ie.push(Number(Wt(S)));const Y=[];let z=Number(Ye(S));for(;z--;)Y.push(Number(Wt(S)));const J=[];let re=Number(Ye(S));for(;re--;)switch(Number(Ye(S))){case 1:{J.push("query");break}case 2:{J.push("oneway");break}case 3:{J.push("composite_query");break}default:throw new Error("unknown annotation")}w.push([q,[ie,Y,J]]);break}case-23:{let ie=Number(Ye(S));const M=[];for(;ie--;){const Y=Number(Ye(S)),z=new TextDecoder().decode(pr(S,Y)),J=Wt(S);M.push([z,J])}w.push([q,M]);break}default:throw new Error("Illegal op_code: "+q)}}const D=[],K=Number(Ye(S));for(let j=0;j<K;j++)D.push(Number(Wt(S)));return[w,D]}const[l,u]=o(t);if(u.length<r.length)throw new Error("Wrong number of return values");const y=l.map(S=>xa());function b(S){if(S<-24)throw new Error("future value not supported");if(S<0)switch(S){case-1:return ea;case-2:return Qo;case-3:return na;case-4:return ra;case-5:return fa;case-6:return la;case-7:return ha;case-8:return da;case-9:return oa;case-10:return aa;case-11:return ca;case-12:return ua;case-13:return ia;case-14:return sa;case-15:return ta;case-16:return Jo;case-17:return Xo;case-24:return pa;default:throw new Error("Illegal op_code: "+S)}if(S>=l.length)throw new Error("type index out of range");return y[S]}function I(S){switch(S[0]){case-19:{const w=b(S[1]);return wa(w)}case-18:{const w=b(S[1]);return ga(w)}case-20:{const w={};for(const[K,j]of S[1]){const q=`_${K}_`;w[q]=b(j)}const k=ba(w),D=k.tryAsTuple();return Array.isArray(D)?ya(...D):k}case-21:{const w={};for(const[k,D]of S[1]){const K=`_${k}_`;w[K]=b(D)}return ma(w)}case-22:{const[w,k,D]=S[1];return _a(w.map(K=>b(K)),k.map(K=>b(K)),D)}case-23:{const w={},k=S[1];for(const[D,K]of k){let j=b(K);if(j instanceof Gt&&(j=j.getType()),!(j instanceof ms))throw new Error("Illegal service definition: services can only contain functions");w[D]=j}return Ea(w)}default:throw new Error("Illegal op_code: "+S[0])}}l.forEach((S,w)=>{if(S[0]===-22){const k=I(S);y[w].fill(k)}}),l.forEach((S,w)=>{if(S[0]!==-22){const k=I(S);y[w].fill(k)}});const B=u.map(S=>b(S)),N=r.map((S,w)=>S.decodeValue(t,B[w]));for(let S=r.length;S<B.length;S++)B[S].decodeValue(t,B[S]);if(t.byteLength>0)throw new Error("decode: Left-over bytes");return N}const Xo=new Ho,Jo=new $r,Mu=new Vo,Qo=new Ko,ea=new ti,ta=new jo,ra=new zo,na=new Wo,ia=new gs(32),sa=new gs(64),oa=new wr(8),aa=new wr(16),ca=new wr(32),ua=new wr(64),fa=new nr(8),la=new nr(16),ha=new nr(32),da=new nr(64),pa=new Yo;function ya(...r){return new gi(r)}function wa(r){return new wi(r)}function ga(r){return new gr(r)}function ba(r){return new pn(r)}function ma(r){return new bi(r)}function xa(){return new Gt}function _a(r,e,t=[]){return new ms(r,e,t)}function Ea(r){return new Zo(r)}const wh=Object.freeze(Object.defineProperty({__proto__:null,Bool:Qo,BoolClass:Ko,ConstructType:or,Empty:Xo,EmptyClass:Ho,FixedIntClass:wr,FixedNatClass:nr,Float32:ia,Float64:sa,FloatClass:gs,Func:_a,FuncClass:ms,Int:ra,Int16:aa,Int32:ca,Int64:ua,Int8:oa,IntClass:zo,Nat:na,Nat16:la,Nat32:ha,Nat64:da,Nat8:fa,NatClass:Wo,Null:ea,NullClass:ti,Opt:ga,OptClass:gr,PrimitiveType:dt,Principal:pa,PrincipalClass:Yo,Rec:xa,RecClass:Gt,Record:ba,RecordClass:pn,Reserved:Jo,ReservedClass:$r,Service:Ea,ServiceClass:Zo,Text:ta,TextClass:jo,Tuple:ya,TupleClass:gi,Type:yi,Unknown:Mu,UnknownClass:Vo,Variant:ma,VariantClass:bi,Vec:wa,VecClass:wi,Visitor:Fu,decode:Lu,encode:Pu},Symbol.toStringTag,{value:"Module"}));var Ia={},yn={};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(r){var e=ln,t=hn,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=u,r.SlowBuffer=j,r.INSPECT_MAX_BYTES=50;var i=2147483647;r.kMaxLength=i,u.TYPED_ARRAY_SUPPORT=o(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var h=new Uint8Array(1),s={foo:function(){return 42}};return Object.setPrototypeOf(s,Uint8Array.prototype),Object.setPrototypeOf(h,s),h.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function l(h){if(h>i)throw new RangeError('The value "'+h+'" is invalid for option "size"');var s=new Uint8Array(h);return Object.setPrototypeOf(s,u.prototype),s}function u(h,s,a){if(typeof h=="number"){if(typeof s=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return B(h)}return y(h,s,a)}u.poolSize=8192;function y(h,s,a){if(typeof h=="string")return N(h,s);if(ArrayBuffer.isView(h))return w(h);if(h==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof h);if(R(h,ArrayBuffer)||h&&R(h.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(R(h,SharedArrayBuffer)||h&&R(h.buffer,SharedArrayBuffer)))return k(h,s,a);if(typeof h=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var p=h.valueOf&&h.valueOf();if(p!=null&&p!==h)return u.from(p,s,a);var x=D(h);if(x)return x;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof h[Symbol.toPrimitive]=="function")return u.from(h[Symbol.toPrimitive]("string"),s,a);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof h)}u.from=function(h,s,a){return y(h,s,a)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array);function b(h){if(typeof h!="number")throw new TypeError('"size" argument must be of type number');if(h<0)throw new RangeError('The value "'+h+'" is invalid for option "size"')}function I(h,s,a){return b(h),h<=0?l(h):s!==void 0?typeof a=="string"?l(h).fill(s,a):l(h).fill(s):l(h)}u.alloc=function(h,s,a){return I(h,s,a)};function B(h){return b(h),l(h<0?0:K(h)|0)}u.allocUnsafe=function(h){return B(h)},u.allocUnsafeSlow=function(h){return B(h)};function N(h,s){if((typeof s!="string"||s==="")&&(s="utf8"),!u.isEncoding(s))throw new TypeError("Unknown encoding: "+s);var a=q(h,s)|0,p=l(a),x=p.write(h,s);return x!==a&&(p=p.slice(0,x)),p}function S(h){for(var s=h.length<0?0:K(h.length)|0,a=l(s),p=0;p<s;p+=1)a[p]=h[p]&255;return a}function w(h){if(R(h,Uint8Array)){var s=new Uint8Array(h);return k(s.buffer,s.byteOffset,s.byteLength)}return S(h)}function k(h,s,a){if(s<0||h.byteLength<s)throw new RangeError('"offset" is outside of buffer bounds');if(h.byteLength<s+(a||0))throw new RangeError('"length" is outside of buffer bounds');var p;return s===void 0&&a===void 0?p=new Uint8Array(h):a===void 0?p=new Uint8Array(h,s):p=new Uint8Array(h,s,a),Object.setPrototypeOf(p,u.prototype),p}function D(h){if(u.isBuffer(h)){var s=K(h.length)|0,a=l(s);return a.length===0||h.copy(a,0,0,s),a}if(h.length!==void 0)return typeof h.length!="number"||O(h.length)?l(0):S(h);if(h.type==="Buffer"&&Array.isArray(h.data))return S(h.data)}function K(h){if(h>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return h|0}function j(h){return+h!=h&&(h=0),u.alloc(+h)}u.isBuffer=function(s){return s!=null&&s._isBuffer===!0&&s!==u.prototype},u.compare=function(s,a){if(R(s,Uint8Array)&&(s=u.from(s,s.offset,s.byteLength)),R(a,Uint8Array)&&(a=u.from(a,a.offset,a.byteLength)),!u.isBuffer(s)||!u.isBuffer(a))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(s===a)return 0;for(var p=s.length,x=a.length,A=0,C=Math.min(p,x);A<C;++A)if(s[A]!==a[A]){p=s[A],x=a[A];break}return p<x?-1:x<p?1:0},u.isEncoding=function(s){switch(String(s).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(s,a){if(!Array.isArray(s))throw new TypeError('"list" argument must be an Array of Buffers');if(s.length===0)return u.alloc(0);var p;if(a===void 0)for(a=0,p=0;p<s.length;++p)a+=s[p].length;var x=u.allocUnsafe(a),A=0;for(p=0;p<s.length;++p){var C=s[p];if(R(C,Uint8Array))A+C.length>x.length?u.from(C).copy(x,A):Uint8Array.prototype.set.call(x,C,A);else if(u.isBuffer(C))C.copy(x,A);else throw new TypeError('"list" argument must be an Array of Buffers');A+=C.length}return x};function q(h,s){if(u.isBuffer(h))return h.length;if(ArrayBuffer.isView(h)||R(h,ArrayBuffer))return h.byteLength;if(typeof h!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof h);var a=h.length,p=arguments.length>2&&arguments[2]===!0;if(!p&&a===0)return 0;for(var x=!1;;)switch(s){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":return te(h).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return a*2;case"hex":return a>>>1;case"base64":return _(h).length;default:if(x)return p?-1:te(h).length;s=(""+s).toLowerCase(),x=!0}}u.byteLength=q;function ie(h,s,a){var p=!1;if((s===void 0||s<0)&&(s=0),s>this.length||((a===void 0||a>this.length)&&(a=this.length),a<=0)||(a>>>=0,s>>>=0,a<=s))return"";for(h||(h="utf8");;)switch(h){case"hex":return ee(this,s,a);case"utf8":case"utf-8":return P(this,s,a);case"ascii":return W(this,s,a);case"latin1":case"binary":return G(this,s,a);case"base64":return T(this,s,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return le(this,s,a);default:if(p)throw new TypeError("Unknown encoding: "+h);h=(h+"").toLowerCase(),p=!0}}u.prototype._isBuffer=!0;function M(h,s,a){var p=h[s];h[s]=h[a],h[a]=p}u.prototype.swap16=function(){var s=this.length;if(s%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var a=0;a<s;a+=2)M(this,a,a+1);return this},u.prototype.swap32=function(){var s=this.length;if(s%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var a=0;a<s;a+=4)M(this,a,a+3),M(this,a+1,a+2);return this},u.prototype.swap64=function(){var s=this.length;if(s%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var a=0;a<s;a+=8)M(this,a,a+7),M(this,a+1,a+6),M(this,a+2,a+5),M(this,a+3,a+4);return this},u.prototype.toString=function(){var s=this.length;return s===0?"":arguments.length===0?P(this,0,s):ie.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(s){if(!u.isBuffer(s))throw new TypeError("Argument must be a Buffer");return this===s?!0:u.compare(this,s)===0},u.prototype.inspect=function(){var s="",a=r.INSPECT_MAX_BYTES;return s=this.toString("hex",0,a).replace(/(.{2})/g,"$1 ").trim(),this.length>a&&(s+=" ... "),"<Buffer "+s+">"},n&&(u.prototype[n]=u.prototype.inspect),u.prototype.compare=function(s,a,p,x,A){if(R(s,Uint8Array)&&(s=u.from(s,s.offset,s.byteLength)),!u.isBuffer(s))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof s);if(a===void 0&&(a=0),p===void 0&&(p=s?s.length:0),x===void 0&&(x=0),A===void 0&&(A=this.length),a<0||p>s.length||x<0||A>this.length)throw new RangeError("out of range index");if(x>=A&&a>=p)return 0;if(x>=A)return-1;if(a>=p)return 1;if(a>>>=0,p>>>=0,x>>>=0,A>>>=0,this===s)return 0;for(var C=A-x,se=p-a,pe=Math.min(C,se),ge=this.slice(x,A),Ee=s.slice(a,p),d=0;d<pe;++d)if(ge[d]!==Ee[d]){C=ge[d],se=Ee[d];break}return C<se?-1:se<C?1:0};function Y(h,s,a,p,x){if(h.length===0)return-1;if(typeof a=="string"?(p=a,a=0):a>2147483647?a=2147483647:a<-2147483648&&(a=-2147483648),a=+a,O(a)&&(a=x?0:h.length-1),a<0&&(a=h.length+a),a>=h.length){if(x)return-1;a=h.length-1}else if(a<0)if(x)a=0;else return-1;if(typeof s=="string"&&(s=u.from(s,p)),u.isBuffer(s))return s.length===0?-1:z(h,s,a,p,x);if(typeof s=="number")return s=s&255,typeof Uint8Array.prototype.indexOf=="function"?x?Uint8Array.prototype.indexOf.call(h,s,a):Uint8Array.prototype.lastIndexOf.call(h,s,a):z(h,[s],a,p,x);throw new TypeError("val must be string, number or Buffer")}function z(h,s,a,p,x){var A=1,C=h.length,se=s.length;if(p!==void 0&&(p=String(p).toLowerCase(),p==="ucs2"||p==="ucs-2"||p==="utf16le"||p==="utf-16le")){if(h.length<2||s.length<2)return-1;A=2,C/=2,se/=2,a/=2}function pe(f,E){return A===1?f[E]:f.readUInt16BE(E*A)}var ge;if(x){var Ee=-1;for(ge=a;ge<C;ge++)if(pe(h,ge)===pe(s,Ee===-1?0:ge-Ee)){if(Ee===-1&&(Ee=ge),ge-Ee+1===se)return Ee*A}else Ee!==-1&&(ge-=ge-Ee),Ee=-1}else for(a+se>C&&(a=C-se),ge=a;ge>=0;ge--){for(var d=!0,c=0;c<se;c++)if(pe(h,ge+c)!==pe(s,c)){d=!1;break}if(d)return ge}return-1}u.prototype.includes=function(s,a,p){return this.indexOf(s,a,p)!==-1},u.prototype.indexOf=function(s,a,p){return Y(this,s,a,p,!0)},u.prototype.lastIndexOf=function(s,a,p){return Y(this,s,a,p,!1)};function J(h,s,a,p){a=Number(a)||0;var x=h.length-a;p?(p=Number(p),p>x&&(p=x)):p=x;var A=s.length;p>A/2&&(p=A/2);for(var C=0;C<p;++C){var se=parseInt(s.substr(C*2,2),16);if(O(se))return C;h[a+C]=se}return C}function re(h,s,a,p){return v(te(s,h.length-a),h,a,p)}function Z(h,s,a,p){return v(ae(s),h,a,p)}function ye(h,s,a,p){return v(_(s),h,a,p)}function he(h,s,a,p){return v(m(s,h.length-a),h,a,p)}u.prototype.write=function(s,a,p,x){if(a===void 0)x="utf8",p=this.length,a=0;else if(p===void 0&&typeof a=="string")x=a,p=this.length,a=0;else if(isFinite(a))a=a>>>0,isFinite(p)?(p=p>>>0,x===void 0&&(x="utf8")):(x=p,p=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var A=this.length-a;if((p===void 0||p>A)&&(p=A),s.length>0&&(p<0||a<0)||a>this.length)throw new RangeError("Attempt to write outside buffer bounds");x||(x="utf8");for(var C=!1;;)switch(x){case"hex":return J(this,s,a,p);case"utf8":case"utf-8":return re(this,s,a,p);case"ascii":case"latin1":case"binary":return Z(this,s,a,p);case"base64":return ye(this,s,a,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return he(this,s,a,p);default:if(C)throw new TypeError("Unknown encoding: "+x);x=(""+x).toLowerCase(),C=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function T(h,s,a){return s===0&&a===h.length?e.fromByteArray(h):e.fromByteArray(h.slice(s,a))}function P(h,s,a){a=Math.min(h.length,a);for(var p=[],x=s;x<a;){var A=h[x],C=null,se=A>239?4:A>223?3:A>191?2:1;if(x+se<=a){var pe,ge,Ee,d;switch(se){case 1:A<128&&(C=A);break;case 2:pe=h[x+1],(pe&192)===128&&(d=(A&31)<<6|pe&63,d>127&&(C=d));break;case 3:pe=h[x+1],ge=h[x+2],(pe&192)===128&&(ge&192)===128&&(d=(A&15)<<12|(pe&63)<<6|ge&63,d>2047&&(d<55296||d>57343)&&(C=d));break;case 4:pe=h[x+1],ge=h[x+2],Ee=h[x+3],(pe&192)===128&&(ge&192)===128&&(Ee&192)===128&&(d=(A&15)<<18|(pe&63)<<12|(ge&63)<<6|Ee&63,d>65535&&d<1114112&&(C=d))}}C===null?(C=65533,se=1):C>65535&&(C-=65536,p.push(C>>>10&1023|55296),C=56320|C&1023),p.push(C),x+=se}return X(p)}var V=4096;function X(h){var s=h.length;if(s<=V)return String.fromCharCode.apply(String,h);for(var a="",p=0;p<s;)a+=String.fromCharCode.apply(String,h.slice(p,p+=V));return a}function W(h,s,a){var p="";a=Math.min(h.length,a);for(var x=s;x<a;++x)p+=String.fromCharCode(h[x]&127);return p}function G(h,s,a){var p="";a=Math.min(h.length,a);for(var x=s;x<a;++x)p+=String.fromCharCode(h[x]);return p}function ee(h,s,a){var p=h.length;(!s||s<0)&&(s=0),(!a||a<0||a>p)&&(a=p);for(var x="",A=s;A<a;++A)x+=L[h[A]];return x}function le(h,s,a){for(var p=h.slice(s,a),x="",A=0;A<p.length-1;A+=2)x+=String.fromCharCode(p[A]+p[A+1]*256);return x}u.prototype.slice=function(s,a){var p=this.length;s=~~s,a=a===void 0?p:~~a,s<0?(s+=p,s<0&&(s=0)):s>p&&(s=p),a<0?(a+=p,a<0&&(a=0)):a>p&&(a=p),a<s&&(a=s);var x=this.subarray(s,a);return Object.setPrototypeOf(x,u.prototype),x};function oe(h,s,a){if(h%1!==0||h<0)throw new RangeError("offset is not uint");if(h+s>a)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(s,a,p){s=s>>>0,a=a>>>0,p||oe(s,a,this.length);for(var x=this[s],A=1,C=0;++C<a&&(A*=256);)x+=this[s+C]*A;return x},u.prototype.readUintBE=u.prototype.readUIntBE=function(s,a,p){s=s>>>0,a=a>>>0,p||oe(s,a,this.length);for(var x=this[s+--a],A=1;a>0&&(A*=256);)x+=this[s+--a]*A;return x},u.prototype.readUint8=u.prototype.readUInt8=function(s,a){return s=s>>>0,a||oe(s,1,this.length),this[s]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(s,a){return s=s>>>0,a||oe(s,2,this.length),this[s]|this[s+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(s,a){return s=s>>>0,a||oe(s,2,this.length),this[s]<<8|this[s+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(s,a){return s=s>>>0,a||oe(s,4,this.length),(this[s]|this[s+1]<<8|this[s+2]<<16)+this[s+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(s,a){return s=s>>>0,a||oe(s,4,this.length),this[s]*16777216+(this[s+1]<<16|this[s+2]<<8|this[s+3])},u.prototype.readIntLE=function(s,a,p){s=s>>>0,a=a>>>0,p||oe(s,a,this.length);for(var x=this[s],A=1,C=0;++C<a&&(A*=256);)x+=this[s+C]*A;return A*=128,x>=A&&(x-=Math.pow(2,8*a)),x},u.prototype.readIntBE=function(s,a,p){s=s>>>0,a=a>>>0,p||oe(s,a,this.length);for(var x=a,A=1,C=this[s+--x];x>0&&(A*=256);)C+=this[s+--x]*A;return A*=128,C>=A&&(C-=Math.pow(2,8*a)),C},u.prototype.readInt8=function(s,a){return s=s>>>0,a||oe(s,1,this.length),this[s]&128?(255-this[s]+1)*-1:this[s]},u.prototype.readInt16LE=function(s,a){s=s>>>0,a||oe(s,2,this.length);var p=this[s]|this[s+1]<<8;return p&32768?p|4294901760:p},u.prototype.readInt16BE=function(s,a){s=s>>>0,a||oe(s,2,this.length);var p=this[s+1]|this[s]<<8;return p&32768?p|4294901760:p},u.prototype.readInt32LE=function(s,a){return s=s>>>0,a||oe(s,4,this.length),this[s]|this[s+1]<<8|this[s+2]<<16|this[s+3]<<24},u.prototype.readInt32BE=function(s,a){return s=s>>>0,a||oe(s,4,this.length),this[s]<<24|this[s+1]<<16|this[s+2]<<8|this[s+3]},u.prototype.readFloatLE=function(s,a){return s=s>>>0,a||oe(s,4,this.length),t.read(this,s,!0,23,4)},u.prototype.readFloatBE=function(s,a){return s=s>>>0,a||oe(s,4,this.length),t.read(this,s,!1,23,4)},u.prototype.readDoubleLE=function(s,a){return s=s>>>0,a||oe(s,8,this.length),t.read(this,s,!0,52,8)},u.prototype.readDoubleBE=function(s,a){return s=s>>>0,a||oe(s,8,this.length),t.read(this,s,!1,52,8)};function fe(h,s,a,p,x,A){if(!u.isBuffer(h))throw new TypeError('"buffer" argument must be a Buffer instance');if(s>x||s<A)throw new RangeError('"value" argument is out of bounds');if(a+p>h.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(s,a,p,x){if(s=+s,a=a>>>0,p=p>>>0,!x){var A=Math.pow(2,8*p)-1;fe(this,s,a,p,A,0)}var C=1,se=0;for(this[a]=s&255;++se<p&&(C*=256);)this[a+se]=s/C&255;return a+p},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(s,a,p,x){if(s=+s,a=a>>>0,p=p>>>0,!x){var A=Math.pow(2,8*p)-1;fe(this,s,a,p,A,0)}var C=p-1,se=1;for(this[a+C]=s&255;--C>=0&&(se*=256);)this[a+C]=s/se&255;return a+p},u.prototype.writeUint8=u.prototype.writeUInt8=function(s,a,p){return s=+s,a=a>>>0,p||fe(this,s,a,1,255,0),this[a]=s&255,a+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(s,a,p){return s=+s,a=a>>>0,p||fe(this,s,a,2,65535,0),this[a]=s&255,this[a+1]=s>>>8,a+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(s,a,p){return s=+s,a=a>>>0,p||fe(this,s,a,2,65535,0),this[a]=s>>>8,this[a+1]=s&255,a+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(s,a,p){return s=+s,a=a>>>0,p||fe(this,s,a,4,4294967295,0),this[a+3]=s>>>24,this[a+2]=s>>>16,this[a+1]=s>>>8,this[a]=s&255,a+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(s,a,p){return s=+s,a=a>>>0,p||fe(this,s,a,4,4294967295,0),this[a]=s>>>24,this[a+1]=s>>>16,this[a+2]=s>>>8,this[a+3]=s&255,a+4},u.prototype.writeIntLE=function(s,a,p,x){if(s=+s,a=a>>>0,!x){var A=Math.pow(2,8*p-1);fe(this,s,a,p,A-1,-A)}var C=0,se=1,pe=0;for(this[a]=s&255;++C<p&&(se*=256);)s<0&&pe===0&&this[a+C-1]!==0&&(pe=1),this[a+C]=(s/se>>0)-pe&255;return a+p},u.prototype.writeIntBE=function(s,a,p,x){if(s=+s,a=a>>>0,!x){var A=Math.pow(2,8*p-1);fe(this,s,a,p,A-1,-A)}var C=p-1,se=1,pe=0;for(this[a+C]=s&255;--C>=0&&(se*=256);)s<0&&pe===0&&this[a+C+1]!==0&&(pe=1),this[a+C]=(s/se>>0)-pe&255;return a+p},u.prototype.writeInt8=function(s,a,p){return s=+s,a=a>>>0,p||fe(this,s,a,1,127,-128),s<0&&(s=255+s+1),this[a]=s&255,a+1},u.prototype.writeInt16LE=function(s,a,p){return s=+s,a=a>>>0,p||fe(this,s,a,2,32767,-32768),this[a]=s&255,this[a+1]=s>>>8,a+2},u.prototype.writeInt16BE=function(s,a,p){return s=+s,a=a>>>0,p||fe(this,s,a,2,32767,-32768),this[a]=s>>>8,this[a+1]=s&255,a+2},u.prototype.writeInt32LE=function(s,a,p){return s=+s,a=a>>>0,p||fe(this,s,a,4,2147483647,-2147483648),this[a]=s&255,this[a+1]=s>>>8,this[a+2]=s>>>16,this[a+3]=s>>>24,a+4},u.prototype.writeInt32BE=function(s,a,p){return s=+s,a=a>>>0,p||fe(this,s,a,4,2147483647,-2147483648),s<0&&(s=4294967295+s+1),this[a]=s>>>24,this[a+1]=s>>>16,this[a+2]=s>>>8,this[a+3]=s&255,a+4};function Q(h,s,a,p,x,A){if(a+p>h.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function g(h,s,a,p,x){return s=+s,a=a>>>0,x||Q(h,s,a,4),t.write(h,s,a,p,23,4),a+4}u.prototype.writeFloatLE=function(s,a,p){return g(this,s,a,!0,p)},u.prototype.writeFloatBE=function(s,a,p){return g(this,s,a,!1,p)};function ne(h,s,a,p,x){return s=+s,a=a>>>0,x||Q(h,s,a,8),t.write(h,s,a,p,52,8),a+8}u.prototype.writeDoubleLE=function(s,a,p){return ne(this,s,a,!0,p)},u.prototype.writeDoubleBE=function(s,a,p){return ne(this,s,a,!1,p)},u.prototype.copy=function(s,a,p,x){if(!u.isBuffer(s))throw new TypeError("argument should be a Buffer");if(p||(p=0),!x&&x!==0&&(x=this.length),a>=s.length&&(a=s.length),a||(a=0),x>0&&x<p&&(x=p),x===p||s.length===0||this.length===0)return 0;if(a<0)throw new RangeError("targetStart out of bounds");if(p<0||p>=this.length)throw new RangeError("Index out of range");if(x<0)throw new RangeError("sourceEnd out of bounds");x>this.length&&(x=this.length),s.length-a<x-p&&(x=s.length-a+p);var A=x-p;return this===s&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(a,p,x):Uint8Array.prototype.set.call(s,this.subarray(p,x),a),A},u.prototype.fill=function(s,a,p,x){if(typeof s=="string"){if(typeof a=="string"?(x=a,a=0,p=this.length):typeof p=="string"&&(x=p,p=this.length),x!==void 0&&typeof x!="string")throw new TypeError("encoding must be a string");if(typeof x=="string"&&!u.isEncoding(x))throw new TypeError("Unknown encoding: "+x);if(s.length===1){var A=s.charCodeAt(0);(x==="utf8"&&A<128||x==="latin1")&&(s=A)}}else typeof s=="number"?s=s&255:typeof s=="boolean"&&(s=Number(s));if(a<0||this.length<a||this.length<p)throw new RangeError("Out of range index");if(p<=a)return this;a=a>>>0,p=p===void 0?this.length:p>>>0,s||(s=0);var C;if(typeof s=="number")for(C=a;C<p;++C)this[C]=s;else{var se=u.isBuffer(s)?s:u.from(s,x),pe=se.length;if(pe===0)throw new TypeError('The value "'+s+'" is invalid for argument "value"');for(C=0;C<p-a;++C)this[C+a]=se[C%pe]}return this};var ue=/[^+/0-9A-Za-z-_]/g;function de(h){if(h=h.split("=")[0],h=h.trim().replace(ue,""),h.length<2)return"";for(;h.length%4!==0;)h=h+"=";return h}function te(h,s){s=s||1/0;for(var a,p=h.length,x=null,A=[],C=0;C<p;++C){if(a=h.charCodeAt(C),a>55295&&a<57344){if(!x){if(a>56319){(s-=3)>-1&&A.push(239,191,189);continue}else if(C+1===p){(s-=3)>-1&&A.push(239,191,189);continue}x=a;continue}if(a<56320){(s-=3)>-1&&A.push(239,191,189),x=a;continue}a=(x-55296<<10|a-56320)+65536}else x&&(s-=3)>-1&&A.push(239,191,189);if(x=null,a<128){if((s-=1)<0)break;A.push(a)}else if(a<2048){if((s-=2)<0)break;A.push(a>>6|192,a&63|128)}else if(a<65536){if((s-=3)<0)break;A.push(a>>12|224,a>>6&63|128,a&63|128)}else if(a<1114112){if((s-=4)<0)break;A.push(a>>18|240,a>>12&63|128,a>>6&63|128,a&63|128)}else throw new Error("Invalid code point")}return A}function ae(h){for(var s=[],a=0;a<h.length;++a)s.push(h.charCodeAt(a)&255);return s}function m(h,s){for(var a,p,x,A=[],C=0;C<h.length&&!((s-=2)<0);++C)a=h.charCodeAt(C),p=a>>8,x=a%256,A.push(x),A.push(p);return A}function _(h){return e.toByteArray(de(h))}function v(h,s,a,p){for(var x=0;x<p&&!(x+a>=s.length||x>=h.length);++x)s[x+a]=h[x];return x}function R(h,s){return h instanceof s||h!=null&&h.constructor!=null&&h.constructor.name!=null&&h.constructor.name===s.name}function O(h){return h!==h}var L=function(){for(var h="0123456789abcdef",s=new Array(256),a=0;a<16;++a)for(var p=a*16,x=0;x<16;++x)s[p+x]=h[a]+h[x];return s}()})(yn);var va={exports:{}};(function(r){(function(e){var t,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,l="[BigNumber Error] ",u=l+"Number primitive has more than 15 significant digits: ",y=1e14,b=14,I=9007199254740991,B=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],N=1e7,S=1e9;function w(Y){var z,J,re,Z=g.prototype={constructor:g,toString:null,valueOf:null},ye=new g(1),he=20,T=4,P=-7,V=21,X=-1e7,W=1e7,G=!1,ee=1,le=0,oe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},fe="0123456789abcdefghijklmnopqrstuvwxyz",Q=!0;function g(m,_){var v,R,O,L,h,s,a,p,x=this;if(!(x instanceof g))return new g(m,_);if(_==null){if(m&&m._isBigNumber===!0){x.s=m.s,!m.c||m.e>W?x.c=x.e=null:m.e<X?x.c=[x.e=0]:(x.e=m.e,x.c=m.c.slice());return}if((s=typeof m=="number")&&m*0==0){if(x.s=1/m<0?(m=-m,-1):1,m===~~m){for(L=0,h=m;h>=10;h/=10,L++);L>W?x.c=x.e=null:(x.e=L,x.c=[m]);return}p=String(m)}else{if(!n.test(p=String(m)))return re(x,p,s);x.s=p.charCodeAt(0)==45?(p=p.slice(1),-1):1}(L=p.indexOf("."))>-1&&(p=p.replace(".","")),(h=p.search(/e/i))>0?(L<0&&(L=h),L+=+p.slice(h+1),p=p.substring(0,h)):L<0&&(L=p.length)}else{if(j(_,2,fe.length,"Base"),_==10&&Q)return x=new g(m),te(x,he+x.e+1,T);if(p=String(m),s=typeof m=="number"){if(m*0!=0)return re(x,p,s,_);if(x.s=1/m<0?(p=p.slice(1),-1):1,g.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(u+m)}else x.s=p.charCodeAt(0)===45?(p=p.slice(1),-1):1;for(v=fe.slice(0,_),L=h=0,a=p.length;h<a;h++)if(v.indexOf(R=p.charAt(h))<0){if(R=="."){if(h>L){L=a;continue}}else if(!O&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){O=!0,h=-1,L=0;continue}return re(x,String(m),s,_)}s=!1,p=J(p,_,10,x.s),(L=p.indexOf("."))>-1?p=p.replace(".",""):L=p.length}for(h=0;p.charCodeAt(h)===48;h++);for(a=p.length;p.charCodeAt(--a)===48;);if(p=p.slice(h,++a)){if(a-=h,s&&g.DEBUG&&a>15&&(m>I||m!==o(m)))throw Error(u+x.s*m);if((L=L-h-1)>W)x.c=x.e=null;else if(L<X)x.c=[x.e=0];else{if(x.e=L,x.c=[],h=(L+1)%b,L<0&&(h+=b),h<a){for(h&&x.c.push(+p.slice(0,h)),a-=b;h<a;)x.c.push(+p.slice(h,h+=b));h=b-(p=p.slice(h)).length}else h-=a;for(;h--;p+="0");x.c.push(+p)}}else x.c=[x.e=0]}g.clone=w,g.ROUND_UP=0,g.ROUND_DOWN=1,g.ROUND_CEIL=2,g.ROUND_FLOOR=3,g.ROUND_HALF_UP=4,g.ROUND_HALF_DOWN=5,g.ROUND_HALF_EVEN=6,g.ROUND_HALF_CEIL=7,g.ROUND_HALF_FLOOR=8,g.EUCLID=9,g.config=g.set=function(m){var _,v;if(m!=null)if(typeof m=="object"){if(m.hasOwnProperty(_="DECIMAL_PLACES")&&(v=m[_],j(v,0,S,_),he=v),m.hasOwnProperty(_="ROUNDING_MODE")&&(v=m[_],j(v,0,8,_),T=v),m.hasOwnProperty(_="EXPONENTIAL_AT")&&(v=m[_],v&&v.pop?(j(v[0],-S,0,_),j(v[1],0,S,_),P=v[0],V=v[1]):(j(v,-S,S,_),P=-(V=v<0?-v:v))),m.hasOwnProperty(_="RANGE"))if(v=m[_],v&&v.pop)j(v[0],-S,-1,_),j(v[1],1,S,_),X=v[0],W=v[1];else if(j(v,-S,S,_),v)X=-(W=v<0?-v:v);else throw Error(l+_+" cannot be zero: "+v);if(m.hasOwnProperty(_="CRYPTO"))if(v=m[_],v===!!v)if(v)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))G=v;else throw G=!v,Error(l+"crypto unavailable");else G=v;else throw Error(l+_+" not true or false: "+v);if(m.hasOwnProperty(_="MODULO_MODE")&&(v=m[_],j(v,0,9,_),ee=v),m.hasOwnProperty(_="POW_PRECISION")&&(v=m[_],j(v,0,S,_),le=v),m.hasOwnProperty(_="FORMAT"))if(v=m[_],typeof v=="object")oe=v;else throw Error(l+_+" not an object: "+v);if(m.hasOwnProperty(_="ALPHABET"))if(v=m[_],typeof v=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(v))Q=v.slice(0,10)=="0123456789",fe=v;else throw Error(l+_+" invalid: "+v)}else throw Error(l+"Object expected: "+m);return{DECIMAL_PLACES:he,ROUNDING_MODE:T,EXPONENTIAL_AT:[P,V],RANGE:[X,W],CRYPTO:G,MODULO_MODE:ee,POW_PRECISION:le,FORMAT:oe,ALPHABET:fe}},g.isBigNumber=function(m){if(!m||m._isBigNumber!==!0)return!1;if(!g.DEBUG)return!0;var _,v,R=m.c,O=m.e,L=m.s;e:if({}.toString.call(R)=="[object Array]"){if((L===1||L===-1)&&O>=-S&&O<=S&&O===o(O)){if(R[0]===0){if(O===0&&R.length===1)return!0;break e}if(_=(O+1)%b,_<1&&(_+=b),String(R[0]).length==_){for(_=0;_<R.length;_++)if(v=R[_],v<0||v>=y||v!==o(v))break e;if(v!==0)return!0}}}else if(R===null&&O===null&&(L===null||L===1||L===-1))return!0;throw Error(l+"Invalid BigNumber: "+m)},g.maximum=g.max=function(){return ue(arguments,-1)},g.minimum=g.min=function(){return ue(arguments,1)},g.random=function(){var m=9007199254740992,_=Math.random()*m&2097151?function(){return o(Math.random()*m)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(v){var R,O,L,h,s,a=0,p=[],x=new g(ye);if(v==null?v=he:j(v,0,S),h=i(v/b),G)if(crypto.getRandomValues){for(R=crypto.getRandomValues(new Uint32Array(h*=2));a<h;)s=R[a]*131072+(R[a+1]>>>11),s>=9e15?(O=crypto.getRandomValues(new Uint32Array(2)),R[a]=O[0],R[a+1]=O[1]):(p.push(s%1e14),a+=2);a=h/2}else if(crypto.randomBytes){for(R=crypto.randomBytes(h*=7);a<h;)s=(R[a]&31)*281474976710656+R[a+1]*1099511627776+R[a+2]*4294967296+R[a+3]*16777216+(R[a+4]<<16)+(R[a+5]<<8)+R[a+6],s>=9e15?crypto.randomBytes(7).copy(R,a):(p.push(s%1e14),a+=7);a=h/7}else throw G=!1,Error(l+"crypto unavailable");if(!G)for(;a<h;)s=_(),s<9e15&&(p[a++]=s%1e14);for(h=p[--a],v%=b,h&&v&&(s=B[b-v],p[a]=o(h/s)*s);p[a]===0;p.pop(),a--);if(a<0)p=[L=0];else{for(L=-1;p[0]===0;p.splice(0,1),L-=b);for(a=1,s=p[0];s>=10;s/=10,a++);a<b&&(L-=b-a)}return x.e=L,x.c=p,x}}(),g.sum=function(){for(var m=1,_=arguments,v=new g(_[0]);m<_.length;)v=v.plus(_[m++]);return v},J=function(){var m="0123456789";function _(v,R,O,L){for(var h,s=[0],a,p=0,x=v.length;p<x;){for(a=s.length;a--;s[a]*=R);for(s[0]+=L.indexOf(v.charAt(p++)),h=0;h<s.length;h++)s[h]>O-1&&(s[h+1]==null&&(s[h+1]=0),s[h+1]+=s[h]/O|0,s[h]%=O)}return s.reverse()}return function(v,R,O,L,h){var s,a,p,x,A,C,se,pe,ge=v.indexOf("."),Ee=he,d=T;for(ge>=0&&(x=le,le=0,v=v.replace(".",""),pe=new g(R),C=pe.pow(v.length-ge),le=x,pe.c=_(M(D(C.c),C.e,"0"),10,O,m),pe.e=pe.c.length),se=_(v,R,O,h?(s=fe,m):(s=m,fe)),p=x=se.length;se[--x]==0;se.pop());if(!se[0])return s.charAt(0);if(ge<0?--p:(C.c=se,C.e=p,C.s=L,C=z(C,pe,Ee,d,O),se=C.c,A=C.r,p=C.e),a=p+Ee+1,ge=se[a],x=O/2,A=A||a<0||se[a+1]!=null,A=d<4?(ge!=null||A)&&(d==0||d==(C.s<0?3:2)):ge>x||ge==x&&(d==4||A||d==6&&se[a-1]&1||d==(C.s<0?8:7)),a<1||!se[0])v=A?M(s.charAt(1),-Ee,s.charAt(0)):s.charAt(0);else{if(se.length=a,A)for(--O;++se[--a]>O;)se[a]=0,a||(++p,se=[1].concat(se));for(x=se.length;!se[--x];);for(ge=0,v="";ge<=x;v+=s.charAt(se[ge++]));v=M(v,p,s.charAt(0))}return v}}(),z=function(){function m(R,O,L){var h,s,a,p,x=0,A=R.length,C=O%N,se=O/N|0;for(R=R.slice();A--;)a=R[A]%N,p=R[A]/N|0,h=se*a+p*C,s=C*a+h%N*N+x,x=(s/L|0)+(h/N|0)+se*p,R[A]=s%L;return x&&(R=[x].concat(R)),R}function _(R,O,L,h){var s,a;if(L!=h)a=L>h?1:-1;else for(s=a=0;s<L;s++)if(R[s]!=O[s]){a=R[s]>O[s]?1:-1;break}return a}function v(R,O,L,h){for(var s=0;L--;)R[L]-=s,s=R[L]<O[L]?1:0,R[L]=s*h+R[L]-O[L];for(;!R[0]&&R.length>1;R.splice(0,1));}return function(R,O,L,h,s){var a,p,x,A,C,se,pe,ge,Ee,d,c,f,E,F,H,$,xe,ve=R.s==O.s?1:-1,_e=R.c,me=O.c;if(!_e||!_e[0]||!me||!me[0])return new g(!R.s||!O.s||(_e?me&&_e[0]==me[0]:!me)?NaN:_e&&_e[0]==0||!me?ve*0:ve/0);for(ge=new g(ve),Ee=ge.c=[],p=R.e-O.e,ve=L+p+1,s||(s=y,p=k(R.e/b)-k(O.e/b),ve=ve/b|0),x=0;me[x]==(_e[x]||0);x++);if(me[x]>(_e[x]||0)&&p--,ve<0)Ee.push(1),A=!0;else{for(F=_e.length,$=me.length,x=0,ve+=2,C=o(s/(me[0]+1)),C>1&&(me=m(me,C,s),_e=m(_e,C,s),$=me.length,F=_e.length),E=$,d=_e.slice(0,$),c=d.length;c<$;d[c++]=0);xe=me.slice(),xe=[0].concat(xe),H=me[0],me[1]>=s/2&&H++;do{if(C=0,a=_(me,d,$,c),a<0){if(f=d[0],$!=c&&(f=f*s+(d[1]||0)),C=o(f/H),C>1)for(C>=s&&(C=s-1),se=m(me,C,s),pe=se.length,c=d.length;_(se,d,pe,c)==1;)C--,v(se,$<pe?xe:me,pe,s),pe=se.length,a=1;else C==0&&(a=C=1),se=me.slice(),pe=se.length;if(pe<c&&(se=[0].concat(se)),v(d,se,c,s),c=d.length,a==-1)for(;_(me,d,$,c)<1;)C++,v(d,$<c?xe:me,c,s),c=d.length}else a===0&&(C++,d=[0]);Ee[x++]=C,d[0]?d[c++]=_e[E]||0:(d=[_e[E]],c=1)}while((E++<F||d[0]!=null)&&ve--);A=d[0]!=null,Ee[0]||Ee.splice(0,1)}if(s==y){for(x=1,ve=Ee[0];ve>=10;ve/=10,x++);te(ge,L+(ge.e=x+p*b-1)+1,h,A)}else ge.e=p,ge.r=+A;return ge}}();function ne(m,_,v,R){var O,L,h,s,a;if(v==null?v=T:j(v,0,8),!m.c)return m.toString();if(O=m.c[0],h=m.e,_==null)a=D(m.c),a=R==1||R==2&&(h<=P||h>=V)?ie(a,h):M(a,h,"0");else if(m=te(new g(m),_,v),L=m.e,a=D(m.c),s=a.length,R==1||R==2&&(_<=L||L<=P)){for(;s<_;a+="0",s++);a=ie(a,L)}else if(_-=h,a=M(a,L,"0"),L+1>s){if(--_>0)for(a+=".";_--;a+="0");}else if(_+=L-s,_>0)for(L+1==s&&(a+=".");_--;a+="0");return m.s<0&&O?"-"+a:a}function ue(m,_){for(var v,R,O=1,L=new g(m[0]);O<m.length;O++)R=new g(m[O]),(!R.s||(v=K(L,R))===_||v===0&&L.s===_)&&(L=R);return L}function de(m,_,v){for(var R=1,O=_.length;!_[--O];_.pop());for(O=_[0];O>=10;O/=10,R++);return(v=R+v*b-1)>W?m.c=m.e=null:v<X?m.c=[m.e=0]:(m.e=v,m.c=_),m}re=function(){var m=/^(-?)0([xbo])(?=\w[\w.]*$)/i,_=/^([^.]+)\.$/,v=/^\.([^.]+)$/,R=/^-?(Infinity|NaN)$/,O=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(L,h,s,a){var p,x=s?h:h.replace(O,"");if(R.test(x))L.s=isNaN(x)?null:x<0?-1:1;else{if(!s&&(x=x.replace(m,function(A,C,se){return p=(se=se.toLowerCase())=="x"?16:se=="b"?2:8,!a||a==p?C:A}),a&&(p=a,x=x.replace(_,"$1").replace(v,"0.$1")),h!=x))return new g(x,p);if(g.DEBUG)throw Error(l+"Not a"+(a?" base "+a:"")+" number: "+h);L.s=null}L.c=L.e=null}}();function te(m,_,v,R){var O,L,h,s,a,p,x,A=m.c,C=B;if(A){e:{for(O=1,s=A[0];s>=10;s/=10,O++);if(L=_-O,L<0)L+=b,h=_,a=A[p=0],x=o(a/C[O-h-1]%10);else if(p=i((L+1)/b),p>=A.length)if(R){for(;A.length<=p;A.push(0));a=x=0,O=1,L%=b,h=L-b+1}else break e;else{for(a=s=A[p],O=1;s>=10;s/=10,O++);L%=b,h=L-b+O,x=h<0?0:o(a/C[O-h-1]%10)}if(R=R||_<0||A[p+1]!=null||(h<0?a:a%C[O-h-1]),R=v<4?(x||R)&&(v==0||v==(m.s<0?3:2)):x>5||x==5&&(v==4||R||v==6&&(L>0?h>0?a/C[O-h]:0:A[p-1])%10&1||v==(m.s<0?8:7)),_<1||!A[0])return A.length=0,R?(_-=m.e+1,A[0]=C[(b-_%b)%b],m.e=-_||0):A[0]=m.e=0,m;if(L==0?(A.length=p,s=1,p--):(A.length=p+1,s=C[b-L],A[p]=h>0?o(a/C[O-h]%C[h])*s:0),R)for(;;)if(p==0){for(L=1,h=A[0];h>=10;h/=10,L++);for(h=A[0]+=s,s=1;h>=10;h/=10,s++);L!=s&&(m.e++,A[0]==y&&(A[0]=1));break}else{if(A[p]+=s,A[p]!=y)break;A[p--]=0,s=1}for(L=A.length;A[--L]===0;A.pop());}m.e>W?m.c=m.e=null:m.e<X&&(m.c=[m.e=0])}return m}function ae(m){var _,v=m.e;return v===null?m.toString():(_=D(m.c),_=v<=P||v>=V?ie(_,v):M(_,v,"0"),m.s<0?"-"+_:_)}return Z.absoluteValue=Z.abs=function(){var m=new g(this);return m.s<0&&(m.s=1),m},Z.comparedTo=function(m,_){return K(this,new g(m,_))},Z.decimalPlaces=Z.dp=function(m,_){var v,R,O,L=this;if(m!=null)return j(m,0,S),_==null?_=T:j(_,0,8),te(new g(L),m+L.e+1,_);if(!(v=L.c))return null;if(R=((O=v.length-1)-k(this.e/b))*b,O=v[O])for(;O%10==0;O/=10,R--);return R<0&&(R=0),R},Z.dividedBy=Z.div=function(m,_){return z(this,new g(m,_),he,T)},Z.dividedToIntegerBy=Z.idiv=function(m,_){return z(this,new g(m,_),0,1)},Z.exponentiatedBy=Z.pow=function(m,_){var v,R,O,L,h,s,a,p,x,A=this;if(m=new g(m),m.c&&!m.isInteger())throw Error(l+"Exponent not an integer: "+ae(m));if(_!=null&&(_=new g(_)),s=m.e>14,!A.c||!A.c[0]||A.c[0]==1&&!A.e&&A.c.length==1||!m.c||!m.c[0])return x=new g(Math.pow(+ae(A),s?m.s*(2-q(m)):+ae(m))),_?x.mod(_):x;if(a=m.s<0,_){if(_.c?!_.c[0]:!_.s)return new g(NaN);R=!a&&A.isInteger()&&_.isInteger(),R&&(A=A.mod(_))}else{if(m.e>9&&(A.e>0||A.e<-1||(A.e==0?A.c[0]>1||s&&A.c[1]>=24e7:A.c[0]<8e13||s&&A.c[0]<=9999975e7)))return L=A.s<0&&q(m)?-0:0,A.e>-1&&(L=1/L),new g(a?1/L:L);le&&(L=i(le/b+2))}for(s?(v=new g(.5),a&&(m.s=1),p=q(m)):(O=Math.abs(+ae(m)),p=O%2),x=new g(ye);;){if(p){if(x=x.times(A),!x.c)break;L?x.c.length>L&&(x.c.length=L):R&&(x=x.mod(_))}if(O){if(O=o(O/2),O===0)break;p=O%2}else if(m=m.times(v),te(m,m.e+1,1),m.e>14)p=q(m);else{if(O=+ae(m),O===0)break;p=O%2}A=A.times(A),L?A.c&&A.c.length>L&&(A.c.length=L):R&&(A=A.mod(_))}return R?x:(a&&(x=ye.div(x)),_?x.mod(_):L?te(x,le,T,h):x)},Z.integerValue=function(m){var _=new g(this);return m==null?m=T:j(m,0,8),te(_,_.e+1,m)},Z.isEqualTo=Z.eq=function(m,_){return K(this,new g(m,_))===0},Z.isFinite=function(){return!!this.c},Z.isGreaterThan=Z.gt=function(m,_){return K(this,new g(m,_))>0},Z.isGreaterThanOrEqualTo=Z.gte=function(m,_){return(_=K(this,new g(m,_)))===1||_===0},Z.isInteger=function(){return!!this.c&&k(this.e/b)>this.c.length-2},Z.isLessThan=Z.lt=function(m,_){return K(this,new g(m,_))<0},Z.isLessThanOrEqualTo=Z.lte=function(m,_){return(_=K(this,new g(m,_)))===-1||_===0},Z.isNaN=function(){return!this.s},Z.isNegative=function(){return this.s<0},Z.isPositive=function(){return this.s>0},Z.isZero=function(){return!!this.c&&this.c[0]==0},Z.minus=function(m,_){var v,R,O,L,h=this,s=h.s;if(m=new g(m,_),_=m.s,!s||!_)return new g(NaN);if(s!=_)return m.s=-_,h.plus(m);var a=h.e/b,p=m.e/b,x=h.c,A=m.c;if(!a||!p){if(!x||!A)return x?(m.s=-_,m):new g(A?h:NaN);if(!x[0]||!A[0])return A[0]?(m.s=-_,m):new g(x[0]?h:T==3?-0:0)}if(a=k(a),p=k(p),x=x.slice(),s=a-p){for((L=s<0)?(s=-s,O=x):(p=a,O=A),O.reverse(),_=s;_--;O.push(0));O.reverse()}else for(R=(L=(s=x.length)<(_=A.length))?s:_,s=_=0;_<R;_++)if(x[_]!=A[_]){L=x[_]<A[_];break}if(L&&(O=x,x=A,A=O,m.s=-m.s),_=(R=A.length)-(v=x.length),_>0)for(;_--;x[v++]=0);for(_=y-1;R>s;){if(x[--R]<A[R]){for(v=R;v&&!x[--v];x[v]=_);--x[v],x[R]+=y}x[R]-=A[R]}for(;x[0]==0;x.splice(0,1),--p);return x[0]?de(m,x,p):(m.s=T==3?-1:1,m.c=[m.e=0],m)},Z.modulo=Z.mod=function(m,_){var v,R,O=this;return m=new g(m,_),!O.c||!m.s||m.c&&!m.c[0]?new g(NaN):!m.c||O.c&&!O.c[0]?new g(O):(ee==9?(R=m.s,m.s=1,v=z(O,m,0,3),m.s=R,v.s*=R):v=z(O,m,0,ee),m=O.minus(v.times(m)),!m.c[0]&&ee==1&&(m.s=O.s),m)},Z.multipliedBy=Z.times=function(m,_){var v,R,O,L,h,s,a,p,x,A,C,se,pe,ge,Ee,d=this,c=d.c,f=(m=new g(m,_)).c;if(!c||!f||!c[0]||!f[0])return!d.s||!m.s||c&&!c[0]&&!f||f&&!f[0]&&!c?m.c=m.e=m.s=null:(m.s*=d.s,!c||!f?m.c=m.e=null:(m.c=[0],m.e=0)),m;for(R=k(d.e/b)+k(m.e/b),m.s*=d.s,a=c.length,A=f.length,a<A&&(pe=c,c=f,f=pe,O=a,a=A,A=O),O=a+A,pe=[];O--;pe.push(0));for(ge=y,Ee=N,O=A;--O>=0;){for(v=0,C=f[O]%Ee,se=f[O]/Ee|0,h=a,L=O+h;L>O;)p=c[--h]%Ee,x=c[h]/Ee|0,s=se*p+x*C,p=C*p+s%Ee*Ee+pe[L]+v,v=(p/ge|0)+(s/Ee|0)+se*x,pe[L--]=p%ge;pe[L]=v}return v?++R:pe.splice(0,1),de(m,pe,R)},Z.negated=function(){var m=new g(this);return m.s=-m.s||null,m},Z.plus=function(m,_){var v,R=this,O=R.s;if(m=new g(m,_),_=m.s,!O||!_)return new g(NaN);if(O!=_)return m.s=-_,R.minus(m);var L=R.e/b,h=m.e/b,s=R.c,a=m.c;if(!L||!h){if(!s||!a)return new g(O/0);if(!s[0]||!a[0])return a[0]?m:new g(s[0]?R:O*0)}if(L=k(L),h=k(h),s=s.slice(),O=L-h){for(O>0?(h=L,v=a):(O=-O,v=s),v.reverse();O--;v.push(0));v.reverse()}for(O=s.length,_=a.length,O-_<0&&(v=a,a=s,s=v,_=O),O=0;_;)O=(s[--_]=s[_]+a[_]+O)/y|0,s[_]=y===s[_]?0:s[_]%y;return O&&(s=[O].concat(s),++h),de(m,s,h)},Z.precision=Z.sd=function(m,_){var v,R,O,L=this;if(m!=null&&m!==!!m)return j(m,1,S),_==null?_=T:j(_,0,8),te(new g(L),m,_);if(!(v=L.c))return null;if(O=v.length-1,R=O*b+1,O=v[O]){for(;O%10==0;O/=10,R--);for(O=v[0];O>=10;O/=10,R++);}return m&&L.e+1>R&&(R=L.e+1),R},Z.shiftedBy=function(m){return j(m,-I,I),this.times("1e"+m)},Z.squareRoot=Z.sqrt=function(){var m,_,v,R,O,L=this,h=L.c,s=L.s,a=L.e,p=he+4,x=new g("0.5");if(s!==1||!h||!h[0])return new g(!s||s<0&&(!h||h[0])?NaN:h?L:1/0);if(s=Math.sqrt(+ae(L)),s==0||s==1/0?(_=D(h),(_.length+a)%2==0&&(_+="0"),s=Math.sqrt(+_),a=k((a+1)/2)-(a<0||a%2),s==1/0?_="5e"+a:(_=s.toExponential(),_=_.slice(0,_.indexOf("e")+1)+a),v=new g(_)):v=new g(s+""),v.c[0]){for(a=v.e,s=a+p,s<3&&(s=0);;)if(O=v,v=x.times(O.plus(z(L,O,p,1))),D(O.c).slice(0,s)===(_=D(v.c)).slice(0,s))if(v.e<a&&--s,_=_.slice(s-3,s+1),_=="9999"||!R&&_=="4999"){if(!R&&(te(O,O.e+he+2,0),O.times(O).eq(L))){v=O;break}p+=4,s+=4,R=1}else{(!+_||!+_.slice(1)&&_.charAt(0)=="5")&&(te(v,v.e+he+2,1),m=!v.times(v).eq(L));break}}return te(v,v.e+he+1,T,m)},Z.toExponential=function(m,_){return m!=null&&(j(m,0,S),m++),ne(this,m,_,1)},Z.toFixed=function(m,_){return m!=null&&(j(m,0,S),m=m+this.e+1),ne(this,m,_)},Z.toFormat=function(m,_,v){var R,O=this;if(v==null)m!=null&&_&&typeof _=="object"?(v=_,_=null):m&&typeof m=="object"?(v=m,m=_=null):v=oe;else if(typeof v!="object")throw Error(l+"Argument not an object: "+v);if(R=O.toFixed(m,_),O.c){var L,h=R.split("."),s=+v.groupSize,a=+v.secondaryGroupSize,p=v.groupSeparator||"",x=h[0],A=h[1],C=O.s<0,se=C?x.slice(1):x,pe=se.length;if(a&&(L=s,s=a,a=L,pe-=L),s>0&&pe>0){for(L=pe%s||s,x=se.substr(0,L);L<pe;L+=s)x+=p+se.substr(L,s);a>0&&(x+=p+se.slice(L)),C&&(x="-"+x)}R=A?x+(v.decimalSeparator||"")+((a=+v.fractionGroupSize)?A.replace(new RegExp("\\d{"+a+"}\\B","g"),"$&"+(v.fractionGroupSeparator||"")):A):x}return(v.prefix||"")+R+(v.suffix||"")},Z.toFraction=function(m){var _,v,R,O,L,h,s,a,p,x,A,C,se=this,pe=se.c;if(m!=null&&(s=new g(m),!s.isInteger()&&(s.c||s.s!==1)||s.lt(ye)))throw Error(l+"Argument "+(s.isInteger()?"out of range: ":"not an integer: ")+ae(s));if(!pe)return new g(se);for(_=new g(ye),p=v=new g(ye),R=a=new g(ye),C=D(pe),L=_.e=C.length-se.e-1,_.c[0]=B[(h=L%b)<0?b+h:h],m=!m||s.comparedTo(_)>0?L>0?_:p:s,h=W,W=1/0,s=new g(C),a.c[0]=0;x=z(s,_,0,1),O=v.plus(x.times(R)),O.comparedTo(m)!=1;)v=R,R=O,p=a.plus(x.times(O=p)),a=O,_=s.minus(x.times(O=_)),s=O;return O=z(m.minus(v),R,0,1),a=a.plus(O.times(p)),v=v.plus(O.times(R)),a.s=p.s=se.s,L=L*2,A=z(p,R,L,T).minus(se).abs().comparedTo(z(a,v,L,T).minus(se).abs())<1?[p,R]:[a,v],W=h,A},Z.toNumber=function(){return+ae(this)},Z.toPrecision=function(m,_){return m!=null&&j(m,1,S),ne(this,m,_,2)},Z.toString=function(m){var _,v=this,R=v.s,O=v.e;return O===null?R?(_="Infinity",R<0&&(_="-"+_)):_="NaN":(m==null?_=O<=P||O>=V?ie(D(v.c),O):M(D(v.c),O,"0"):m===10&&Q?(v=te(new g(v),he+O+1,T),_=M(D(v.c),v.e,"0")):(j(m,2,fe.length,"Base"),_=J(M(D(v.c),O,"0"),10,m,R,!0)),R<0&&v.c[0]&&(_="-"+_)),_},Z.valueOf=Z.toJSON=function(){return ae(this)},Z._isBigNumber=!0,Y!=null&&g.set(Y),g}function k(Y){var z=Y|0;return Y>0||Y===z?z:z-1}function D(Y){for(var z,J,re=1,Z=Y.length,ye=Y[0]+"";re<Z;){for(z=Y[re++]+"",J=b-z.length;J--;z="0"+z);ye+=z}for(Z=ye.length;ye.charCodeAt(--Z)===48;);return ye.slice(0,Z+1||1)}function K(Y,z){var J,re,Z=Y.c,ye=z.c,he=Y.s,T=z.s,P=Y.e,V=z.e;if(!he||!T)return null;if(J=Z&&!Z[0],re=ye&&!ye[0],J||re)return J?re?0:-T:he;if(he!=T)return he;if(J=he<0,re=P==V,!Z||!ye)return re?0:!Z^J?1:-1;if(!re)return P>V^J?1:-1;for(T=(P=Z.length)<(V=ye.length)?P:V,he=0;he<T;he++)if(Z[he]!=ye[he])return Z[he]>ye[he]^J?1:-1;return P==V?0:P>V^J?1:-1}function j(Y,z,J,re){if(Y<z||Y>J||Y!==o(Y))throw Error(l+(re||"Argument")+(typeof Y=="number"?Y<z||Y>J?" out of range: ":" not an integer: ":" not a primitive number: ")+String(Y))}function q(Y){var z=Y.c.length-1;return k(Y.e/b)==z&&Y.c[z]%2!=0}function ie(Y,z){return(Y.length>1?Y.charAt(0)+"."+Y.slice(1):Y)+(z<0?"e":"e+")+z}function M(Y,z,J){var re,Z;if(z<0){for(Z=J+".";++z;Z+=J);Y=Z+Y}else if(re=Y.length,++z>re){for(Z=J,z-=re;--z;Z+=J);Y+=Z}else z<re&&(Y=Y.slice(0,z)+"."+Y.slice(z));return Y}t=w(),t.default=t.BigNumber=t,r.exports?r.exports=t:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=t)})(Dr)})(va);var mi=va.exports,Du=function(e,t,n){var i=new e.Uint8Array(n),o=t.pushInt,l=t.pushInt32,u=t.pushInt32Neg,y=t.pushInt64,b=t.pushInt64Neg,I=t.pushFloat,B=t.pushFloatSingle,N=t.pushFloatDouble,S=t.pushTrue,w=t.pushFalse,k=t.pushUndefined,D=t.pushNull,K=t.pushInfinity,j=t.pushInfinityNeg,q=t.pushNaN,ie=t.pushNaNNeg,M=t.pushArrayStart,Y=t.pushArrayStartFixed,z=t.pushArrayStartFixed32,J=t.pushArrayStartFixed64,re=t.pushObjectStart,Z=t.pushObjectStartFixed,ye=t.pushObjectStartFixed32,he=t.pushObjectStartFixed64,T=t.pushByteString,P=t.pushByteStringStart,V=t.pushUtf8String,X=t.pushUtf8StringStart,W=t.pushSimpleUnassigned,G=t.pushTagStart,ee=t.pushTagStart4,le=t.pushTagStart8,oe=t.pushTagUnassigned,fe=t.pushBreak,Q=e.Math.pow,g=0,ne=0,ue=0;function de(U){for(U=U|0,g=0,ne=U;(g|0)<(ne|0)&&(ue=Yc[i[g]&255](i[g]|0)|0,!((ue|0)>0)););return ue|0}function te(U){return U=U|0,((g|0)+(U|0)|0)<(ne|0)?0:1}function ae(U){return U=U|0,i[U|0]<<8|i[U+1|0]|0}function m(U){return U=U|0,i[U|0]<<24|i[U+1|0]<<16|i[U+2|0]<<8|i[U+3|0]|0}function _(U){return U=U|0,o(U|0),g=g+1|0,0}function v(U){return U=U|0,te(1)|0?1:(o(i[g+1|0]|0),g=g+2|0,0)}function R(U){return U=U|0,te(2)|0?1:(o(ae(g+1|0)|0),g=g+3|0,0)}function O(U){return U=U|0,te(4)|0?1:(l(ae(g+1|0)|0,ae(g+3|0)|0),g=g+5|0,0)}function L(U){return U=U|0,te(8)|0?1:(y(ae(g+1|0)|0,ae(g+3|0)|0,ae(g+5|0)|0,ae(g+7|0)|0),g=g+9|0,0)}function h(U){return U=U|0,o(-1-(U-32|0)|0),g=g+1|0,0}function s(U){return U=U|0,te(1)|0?1:(o(-1-(i[g+1|0]|0)|0),g=g+2|0,0)}function a(U){U=U|0;var Se=0;return te(2)|0?1:(Se=ae(g+1|0)|0,o(-1-(Se|0)|0),g=g+3|0,0)}function p(U){return U=U|0,te(4)|0?1:(u(ae(g+1|0)|0,ae(g+3|0)|0),g=g+5|0,0)}function x(U){return U=U|0,te(8)|0?1:(b(ae(g+1|0)|0,ae(g+3|0)|0,ae(g+5|0)|0,ae(g+7|0)|0),g=g+9|0,0)}function A(U){U=U|0;var Se=0,Te=0,Be=0;return Be=U-64|0,te(Be|0)|0?1:(Se=g+1|0,Te=(g+1|0)+(Be|0)|0,T(Se|0,Te|0),g=Te|0,0)}function C(U){U=U|0;var Se=0,Te=0,Be=0;return te(1)|0||(Be=i[g+1|0]|0,Se=g+2|0,Te=(g+2|0)+(Be|0)|0,te(Be+1|0)|0)?1:(T(Se|0,Te|0),g=Te|0,0)}function se(U){U=U|0;var Se=0,Te=0,Be=0;return te(2)|0||(Be=ae(g+1|0)|0,Se=g+3|0,Te=(g+3|0)+(Be|0)|0,te(Be+2|0)|0)?1:(T(Se|0,Te|0),g=Te|0,0)}function pe(U){U=U|0;var Se=0,Te=0,Be=0;return te(4)|0||(Be=m(g+1|0)|0,Se=g+5|0,Te=(g+5|0)+(Be|0)|0,te(Be+4|0)|0)?1:(T(Se|0,Te|0),g=Te|0,0)}function ge(U){return U=U|0,1}function Ee(U){return U=U|0,P(),g=g+1|0,0}function d(U){U=U|0;var Se=0,Te=0,Be=0;return Be=U-96|0,te(Be|0)|0?1:(Se=g+1|0,Te=(g+1|0)+(Be|0)|0,V(Se|0,Te|0),g=Te|0,0)}function c(U){U=U|0;var Se=0,Te=0,Be=0;return te(1)|0||(Be=i[g+1|0]|0,Se=g+2|0,Te=(g+2|0)+(Be|0)|0,te(Be+1|0)|0)?1:(V(Se|0,Te|0),g=Te|0,0)}function f(U){U=U|0;var Se=0,Te=0,Be=0;return te(2)|0||(Be=ae(g+1|0)|0,Se=g+3|0,Te=(g+3|0)+(Be|0)|0,te(Be+2|0)|0)?1:(V(Se|0,Te|0),g=Te|0,0)}function E(U){U=U|0;var Se=0,Te=0,Be=0;return te(4)|0||(Be=m(g+1|0)|0,Se=g+5|0,Te=(g+5|0)+(Be|0)|0,te(Be+4|0)|0)?1:(V(Se|0,Te|0),g=Te|0,0)}function F(U){return U=U|0,1}function H(U){return U=U|0,X(),g=g+1|0,0}function $(U){return U=U|0,Y(U-128|0),g=g+1|0,0}function xe(U){return U=U|0,te(1)|0?1:(Y(i[g+1|0]|0),g=g+2|0,0)}function ve(U){return U=U|0,te(2)|0?1:(Y(ae(g+1|0)|0),g=g+3|0,0)}function _e(U){return U=U|0,te(4)|0?1:(z(ae(g+1|0)|0,ae(g+3|0)|0),g=g+5|0,0)}function me(U){return U=U|0,te(8)|0?1:(J(ae(g+1|0)|0,ae(g+3|0)|0,ae(g+5|0)|0,ae(g+7|0)|0),g=g+9|0,0)}function Ue(U){return U=U|0,M(),g=g+1|0,0}function Le(U){U=U|0;var Se=0;return Se=U-160|0,te(Se|0)|0?1:(Z(Se|0),g=g+1|0,0)}function Oc(U){return U=U|0,te(1)|0?1:(Z(i[g+1|0]|0),g=g+2|0,0)}function Rc(U){return U=U|0,te(2)|0?1:(Z(ae(g+1|0)|0),g=g+3|0,0)}function Fc(U){return U=U|0,te(4)|0?1:(ye(ae(g+1|0)|0,ae(g+3|0)|0),g=g+5|0,0)}function Pc(U){return U=U|0,te(8)|0?1:(he(ae(g+1|0)|0,ae(g+3|0)|0,ae(g+5|0)|0,ae(g+7|0)|0),g=g+9|0,0)}function Lc(U){return U=U|0,re(),g=g+1|0,0}function mr(U){return U=U|0,G(U-192|0|0),g=g+1|0,0}function ah(U){return U=U|0,G(U|0),g=g+1|0,0}function ch(U){return U=U|0,G(U|0),g=g+1|0,0}function uh(U){return U=U|0,G(U|0),g=g+1|0,0}function fh(U){return U=U|0,G(U|0),g=g+1|0,0}function We(U){return U=U|0,G(U-192|0|0),g=g+1|0,0}function lh(U){return U=U|0,G(U|0),g=g+1|0,0}function hh(U){return U=U|0,G(U|0),g=g+1|0,0}function dh(U){return U=U|0,G(U|0),g=g+1|0,0}function Mc(U){return U=U|0,te(1)|0?1:(G(i[g+1|0]|0),g=g+2|0,0)}function Dc(U){return U=U|0,te(2)|0?1:(G(ae(g+1|0)|0),g=g+3|0,0)}function kc(U){return U=U|0,te(4)|0?1:(ee(ae(g+1|0)|0,ae(g+3|0)|0),g=g+5|0,0)}function Cc(U){return U=U|0,te(8)|0?1:(le(ae(g+1|0)|0,ae(g+3|0)|0,ae(g+5|0)|0,ae(g+7|0)|0),g=g+9|0,0)}function qe(U){return U=U|0,W((U|0)-224|0),g=g+1|0,0}function $c(U){return U=U|0,w(),g=g+1|0,0}function qc(U){return U=U|0,S(),g=g+1|0,0}function Gc(U){return U=U|0,D(),g=g+1|0,0}function Hc(U){return U=U|0,k(),g=g+1|0,0}function Vc(U){return U=U|0,te(1)|0?1:(W(i[g+1|0]|0),g=g+2|0,0)}function Kc(U){U=U|0;var Se=0,Te=0,Be=1,mn=0,Vr=0,ph=0;return te(2)|0?1:(Se=i[g+1|0]|0,Te=i[g+2|0]|0,(Se|0)&128&&(Be=-1),mn=+(((Se|0)&124)>>2),Vr=+(((Se|0)&3)<<8|Te),+mn==0?I(+(+Be*5960464477539063e-23*+Vr)):+mn==31?+Be==1?+Vr>0?q():K():+Vr>0?ie():j():I(+(+Be*Q(2,+(+mn-25))*+(1024+Vr))),g=g+3|0,0)}function jc(U){return U=U|0,te(4)|0?1:(B(i[g+1|0]|0,i[g+2|0]|0,i[g+3|0]|0,i[g+4|0]|0),g=g+5|0,0)}function zc(U){return U=U|0,te(8)|0?1:(N(i[g+1|0]|0,i[g+2|0]|0,i[g+3|0]|0,i[g+4|0]|0,i[g+5|0]|0,i[g+6|0]|0,i[g+7|0]|0,i[g+8|0]|0),g=g+9|0,0)}function Fe(U){return U=U|0,1}function Wc(U){return U=U|0,fe(),g=g+1|0,0}var Yc=[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,v,R,O,L,Fe,Fe,Fe,Fe,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,s,a,p,x,Fe,Fe,Fe,Fe,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,C,se,pe,ge,Fe,Fe,Fe,Ee,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,c,f,E,F,Fe,Fe,Fe,H,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,xe,ve,_e,me,Fe,Fe,Fe,Ue,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Oc,Rc,Fc,Pc,Fe,Fe,Fe,Lc,mr,mr,mr,mr,mr,mr,We,We,We,We,We,We,We,We,We,We,We,We,We,We,We,We,We,We,Mc,Dc,kc,Cc,Fe,Fe,Fe,Fe,qe,qe,qe,qe,qe,qe,qe,qe,qe,qe,qe,qe,qe,qe,qe,qe,qe,qe,qe,qe,$c,qc,Gc,Hc,Vc,Kc,jc,zc,Fe,Fe,Fe,Wc];return{parse:de}},xi={},nt={};const xs=mi.BigNumber;nt.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7};nt.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36};nt.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31};nt.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23};nt.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")};nt.SHIFT32=Math.pow(2,32);nt.SHIFT16=Math.pow(2,16);nt.MAX_SAFE_HIGH=2097151;nt.NEG_ONE=new xs(-1);nt.TEN=new xs(10);nt.TWO=new xs(2);nt.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5};(function(r){const{Buffer:e}=yn,t=mi.BigNumber,n=nt,i=n.SHIFT32,o=n.SHIFT16,l=2097151;r.parseHalf=function(b){var I,B,N;return N=b[0]&128?-1:1,I=(b[0]&124)>>2,B=(b[0]&3)<<8|b[1],I?I===31?N*(B?0/0:1/0):N*Math.pow(2,I-25)*(1024+B):N*5960464477539063e-23*B};function u(y){return y<16?"0"+y.toString(16):y.toString(16)}r.arrayBufferToBignumber=function(y){const b=y.byteLength;let I="";for(let B=0;B<b;B++)I+=u(y[B]);return new t(I,16)},r.buildMap=y=>{const b=new Map,I=Object.keys(y),B=I.length;for(let N=0;N<B;N++)b.set(I[N],y[I[N]]);return b},r.buildInt32=(y,b)=>y*o+b,r.buildInt64=(y,b,I,B)=>{const N=r.buildInt32(y,b),S=r.buildInt32(I,B);return N>l?new t(N).times(i).plus(S):N*i+S},r.writeHalf=function(b,I){const B=e.allocUnsafe(4);B.writeFloatBE(I,0);const N=B.readUInt32BE(0);if(N&8191)return!1;var S=N>>16&32768;const w=N>>23&255,k=N&8388607;if(w>=113&&w<=142)S+=(w-112<<10)+(k>>13);else if(w>=103&&w<113){if(k&(1<<126-w)-1)return!1;S+=k+8388608>>126-w}else return!1;return b.writeUInt16BE(S,0),!0},r.keySorter=function(y,b){var I=y[0].byteLength,B=b[0].byteLength;return I>B?1:B>I?-1:y[0].compare(b[0])},r.isNegativeZero=y=>y===0&&1/y<0,r.nextPowerOf2=y=>{let b=0;if(y&&!(y&y-1))return y;for(;y!==0;)y>>=1,b+=1;return 1<<b}})(xi);const _s=nt,ku=_s.MT,_n=_s.SIMPLE,Ti=_s.SYMS;let Cu=class Zi{constructor(e){if(typeof e!="number")throw new Error("Invalid Simple type: "+typeof e);if(e<0||e>255||(e|0)!==e)throw new Error("value must be a small positive integer: "+e);this.value=e}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(e){return e._pushInt(this.value,ku.SIMPLE_FLOAT)}static isSimple(e){return e instanceof Zi}static decode(e,t){switch(t==null&&(t=!0),e){case _n.FALSE:return!1;case _n.TRUE:return!0;case _n.NULL:return t?null:Ti.NULL;case _n.UNDEFINED:return t?void 0:Ti.UNDEFINED;case-1:if(!t)throw new Error("Invalid BREAK");return Ti.BREAK;default:return new Zi(e)}}};var Ba=Cu;let $u=class Xi{constructor(e,t,n){if(this.tag=e,this.value=t,this.err=n,typeof this.tag!="number")throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(this.tag|0)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(e){return e._pushTag(this.tag),e.pushAny(this.value)}convert(e){var t,n;if(n=e!=null?e[this.tag]:void 0,typeof n!="function"&&(n=Xi["_tag"+this.tag],typeof n!="function"))return this;try{return n.call(Xi,this.value)}catch(i){return t=i,this.err=t,this}}};var Aa=$u;const Sa=self.location?self.location.protocol+"//"+self.location.host:"",Ji=self.URL;let qu=class{constructor(e="",t=Sa){this.super=new Ji(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set origin(e){this.super.origin=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set searchParams(e){this.super.searchParams=e}set username(e){this.super.username=e}createObjectURL(e){return this.super.createObjectURL(e)}revokeObjectURL(e){this.super.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function Gu(r){if(typeof r=="string")return new Ji(r).toString();if(!(r instanceof Ji)){const e=r.username&&r.password?`${r.username}:${r.password}@`:"",t=r.auth?r.auth+"@":"",n=r.port?":"+r.port:"",i=r.protocol?r.protocol+"//":"",o=r.host||"",l=r.hostname||"",u=r.search||(r.query?"?"+r.query:""),y=r.hash||"",b=r.pathname||"",I=r.path||b+u;return`${i}${e||t}${o||l+n}${I}${y}`}}var Ta={URLWithLegacySupport:qu,URLSearchParams:self.URLSearchParams,defaultBase:Sa,format:Gu};const{URLWithLegacySupport:Cs,format:Hu}=Ta;var Vu=(r,e={},t={},n)=>{let i=e.protocol?e.protocol.replace(":",""):"http";i=(t[i]||n||i)+":";let o;try{o=new Cs(r)}catch{o={}}const l=Object.assign({},e,{protocol:i||o.protocol,host:e.host||o.host});return new Cs(r,Hu(l)).toString()};const{URLWithLegacySupport:Ku,format:ju,URLSearchParams:zu,defaultBase:Wu}=Ta,Yu=Vu;var Na={URL:Ku,URLSearchParams:zu,format:ju,relative:Yu,defaultBase:Wu};const{Buffer:Er}=yn,$s=hn,Zu=mi.BigNumber,Xu=Du,it=xi,Re=nt,Ju=Ba,Qu=Aa,{URL:ef}=Na;let Qi=class es{constructor(e){e=e||{},!e.size||e.size<65536?e.size=65536:e.size=it.nextPowerOf2(e.size),this._heap=new ArrayBuffer(e.size),this._heap8=new Uint8Array(this._heap),this._buffer=Er.from(this._heap),this._reset(),this._knownTags=Object.assign({0:t=>new Date(t),1:t=>new Date(t*1e3),2:t=>it.arrayBufferToBignumber(t),3:t=>Re.NEG_ONE.minus(it.arrayBufferToBignumber(t)),4:t=>Re.TEN.pow(t[0]).times(t[1]),5:t=>Re.TWO.pow(t[0]).times(t[1]),32:t=>new ef(t),35:t=>new RegExp(t)},e.tags),this.parser=Xu(Dr,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var e=this._parents.pop();if(e.length>0)throw new Error(`Missing ${e.length} elements`);switch(e.type){case Re.PARENT.TAG:this._push(this.createTag(e.ref[0],e.ref[1]));break;case Re.PARENT.BYTE_STRING:this._push(this.createByteString(e.ref,e.length));break;case Re.PARENT.UTF8_STRING:this._push(this.createUtf8String(e.ref,e.length));break;case Re.PARENT.MAP:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(e.ref,e.length));break;case Re.PARENT.OBJECT:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(e.ref,e.length));break;case Re.PARENT.ARRAY:this._push(this.createArray(e.ref,e.length));break}this._currentParent&&this._currentParent.type===Re.PARENT.TAG&&this._dec()}_dec(){const e=this._currentParent;e.length<0||(e.length--,e.length===0&&this._closeParent())}_push(e,t){const n=this._currentParent;switch(n.values++,n.type){case Re.PARENT.ARRAY:case Re.PARENT.BYTE_STRING:case Re.PARENT.UTF8_STRING:n.length>-1?this._ref[this._ref.length-n.length]=e:this._ref.push(e),this._dec();break;case Re.PARENT.OBJECT:n.tmpKey!=null?(this._ref[n.tmpKey]=e,n.tmpKey=null,this._dec()):(n.tmpKey=e,typeof n.tmpKey!="string"&&(n.type=Re.PARENT.MAP,n.ref=it.buildMap(n.ref)));break;case Re.PARENT.MAP:n.tmpKey!=null?(this._ref.set(n.tmpKey,e),n.tmpKey=null,this._dec()):n.tmpKey=e;break;case Re.PARENT.TAG:this._ref.push(e),t||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(e,t,n){this._parents[this._depth]={type:t,length:n,ref:e,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:Re.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(e,t){const n=this._knownTags[e];return n?n(t):new Qu(e,t)}createMap(e,t){return e}createObject(e,t){return e}createArray(e,t){return e}createByteString(e,t){return Er.concat(e)}createByteStringFromHeap(e,t){return e===t?Er.alloc(0):Er.from(this._heap.slice(e,t))}createInt(e){return e}createInt32(e,t){return it.buildInt32(e,t)}createInt64(e,t,n,i){return it.buildInt64(e,t,n,i)}createFloat(e){return e}createFloatSingle(e,t,n,i){return $s.read([e,t,n,i],0,!1,23,4)}createFloatDouble(e,t,n,i,o,l,u,y){return $s.read([e,t,n,i,o,l,u,y],0,!1,52,8)}createInt32Neg(e,t){return-1-it.buildInt32(e,t)}createInt64Neg(e,t,n,i){const o=it.buildInt32(e,t),l=it.buildInt32(n,i);return o>Re.MAX_SAFE_HIGH?Re.NEG_ONE.minus(new Zu(o).times(Re.SHIFT32).plus(l)):-1-(o*Re.SHIFT32+l)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(e,t){return e.join("")}createUtf8StringFromHeap(e,t){return e===t?"":this._buffer.toString("utf8",e,t)}createSimpleUnassigned(e){return new Ju(e)}pushInt(e){this._push(this.createInt(e))}pushInt32(e,t){this._push(this.createInt32(e,t))}pushInt64(e,t,n,i){this._push(this.createInt64(e,t,n,i))}pushFloat(e){this._push(this.createFloat(e))}pushFloatSingle(e,t,n,i){this._push(this.createFloatSingle(e,t,n,i))}pushFloatDouble(e,t,n,i,o,l,u,y){this._push(this.createFloatDouble(e,t,n,i,o,l,u,y))}pushInt32Neg(e,t){this._push(this.createInt32Neg(e,t))}pushInt64Neg(e,t,n,i){this._push(this.createInt64Neg(e,t,n,i))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],Re.PARENT.ARRAY,-1)}pushArrayStartFixed(e){this._createArrayStartFixed(e)}pushArrayStartFixed32(e,t){const n=it.buildInt32(e,t);this._createArrayStartFixed(n)}pushArrayStartFixed64(e,t,n,i){const o=it.buildInt64(e,t,n,i);this._createArrayStartFixed(o)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(e){this._createObjectStartFixed(e)}pushObjectStartFixed32(e,t){const n=it.buildInt32(e,t);this._createObjectStartFixed(n)}pushObjectStartFixed64(e,t,n,i){const o=it.buildInt64(e,t,n,i);this._createObjectStartFixed(o)}pushByteStringStart(){this._parents[this._depth]={type:Re.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(e,t){this._push(this.createByteStringFromHeap(e,t))}pushUtf8StringStart(){this._parents[this._depth]={type:Re.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(e,t){this._push(this.createUtf8StringFromHeap(e,t))}pushSimpleUnassigned(e){this._push(this.createSimpleUnassigned(e))}pushTagStart(e){this._parents[this._depth]={type:Re.PARENT.TAG,length:1,ref:[e]}}pushTagStart4(e,t){this.pushTagStart(it.buildInt32(e,t))}pushTagStart8(e,t,n,i){this.pushTagStart(it.buildInt64(e,t,n,i))}pushTagUnassigned(e){this._push(this.createTag(e))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(e){if(e===0){this._push(this.createObject({}));return}this._createParent({},Re.PARENT.OBJECT,e)}_createArrayStartFixed(e){if(e===0){this._push(this.createArray([]));return}this._createParent(new Array(e),Re.PARENT.ARRAY,e)}_decode(e){if(e.byteLength===0)throw new Error("Input too short");this._reset(),this._heap8.set(e);const t=this.parser.parse(e.byteLength);if(this._depth>1){for(;this._currentParent.length===0;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(t>0)throw new Error("Failed to parse");if(this._res.length===0)throw new Error("No valid result")}decodeFirst(e){return this._decode(e),this._res[0]}decodeAll(e){return this._decode(e),this._res}static decode(e,t){return typeof e=="string"&&(e=Er.from(e,t||"hex")),new es({size:e.length}).decodeFirst(e)}static decodeAll(e,t){return typeof e=="string"&&(e=Er.from(e,t||"hex")),new es({size:e.length}).decodeAll(e)}};Qi.decodeFirst=Qi.decode;var Ua=Qi;const{Buffer:Ni}=yn,tf=Ua,rf=xi;class Es extends tf{createTag(e,t){return`${e}(${t})`}createInt(e){return super.createInt(e).toString()}createInt32(e,t){return super.createInt32(e,t).toString()}createInt64(e,t,n,i){return super.createInt64(e,t,n,i).toString()}createInt32Neg(e,t){return super.createInt32Neg(e,t).toString()}createInt64Neg(e,t,n,i){return super.createInt64Neg(e,t,n,i).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(e){const t=super.createFloat(e);return rf.isNegativeZero(e)?"-0_1":`${t}_1`}createFloatSingle(e,t,n,i){return`${super.createFloatSingle(e,t,n,i)}_2`}createFloatDouble(e,t,n,i,o,l,u,y){return`${super.createFloatDouble(e,t,n,i,o,l,u,y)}_3`}createByteString(e,t){const n=e.join(", ");return t===-1?`(_ ${n})`:`h'${n}`}createByteStringFromHeap(e,t){return`h'${Ni.from(super.createByteStringFromHeap(e,t)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(e){return`simple(${e})`}createArray(e,t){const n=super.createArray(e,t);return t===-1?`[_ ${n.join(", ")}]`:`[${n.join(", ")}]`}createMap(e,t){const n=super.createMap(e),i=Array.from(n.keys()).reduce(qs(n),"");return t===-1?`{_ ${i}}`:`{${i}}`}createObject(e,t){const n=super.createObject(e),i=Object.keys(n).reduce(qs(n),"");return t===-1?`{_ ${i}}`:`{${i}}`}createUtf8String(e,t){const n=e.join(", ");return t===-1?`(_ ${n})`:`"${n}"`}createUtf8StringFromHeap(e,t){return`"${Ni.from(super.createUtf8StringFromHeap(e,t)).toString("utf8")}"`}static diagnose(e,t){return typeof e=="string"&&(e=Ni.from(e,t||"hex")),new Es().decodeFirst(e)}}var nf=Es;function qs(r){return(e,t)=>e?`${e}, ${t}: ${r[t]}`:`${t}: ${r[t]}`}const{Buffer:Tt}=yn,{URL:sf}=Na,ts=mi.BigNumber,Ui=xi,ze=nt,pt=ze.MT,En=ze.NUMBYTES,Gs=ze.SHIFT32,Hs=ze.SYMS,Ir=ze.TAG,of=ze.MT.SIMPLE_FLOAT<<5|ze.NUMBYTES.TWO,af=ze.MT.SIMPLE_FLOAT<<5|ze.NUMBYTES.FOUR,cf=ze.MT.SIMPLE_FLOAT<<5|ze.NUMBYTES.EIGHT,uf=ze.MT.SIMPLE_FLOAT<<5|ze.SIMPLE.TRUE,ff=ze.MT.SIMPLE_FLOAT<<5|ze.SIMPLE.FALSE,lf=ze.MT.SIMPLE_FLOAT<<5|ze.SIMPLE.UNDEFINED,Vs=ze.MT.SIMPLE_FLOAT<<5|ze.SIMPLE.NULL,hf=new ts("0x20000000000000"),df=Tt.from("f97e00","hex"),pf=Tt.from("f9fc00","hex"),yf=Tt.from("f97c00","hex");function wf(r){return{}.toString.call(r).slice(8,-1)}class ri{constructor(e){e=e||{},this.streaming=typeof e.stream=="function",this.onData=e.stream,this.semanticTypes=[[sf,this._pushUrl],[ts,this._pushBigNumber]];const t=e.genTypes||[],n=t.length;for(let i=0;i<n;i++)this.addSemanticType(t[i][0],t[i][1]);this._reset()}addSemanticType(e,t){const n=this.semanticTypes.length;for(let i=0;i<n;i++)if(this.semanticTypes[i][0]===e){const l=this.semanticTypes[i][1];return this.semanticTypes[i][1]=t,l}return this.semanticTypes.push([e,t]),null}push(e){return e&&(this.result[this.offset]=e,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=e.length,this.offset++,this.streaming&&this.onData(this.finalize())),!0}pushWrite(e,t,n){return this.result[this.offset]=e,this.resultMethod[this.offset]=t,this.resultLength[this.offset]=n,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(e){return this.pushWrite(e,1,1)}_pushUInt16BE(e){return this.pushWrite(e,2,2)}_pushUInt32BE(e){return this.pushWrite(e,3,4)}_pushDoubleBE(e){return this.pushWrite(e,4,8)}_pushNaN(){return this.push(df)}_pushInfinity(e){const t=e<0?pf:yf;return this.push(t)}_pushFloat(e){const t=Tt.allocUnsafe(2);if(Ui.writeHalf(t,e)&&Ui.parseHalf(t)===e)return this._pushUInt8(of)&&this.push(t);const n=Tt.allocUnsafe(4);return n.writeFloatBE(e,0),n.readFloatBE(0)===e?this._pushUInt8(af)&&this.push(n):this._pushUInt8(cf)&&this._pushDoubleBE(e)}_pushInt(e,t,n){const i=t<<5;return e<24?this._pushUInt8(i|e):e<=255?this._pushUInt8(i|En.ONE)&&this._pushUInt8(e):e<=65535?this._pushUInt8(i|En.TWO)&&this._pushUInt16BE(e):e<=4294967295?this._pushUInt8(i|En.FOUR)&&this._pushUInt32BE(e):e<=Number.MAX_SAFE_INTEGER?this._pushUInt8(i|En.EIGHT)&&this._pushUInt32BE(Math.floor(e/Gs))&&this._pushUInt32BE(e%Gs):t===pt.NEG_INT?this._pushFloat(n):this._pushFloat(e)}_pushIntNum(e){return e<0?this._pushInt(-e-1,pt.NEG_INT,e):this._pushInt(e,pt.POS_INT)}_pushNumber(e){switch(!1){case e===e:return this._pushNaN(e);case isFinite(e):return this._pushInfinity(e);case e%1!==0:return this._pushIntNum(e);default:return this._pushFloat(e)}}_pushString(e){const t=Tt.byteLength(e,"utf8");return this._pushInt(t,pt.UTF8_STRING)&&this.pushWrite(e,5,t)}_pushBoolean(e){return this._pushUInt8(e?uf:ff)}_pushUndefined(e){return this._pushUInt8(lf)}_pushArray(e,t){const n=t.length;if(!e._pushInt(n,pt.ARRAY))return!1;for(let i=0;i<n;i++)if(!e.pushAny(t[i]))return!1;return!0}_pushTag(e){return this._pushInt(e,pt.TAG)}_pushDate(e,t){return e._pushTag(Ir.DATE_EPOCH)&&e.pushAny(Math.round(t/1e3))}_pushBuffer(e,t){return e._pushInt(t.length,pt.BYTE_STRING)&&e.push(t)}_pushNoFilter(e,t){return e._pushBuffer(e,t.slice())}_pushRegexp(e,t){return e._pushTag(Ir.REGEXP)&&e.pushAny(t.source)}_pushSet(e,t){if(!e._pushInt(t.size,pt.ARRAY))return!1;for(const n of t)if(!e.pushAny(n))return!1;return!0}_pushUrl(e,t){return e._pushTag(Ir.URI)&&e.pushAny(t.format())}_pushBigint(e){let t=Ir.POS_BIGINT;e.isNegative()&&(e=e.negated().minus(1),t=Ir.NEG_BIGINT);let n=e.toString(16);n.length%2&&(n="0"+n);const i=Tt.from(n,"hex");return this._pushTag(t)&&this._pushBuffer(this,i)}_pushBigNumber(e,t){if(t.isNaN())return e._pushNaN();if(!t.isFinite())return e._pushInfinity(t.isNegative()?-1/0:1/0);if(t.isInteger())return e._pushBigint(t);if(!(e._pushTag(Ir.DECIMAL_FRAC)&&e._pushInt(2,pt.ARRAY)))return!1;const n=t.decimalPlaces(),i=t.multipliedBy(new ts(10).pow(n));return e._pushIntNum(-n)?i.abs().isLessThan(hf)?e._pushIntNum(i.toNumber()):e._pushBigint(i):!1}_pushMap(e,t){return e._pushInt(t.size,pt.MAP)?this._pushRawMap(t.size,Array.from(t)):!1}_pushObject(e){if(!e)return this._pushUInt8(Vs);for(var t=this.semanticTypes.length,n=0;n<t;n++)if(e instanceof this.semanticTypes[n][0])return this.semanticTypes[n][1].call(e,this,e);var i=e.encodeCBOR;if(typeof i=="function")return i.call(e,this);var o=Object.keys(e),l=o.length;return this._pushInt(l,pt.MAP)?this._pushRawMap(l,o.map(u=>[u,e[u]])):!1}_pushRawMap(e,t){t=t.map(function(i){return i[0]=ri.encode(i[0]),i}).sort(Ui.keySorter);for(var n=0;n<e;n++)if(!this.push(t[n][0])||!this.pushAny(t[n][1]))return!1;return!0}write(e){return this.pushAny(e)}pushAny(e){var t=wf(e);switch(t){case"Number":return this._pushNumber(e);case"String":return this._pushString(e);case"Boolean":return this._pushBoolean(e);case"Object":return this._pushObject(e);case"Array":return this._pushArray(this,e);case"Uint8Array":return this._pushBuffer(this,Tt.isBuffer(e)?e:Tt.from(e));case"Null":return this._pushUInt8(Vs);case"Undefined":return this._pushUndefined(e);case"Map":return this._pushMap(this,e);case"Set":return this._pushSet(this,e);case"URL":return this._pushUrl(this,e);case"BigNumber":return this._pushBigNumber(this,e);case"Date":return this._pushDate(this,e);case"RegExp":return this._pushRegexp(this,e);case"Symbol":switch(e){case Hs.NULL:return this._pushObject(null);case Hs.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+e.toString())}default:throw new Error("Unknown type: "+typeof e+", "+(e?e.toString():""))}}finalize(){if(this.offset===0)return null;for(var e=this.result,t=this.resultLength,n=this.resultMethod,i=this.offset,o=0,l=0;l<i;l++)o+=t[l];var u=Tt.allocUnsafe(o),y=0,b=0;for(l=0;l<i;l++){switch(b=t[l],n[l]){case 0:e[l].copy(u,y);break;case 1:u.writeUInt8(e[l],y,!0);break;case 2:u.writeUInt16BE(e[l],y,!0);break;case 3:u.writeUInt32BE(e[l],y,!0);break;case 4:u.writeDoubleBE(e[l],y,!0);break;case 5:u.write(e[l],y,b,"utf8");break;default:throw new Error("unkown method")}y+=b}var I=u;return this._reset(),I}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(e){const t=new ri;if(!t.pushAny(e))throw new Error("Failed to encode input");return t.finalize()}}var gf=ri;(function(r){r.Diagnose=nf,r.Decoder=Ua,r.Encoder=gf,r.Simple=Ba,r.Tagged=Aa,r.decodeAll=r.Decoder.decodeAll,r.decodeFirst=r.Decoder.decodeFirst,r.diagnose=r.Diagnose.diagnose,r.encode=r.Encoder.encode,r.decode=r.Decoder.decode,r.leveldb={decode:r.Decoder.decodeAll,encode:r.Encoder.encode,buffer:!0,name:"cbor"}})(Ia);const Oa=Zc(Ia);function mt(r){return Qr(ws.create().update(new Uint8Array(r)).digest())}function Fn(r){if(r instanceof Oa.Tagged)return Fn(r.value);if(typeof r=="string")return Ra(r);if(typeof r=="number")return mt(ke(r));if(r instanceof ArrayBuffer||ArrayBuffer.isView(r))return mt(r);if(Array.isArray(r)){const e=r.map(Fn);return mt(xt(...e))}else{if(r&&typeof r=="object"&&r._isPrincipal)return mt(r.toUint8Array());if(typeof r=="object"&&r!==null&&typeof r.toHash=="function")return Fn(r.toHash());if(typeof r=="object")return ni(r);if(typeof r=="bigint")return mt(ke(r))}throw Object.assign(new Error(`Attempt to hash a value of unsupported type: ${r}`),{value:r})}const Ra=r=>{const e=new TextEncoder().encode(r);return mt(e)};function an(r){return ni(r)}function ni(r){const n=Object.entries(r).filter(([,l])=>l!==void 0).map(([l,u])=>{const y=Ra(l),b=Fn(u);return[y,b]}).sort(([l],[u])=>Co(l,u)),i=xt(...n.map(l=>xt(...l)));return mt(i)}var bf=globalThis&&globalThis.__rest||function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const mf=new TextEncoder().encode(`
ic-request`);class Is{getPrincipal(){return this._principal||(this._principal=Ne.selfAuthenticating(new Uint8Array(this.getPublicKey().toDer()))),this._principal}async transformRequest(e){const{body:t}=e,n=bf(e,["body"]),i=an(t);return Object.assign(Object.assign({},n),{body:{content:t,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign(xt(mf,i))}})}}class ii{getPrincipal(){return Ne.anonymous()}async transformRequest(e){return Object.assign(Object.assign({},e),{body:{content:e.body}})}}var ut={},Hr={},Pe={};Object.defineProperty(Pe,"__esModule",{value:!0});const xf=9007199254740992;function qt(r,...e){const t=new Uint8Array(r.byteLength+e.reduce((i,o)=>i+o.byteLength,0));t.set(new Uint8Array(r),0);let n=r.byteLength;for(const i of e)t.set(new Uint8Array(i),n),n+=i.byteLength;return t.buffer}function _t(r,e,t){t=t.replace(/[^0-9a-fA-F]/g,"");const n=2**(e-24);t=t.slice(-n*2).padStart(n*2,"0");const i=[(r<<5)+e].concat(t.match(/../g).map(o=>parseInt(o,16)));return new Uint8Array(i).buffer}function _i(r,e){if(e<24)return new Uint8Array([(r<<5)+e]).buffer;{const t=e<=255?24:e<=65535?25:e<=4294967295?26:27;return _t(r,t,e.toString(16))}}function Fa(r){const e=[];for(let t=0;t<r.length;t++){let n=r.charCodeAt(t);n<128?e.push(n):n<2048?e.push(192|n>>6,128|n&63):n<55296||n>=57344?e.push(224|n>>12,128|n>>6&63,128|n&63):(t++,n=(n&1023)<<10|r.charCodeAt(t)&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63))}return qt(new Uint8Array(_i(3,r.length)),new Uint8Array(e))}function _f(r,e){if(r==14277111)return qt(new Uint8Array([217,217,247]),e);if(r<24)return qt(new Uint8Array([192+r]),e);{const t=r<=255?24:r<=65535?25:r<=4294967295?26:27,n=2**(t-24),i=r.toString(16).slice(-n*2).padStart(n*2,"0"),o=[192+t].concat(i.match(/../g).map(l=>parseInt(l,16)));return new Uint8Array(o).buffer}}Pe.tagged=_f;function wn(r){return new Uint8Array(r).buffer}Pe.raw=wn;function vs(r){if(isNaN(r))throw new RangeError("Invalid number.");r=Math.min(Math.max(0,r),23);const e=[0+r];return new Uint8Array(e).buffer}Pe.uSmall=vs;function Pa(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,r),255),r=r.toString(16),_t(0,24,r)}Pe.u8=Pa;function La(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,r),65535),r=r.toString(16),_t(0,25,r)}Pe.u16=La;function Ma(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,r),4294967295),r=r.toString(16),_t(0,26,r)}Pe.u32=Ma;function Bs(r,e){if(typeof r=="string"&&e==16){if(r.match(/[^0-9a-fA-F]/))throw new RangeError("Invalid number.");return _t(0,27,r)}if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,r),xf),r=r.toString(16),_t(0,27,r)}Pe.u64=Bs;function Da(r){if(isNaN(r))throw new RangeError("Invalid number.");if(r===0)return vs(0);r=Math.min(Math.max(0,-r),24)-1;const e=[32+r];return new Uint8Array(e).buffer}Pe.iSmall=Da;function ka(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,-r-1),255),r=r.toString(16),_t(1,24,r)}Pe.i8=ka;function Ca(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,-r-1),65535),r=r.toString(16),_t(1,25,r)}Pe.i16=Ca;function $a(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,-r-1),4294967295),r=r.toString(16),_t(1,26,r)}Pe.i32=$a;function qa(r,e){if(typeof r=="string"&&e==16){if(r.startsWith("-")?r=r.slice(1):r="0",r.match(/[^0-9a-fA-F]/)||r.length>16)throw new RangeError("Invalid number.");let t=!1,n=r.split("").reduceRight((i,o)=>{if(t)return o+i;let l=parseInt(o,16)-1;return l>=0?(t=!0,l.toString(16)+i):"f"+i},"");return t?_t(1,27,n):Bs(0)}if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,-r-1),9007199254740992),r=r.toString(16),_t(1,27,r)}Pe.i64=qa;function Ef(r){return r>=0?r<24?vs(r):r<=255?Pa(r):r<=65535?La(r):r<=4294967295?Ma(r):Bs(r):r>=-24?Da(r):r>=-255?ka(r):r>=-65535?Ca(r):r>=-4294967295?$a(r):qa(r)}Pe.number=Ef;function If(r){return qt(_i(2,r.byteLength),r)}Pe.bytes=If;function vf(r){return Fa(r)}Pe.string=vf;function Bf(r){return qt(_i(4,r.length),...r)}Pe.array=Bf;function Af(r,e=!1){r instanceof Map||(r=new Map(Object.entries(r)));let t=Array.from(r.entries());return e&&(t=t.sort(([n],[i])=>n.localeCompare(i))),qt(_i(5,r.size),...t.map(([n,i])=>qt(Fa(n),i)))}Pe.map=Af;function Sf(r){const e=new Float32Array([r]);return qt(new Uint8Array([224+26]),new Uint8Array(e.buffer))}Pe.singleFloat=Sf;function Tf(r){const e=new Float64Array([r]);return qt(new Uint8Array([224+27]),new Uint8Array(e.buffer))}Pe.doubleFloat=Tf;function Nf(r){return r?Ga():Ha()}Pe.bool=Nf;function Ga(){return wn(new Uint8Array([224+21]))}Pe.true_=Ga;function Ha(){return wn(new Uint8Array([224+20]))}Pe.false_=Ha;function Uf(){return wn(new Uint8Array([224+22]))}Pe.null_=Uf;function Of(){return wn(new Uint8Array([224+23]))}Pe.undefined_=Of;var Rf=Dr&&Dr.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e};Object.defineProperty(Hr,"__esModule",{value:!0});const yt=Rf(Pe),Ff=[ArrayBuffer,Uint8Array,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array];class Va{constructor(e,t=!1){this._serializer=e,this._stable=t,this.name="jsonDefault",this.priority=-100}match(e){return["undefined","boolean","number","string","object"].indexOf(typeof e)!=-1}encode(e){switch(typeof e){case"undefined":return yt.undefined_();case"boolean":return yt.bool(e);case"number":return Math.floor(e)===e?yt.number(e):yt.doubleFloat(e);case"string":return yt.string(e);case"object":if(e===null)return yt.null_();if(Array.isArray(e))return yt.array(e.map(t=>this._serializer.serializeValue(t)));if(Ff.find(t=>e instanceof t))return yt.bytes(e.buffer);if(Object.getOwnPropertyNames(e).indexOf("toJSON")!==-1)return this.encode(e.toJSON());if(e instanceof Map){const t=new Map;for(const[n,i]of e.entries())t.set(n,this._serializer.serializeValue(i));return yt.map(t,this._stable)}else{const t=new Map;for(const[n,i]of Object.entries(e))t.set(n,this._serializer.serializeValue(i));return yt.map(t,this._stable)}default:throw new Error("Invalid value.")}}}Hr.JsonDefaultCborEncoder=Va;class Ka{constructor(){this.name="cborEncoder",this.priority=-90}match(e){return typeof e=="object"&&typeof e.toCBOR=="function"}encode(e){return e.toCBOR()}}Hr.ToCborEncoder=Ka;class ja{constructor(){this._encoders=new Set}static withDefaultEncoders(e=!1){const t=new this;return t.addEncoder(new Va(t,e)),t.addEncoder(new Ka),t}removeEncoder(e){for(const t of this._encoders.values())t.name==e&&this._encoders.delete(t)}addEncoder(e){this._encoders.add(e)}getEncoderFor(e){let t=null;for(const n of this._encoders)(!t||n.priority>t.priority)&&n.match(e)&&(t=n);if(t===null)throw new Error("Could not find an encoder for value.");return t}serializeValue(e){return this.getEncoderFor(e).encode(e)}serialize(e){return this.serializeValue(e)}}Hr.CborSerializer=ja;class Pf extends ja{serialize(e){return yt.raw(new Uint8Array([...new Uint8Array([217,217,247]),...new Uint8Array(super.serializeValue(e))]))}}Hr.SelfDescribeCborSerializer=Pf;(function(r){function e(i){for(var o in i)r.hasOwnProperty(o)||(r[o]=i[o])}var t=Dr&&Dr.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var l in i)Object.hasOwnProperty.call(i,l)&&(o[l]=i[l]);return o.default=i,o};Object.defineProperty(r,"__esModule",{value:!0}),e(Hr);const n=t(Pe);r.value=n})(ut);class Lf{get name(){return"Principal"}get priority(){return 0}match(e){return e&&e._isPrincipal===!0}encode(e){return ut.value.bytes(e.toUint8Array())}}class Mf{get name(){return"Buffer"}get priority(){return 1}match(e){return e instanceof ArrayBuffer||ArrayBuffer.isView(e)}encode(e){return ut.value.bytes(new Uint8Array(e))}}class Df{get name(){return"BigInt"}get priority(){return 1}match(e){return typeof e=="bigint"}encode(e){return e>BigInt(0)?ut.value.tagged(2,ut.value.bytes($t(e.toString(16)))):ut.value.tagged(3,ut.value.bytes($t((BigInt("-1")*e).toString(16))))}}const Ei=ut.SelfDescribeCborSerializer.withDefaultEncoders(!0);Ei.addEncoder(new Lf);Ei.addEncoder(new Mf);Ei.addEncoder(new Df);var rs;(function(r){r[r.Uint64LittleEndian=71]="Uint64LittleEndian",r[r.Semantic=55799]="Semantic"})(rs||(rs={}));function Oi(r){return Ei.serialize(r)}function Ks(r){const e=r.byteLength;let t=BigInt(0);for(let n=0;n<e;n++)t=t*BigInt(256)+BigInt(r[n]);return t}class kf extends Oa.Decoder{createByteString(e){return xt(...e)}createByteStringFromHeap(e,t){return e===t?new ArrayBuffer(0):new Uint8Array(this._heap.slice(e,t))}}function kt(r){const e=new Uint8Array(r),t=new kf({size:e.byteLength,tags:{2:n=>Ks(n),3:n=>-Ks(n),[rs.Semantic]:n=>n}});try{return t.decodeFirst(e)}catch(n){throw new Error(`Failed to decode CBOR: ${n}, input: ${Ge(e)}`)}}const In=()=>{if(typeof window<"u"&&window.crypto&&window.crypto.getRandomValues){const r=new Uint32Array(1);return window.crypto.getRandomValues(r),r[0]}if(typeof crypto<"u"&&crypto.getRandomValues){const r=new Uint32Array(1);return crypto.getRandomValues(r),r[0]}return typeof crypto<"u"&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(Math.random()*4294967295)};var ns;(function(r){r.Call="call"})(ns||(ns={}));function is(){const r=new ArrayBuffer(16),e=new DataView(r),t=In(),n=In(),i=In(),o=In();return e.setUint32(0,t),e.setUint32(4,n),e.setUint32(8,i),e.setUint32(12,o),r}const js=BigInt(1e6),Cf=60*1e3;class vn{constructor(e){if(e<90*1e3){const u=BigInt(Date.now()+e)*js/BigInt(1e9);this._value=u*BigInt(1e9);return}const o=BigInt(Math.floor(Date.now()+e-Cf))*js/BigInt(1e9)/BigInt(60)*BigInt(60)*BigInt(1e9);this._value=o}toCBOR(){return ut.value.u64(this._value.toString(16),16)}toHash(){return ke(this._value)}}function zs(r=is){return async e=>{const t=e.request.headers;e.request.headers=t,e.endpoint==="call"&&(e.body.nonce=r())}}function jr(r){const e=[];return r.forEach((t,n)=>{e.push([n,t])}),e}class Ri extends Ke{constructor(e,t){super(e),this.response=t,this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}class $f extends Ke{constructor(e,t,n,i,o,l){super(e),this.response=t,this.requestId=n,this.senderPubkey=i,this.senderSig=o,this.ingressExpiry=l,this.name="AgentCallError",Object.setPrototypeOf(this,new.target.prototype)}}class qf extends Ke{constructor(e,t,n,i,o,l){super(e),this.response=t,this.requestId=n,this.senderPubkey=i,this.senderSig=o,this.ingressExpiry=l,this.name="AgentQueryError",Object.setPrototypeOf(this,new.target.prototype)}}class Gf extends Ke{constructor(e,t,n,i,o,l){super(e),this.response=t,this.requestId=n,this.senderPubkey=i,this.senderSig=o,this.ingressExpiry=l,this.name="AgentReadStateError",Object.setPrototypeOf(this,new.target.prototype)}}const Bn=BigInt(2**32-1),ss=BigInt(32);function za(r,e=!1){return e?{h:Number(r&Bn),l:Number(r>>ss&Bn)}:{h:Number(r>>ss&Bn)|0,l:Number(r&Bn)|0}}function Hf(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let i=0;i<r.length;i++){const{h:o,l}=za(r[i],e);[t[i],n[i]]=[o,l]}return[t,n]}const Vf=(r,e)=>BigInt(r>>>0)<<ss|BigInt(e>>>0),Kf=(r,e,t)=>r>>>t,jf=(r,e,t)=>r<<32-t|e>>>t,zf=(r,e,t)=>r>>>t|e<<32-t,Wf=(r,e,t)=>r<<32-t|e>>>t,Yf=(r,e,t)=>r<<64-t|e>>>t-32,Zf=(r,e,t)=>r>>>t-32|e<<64-t,Xf=(r,e)=>e,Jf=(r,e)=>r,Qf=(r,e,t)=>r<<t|e>>>32-t,e0=(r,e,t)=>e<<t|r>>>32-t,t0=(r,e,t)=>e<<t-32|r>>>64-t,r0=(r,e,t)=>r<<t-32|e>>>64-t;function n0(r,e,t,n){const i=(e>>>0)+(n>>>0);return{h:r+t+(i/2**32|0)|0,l:i|0}}const i0=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),s0=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,o0=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),a0=(r,e,t,n,i)=>e+t+n+i+(r/2**32|0)|0,c0=(r,e,t,n,i)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0),u0=(r,e,t,n,i,o)=>e+t+n+i+o+(r/2**32|0)|0,f0={fromBig:za,split:Hf,toBig:Vf,shrSH:Kf,shrSL:jf,rotrSH:zf,rotrSL:Wf,rotrBH:Yf,rotrBL:Zf,rotr32H:Xf,rotr32L:Jf,rotlSH:Qf,rotlSL:e0,rotlBH:t0,rotlBL:r0,add:n0,add3L:i0,add3H:s0,add4L:o0,add4H:a0,add5H:u0,add5L:c0},Ie=f0,[l0,h0]=(()=>Ie.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))))(),Kt=new Uint32Array(80),jt=new Uint32Array(80);class d0 extends Do{constructor(e=64){super(128,e,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:i,Ch:o,Cl:l,Dh:u,Dl:y,Eh:b,El:I,Fh:B,Fl:N,Gh:S,Gl:w,Hh:k,Hl:D}=this;return[e,t,n,i,o,l,u,y,b,I,B,N,S,w,k,D]}set(e,t,n,i,o,l,u,y,b,I,B,N,S,w,k,D){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=l|0,this.Dh=u|0,this.Dl=y|0,this.Eh=b|0,this.El=I|0,this.Fh=B|0,this.Fl=N|0,this.Gh=S|0,this.Gl=w|0,this.Hh=k|0,this.Hl=D|0}process(e,t){for(let q=0;q<16;q++,t+=4)Kt[q]=e.getUint32(t),jt[q]=e.getUint32(t+=4);for(let q=16;q<80;q++){const ie=Kt[q-15]|0,M=jt[q-15]|0,Y=Ie.rotrSH(ie,M,1)^Ie.rotrSH(ie,M,8)^Ie.shrSH(ie,M,7),z=Ie.rotrSL(ie,M,1)^Ie.rotrSL(ie,M,8)^Ie.shrSL(ie,M,7),J=Kt[q-2]|0,re=jt[q-2]|0,Z=Ie.rotrSH(J,re,19)^Ie.rotrBH(J,re,61)^Ie.shrSH(J,re,6),ye=Ie.rotrSL(J,re,19)^Ie.rotrBL(J,re,61)^Ie.shrSL(J,re,6),he=Ie.add4L(z,ye,jt[q-7],jt[q-16]),T=Ie.add4H(he,Y,Z,Kt[q-7],Kt[q-16]);Kt[q]=T|0,jt[q]=he|0}let{Ah:n,Al:i,Bh:o,Bl:l,Ch:u,Cl:y,Dh:b,Dl:I,Eh:B,El:N,Fh:S,Fl:w,Gh:k,Gl:D,Hh:K,Hl:j}=this;for(let q=0;q<80;q++){const ie=Ie.rotrSH(B,N,14)^Ie.rotrSH(B,N,18)^Ie.rotrBH(B,N,41),M=Ie.rotrSL(B,N,14)^Ie.rotrSL(B,N,18)^Ie.rotrBL(B,N,41),Y=B&S^~B&k,z=N&w^~N&D,J=Ie.add5L(j,M,z,h0[q],jt[q]),re=Ie.add5H(J,K,ie,Y,l0[q],Kt[q]),Z=J|0,ye=Ie.rotrSH(n,i,28)^Ie.rotrBH(n,i,34)^Ie.rotrBH(n,i,39),he=Ie.rotrSL(n,i,28)^Ie.rotrBL(n,i,34)^Ie.rotrBL(n,i,39),T=n&o^n&u^o&u,P=i&l^i&y^l&y;K=k|0,j=D|0,k=S|0,D=w|0,S=B|0,w=N|0,{h:B,l:N}=Ie.add(b|0,I|0,re|0,Z|0),b=u|0,I=y|0,u=o|0,y=l|0,o=n|0,l=i|0;const V=Ie.add3L(Z,he,P);n=Ie.add3H(V,re,ye,T),i=V|0}({h:n,l:i}=Ie.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l}=Ie.add(this.Bh|0,this.Bl|0,o|0,l|0),{h:u,l:y}=Ie.add(this.Ch|0,this.Cl|0,u|0,y|0),{h:b,l:I}=Ie.add(this.Dh|0,this.Dl|0,b|0,I|0),{h:B,l:N}=Ie.add(this.Eh|0,this.El|0,B|0,N|0),{h:S,l:w}=Ie.add(this.Fh|0,this.Fl|0,S|0,w|0),{h:k,l:D}=Ie.add(this.Gh|0,this.Gl|0,k|0,D|0),{h:K,l:j}=Ie.add(this.Hh|0,this.Hl|0,K|0,j|0),this.set(n,i,o,l,u,y,b,I,B,N,S,w,k,D,K,j)}roundClean(){Kt.fill(0),jt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const p0=ys(()=>new d0);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const As=BigInt(0),si=BigInt(1);function Ii(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function sr(r){if(!Ii(r))throw new Error("Uint8Array expected")}function en(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}function Wa(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?As:BigInt("0x"+r)}const Ya=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",y0=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function br(r){if(sr(r),Ya)return r.toHex();let e="";for(let t=0;t<r.length;t++)e+=y0[r[t]];return e}const Rt={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ws(r){if(r>=Rt._0&&r<=Rt._9)return r-Rt._0;if(r>=Rt.A&&r<=Rt.F)return r-(Rt.A-10);if(r>=Rt.a&&r<=Rt.f)return r-(Rt.a-10)}function Za(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);if(Ya)return Uint8Array.fromHex(r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let i=0,o=0;i<t;i++,o+=2){const l=Ws(r.charCodeAt(o)),u=Ws(r.charCodeAt(o+1));if(l===void 0||u===void 0){const y=r[o]+r[o+1];throw new Error('hex string expected, got non-hex character "'+y+'" at index '+o)}n[i]=l*16+u}return n}function bt(r){return Wa(br(r))}function tn(r){return sr(r),Wa(br(Uint8Array.from(r).reverse()))}function Qe(r,e){return Za(r.toString(16).padStart(e*2,"0"))}function oi(r,e){return Qe(r,e).reverse()}function ct(r,e,t){let n;if(typeof e=="string")try{n=Za(e)}catch(o){throw new Error(r+" must be hex string or Uint8Array, cause: "+o)}else if(Ii(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const i=n.length;if(typeof t=="number"&&i!==t)throw new Error(r+" of length "+t+" expected, got "+i);return n}function He(...r){let e=0;for(let n=0;n<r.length;n++){const i=r[n];sr(i),e+=i.length}const t=new Uint8Array(e);for(let n=0,i=0;n<r.length;n++){const o=r[n];t.set(o,i),i+=o.length}return t}function Ss(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}const Fi=r=>typeof r=="bigint"&&As<=r;function Xa(r,e,t){return Fi(r)&&Fi(e)&&Fi(t)&&e<=r&&r<t}function Qt(r,e,t,n){if(!Xa(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function rn(r){let e;for(e=0;r>As;r>>=si,e+=1);return e}function w0(r,e){return r>>BigInt(e)&si}const Lr=r=>(si<<BigInt(r))-si,g0={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||Ii(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function gn(r,e,t={}){const n=(i,o,l)=>{const u=g0[o];if(typeof u!="function")throw new Error("invalid validator function");const y=r[i];if(!(l&&y===void 0)&&!u(y,r))throw new Error("param "+String(i)+" is invalid. Expected "+o+", got "+y)};for(const[i,o]of Object.entries(e))n(i,o,!1);for(const[i,o]of Object.entries(t))n(i,o,!0);return r}const Ys=()=>{throw new Error("not implemented")};function cn(r){const e=new WeakMap;return(t,...n)=>{const i=e.get(t);if(i!==void 0)return i;const o=r(t,...n);return e.set(t,o),o}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Xe=BigInt(0),Me=BigInt(1),er=BigInt(2),b0=BigInt(3),os=BigInt(4),Zs=BigInt(5),Xs=BigInt(8);function De(r,e){const t=r%e;return t>=Xe?t:e+t}function m0(r,e,t){if(e<Xe)throw new Error("invalid exponent, negatives unsupported");if(t<=Xe)throw new Error("invalid modulus");if(t===Me)return Xe;let n=Me;for(;e>Xe;)e&Me&&(n=n*r%t),r=r*r%t,e>>=Me;return n}function It(r,e,t){let n=r;for(;e-- >Xe;)n*=n,n%=t;return n}function Js(r,e){if(r===Xe)throw new Error("invert: expected non-zero number");if(e<=Xe)throw new Error("invert: expected positive modulus, got "+e);let t=De(r,e),n=e,i=Xe,o=Me;for(;t!==Xe;){const u=n/t,y=n%t,b=i-o*u;n=t,t=y,i=o,o=b}if(n!==Me)throw new Error("invert: does not exist");return De(i,e)}function x0(r){const e=(r-Me)/er;let t,n,i;for(t=r-Me,n=0;t%er===Xe;t/=er,n++);for(i=er;i<r&&m0(i,e,r)!==r-Me;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const l=(r+Me)/os;return function(y,b){const I=y.pow(b,l);if(!y.eql(y.sqr(I),b))throw new Error("Cannot find square root");return I}}const o=(t+Me)/er;return function(u,y){if(u.pow(y,e)===u.neg(u.ONE))throw new Error("Cannot find square root");let b=n,I=u.pow(u.mul(u.ONE,i),t),B=u.pow(y,o),N=u.pow(y,t);for(;!u.eql(N,u.ONE);){if(u.eql(N,u.ZERO))return u.ZERO;let S=1;for(let k=u.sqr(N);S<b&&!u.eql(k,u.ONE);S++)k=u.sqr(k);const w=u.pow(I,Me<<BigInt(b-S-1));I=u.sqr(w),B=u.mul(B,w),N=u.mul(N,I),b=S}return B}}function _0(r){if(r%os===b0){const e=(r+Me)/os;return function(n,i){const o=n.pow(i,e);if(!n.eql(n.sqr(o),i))throw new Error("Cannot find square root");return o}}if(r%Xs===Zs){const e=(r-Zs)/Xs;return function(n,i){const o=n.mul(i,er),l=n.pow(o,e),u=n.mul(i,l),y=n.mul(n.mul(u,er),l),b=n.mul(u,n.sub(y,n.ONE));if(!n.eql(n.sqr(b),i))throw new Error("Cannot find square root");return b}}return x0(r)}const E0=(r,e)=>(De(r,e)&Me)===Me,I0=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ja(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=I0.reduce((n,i)=>(n[i]="function",n),e);return gn(r,t)}function Pn(r,e,t){if(t<Xe)throw new Error("invalid exponent, negatives unsupported");if(t===Xe)return r.ONE;if(t===Me)return e;let n=r.ONE,i=e;for(;t>Xe;)t&Me&&(n=r.mul(n,i)),i=r.sqr(i),t>>=Me;return n}function Ln(r,e){const t=new Array(e.length),n=e.reduce((o,l,u)=>r.is0(l)?o:(t[u]=o,r.mul(o,l)),r.ONE),i=r.inv(n);return e.reduceRight((o,l,u)=>r.is0(l)?o:(t[u]=r.mul(o,t[u]),r.mul(o,l)),i),t}function v0(r){const e=(r-Me)/er;return(t,n)=>t.pow(n,e)}function Qa(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function bn(r,e,t=!1,n={}){if(r<=Xe)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:i,nByteLength:o}=Qa(r,e);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let l;const u=Object.freeze({ORDER:r,isLE:t,BITS:i,BYTES:o,MASK:Lr(i),ZERO:Xe,ONE:Me,create:y=>De(y,r),isValid:y=>{if(typeof y!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof y);return Xe<=y&&y<r},is0:y=>y===Xe,isOdd:y=>(y&Me)===Me,neg:y=>De(-y,r),eql:(y,b)=>y===b,sqr:y=>De(y*y,r),add:(y,b)=>De(y+b,r),sub:(y,b)=>De(y-b,r),mul:(y,b)=>De(y*b,r),pow:(y,b)=>Pn(u,y,b),div:(y,b)=>De(y*Js(b,r),r),sqrN:y=>y*y,addN:(y,b)=>y+b,subN:(y,b)=>y-b,mulN:(y,b)=>y*b,inv:y=>Js(y,r),sqrt:n.sqrt||(y=>(l||(l=_0(r)),l(u,y))),invertBatch:y=>Ln(u,y),cmov:(y,b,I)=>I?b:y,toBytes:y=>t?oi(y,o):Qe(y,o),fromBytes:y=>{if(y.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+y.length);return t?tn(y):bt(y)}});return Object.freeze(u)}function ec(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function tc(r){const e=ec(r);return e+Math.ceil(e/2)}function B0(r,e,t=!1){const n=r.length,i=ec(e),o=tc(e);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);const l=t?tn(r):bt(r),u=De(l,e-Me)+Me;return t?oi(u,i):Qe(u,i)}const A0=bt;function Yt(r,e){if(un(r),un(e),r<0||r>=1<<8*e)throw new Error("invalid I2OSP input: "+r);const t=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)t[n]=r&255,r>>>=8;return new Uint8Array(t)}function S0(r,e){const t=new Uint8Array(r.length);for(let n=0;n<r.length;n++)t[n]=r[n]^e[n];return t}function un(r){if(!Number.isSafeInteger(r))throw new Error("number expected")}function T0(r,e,t,n){sr(r),sr(e),un(t),e.length>255&&(e=n(He(Ss("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:o}=n,l=Math.ceil(t/i);if(t>65535||l>255)throw new Error("expand_message_xmd: invalid lenInBytes");const u=He(e,Yt(e.length,1)),y=Yt(0,o),b=Yt(t,2),I=new Array(l),B=n(He(y,r,b,Yt(0,1),u));I[0]=n(He(B,Yt(1,1),u));for(let S=1;S<=l;S++){const w=[S0(B,I[S-1]),Yt(S+1,1),u];I[S]=n(He(...w))}return He(...I).slice(0,t)}function N0(r,e,t,n,i){if(sr(r),sr(e),un(t),e.length>255){const o=Math.ceil(2*n/8);e=i.create({dkLen:o}).update(Ss("H2C-OVERSIZE-DST-")).update(e).digest()}if(t>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:t}).update(r).update(Yt(t,2)).update(e).update(Yt(e.length,1)).digest()}function Qs(r,e,t){gn(t,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:n,k:i,m:o,hash:l,expand:u,DST:y}=t;sr(r),un(e);const b=typeof y=="string"?Ss(y):y,I=n.toString(2).length,B=Math.ceil((I+i)/8),N=e*o*B;let S;if(u==="xmd")S=T0(r,b,N,l);else if(u==="xof")S=N0(r,b,N,i,l);else if(u==="_internal_pass")S=r;else throw new Error('expand must be "xmd" or "xof"');const w=new Array(e);for(let k=0;k<e;k++){const D=new Array(o);for(let K=0;K<o;K++){const j=B*(K+k*o),q=S.subarray(j,j+B);D[K]=De(A0(q),n)}w[k]=D}return w}function rc(r,e){const t=e.map(n=>Array.from(n).reverse());return(n,i)=>{const[o,l,u,y]=t.map(b=>b.reduce((I,B)=>r.add(r.mul(I,n),B)));if(r.is0(l)||r.is0(y))throw new Error("bad point: ZERO");return n=r.div(o,l),i=r.mul(i,r.div(u,y)),{x:n,y:i}}}function eo(r,e,t){if(typeof e!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){const o=Qs(n,2,{...t,DST:t.DST,...i}),l=r.fromAffine(e(o[0])),u=r.fromAffine(e(o[1])),y=l.add(u).clearCofactor();return y.assertValidity(),y},encodeToCurve(n,i){const o=Qs(n,1,{...t,DST:t.encodeDST,...i}),l=r.fromAffine(e(o[0])).clearCofactor();return l.assertValidity(),l},mapToCurve(n){if(!Array.isArray(n))throw new Error("mapToCurve: expected array of bigints");for(const o of n)if(typeof o!="bigint")throw new Error("mapToCurve: expected array of bigints");const i=r.fromAffine(e(n)).clearCofactor();return i.assertValidity(),i}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const to=BigInt(0),as=BigInt(1);function Pi(r,e){const t=e.negate();return r?t:e}function nc(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function Li(r,e){nc(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1),i=2**r,o=Lr(r),l=BigInt(r);return{windows:t,windowSize:n,mask:o,maxNumber:i,shiftBy:l}}function ro(r,e,t){const{windowSize:n,mask:i,maxNumber:o,shiftBy:l}=t;let u=Number(r&i),y=r>>l;u>n&&(u-=o,y+=as);const b=e*n,I=b+Math.abs(u)-1,B=u===0,N=u<0,S=e%2!==0;return{nextN:y,offset:I,isZero:B,isNeg:N,isNegF:S,offsetF:b}}function U0(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function O0(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const Mi=new WeakMap,ic=new WeakMap;function Di(r){return ic.get(r)||1}function sc(r,e){return{constTimeNegate:Pi,hasPrecomputes(t){return Di(t)!==1},unsafeLadder(t,n,i=r.ZERO){let o=t;for(;n>to;)n&as&&(i=i.add(o)),o=o.double(),n>>=as;return i},precomputeWindow(t,n){const{windows:i,windowSize:o}=Li(n,e),l=[];let u=t,y=u;for(let b=0;b<i;b++){y=u,l.push(y);for(let I=1;I<o;I++)y=y.add(u),l.push(y);u=y.double()}return l},wNAF(t,n,i){let o=r.ZERO,l=r.BASE;const u=Li(t,e);for(let y=0;y<u.windows;y++){const{nextN:b,offset:I,isZero:B,isNeg:N,isNegF:S,offsetF:w}=ro(i,y,u);i=b,B?l=l.add(Pi(S,n[w])):o=o.add(Pi(N,n[I]))}return{p:o,f:l}},wNAFUnsafe(t,n,i,o=r.ZERO){const l=Li(t,e);for(let u=0;u<l.windows&&i!==to;u++){const{nextN:y,offset:b,isZero:I,isNeg:B}=ro(i,u,l);if(i=y,!I){const N=n[b];o=o.add(B?N.negate():N)}}return o},getPrecomputes(t,n,i){let o=Mi.get(n);return o||(o=this.precomputeWindow(n,t),t!==1&&Mi.set(n,i(o))),o},wNAFCached(t,n,i){const o=Di(t);return this.wNAF(o,this.getPrecomputes(o,t,i),n)},wNAFCachedUnsafe(t,n,i,o){const l=Di(t);return l===1?this.unsafeLadder(t,n,o):this.wNAFUnsafe(l,this.getPrecomputes(l,t,i),n,o)},setWindowSize(t,n){nc(n,e),ic.set(t,n),Mi.delete(t)}}}function oc(r,e,t,n){if(U0(t,r),O0(n,e),t.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=r.ZERO,o=rn(BigInt(t.length)),l=o>12?o-3:o>4?o-2:o?2:1,u=Lr(l),y=new Array(Number(u)+1).fill(i),b=Math.floor((e.BITS-1)/l)*l;let I=i;for(let B=b;B>=0;B-=l){y.fill(i);for(let S=0;S<n.length;S++){const w=n[S],k=Number(w>>BigInt(B)&u);y[k]=y[k].add(t[S])}let N=i;for(let S=y.length-1,w=i;S>0;S--)w=w.add(y[S]),N=N.add(w);if(I=I.add(N),B!==0)for(let S=0;S<l;S++)I=I.double()}return I}function ac(r){return Ja(r.Fp),gn(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Qa(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function R0(r){const e=ac(r);gn(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:i}=e;if(t){if(!n.eql(i,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const hr=BigInt(0),Ce=BigInt(1),zt=BigInt(2),ai=BigInt(3),no=BigInt(4);function io(r){const e=R0(r),{Fp:t}=e,n=bn(e.n,e.nBitLength),i=e.toBytes||((k,D,K)=>{const j=D.toAffine();return He(Uint8Array.from([4]),t.toBytes(j.x),t.toBytes(j.y))}),o=e.fromBytes||(k=>{const D=k.subarray(1),K=t.fromBytes(D.subarray(0,t.BYTES)),j=t.fromBytes(D.subarray(t.BYTES,2*t.BYTES));return{x:K,y:j}});function l(k){const{a:D,b:K}=e,j=t.sqr(k),q=t.mul(j,k);return t.add(t.add(q,t.mul(k,D)),K)}if(!t.eql(t.sqr(e.Gy),l(e.Gx)))throw new Error("bad generator point: equation left != right");function u(k){return Xa(k,Ce,e.n)}function y(k){const{allowedPrivateKeyLengths:D,nByteLength:K,wrapPrivateKey:j,n:q}=e;if(D&&typeof k!="bigint"){if(Ii(k)&&(k=br(k)),typeof k!="string"||!D.includes(k.length))throw new Error("invalid private key");k=k.padStart(K*2,"0")}let ie;try{ie=typeof k=="bigint"?k:bt(ct("private key",k,K))}catch{throw new Error("invalid private key, expected hex or "+K+" bytes, got "+typeof k)}return j&&(ie=De(ie,q)),Qt("private key",ie,Ce,q),ie}function b(k){if(!(k instanceof N))throw new Error("ProjectivePoint expected")}const I=cn((k,D)=>{const{px:K,py:j,pz:q}=k;if(t.eql(q,t.ONE))return{x:K,y:j};const ie=k.is0();D==null&&(D=ie?t.ONE:t.inv(q));const M=t.mul(K,D),Y=t.mul(j,D),z=t.mul(q,D);if(ie)return{x:t.ZERO,y:t.ZERO};if(!t.eql(z,t.ONE))throw new Error("invZ was invalid");return{x:M,y:Y}}),B=cn(k=>{if(k.is0()){if(e.allowInfinityPoint&&!t.is0(k.py))return;throw new Error("bad point: ZERO")}const{x:D,y:K}=k.toAffine();if(!t.isValid(D)||!t.isValid(K))throw new Error("bad point: x or y not FE");const j=t.sqr(K),q=l(D);if(!t.eql(j,q))throw new Error("bad point: equation left != right");if(!k.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class N{constructor(D,K,j){if(D==null||!t.isValid(D))throw new Error("x required");if(K==null||!t.isValid(K))throw new Error("y required");if(j==null||!t.isValid(j))throw new Error("z required");this.px=D,this.py=K,this.pz=j,Object.freeze(this)}static fromAffine(D){const{x:K,y:j}=D||{};if(!D||!t.isValid(K)||!t.isValid(j))throw new Error("invalid affine point");if(D instanceof N)throw new Error("projective point not allowed");const q=ie=>t.eql(ie,t.ZERO);return q(K)&&q(j)?N.ZERO:new N(K,j,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(D){const K=t.invertBatch(D.map(j=>j.pz));return D.map((j,q)=>j.toAffine(K[q])).map(N.fromAffine)}static fromHex(D){const K=N.fromAffine(o(ct("pointHex",D)));return K.assertValidity(),K}static fromPrivateKey(D){return N.BASE.multiply(y(D))}static msm(D,K){return oc(N,n,D,K)}_setWindowSize(D){w.setWindowSize(this,D)}assertValidity(){B(this)}hasEvenY(){const{y:D}=this.toAffine();if(t.isOdd)return!t.isOdd(D);throw new Error("Field doesn't support isOdd")}equals(D){b(D);const{px:K,py:j,pz:q}=this,{px:ie,py:M,pz:Y}=D,z=t.eql(t.mul(K,Y),t.mul(ie,q)),J=t.eql(t.mul(j,Y),t.mul(M,q));return z&&J}negate(){return new N(this.px,t.neg(this.py),this.pz)}double(){const{a:D,b:K}=e,j=t.mul(K,ai),{px:q,py:ie,pz:M}=this;let Y=t.ZERO,z=t.ZERO,J=t.ZERO,re=t.mul(q,q),Z=t.mul(ie,ie),ye=t.mul(M,M),he=t.mul(q,ie);return he=t.add(he,he),J=t.mul(q,M),J=t.add(J,J),Y=t.mul(D,J),z=t.mul(j,ye),z=t.add(Y,z),Y=t.sub(Z,z),z=t.add(Z,z),z=t.mul(Y,z),Y=t.mul(he,Y),J=t.mul(j,J),ye=t.mul(D,ye),he=t.sub(re,ye),he=t.mul(D,he),he=t.add(he,J),J=t.add(re,re),re=t.add(J,re),re=t.add(re,ye),re=t.mul(re,he),z=t.add(z,re),ye=t.mul(ie,M),ye=t.add(ye,ye),re=t.mul(ye,he),Y=t.sub(Y,re),J=t.mul(ye,Z),J=t.add(J,J),J=t.add(J,J),new N(Y,z,J)}add(D){b(D);const{px:K,py:j,pz:q}=this,{px:ie,py:M,pz:Y}=D;let z=t.ZERO,J=t.ZERO,re=t.ZERO;const Z=e.a,ye=t.mul(e.b,ai);let he=t.mul(K,ie),T=t.mul(j,M),P=t.mul(q,Y),V=t.add(K,j),X=t.add(ie,M);V=t.mul(V,X),X=t.add(he,T),V=t.sub(V,X),X=t.add(K,q);let W=t.add(ie,Y);return X=t.mul(X,W),W=t.add(he,P),X=t.sub(X,W),W=t.add(j,q),z=t.add(M,Y),W=t.mul(W,z),z=t.add(T,P),W=t.sub(W,z),re=t.mul(Z,X),z=t.mul(ye,P),re=t.add(z,re),z=t.sub(T,re),re=t.add(T,re),J=t.mul(z,re),T=t.add(he,he),T=t.add(T,he),P=t.mul(Z,P),X=t.mul(ye,X),T=t.add(T,P),P=t.sub(he,P),P=t.mul(Z,P),X=t.add(X,P),he=t.mul(T,X),J=t.add(J,he),he=t.mul(W,X),z=t.mul(V,z),z=t.sub(z,he),he=t.mul(V,T),re=t.mul(W,re),re=t.add(re,he),new N(z,J,re)}subtract(D){return this.add(D.negate())}is0(){return this.equals(N.ZERO)}wNAF(D){return w.wNAFCached(this,D,N.normalizeZ)}multiplyUnsafe(D){const{endo:K,n:j}=e;Qt("scalar",D,hr,j);const q=N.ZERO;if(D===hr)return q;if(this.is0()||D===Ce)return this;if(!K||w.hasPrecomputes(this))return w.wNAFCachedUnsafe(this,D,N.normalizeZ);let{k1neg:ie,k1:M,k2neg:Y,k2:z}=K.splitScalar(D),J=q,re=q,Z=this;for(;M>hr||z>hr;)M&Ce&&(J=J.add(Z)),z&Ce&&(re=re.add(Z)),Z=Z.double(),M>>=Ce,z>>=Ce;return ie&&(J=J.negate()),Y&&(re=re.negate()),re=new N(t.mul(re.px,K.beta),re.py,re.pz),J.add(re)}multiply(D){const{endo:K,n:j}=e;Qt("scalar",D,Ce,j);let q,ie;if(K){const{k1neg:M,k1:Y,k2neg:z,k2:J}=K.splitScalar(D);let{p:re,f:Z}=this.wNAF(Y),{p:ye,f:he}=this.wNAF(J);re=w.constTimeNegate(M,re),ye=w.constTimeNegate(z,ye),ye=new N(t.mul(ye.px,K.beta),ye.py,ye.pz),q=re.add(ye),ie=Z.add(he)}else{const{p:M,f:Y}=this.wNAF(D);q=M,ie=Y}return N.normalizeZ([q,ie])[0]}multiplyAndAddUnsafe(D,K,j){const q=N.BASE,ie=(Y,z)=>z===hr||z===Ce||!Y.equals(q)?Y.multiplyUnsafe(z):Y.multiply(z),M=ie(this,K).add(ie(D,j));return M.is0()?void 0:M}toAffine(D){return I(this,D)}isTorsionFree(){const{h:D,isTorsionFree:K}=e;if(D===Ce)return!0;if(K)return K(N,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:D,clearCofactor:K}=e;return D===Ce?this:K?K(N,this):this.multiplyUnsafe(e.h)}toRawBytes(D=!0){return en("isCompressed",D),this.assertValidity(),i(N,this,D)}toHex(D=!0){return en("isCompressed",D),br(this.toRawBytes(D))}}N.BASE=new N(e.Gx,e.Gy,t.ONE),N.ZERO=new N(t.ZERO,t.ONE,t.ZERO);const S=e.nBitLength,w=sc(N,e.endo?Math.ceil(S/2):S);return{CURVE:e,ProjectivePoint:N,normPrivateKeyToScalar:y,weierstrassEquation:l,isWithinCurveOrder:u}}function F0(r,e){const t=r.ORDER;let n=hr;for(let w=t-Ce;w%zt===hr;w/=zt)n+=Ce;const i=n,o=zt<<i-Ce-Ce,l=o*zt,u=(t-Ce)/l,y=(u-Ce)/zt,b=l-Ce,I=o,B=r.pow(e,u),N=r.pow(e,(u+Ce)/zt);let S=(w,k)=>{let D=B,K=r.pow(k,b),j=r.sqr(K);j=r.mul(j,k);let q=r.mul(w,j);q=r.pow(q,y),q=r.mul(q,K),K=r.mul(q,k),j=r.mul(q,w);let ie=r.mul(j,K);q=r.pow(ie,I);let M=r.eql(q,r.ONE);K=r.mul(j,N),q=r.mul(ie,D),j=r.cmov(K,j,M),ie=r.cmov(q,ie,M);for(let Y=i;Y>Ce;Y--){let z=Y-zt;z=zt<<z-Ce;let J=r.pow(ie,z);const re=r.eql(J,r.ONE);K=r.mul(j,D),D=r.mul(D,D),J=r.mul(ie,D),j=r.cmov(K,j,re),ie=r.cmov(J,ie,re)}return{isValid:M,value:j}};if(r.ORDER%no===ai){const w=(r.ORDER-ai)/no,k=r.sqrt(r.neg(e));S=(D,K)=>{let j=r.sqr(K);const q=r.mul(D,K);j=r.mul(j,q);let ie=r.pow(j,w);ie=r.mul(ie,q);const M=r.mul(ie,k),Y=r.mul(r.sqr(ie),K),z=r.eql(Y,D);let J=r.cmov(M,ie,z);return{isValid:z,value:J}}}return S}function cc(r,e){if(Ja(r),!r.isValid(e.A)||!r.isValid(e.B)||!r.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const t=F0(r,e.Z);if(!r.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,o,l,u,y,b,I,B;i=r.sqr(n),i=r.mul(i,e.Z),o=r.sqr(i),o=r.add(o,i),l=r.add(o,r.ONE),l=r.mul(l,e.B),u=r.cmov(e.Z,r.neg(o),!r.eql(o,r.ZERO)),u=r.mul(u,e.A),o=r.sqr(l),b=r.sqr(u),y=r.mul(b,e.A),o=r.add(o,y),o=r.mul(o,l),b=r.mul(b,u),y=r.mul(b,e.B),o=r.add(o,y),I=r.mul(i,l);const{isValid:N,value:S}=t(o,b);B=r.mul(i,n),B=r.mul(B,S),I=r.cmov(I,l,N),B=r.cmov(B,S,N);const w=r.isOdd(n)===r.isOdd(B);return B=r.cmov(r.neg(B),B,w),I=r.div(I,u),{x:I,y:B}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const P0=BigInt(0),An=BigInt(1),so=BigInt(2),Rr=BigInt(3);function L0(r){const e=[];for(;r>An;r>>=An)(r&An)===P0?e.unshift(0):(r&Rr)===Rr?(e.unshift(-1),r+=An):e.unshift(1);return e}function M0(r){const{Fp:e,Fr:t,Fp2:n,Fp6:i,Fp12:o}=r.fields,l=r.params.xNegative,u=r.params.twistType,y=io({n:t.ORDER,...r.G1}),b=Object.assign(y,eo(y.ProjectivePoint,r.G1.mapToCurve,{...r.htfDefaults,...r.G1.htfDefaults})),I=io({n:t.ORDER,...r.G2}),B=Object.assign(I,eo(I.ProjectivePoint,r.G2.mapToCurve,{...r.htfDefaults,...r.G2.htfDefaults}));let N;if(u==="multiplicative")N=(Q,g,ne,ue,de,te)=>o.mul014(ue,Q,n.mul(g,de),n.mul(ne,te));else if(u==="divisive")N=(Q,g,ne,ue,de,te)=>o.mul034(ue,n.mul(ne,te),n.mul(g,de),Q);else throw new Error("bls: unknown twist type");const S=n.div(n.ONE,n.mul(n.ONE,so));function w(Q,g,ne,ue){const de=n.sqr(ne),te=n.sqr(ue),ae=n.mulByB(n.mul(te,Rr)),m=n.mul(ae,Rr),_=n.sub(n.sub(n.sqr(n.add(ne,ue)),te),de),v=n.sub(ae,de),R=n.mul(n.sqr(g),Rr),O=n.neg(_);return Q.push([v,R,O]),g=n.mul(n.mul(n.mul(n.sub(de,m),g),ne),S),ne=n.sub(n.sqr(n.mul(n.add(de,m),S)),n.mul(n.sqr(ae),Rr)),ue=n.mul(de,_),{Rx:g,Ry:ne,Rz:ue}}function k(Q,g,ne,ue,de,te){const ae=n.sub(ne,n.mul(te,ue)),m=n.sub(g,n.mul(de,ue)),_=n.sub(n.mul(ae,de),n.mul(m,te)),v=n.neg(ae),R=m;Q.push([_,v,R]);const O=n.sqr(m),L=n.mul(O,m),h=n.mul(O,g),s=n.add(n.sub(L,n.mul(h,so)),n.mul(n.sqr(ae),ue));return g=n.mul(m,s),ne=n.sub(n.mul(n.sub(h,s),ae),n.mul(L,ne)),ue=n.mul(ue,L),{Rx:g,Ry:ne,Rz:ue}}const D=L0(r.params.ateLoopSize),K=cn(Q=>{const g=Q,{x:ne,y:ue}=g.toAffine(),de=ne,te=ue,ae=n.neg(ue);let m=de,_=te,v=n.ONE;const R=[];for(const O of D){const L=[];({Rx:m,Ry:_,Rz:v}=w(L,m,_,v)),O&&({Rx:m,Ry:_,Rz:v}=k(L,m,_,v,de,O===-1?ae:te)),R.push(L)}if(r.postPrecompute){const O=R[R.length-1];r.postPrecompute(m,_,v,de,te,k.bind(null,O))}return R});function j(Q,g=!1){let ne=o.ONE;if(Q.length){const ue=Q[0][0].length;for(let de=0;de<ue;de++){ne=o.sqr(ne);for(const[te,ae,m]of Q)for(const[_,v,R]of te[de])ne=N(_,v,R,ne,ae,m)}}return l&&(ne=o.conjugate(ne)),g?o.finalExponentiate(ne):ne}function q(Q,g=!0){const ne=[];b.ProjectivePoint.normalizeZ(Q.map(({g1:ue})=>ue)),B.ProjectivePoint.normalizeZ(Q.map(({g2:ue})=>ue));for(const{g1:ue,g2:de}of Q){if(ue.equals(b.ProjectivePoint.ZERO)||de.equals(B.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");ue.assertValidity(),de.assertValidity();const te=ue.toAffine();ne.push([K(de),te.x,te.y])}return j(ne,g)}function ie(Q,g,ne=!0){return q([{g1:Q,g2:g}],ne)}const M={randomPrivateKey:()=>{const Q=tc(t.ORDER);return B0(r.randomBytes(Q),t.ORDER)},calcPairingPrecomputes:K},{ShortSignature:Y}=r.G1,{Signature:z}=r.G2;function J(Q){return Q instanceof b.ProjectivePoint?Q:b.ProjectivePoint.fromHex(Q)}function re(Q,g){return Q instanceof b.ProjectivePoint?Q:b.hashToCurve(ct("point",Q),g)}function Z(Q){return Q instanceof B.ProjectivePoint?Q:z.fromHex(Q)}function ye(Q,g){return Q instanceof B.ProjectivePoint?Q:B.hashToCurve(ct("point",Q),g)}function he(Q){return b.ProjectivePoint.fromPrivateKey(Q).toRawBytes(!0)}function T(Q){return B.ProjectivePoint.fromPrivateKey(Q).toRawBytes(!0)}function P(Q,g,ne){const ue=ye(Q,ne);ue.assertValidity();const de=ue.multiply(b.normPrivateKeyToScalar(g));return Q instanceof B.ProjectivePoint?de:z.toRawBytes(de)}function V(Q,g,ne){const ue=re(Q,ne);ue.assertValidity();const de=ue.multiply(b.normPrivateKeyToScalar(g));return Q instanceof b.ProjectivePoint?de:Y.toRawBytes(de)}function X(Q,g,ne,ue){const de=J(ne),te=ye(g,ue),ae=b.ProjectivePoint.BASE,m=Z(Q),_=q([{g1:de.negate(),g2:te},{g1:ae,g2:m}]);return o.eql(_,o.ONE)}function W(Q,g,ne,ue){const de=Z(ne),te=re(g,ue),ae=B.ProjectivePoint.BASE,m=J(Q),_=q([{g1:te,g2:de},{g1:m,g2:ae.negate()}]);return o.eql(_,o.ONE)}function G(Q){if(!Array.isArray(Q)||Q.length===0)throw new Error("expected non-empty array")}function ee(Q){G(Q);const ne=Q.map(J).reduce((ue,de)=>ue.add(de),b.ProjectivePoint.ZERO);return Q[0]instanceof b.ProjectivePoint?(ne.assertValidity(),ne):ne.toRawBytes(!0)}function le(Q){G(Q);const ne=Q.map(Z).reduce((ue,de)=>ue.add(de),B.ProjectivePoint.ZERO);return Q[0]instanceof B.ProjectivePoint?(ne.assertValidity(),ne):z.toRawBytes(ne)}function oe(Q){G(Q);const ne=Q.map(J).reduce((ue,de)=>ue.add(de),b.ProjectivePoint.ZERO);return Q[0]instanceof b.ProjectivePoint?(ne.assertValidity(),ne):Y.toRawBytes(ne)}function fe(Q,g,ne,ue){if(G(g),ne.length!==g.length)throw new Error("amount of public keys and messages should be equal");const de=Z(Q),te=g.map(v=>ye(v,ue)),ae=ne.map(J),m=new Map;for(let v=0;v<ae.length;v++){const R=ae[v],O=te[v];let L=m.get(O);L===void 0&&(L=[],m.set(O,L)),L.push(R)}const _=[];try{for(const[v,R]of m){const O=R.reduce((L,h)=>L.add(h));_.push({g1:O,g2:v})}return _.push({g1:b.ProjectivePoint.BASE.negate(),g2:de}),o.eql(q(_),o.ONE)}catch{return!1}}return b.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:he,getPublicKeyForShortSignatures:T,sign:P,signShortSignature:V,verify:X,verifyBatch:fe,verifyShortSignature:W,aggregatePublicKeys:ee,aggregateSignatures:le,aggregateShortSignatures:oe,millerLoopBatch:j,pairing:ie,pairingBatch:q,G1:b,G2:B,Signature:z,ShortSignature:Y,fields:{Fr:t,Fp:e,Fp2:n,Fp6:i,Fp12:o},params:{ateLoopSize:r.params.ateLoopSize,r:r.params.r,G1b:r.G1.b,G2b:r.G2.b},utils:M}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const D0=BigInt(0),Fr=BigInt(1),Lt=BigInt(2),oo=BigInt(3);function ki(r,e,t,n,i=1,o){const l=BigInt(o===void 0?n:o),u=t**BigInt(n),y=[];for(let b=0;b<i;b++){const I=BigInt(b+1),B=[];for(let N=0,S=Fr;N<n;N++){const w=(I*S-I)/l%u;B.push(r.pow(e,w)),S*=t}y.push(B)}return y}function k0(r,e,t){const n=e.pow(t,(r.ORDER-Fr)/oo),i=e.pow(t,(r.ORDER-Fr)/Lt);function o(N,S){const w=e.mul(e.frobeniusMap(N,1),n),k=e.mul(e.frobeniusMap(S,1),i);return[w,k]}const l=e.pow(t,(r.ORDER**Lt-Fr)/oo),u=e.pow(t,(r.ORDER**Lt-Fr)/Lt);if(!e.eql(u,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function y(N,S){return[e.mul(N,l),e.neg(S)]}const b=N=>(S,w)=>{const k=w.toAffine(),D=N(k.x,k.y);return S.fromAffine({x:D[0],y:D[1]})},I=b(o),B=b(y);return{psi:o,psi2:y,G2psi:I,G2psi2:B,PSI_X:n,PSI_Y:i,PSI2_X:l,PSI2_Y:u}}function C0(r){const{ORDER:e}=r,t=bn(e),n=t.create(r.NONRESIDUE||BigInt(-1)),i=v0(e),o=t.div(t.ONE,Lt),l=ki(t,n,t.ORDER,2)[0],u=({c0:T,c1:P},{c0:V,c1:X})=>({c0:t.add(T,V),c1:t.add(P,X)}),y=({c0:T,c1:P},{c0:V,c1:X})=>({c0:t.sub(T,V),c1:t.sub(P,X)}),b=({c0:T,c1:P},V)=>{if(typeof V=="bigint")return{c0:t.mul(T,V),c1:t.mul(P,V)};const{c0:X,c1:W}=V;let G=t.mul(T,X),ee=t.mul(P,W);const le=t.sub(G,ee),oe=t.sub(t.mul(t.add(T,P),t.add(X,W)),t.add(G,ee));return{c0:le,c1:oe}},I=({c0:T,c1:P})=>{const V=t.add(T,P),X=t.sub(T,P),W=t.add(T,T);return{c0:t.mul(V,X),c1:t.mul(W,P)}},B=T=>{if(T.length!==2)throw new Error("invalid tuple");const P=T.map(V=>t.create(V));return{c0:P[0],c1:P[1]}},N=e*e,S=B(r.FP2_NONRESIDUE),w={ORDER:N,isLE:t.isLE,NONRESIDUE:S,BITS:rn(N),BYTES:Math.ceil(rn(N)/8),MASK:Lr(rn(N)),ZERO:{c0:t.ZERO,c1:t.ZERO},ONE:{c0:t.ONE,c1:t.ZERO},create:T=>T,isValid:({c0:T,c1:P})=>typeof T=="bigint"&&typeof P=="bigint",is0:({c0:T,c1:P})=>t.is0(T)&&t.is0(P),eql:({c0:T,c1:P},{c0:V,c1:X})=>t.eql(T,V)&&t.eql(P,X),neg:({c0:T,c1:P})=>({c0:t.neg(T),c1:t.neg(P)}),pow:(T,P)=>Pn(w,T,P),invertBatch:T=>Ln(w,T),add:u,sub:y,mul:b,sqr:I,addN:u,subN:y,mulN:b,sqrN:I,div:(T,P)=>w.mul(T,typeof P=="bigint"?t.inv(t.create(P)):w.inv(P)),inv:({c0:T,c1:P})=>{const V=t.inv(t.create(T*T+P*P));return{c0:t.mul(V,t.create(T)),c1:t.mul(V,t.create(-P))}},sqrt:T=>{if(r.Fp2sqrt)return r.Fp2sqrt(T);const{c0:P,c1:V}=T;if(t.is0(V))return t.eql(i(t,P),t.ONE)?w.create({c0:t.sqrt(P),c1:t.ZERO}):w.create({c0:t.ZERO,c1:t.sqrt(t.div(P,n))});const X=t.sqrt(t.sub(t.sqr(P),t.mul(t.sqr(V),n)));let W=t.mul(t.add(X,P),o);const G=i(t,W);!t.is0(G)&&!t.eql(G,t.ONE)&&(W=t.sub(W,X));const ee=t.sqrt(W),le=w.create({c0:ee,c1:t.div(t.mul(V,o),ee)});if(!w.eql(w.sqr(le),T))throw new Error("Cannot find square root");const oe=le,fe=w.neg(oe),{re:Q,im:g}=w.reim(oe),{re:ne,im:ue}=w.reim(fe);return g>ue||g===ue&&Q>ne?oe:fe},isOdd:T=>{const{re:P,im:V}=w.reim(T),X=P%Lt,W=P===D0,G=V%Lt;return BigInt(X||W&&G)==Fr},fromBytes(T){if(T.length!==w.BYTES)throw new Error("fromBytes invalid length="+T.length);return{c0:t.fromBytes(T.subarray(0,t.BYTES)),c1:t.fromBytes(T.subarray(t.BYTES))}},toBytes:({c0:T,c1:P})=>He(t.toBytes(T),t.toBytes(P)),cmov:({c0:T,c1:P},{c0:V,c1:X},W)=>({c0:t.cmov(T,V,W),c1:t.cmov(P,X,W)}),reim:({c0:T,c1:P})=>({re:T,im:P}),mulByNonresidue:({c0:T,c1:P})=>w.mul({c0:T,c1:P},S),mulByB:r.Fp2mulByB,fromBigTuple:B,frobeniusMap:({c0:T,c1:P},V)=>({c0:T,c1:t.mul(P,l[V%2])})},k=({c0:T,c1:P,c2:V},{c0:X,c1:W,c2:G})=>({c0:w.add(T,X),c1:w.add(P,W),c2:w.add(V,G)}),D=({c0:T,c1:P,c2:V},{c0:X,c1:W,c2:G})=>({c0:w.sub(T,X),c1:w.sub(P,W),c2:w.sub(V,G)}),K=({c0:T,c1:P,c2:V},X)=>{if(typeof X=="bigint")return{c0:w.mul(T,X),c1:w.mul(P,X),c2:w.mul(V,X)};const{c0:W,c1:G,c2:ee}=X,le=w.mul(T,W),oe=w.mul(P,G),fe=w.mul(V,ee);return{c0:w.add(le,w.mulByNonresidue(w.sub(w.mul(w.add(P,V),w.add(G,ee)),w.add(oe,fe)))),c1:w.add(w.sub(w.mul(w.add(T,P),w.add(W,G)),w.add(le,oe)),w.mulByNonresidue(fe)),c2:w.sub(w.add(oe,w.mul(w.add(T,V),w.add(W,ee))),w.add(le,fe))}},j=({c0:T,c1:P,c2:V})=>{let X=w.sqr(T),W=w.mul(w.mul(T,P),Lt),G=w.mul(w.mul(P,V),Lt),ee=w.sqr(V);return{c0:w.add(w.mulByNonresidue(G),X),c1:w.add(w.mulByNonresidue(ee),W),c2:w.sub(w.sub(w.add(w.add(W,w.sqr(w.add(w.sub(T,P),V))),G),X),ee)}},[q,ie]=ki(w,S,t.ORDER,6,2,3),M={ORDER:w.ORDER,isLE:w.isLE,BITS:3*w.BITS,BYTES:3*w.BYTES,MASK:Lr(3*w.BITS),ZERO:{c0:w.ZERO,c1:w.ZERO,c2:w.ZERO},ONE:{c0:w.ONE,c1:w.ZERO,c2:w.ZERO},create:T=>T,isValid:({c0:T,c1:P,c2:V})=>w.isValid(T)&&w.isValid(P)&&w.isValid(V),is0:({c0:T,c1:P,c2:V})=>w.is0(T)&&w.is0(P)&&w.is0(V),neg:({c0:T,c1:P,c2:V})=>({c0:w.neg(T),c1:w.neg(P),c2:w.neg(V)}),eql:({c0:T,c1:P,c2:V},{c0:X,c1:W,c2:G})=>w.eql(T,X)&&w.eql(P,W)&&w.eql(V,G),sqrt:Ys,div:(T,P)=>M.mul(T,typeof P=="bigint"?t.inv(t.create(P)):M.inv(P)),pow:(T,P)=>Pn(M,T,P),invertBatch:T=>Ln(M,T),add:k,sub:D,mul:K,sqr:j,addN:k,subN:D,mulN:K,sqrN:j,inv:({c0:T,c1:P,c2:V})=>{let X=w.sub(w.sqr(T),w.mulByNonresidue(w.mul(V,P))),W=w.sub(w.mulByNonresidue(w.sqr(V)),w.mul(T,P)),G=w.sub(w.sqr(P),w.mul(T,V)),ee=w.inv(w.add(w.mulByNonresidue(w.add(w.mul(V,W),w.mul(P,G))),w.mul(T,X)));return{c0:w.mul(ee,X),c1:w.mul(ee,W),c2:w.mul(ee,G)}},fromBytes:T=>{if(T.length!==M.BYTES)throw new Error("fromBytes invalid length="+T.length);return{c0:w.fromBytes(T.subarray(0,w.BYTES)),c1:w.fromBytes(T.subarray(w.BYTES,2*w.BYTES)),c2:w.fromBytes(T.subarray(2*w.BYTES))}},toBytes:({c0:T,c1:P,c2:V})=>He(w.toBytes(T),w.toBytes(P),w.toBytes(V)),cmov:({c0:T,c1:P,c2:V},{c0:X,c1:W,c2:G},ee)=>({c0:w.cmov(T,X,ee),c1:w.cmov(P,W,ee),c2:w.cmov(V,G,ee)}),fromBigSix:T=>{if(!Array.isArray(T)||T.length!==6)throw new Error("invalid Fp6 usage");return{c0:w.fromBigTuple(T.slice(0,2)),c1:w.fromBigTuple(T.slice(2,4)),c2:w.fromBigTuple(T.slice(4,6))}},frobeniusMap:({c0:T,c1:P,c2:V},X)=>({c0:w.frobeniusMap(T,X),c1:w.mul(w.frobeniusMap(P,X),q[X%6]),c2:w.mul(w.frobeniusMap(V,X),ie[X%6])}),mulByFp2:({c0:T,c1:P,c2:V},X)=>({c0:w.mul(T,X),c1:w.mul(P,X),c2:w.mul(V,X)}),mulByNonresidue:({c0:T,c1:P,c2:V})=>({c0:w.mulByNonresidue(V),c1:T,c2:P}),mul1:({c0:T,c1:P,c2:V},X)=>({c0:w.mulByNonresidue(w.mul(V,X)),c1:w.mul(T,X),c2:w.mul(P,X)}),mul01({c0:T,c1:P,c2:V},X,W){let G=w.mul(T,X),ee=w.mul(P,W);return{c0:w.add(w.mulByNonresidue(w.sub(w.mul(w.add(P,V),W),ee)),G),c1:w.sub(w.sub(w.mul(w.add(X,W),w.add(T,P)),G),ee),c2:w.add(w.sub(w.mul(w.add(T,V),X),G),ee)}}},Y=ki(w,S,t.ORDER,12,1,6)[0],z=({c0:T,c1:P},{c0:V,c1:X})=>({c0:M.add(T,V),c1:M.add(P,X)}),J=({c0:T,c1:P},{c0:V,c1:X})=>({c0:M.sub(T,V),c1:M.sub(P,X)}),re=({c0:T,c1:P},V)=>{if(typeof V=="bigint")return{c0:M.mul(T,V),c1:M.mul(P,V)};let{c0:X,c1:W}=V,G=M.mul(T,X),ee=M.mul(P,W);return{c0:M.add(G,M.mulByNonresidue(ee)),c1:M.sub(M.mul(M.add(T,P),M.add(X,W)),M.add(G,ee))}},Z=({c0:T,c1:P})=>{let V=M.mul(T,P);return{c0:M.sub(M.sub(M.mul(M.add(M.mulByNonresidue(P),T),M.add(T,P)),V),M.mulByNonresidue(V)),c1:M.add(V,V)}};function ye(T,P){const V=w.sqr(T),X=w.sqr(P);return{first:w.add(w.mulByNonresidue(X),V),second:w.sub(w.sub(w.sqr(w.add(T,P)),V),X)}}const he={ORDER:w.ORDER,isLE:M.isLE,BITS:2*M.BITS,BYTES:2*M.BYTES,MASK:Lr(2*M.BITS),ZERO:{c0:M.ZERO,c1:M.ZERO},ONE:{c0:M.ONE,c1:M.ZERO},create:T=>T,isValid:({c0:T,c1:P})=>M.isValid(T)&&M.isValid(P),is0:({c0:T,c1:P})=>M.is0(T)&&M.is0(P),neg:({c0:T,c1:P})=>({c0:M.neg(T),c1:M.neg(P)}),eql:({c0:T,c1:P},{c0:V,c1:X})=>M.eql(T,V)&&M.eql(P,X),sqrt:Ys,inv:({c0:T,c1:P})=>{let V=M.inv(M.sub(M.sqr(T),M.mulByNonresidue(M.sqr(P))));return{c0:M.mul(T,V),c1:M.neg(M.mul(P,V))}},div:(T,P)=>he.mul(T,typeof P=="bigint"?t.inv(t.create(P)):he.inv(P)),pow:(T,P)=>Pn(he,T,P),invertBatch:T=>Ln(he,T),add:z,sub:J,mul:re,sqr:Z,addN:z,subN:J,mulN:re,sqrN:Z,fromBytes:T=>{if(T.length!==he.BYTES)throw new Error("fromBytes invalid length="+T.length);return{c0:M.fromBytes(T.subarray(0,M.BYTES)),c1:M.fromBytes(T.subarray(M.BYTES))}},toBytes:({c0:T,c1:P})=>He(M.toBytes(T),M.toBytes(P)),cmov:({c0:T,c1:P},{c0:V,c1:X},W)=>({c0:M.cmov(T,V,W),c1:M.cmov(P,X,W)}),fromBigTwelve:T=>({c0:M.fromBigSix(T.slice(0,6)),c1:M.fromBigSix(T.slice(6,12))}),frobeniusMap(T,P){const{c0:V,c1:X,c2:W}=M.frobeniusMap(T.c1,P),G=Y[P%12];return{c0:M.frobeniusMap(T.c0,P),c1:M.create({c0:w.mul(V,G),c1:w.mul(X,G),c2:w.mul(W,G)})}},mulByFp2:({c0:T,c1:P},V)=>({c0:M.mulByFp2(T,V),c1:M.mulByFp2(P,V)}),conjugate:({c0:T,c1:P})=>({c0:T,c1:M.neg(P)}),mul014:({c0:T,c1:P},V,X,W)=>{let G=M.mul01(T,V,X),ee=M.mul1(P,W);return{c0:M.add(M.mulByNonresidue(ee),G),c1:M.sub(M.sub(M.mul01(M.add(P,T),V,w.add(X,W)),G),ee)}},mul034:({c0:T,c1:P},V,X,W)=>{const G=M.create({c0:w.mul(T.c0,V),c1:w.mul(T.c1,V),c2:w.mul(T.c2,V)}),ee=M.mul01(P,X,W),le=M.mul01(M.add(T,P),w.add(V,X),W);return{c0:M.add(M.mulByNonresidue(ee),G),c1:M.sub(le,M.add(G,ee))}},_cyclotomicSquare:r.Fp12cyclotomicSquare,_cyclotomicExp:r.Fp12cyclotomicExp,finalExponentiate:r.Fp12finalExponentiate};return{Fp:t,Fp2:w,Fp6:M,Fp4Square:ye,Fp12:he}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const at=BigInt(0),ci=BigInt(1),Ze=BigInt(2),Sn=BigInt(3),nn=BigInt(4),Zt=BigInt("0xd201000000010000"),$0=rn(Zt),{Fp:we,Fp2:be,Fp6:cs,Fp4Square:Ci,Fp12:Ae}=C0({ORDER:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),FP2_NONRESIDUE:[ci,ci],Fp2mulByB:({c0:r,c1:e})=>{const t=we.mul(r,nn),n=we.mul(e,nn);return{c0:we.sub(t,n),c1:we.add(t,n)}},Fp12cyclotomicSquare:({c0:r,c1:e})=>{const{c0:t,c1:n,c2:i}=r,{c0:o,c1:l,c2:u}=e,{first:y,second:b}=Ci(t,l),{first:I,second:B}=Ci(o,i),{first:N,second:S}=Ci(n,u),w=be.mulByNonresidue(S);return{c0:cs.create({c0:be.add(be.mul(be.sub(y,t),Ze),y),c1:be.add(be.mul(be.sub(I,n),Ze),I),c2:be.add(be.mul(be.sub(N,i),Ze),N)}),c1:cs.create({c0:be.add(be.mul(be.add(w,o),Ze),w),c1:be.add(be.mul(be.add(b,l),Ze),b),c2:be.add(be.mul(be.add(B,u),Ze),B)})}},Fp12cyclotomicExp(r,e){let t=Ae.ONE;for(let n=$0-1;n>=0;n--)t=Ae._cyclotomicSquare(t),w0(e,n)&&(t=Ae.mul(t,r));return t},Fp12finalExponentiate:r=>{const e=Zt,t=Ae.div(Ae.frobeniusMap(r,6),r),n=Ae.mul(Ae.frobeniusMap(t,2),t),i=Ae.conjugate(Ae._cyclotomicExp(n,e)),o=Ae.mul(Ae.conjugate(Ae._cyclotomicSquare(n)),i),l=Ae.conjugate(Ae._cyclotomicExp(o,e)),u=Ae.conjugate(Ae._cyclotomicExp(l,e)),y=Ae.mul(Ae.conjugate(Ae._cyclotomicExp(u,e)),Ae._cyclotomicSquare(i)),b=Ae.conjugate(Ae._cyclotomicExp(y,e)),I=Ae.frobeniusMap(Ae.mul(i,u),2),B=Ae.frobeniusMap(Ae.mul(l,n),3),N=Ae.frobeniusMap(Ae.mul(y,Ae.conjugate(n)),1),S=Ae.mul(Ae.mul(b,Ae.conjugate(o)),n);return Ae.mul(Ae.mul(Ae.mul(I,B),N),S)}}),ao=bn(BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001")),q0=rc(be,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(r=>r.map(e=>be.fromBigTuple(e.map(BigInt))))),G0=rc(we,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(r=>r.map(e=>BigInt(e)))),H0=cc(be,{A:be.create({c0:we.create(at),c1:we.create(BigInt(240))}),B:be.create({c0:we.create(BigInt(1012)),c1:we.create(BigInt(1012))}),Z:be.create({c0:we.create(BigInt(-2)),c1:we.create(BigInt(-1))})}),V0=cc(we,{A:we.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:we.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:we.create(BigInt(11))}),{G2psi:co,G2psi2:K0}=k0(we,be,be.div(be.ONE,be.NONRESIDUE)),$i=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:we.ORDER,m:2,k:128,expand:"xmd",hash:ws}),ui=fn(we.toBytes(at),{infinity:!0,compressed:!0});function Tn(r){r=r.slice();const e=r[0]&224,t=!!(e>>7&1),n=!!(e>>6&1),i=!!(e>>5&1);return r[0]&=31,{compressed:t,infinity:n,sort:i,value:r}}function fn(r,e){if(r[0]&224)throw new Error("setMask: non-empty mask");return e.compressed&&(r[0]|=128),e.infinity&&(r[0]|=64),e.sort&&(r[0]|=32),r}function uo(r){r.assertValidity();const e=r.equals(ht.G1.ProjectivePoint.ZERO),{x:t,y:n}=r.toAffine();if(e)return ui.slice();const i=we.ORDER,o=!!(n*Ze/i);return fn(Qe(t,we.BYTES),{compressed:!0,sort:o})}function fo(r){r.assertValidity();const e=we.BYTES;if(r.equals(ht.G2.ProjectivePoint.ZERO))return He(ui,Qe(at,e));const{x:t,y:n}=r.toAffine(),{re:i,im:o}=be.reim(t),{re:l,im:u}=be.reim(n),b=!!((u>at?u*Ze:l*Ze)/we.ORDER&ci),I=i;return He(fn(Qe(o,e),{sort:b,compressed:!0}),Qe(I,e))}const ht=M0({fields:{Fp:we,Fp2:be,Fp6:cs,Fp12:Ae,Fr:ao},G1:{Fp:we,h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1"),a:we.ZERO,b:nn,htfDefaults:{...$i,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(r,e)=>{const t=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),n=new r(we.mul(e.px,t),e.py,e.pz);return e.multiplyUnsafe(Zt).negate().multiplyUnsafe(Zt).equals(n)},clearCofactor:(r,e)=>e.multiplyUnsafe(Zt).add(e),mapToCurve:r=>{const{x:e,y:t}=V0(we.create(r[0]));return G0(e,t)},fromBytes:r=>{const{compressed:e,infinity:t,sort:n,value:i}=Tn(r);if(i.length===48&&e){const o=we.ORDER,l=bt(i),u=we.create(l&we.MASK);if(t){if(u!==at)throw new Error("G1: non-empty compressed point at infinity");return{x:at,y:at}}const y=we.add(we.pow(u,Sn),we.create(ht.params.G1b));let b=we.sqrt(y);if(!b)throw new Error("invalid compressed G1 point");return b*Ze/o!==BigInt(n)&&(b=we.neg(b)),{x:we.create(u),y:we.create(b)}}else if(i.length===96&&!e){const o=bt(i.subarray(0,we.BYTES)),l=bt(i.subarray(we.BYTES));if(t){if(o!==at||l!==at)throw new Error("G1: non-empty point at infinity");return ht.G1.ProjectivePoint.ZERO.toAffine()}return{x:we.create(o),y:we.create(l)}}else throw new Error("invalid point G1, expected 48/96 bytes")},toBytes:(r,e,t)=>{const n=e.equals(r.ZERO),{x:i,y:o}=e.toAffine();if(t){if(n)return ui.slice();const l=we.ORDER,u=!!(o*Ze/l);return fn(Qe(i,we.BYTES),{compressed:!0,sort:u})}else return n?He(new Uint8Array([64]),new Uint8Array(2*we.BYTES-1)):He(Qe(i,we.BYTES),Qe(o,we.BYTES))},ShortSignature:{fromHex(r){const{infinity:e,sort:t,value:n}=Tn(ct("signatureHex",r,48)),i=we.ORDER,o=bt(n);if(e)return ht.G1.ProjectivePoint.ZERO;const l=we.create(o&we.MASK),u=we.add(we.pow(l,Sn),we.create(ht.params.G1b));let y=we.sqrt(u);if(!y)throw new Error("invalid compressed G1 point");const b=BigInt(t);y*Ze/i!==b&&(y=we.neg(y));const I=ht.G1.ProjectivePoint.fromAffine({x:l,y});return I.assertValidity(),I},toRawBytes(r){return uo(r)},toHex(r){return br(uo(r))}}},G2:{Fp:be,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),Gx:be.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:be.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")]),a:be.ZERO,b:be.fromBigTuple([nn,nn]),hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...$i},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:r=>{const{x:e,y:t}=H0(be.fromBigTuple(r));return q0(e,t)},isTorsionFree:(r,e)=>e.multiplyUnsafe(Zt).negate().equals(co(r,e)),clearCofactor:(r,e)=>{const t=Zt;let n=e.multiplyUnsafe(t).negate(),i=co(r,e),o=e.double();return o=K0(r,o),o=o.subtract(i),i=n.add(i),i=i.multiplyUnsafe(t).negate(),o=o.add(i),o=o.subtract(n),o.subtract(e)},fromBytes:r=>{const{compressed:e,infinity:t,sort:n,value:i}=Tn(r);if(!e&&!t&&n||!e&&t&&n||n&&t&&e)throw new Error("invalid encoding flag: "+(r[0]&224));const o=we.BYTES,l=(u,y,b)=>bt(u.slice(y,b));if(i.length===96&&e){const u=ht.params.G2b,y=we.ORDER;if(t){if(i.reduce((k,D)=>k!==0?D+1:D,0)>0)throw new Error("invalid compressed G2 point");return{x:be.ZERO,y:be.ZERO}}const b=l(i,0,o),I=l(i,o,2*o),B=be.create({c0:we.create(I),c1:we.create(b)}),N=be.add(be.pow(B,Sn),u);let S=be.sqrt(N);const w=S.c1===at?S.c0*Ze/y:S.c1*Ze/y?ci:at;return S=n&&w>0?S:be.neg(S),{x:B,y:S}}else if(i.length===192&&!e){if(t){if(i.reduce((B,N)=>B!==0?N+1:N,0)>0)throw new Error("invalid uncompressed G2 point");return{x:be.ZERO,y:be.ZERO}}const u=l(i,0,o),y=l(i,o,2*o),b=l(i,2*o,3*o),I=l(i,3*o,4*o);return{x:be.fromBigTuple([y,u]),y:be.fromBigTuple([I,b])}}else throw new Error("invalid point G2, expected 96/192 bytes")},toBytes:(r,e,t)=>{const{BYTES:n,ORDER:i}=we,o=e.equals(r.ZERO),{x:l,y:u}=e.toAffine();if(t){if(o)return He(ui,Qe(at,n));const y=!!(u.c1===at?u.c0*Ze/i:u.c1*Ze/i);return He(fn(Qe(l.c1,n),{compressed:!0,sort:y}),Qe(l.c0,n))}else{if(o)return He(new Uint8Array([64]),new Uint8Array(4*n-1));const{re:y,im:b}=be.reim(l),{re:I,im:B}=be.reim(u);return He(Qe(b,n),Qe(y,n),Qe(B,n),Qe(I,n))}},Signature:{fromHex(r){const{infinity:e,sort:t,value:n}=Tn(ct("signatureHex",r)),i=we.ORDER,o=n.length/2;if(o!==48&&o!==96)throw new Error("invalid compressed signature length, must be 96 or 192");const l=bt(n.slice(0,o)),u=bt(n.slice(o));if(e)return ht.G2.ProjectivePoint.ZERO;const y=we.create(l&we.MASK),b=we.create(u),I=be.create({c0:b,c1:y}),B=be.add(be.pow(I,Sn),ht.params.G2b);let N=be.sqrt(B);if(!N)throw new Error("Failed to find a square root");const{re:S,im:w}=be.reim(N),k=BigInt(t),D=w>at&&w*Ze/i!==k,K=w===at&&S*Ze/i!==k;(D||K)&&(N=be.neg(N));const j=ht.G2.ProjectivePoint.fromAffine({x:I,y:N});return j.assertValidity(),j},toRawBytes(r){return fo(r)},toHex(r){return br(fo(r))}}},params:{ateLoopSize:Zt,r:ao.ORDER,xNegative:!0,twistType:"multiplicative"},htfDefaults:$i,hash:ws,randomBytes:Mo});function j0(r,e,t){const n=typeof r=="string"?r:Ge(r),i=typeof e=="string"?e:Ge(e),o=typeof t=="string"?t:Ge(t);return ht.verifyShortSignature(i,o,n)}const uc=r=>Ye(new Gr(r)),Ts=r=>{const e=uc(r);return new Date(Number(e)/1e6)};var z0=globalThis&&globalThis.__classPrivateFieldSet||function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},W0=globalThis&&globalThis.__classPrivateFieldGet||function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Mn;class Nt extends Ke{constructor(e){super(`Invalid certificate: ${e}`)}}var ft;(function(r){r[r.Empty=0]="Empty",r[r.Fork=1]="Fork",r[r.Labeled=2]="Labeled",r[r.Leaf=3]="Leaf",r[r.Pruned=4]="Pruned"})(ft||(ft={}));function Y0(r,e){const t=new Uint8Array(r),n=new Uint8Array(e);for(let i=0;i<t.length;i++)if(t[i]>n[i])return!0;return!1}class sn{constructor(e,t,n,i,o=5,l=!1){this._rootKey=t,this._canisterId=n,this._blsVerify=i,this._maxAgeInMinutes=o,Mn.set(this,!1),z0(this,Mn,l,"f"),this.cert=kt(new Uint8Array(e))}static async create(e){const t=sn.createUnverified(e);return await t.verify(),t}static createUnverified(e){let t=e.blsVerify;return t||(t=j0),new sn(e.certificate,e.rootKey,e.canisterId,t,e.maxAgeInMinutes,e.disableTimeVerification)}lookup(e){return qr(e,this.cert.tree)}lookup_label(e){return this.lookup([e])}async verify(){const e=await Dn(this.cert.tree),t=await this._checkDelegationAndGetKey(this.cert.delegation),n=this.cert.signature,i=X0(t),o=xt(zr("ic-state-root"),e);let l=!1;const u=us(this.lookup(["time"]));if(!u)throw new Nt("Certificate does not contain a time");if(!W0(this,Mn,"f")){const b=this._maxAgeInMinutes*60*1e3,I=Date.now(),B=I-b,N=I+3e5,S=Ts(u);if(S.getTime()<B)throw new Nt(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: `+S.toISOString()+" Current time: "+new Date(I).toISOString());if(S.getTime()>N)throw new Nt("Certificate is signed more than 5 minutes in the future. Certificate time: "+S.toISOString()+" Current time: "+new Date(I).toISOString())}try{l=await this._blsVerify(new Uint8Array(i),new Uint8Array(n),new Uint8Array(o))}catch{l=!1}if(!l)throw new Nt("Signature verification failed")}async _checkDelegationAndGetKey(e){if(!e)return this._rootKey;const t=await sn.createUnverified({certificate:e.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,maxAgeInMinutes:1/0});if(t.cert.delegation)throw new Nt("Delegation certificates cannot be nested");if(await t.verify(),this._canisterId.toString()!==bl&&!fc({canisterId:this._canisterId,subnetId:Ne.fromUint8Array(new Uint8Array(e.subnet_id)),tree:t.cert.tree}))throw new Nt(`Canister ${this._canisterId} not in range of delegations for subnet 0x${Ge(e.subnet_id)}`);const n=us(t.lookup(["subnet",e.subnet_id,"public_key"]));if(!n)throw new Error(`Could not find subnet key for subnet 0x${Ge(e.subnet_id)}`);return n}}Mn=new WeakMap;const Kr=$t("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),Z0=96;function X0(r){const e=Kr.byteLength+Z0;if(r.byteLength!==e)throw new TypeError(`BLS DER-encoded public key must be ${e} bytes long`);const t=r.slice(0,Kr.byteLength);if(!dn(t,Kr))throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${Kr}, but get ${t}`);return r.slice(Kr.byteLength)}function us(r){if(r.status===Ve.Found){if(r.value instanceof ArrayBuffer)return r.value;if(r.value instanceof Uint8Array)return r.value.buffer}}async function Dn(r){switch(r[0]){case ft.Empty:return mt(zr("ic-hashtree-empty"));case ft.Pruned:return r[1];case ft.Leaf:return mt(xt(zr("ic-hashtree-leaf"),r[1]));case ft.Labeled:return mt(xt(zr("ic-hashtree-labeled"),r[1],await Dn(r[2])));case ft.Fork:return mt(xt(zr("ic-hashtree-fork"),await Dn(r[1]),await Dn(r[2])));default:throw new Error("unreachable")}}function zr(r){const e=new Uint8Array([r.length]),t=new TextEncoder().encode(r);return xt(e,t)}var Ve;(function(r){r.Unknown="unknown",r.Absent="absent",r.Found="found"})(Ve||(Ve={}));var Mt;(function(r){r.Less="less",r.Greater="greater"})(Mt||(Mt={}));function qr(r,e){if(r.length===0)switch(e[0]){case ft.Leaf:{if(!e[1])throw new Error("Invalid tree structure for leaf");return e[1]instanceof ArrayBuffer?{status:Ve.Found,value:e[1]}:e[1]instanceof Uint8Array?{status:Ve.Found,value:e[1].buffer}:{status:Ve.Found,value:e[1]}}default:return{status:Ve.Found,value:e}}const t=typeof r[0]=="string"?new TextEncoder().encode(r[0]):r[0],n=kn(t,e);switch(n.status){case Ve.Found:return qr(r.slice(1),n.value);case Mt.Greater:case Mt.Less:return{status:Ve.Absent};default:return n}}function fs(r){switch(r[0]){case ft.Empty:return[];case ft.Fork:return fs(r[1]).concat(fs(r[2]));default:return[r]}}function kn(r,e){switch(e[0]){case ft.Labeled:return Y0(r,e[1])?{status:Mt.Greater}:dn(r,e[1])?{status:Ve.Found,value:e[2]}:{status:Mt.Less};case ft.Fork:const t=kn(r,e[1]);switch(t.status){case Mt.Greater:{const n=kn(r,e[2]);return n.status===Mt.Less?{status:Ve.Absent}:n}case Ve.Unknown:{let n=kn(r,e[2]);return n.status===Mt.Less?{status:Ve.Unknown}:n}default:return t}case ft.Pruned:return{status:Ve.Unknown};default:return{status:Ve.Absent}}}function fc(r){const{canisterId:e,subnetId:t,tree:n}=r,i=qr(["subnet",t.toUint8Array(),"canister_ranges"],n);if(i.status!==Ve.Found||!(i.value instanceof ArrayBuffer))throw new Error(`Could not find canister ranges for subnet ${t}`);return kt(i.value).map(y=>[Ne.fromUint8Array(y[0]),Ne.fromUint8Array(y[1])]).some(y=>y[0].ltEq(e)&&y[1].gtEq(e))}class J0{constructor(e,t,n){this.key=e,this.path=t,this.decodeStrategy=n}}const lc=async r=>{const{agent:e,paths:t}=r,n=Ne.from(r.canisterId),i=[...new Set(t)],o=i.map(y=>ls(y,n)),l=new Map,u=i.map((y,b)=>(async()=>{var I;try{const B=await e.readState(n,{paths:[o[b]]});if(e.rootKey==null)throw new Error("Agent is missing root key");const N=await sn.create({certificate:B.certificate,rootKey:e.rootKey,canisterId:n,disableTimeVerification:!0}),S=(D,K)=>{if(K==="subnet"){if(e.rootKey==null)throw new Error("Agent is missing root key");const j=hc(B.certificate,n,e.rootKey);return{path:K,data:j}}else return{path:K,data:us(D.lookup(ls(K,n)))}},{path:w,data:k}=S(N,i[b]);if(!k)console.warn(`Expected to find result for path ${w}, but instead found nothing.`),typeof w=="string"?l.set(w,null):l.set(w.key,null);else switch(w){case"time":{l.set(w,Ts(k));break}case"controllers":{l.set(w,el(k));break}case"module_hash":{l.set(w,lo(k));break}case"subnet":{l.set(w,k);break}case"candid":{l.set(w,new TextDecoder().decode(k));break}default:if(typeof w!="string"&&"key"in w&&"path"in w)switch(w.decodeStrategy){case"raw":l.set(w.key,k);break;case"leb128":{l.set(w.key,uc(k));break}case"cbor":{l.set(w.key,dc(k));break}case"hex":{l.set(w.key,lo(k));break}case"utf-8":l.set(w.key,Q0(k))}}}catch(B){if(!((I=B==null?void 0:B.message)===null||I===void 0)&&I.includes("Invalid certificate"))throw new Ke(B.message);typeof y!="string"&&"key"in y&&"path"in y?l.set(y.key,null):l.set(y,null),console.group(),console.warn(`Expected to find result for path ${y}, but instead found nothing.`),console.warn(B),console.groupEnd()}})());return await Promise.all(u),l},hc=(r,e,t)=>{if(!e._isPrincipal)throw new Error("Invalid canisterId");const n=kt(new Uint8Array(r)),i=n.tree;let o=n.delegation,l;if(o&&o.subnet_id?l=Ne.fromUint8Array(new Uint8Array(o.subnet_id)):!o&&typeof t<"u"?(l=Ne.selfAuthenticating(new Uint8Array(t)),o={subnet_id:l.toUint8Array(),certificate:new ArrayBuffer(0)}):(l=Ne.selfAuthenticating(Ne.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),o={subnet_id:l.toUint8Array(),certificate:new ArrayBuffer(0)}),!fc({canisterId:e,subnetId:l,tree:i}))throw new Error("Canister not in range");const y=qr(["subnet",o.subnet_id,"node"],i);if(y.status!==Ve.Found)throw new Error("Node not found");if(y.value instanceof ArrayBuffer)throw new Error("Invalid node tree");const b=fs(y.value),I=new Map;return b.forEach(B=>{const N=Ne.from(new Uint8Array(B[1])).toText(),S=qr(["public_key"],B[2]);if(S.status!==Ve.Found)throw new Error("Public key not found");const w=S.value;if(w.byteLength!==44)throw new Error("Invalid public key length");I.set(N,w)}),{subnetId:Ne.fromUint8Array(new Uint8Array(o.subnet_id)).toText(),nodeKeys:I}},ls=(r,e)=>{const t=new TextEncoder,n=o=>new DataView(t.encode(o).buffer).buffer,i=new DataView(e.toUint8Array().buffer).buffer;switch(r){case"time":return[n("time")];case"controllers":return[n("canister"),i,n("controllers")];case"module_hash":return[n("canister"),i,n("module_hash")];case"subnet":return[n("subnet")];case"candid":return[n("canister"),i,n("metadata"),n("candid:service")];default:if("key"in r&&"path"in r)if(typeof r.path=="string"||r.path instanceof ArrayBuffer){const o=r.path,l=typeof o=="string"?n(o):o;return[n("canister"),i,n("metadata"),l]}else return r.path}throw new Error(`An unexpeected error was encountered while encoding your path for canister status. Please ensure that your path, ${r} was formatted correctly.`)},lo=r=>Ge(r),dc=r=>kt(r),Q0=r=>new TextDecoder().decode(r),el=r=>dc(r).map(t=>Ne.fromUint8Array(new Uint8Array(t))),tl=Object.freeze(Object.defineProperty({__proto__:null,CustomPath:J0,encodePath:ls,fetchNodeKeys:hc,request:lc},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const vt=BigInt(0),st=BigInt(1),ho=BigInt(2),rl=BigInt(8),nl={zip215:!0};function il(r){const e=ac(r);return gn(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function sl(r){const e=il(r),{Fp:t,n,prehash:i,hash:o,randomBytes:l,nByteLength:u,h:y}=e,b=ho<<BigInt(u*8)-st,I=t.create,B=bn(e.n,e.nBitLength),N=e.uvRatio||((W,G)=>{try{return{isValid:!0,value:t.sqrt(W*t.inv(G))}}catch{return{isValid:!1,value:vt}}}),S=e.adjustScalarBytes||(W=>W),w=e.domain||((W,G,ee)=>{if(en("phflag",ee),G.length||ee)throw new Error("Contexts/pre-hash are not supported");return W});function k(W,G,ee=!1){const le=ee?st:vt;Qt("coordinate "+W,G,le,b)}function D(W){if(!(W instanceof q))throw new Error("ExtendedPoint expected")}const K=cn((W,G)=>{const{ex:ee,ey:le,ez:oe}=W,fe=W.is0();G==null&&(G=fe?rl:t.inv(oe));const Q=I(ee*G),g=I(le*G),ne=I(oe*G);if(fe)return{x:vt,y:st};if(ne!==st)throw new Error("invZ was invalid");return{x:Q,y:g}}),j=cn(W=>{const{a:G,d:ee}=e;if(W.is0())throw new Error("bad point: ZERO");const{ex:le,ey:oe,ez:fe,et:Q}=W,g=I(le*le),ne=I(oe*oe),ue=I(fe*fe),de=I(ue*ue),te=I(g*G),ae=I(ue*I(te+ne)),m=I(de+I(ee*I(g*ne)));if(ae!==m)throw new Error("bad point: equation left != right (1)");const _=I(le*oe),v=I(fe*Q);if(_!==v)throw new Error("bad point: equation left != right (2)");return!0});class q{constructor(G,ee,le,oe){k("x",G),k("y",ee),k("z",le,!0),k("t",oe),this.ex=G,this.ey=ee,this.ez=le,this.et=oe,Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(G){if(G instanceof q)throw new Error("extended point not allowed");const{x:ee,y:le}=G||{};return k("x",ee),k("y",le),new q(ee,le,st,I(ee*le))}static normalizeZ(G){const ee=t.invertBatch(G.map(le=>le.ez));return G.map((le,oe)=>le.toAffine(ee[oe])).map(q.fromAffine)}static msm(G,ee){return oc(q,B,G,ee)}_setWindowSize(G){Y.setWindowSize(this,G)}assertValidity(){j(this)}equals(G){D(G);const{ex:ee,ey:le,ez:oe}=this,{ex:fe,ey:Q,ez:g}=G,ne=I(ee*g),ue=I(fe*oe),de=I(le*g),te=I(Q*oe);return ne===ue&&de===te}is0(){return this.equals(q.ZERO)}negate(){return new q(I(-this.ex),this.ey,this.ez,I(-this.et))}double(){const{a:G}=e,{ex:ee,ey:le,ez:oe}=this,fe=I(ee*ee),Q=I(le*le),g=I(ho*I(oe*oe)),ne=I(G*fe),ue=ee+le,de=I(I(ue*ue)-fe-Q),te=ne+Q,ae=te-g,m=ne-Q,_=I(de*ae),v=I(te*m),R=I(de*m),O=I(ae*te);return new q(_,v,O,R)}add(G){D(G);const{a:ee,d:le}=e,{ex:oe,ey:fe,ez:Q,et:g}=this,{ex:ne,ey:ue,ez:de,et:te}=G,ae=I(oe*ne),m=I(fe*ue),_=I(g*le*te),v=I(Q*de),R=I((oe+fe)*(ne+ue)-ae-m),O=v-_,L=v+_,h=I(m-ee*ae),s=I(R*O),a=I(L*h),p=I(R*h),x=I(O*L);return new q(s,a,x,p)}subtract(G){return this.add(G.negate())}wNAF(G){return Y.wNAFCached(this,G,q.normalizeZ)}multiply(G){const ee=G;Qt("scalar",ee,st,n);const{p:le,f:oe}=this.wNAF(ee);return q.normalizeZ([le,oe])[0]}multiplyUnsafe(G,ee=q.ZERO){const le=G;return Qt("scalar",le,vt,n),le===vt?M:this.is0()||le===st?this:Y.wNAFCachedUnsafe(this,le,q.normalizeZ,ee)}isSmallOrder(){return this.multiplyUnsafe(y).is0()}isTorsionFree(){return Y.unsafeLadder(this,n).is0()}toAffine(G){return K(this,G)}clearCofactor(){const{h:G}=e;return G===st?this:this.multiplyUnsafe(G)}static fromHex(G,ee=!1){const{d:le,a:oe}=e,fe=t.BYTES;G=ct("pointHex",G,fe),en("zip215",ee);const Q=G.slice(),g=G[fe-1];Q[fe-1]=g&-129;const ne=tn(Q),ue=ee?b:t.ORDER;Qt("pointHex.y",ne,vt,ue);const de=I(ne*ne),te=I(de-st),ae=I(le*de-oe);let{isValid:m,value:_}=N(te,ae);if(!m)throw new Error("Point.fromHex: invalid y coordinate");const v=(_&st)===st,R=(g&128)!==0;if(!ee&&_===vt&&R)throw new Error("Point.fromHex: x=0 and x_0=1");return R!==v&&(_=I(-_)),q.fromAffine({x:_,y:ne})}static fromPrivateKey(G){const{scalar:ee}=re(G);return ie.multiply(ee)}toRawBytes(){const{x:G,y:ee}=this.toAffine(),le=oi(ee,t.BYTES);return le[le.length-1]|=G&st?128:0,le}toHex(){return br(this.toRawBytes())}}q.BASE=new q(e.Gx,e.Gy,st,I(e.Gx*e.Gy)),q.ZERO=new q(vt,st,st,vt);const{BASE:ie,ZERO:M}=q,Y=sc(q,u*8);function z(W){return De(W,n)}function J(W){return z(tn(W))}function re(W){const G=t.BYTES;W=ct("private key",W,G);const ee=ct("hashed private key",o(W),2*G),le=S(ee.slice(0,G)),oe=ee.slice(G,2*G),fe=J(le);return{head:le,prefix:oe,scalar:fe}}function Z(W){const{head:G,prefix:ee,scalar:le}=re(W),oe=ie.multiply(le),fe=oe.toRawBytes();return{head:G,prefix:ee,scalar:le,point:oe,pointBytes:fe}}function ye(W){return Z(W).pointBytes}function he(W=new Uint8Array,...G){const ee=He(...G);return J(o(w(ee,ct("context",W),!!i)))}function T(W,G,ee={}){W=ct("message",W),i&&(W=i(W));const{prefix:le,scalar:oe,pointBytes:fe}=Z(G),Q=he(ee.context,le,W),g=ie.multiply(Q).toRawBytes(),ne=he(ee.context,g,fe,W),ue=z(Q+ne*oe);Qt("signature.s",ue,vt,n);const de=He(g,oi(ue,t.BYTES));return ct("result",de,t.BYTES*2)}const P=nl;function V(W,G,ee,le=P){const{context:oe,zip215:fe}=le,Q=t.BYTES;W=ct("signature",W,2*Q),G=ct("message",G),ee=ct("publicKey",ee,Q),fe!==void 0&&en("zip215",fe),i&&(G=i(G));const g=tn(W.slice(Q,2*Q));let ne,ue,de;try{ne=q.fromHex(ee,fe),ue=q.fromHex(W.slice(0,Q),fe),de=ie.multiplyUnsafe(g)}catch{return!1}if(!fe&&ne.isSmallOrder())return!1;const te=he(oe,ue.toRawBytes(),ne.toRawBytes(),G);return ue.add(ne.multiplyUnsafe(te)).subtract(de).clearCofactor().equals(q.ZERO)}return ie._setWindowSize(8),{CURVE:e,getPublicKey:ye,sign:T,verify:V,ExtendedPoint:q,utils:{getExtendedPublicKey:Z,randomPrivateKey:()=>l(t.BYTES),precompute(W=8,G=q.BASE){return G._setWindowSize(W),G.multiply(BigInt(3)),G}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ns=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),po=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const ol=BigInt(1),yo=BigInt(2);BigInt(3);const al=BigInt(5),cl=BigInt(8);function ul(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),i=BigInt(80),o=Ns,u=r*r%o*r%o,y=It(u,yo,o)*u%o,b=It(y,ol,o)*r%o,I=It(b,al,o)*b%o,B=It(I,e,o)*I%o,N=It(B,t,o)*B%o,S=It(N,n,o)*N%o,w=It(S,i,o)*S%o,k=It(w,i,o)*S%o,D=It(k,e,o)*I%o;return{pow_p_5_8:It(D,yo,o)*r%o,b2:u}}function fl(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function ll(r,e){const t=Ns,n=De(e*e*e,t),i=De(n*n*e,t),o=ul(r*i).pow_p_5_8;let l=De(r*n*o,t);const u=De(e*l*l,t),y=l,b=De(l*po,t),I=u===r,B=u===De(-r,t),N=u===De(-r*po,t);return I&&(l=y),(B||N)&&(l=b),E0(l,t)&&(l=De(-l,t)),{isValid:I||B,value:l}}const wo=(()=>bn(Ns,void 0,!0))(),hl=(()=>({a:wo.create(BigInt(-1)),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:wo,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:cl,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:p0,randomBytes:Mo,adjustScalarBytes:fl,uvRatio:ll}))(),Br=(()=>sl(hl))();var go=globalThis&&globalThis.__classPrivateFieldSet||function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},ot=globalThis&&globalThis.__classPrivateFieldGet||function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},tt,Wr,pc,yc;class dl{constructor(e={}){tt.set(this,void 0),Wr.set(this,void 0),this[pc]=this.entries.bind(this),this[yc]="ExpirableMap";const{source:t=[],expirationTime:n=10*60*1e3}=e,i=Date.now();go(this,tt,new Map([...t].map(([o,l])=>[o,{value:l,timestamp:i}])),"f"),go(this,Wr,n,"f")}prune(){const e=Date.now();for(const[t,n]of ot(this,tt,"f").entries())e-n.timestamp>ot(this,Wr,"f")&&ot(this,tt,"f").delete(t);return this}set(e,t){this.prune();const n={value:t,timestamp:Date.now()};return ot(this,tt,"f").set(e,n),this}get(e){const t=ot(this,tt,"f").get(e);if(t!==void 0){if(Date.now()-t.timestamp>ot(this,Wr,"f")){ot(this,tt,"f").delete(e);return}return t.value}}clear(){ot(this,tt,"f").clear()}entries(){const e=ot(this,tt,"f").entries();return function*(){for(const[n,i]of e)yield[n,i.value]}()}values(){const e=ot(this,tt,"f").values();return function*(){for(const n of e)yield n.value}()}keys(){return ot(this,tt,"f").keys()}forEach(e,t){for(const[n,i]of ot(this,tt,"f").entries())e.call(t,i.value,n,this)}has(e){return ot(this,tt,"f").has(e)}delete(e){return ot(this,tt,"f").delete(e)}get size(){return ot(this,tt,"f").size}}tt=new WeakMap,Wr=new WeakMap,pc=Symbol.iterator,yc=Symbol.toStringTag;const bo=r=>{if(r<=127)return 1;if(r<=255)return 2;if(r<=65535)return 3;if(r<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")},mo=(r,e,t)=>{if(t<=127)return r[e]=t,1;if(t<=255)return r[e]=129,r[e+1]=t,2;if(t<=65535)return r[e]=130,r[e+1]=t>>8,r[e+2]=t,3;if(t<=16777215)return r[e]=131,r[e+1]=t>>16,r[e+2]=t>>8,r[e+3]=t,4;throw new Error("Length too long (> 4 bytes)")},hs=(r,e)=>{if(r[e]<128)return 1;if(r[e]===128)throw new Error("Invalid length 0");if(r[e]===129)return 2;if(r[e]===130)return 3;if(r[e]===131)return 4;throw new Error("Length too long (> 4 bytes)")},pl=(r,e)=>{const t=hs(r,e);if(t===1)return r[e];if(t===2)return r[e+1];if(t===3)return(r[e+1]<<8)+r[e+2];if(t===4)return(r[e+1]<<16)+(r[e+2]<<8)+r[e+3];throw new Error("Length too long (> 4 bytes)")};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);const fi=Uint8Array.from([48,5,6,3,43,101,112]);Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);function wc(r,e){const t=2+bo(r.byteLength+1),n=e.byteLength+t+r.byteLength;let i=0;const o=new Uint8Array(1+bo(n)+n);return o[i++]=48,i+=mo(o,i,n),o.set(e,i),i+=e.byteLength,o[i++]=3,i+=mo(o,i,r.byteLength+1),o[i++]=0,o.set(new Uint8Array(r),i),o}const gc=(r,e)=>{let t=0;const n=(u,y)=>{if(i[t++]!==u)throw new Error("Expected: "+y)},i=new Uint8Array(r);if(n(48,"sequence"),t+=hs(i,t),!dn(i.slice(t,t+e.byteLength),e))throw new Error("Not the expected OID.");t+=e.byteLength,n(3,"bit string");const o=pl(i,t)-1;t+=hs(i,t),n(0,"0 padding");const l=i.slice(t);if(o!==l.length)throw new Error(`DER payload mismatch: Expected length ${o} actual length ${l.length}`);return l};var xo=globalThis&&globalThis.__classPrivateFieldSet||function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},_o=globalThis&&globalThis.__classPrivateFieldGet||function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Cn,$n;let bc=class Yr{constructor(e){if(Cn.set(this,void 0),$n.set(this,void 0),e.byteLength!==Yr.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");xo(this,Cn,e,"f"),xo(this,$n,Yr.derEncode(e),"f")}static from(e){return this.fromDer(e.toDer())}static fromRaw(e){return new Yr(e)}static fromDer(e){return new Yr(this.derDecode(e))}static derEncode(e){return wc(e,fi).buffer}static derDecode(e){const t=gc(e,fi);if(t.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return t}get rawKey(){return _o(this,Cn,"f")}get derKey(){return _o(this,$n,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}};Cn=new WeakMap,$n=new WeakMap;bc.RAW_KEY_LENGTH=32;class yl{constructor(){this.observers=[]}subscribe(e){this.observers.push(e)}unsubscribe(e){this.observers=this.observers.filter(t=>t!==e)}notify(e,...t){this.observers.forEach(n=>n(e,...t))}}class wl extends yl{constructor(){super()}print(e,...t){this.notify({message:e,level:"info"},...t)}warn(e,...t){this.notify({message:e,level:"warn"},...t)}error(e,t,...n){this.notify({message:e,level:"error",error:t},...n)}}var Bt=globalThis&&globalThis.__classPrivateFieldSet||function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},et=globalThis&&globalThis.__classPrivateFieldGet||function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},At,qn,Gn,Hn,Vn,Kn,jn,zn,Ar;const mc=.5,xc=1.5,_c=500,Ec=6e4,Ic=9e5,vc=10;class vi{constructor(e=vi.default){At.set(this,void 0),qn.set(this,void 0),Gn.set(this,void 0),Hn.set(this,void 0),Vn.set(this,void 0),Kn.set(this,void 0),jn.set(this,void 0),zn.set(this,void 0),Ar.set(this,0);const{initialInterval:t=_c,randomizationFactor:n=mc,multiplier:i=xc,maxInterval:o=Ec,maxElapsedTime:l=Ic,maxIterations:u=vc,date:y=Date}=e;Bt(this,At,t,"f"),Bt(this,qn,n,"f"),Bt(this,Gn,i,"f"),Bt(this,Hn,o,"f"),Bt(this,zn,y,"f"),Bt(this,Vn,y.now(),"f"),Bt(this,Kn,l,"f"),Bt(this,jn,u,"f")}get ellapsedTimeInMsec(){return et(this,zn,"f").now()-et(this,Vn,"f")}get currentInterval(){return et(this,At,"f")}get count(){return et(this,Ar,"f")}get randomValueFromInterval(){const e=et(this,qn,"f")*et(this,At,"f"),t=et(this,At,"f")-e,n=et(this,At,"f")+e;return Math.random()*(n-t)+t}incrementCurrentInterval(){var e;return Bt(this,At,Math.min(et(this,At,"f")*et(this,Gn,"f"),et(this,Hn,"f")),"f"),Bt(this,Ar,(e=et(this,Ar,"f"),e++,e),"f"),et(this,At,"f")}next(){return this.ellapsedTimeInMsec>=et(this,Kn,"f")||et(this,Ar,"f")>=et(this,jn,"f")?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}}At=new WeakMap,qn=new WeakMap,Gn=new WeakMap,Hn=new WeakMap,Vn=new WeakMap,Kn=new WeakMap,jn=new WeakMap,zn=new WeakMap,Ar=new WeakMap;vi.default={initialInterval:_c,randomizationFactor:mc,multiplier:xc,maxInterval:Ec,maxElapsedTime:Ic,maxIterations:vc,date:Date};var Je=globalThis&&globalThis.__classPrivateFieldSet||function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},ce=globalThis&&globalThis.__classPrivateFieldGet||function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},rt,ar,Mr,St,Pt,Pr,Zr,Sr,wt,gt,cr,ur,Xr,Tr,Nr,fr,dr,Bc,Wn,Yn,lr,Eo;(function(r){r.Received="received",r.Processing="processing",r.Replied="replied",r.Rejected="rejected",r.Unknown="unknown",r.Done="done"})(Eo||(Eo={}));const Nn=60*1e3,gl="308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae",bl="aaaaa-aa",ml="ic0.app",xl=".ic0.app",_l="icp0.io",El=".icp0.io",Il="icp-api.io",vl=".icp-api.io";class qi extends Ke{constructor(e){super(e),this.message=e}}class Un extends Ke{constructor(e){super(e),this.message=e}}function Bl(){let r;if(typeof window<"u")if(window.fetch)r=window.fetch.bind(window);else throw new qi("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.");else if(typeof global<"u")if(global.fetch)r=global.fetch.bind(global);else throw new qi("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.");else typeof self<"u"&&self.fetch&&(r=self.fetch.bind(self));if(r)return r;throw new qi("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.")}function Al(r){let e;if(r!==void 0)!r.match(/^[a-z]+:/)&&typeof window<"u"?e=new URL(window.location.protocol+"//"+r):e=new URL(r);else{const t=["ic0.app","icp0.io","127.0.0.1","localhost"],n=[".github.dev",".gitpod.io"],i=typeof window<"u"?window.location:void 0,o=i==null?void 0:i.hostname;let l;o&&typeof o=="string"&&(n.some(u=>o.endsWith(u))?l=o:l=t.find(u=>o.endsWith(u))),i&&l?e=new URL(`${i.protocol}//${l}${i.port?":"+i.port:""}`):e=new URL("https://icp-api.io")}return e.toString()}class Jr{constructor(e={}){var t,n;rt.add(this),ar.set(this,null),Mr.set(this,!1),St.set(this,void 0),Pt.set(this,void 0),Pr.set(this,void 0),Zr.set(this,void 0),Sr.set(this,0),wt.set(this,void 0),gt.set(this,void 0),cr.set(this,void 0),ur.set(this,void 0),this._isAgent=!0,this.config={},Xr.set(this,0),this.log=new wl,Tr.set(this,[]),Nr.set(this,[]),fr.set(this,new dl({expirationTime:5*60*1e3})),dr.set(this,!0),Yn.set(this,(l,u)=>{if(ce(this,dr,"f")===!1)return l;if(!u)throw new Nt("Invalid signature from replica signed query: no matching node key found.");const{status:y,signatures:b=[],requestId:I}=l,B=Dt(new TextEncoder().encode("\vic-response"));for(const N of b){const{timestamp:S,identity:w}=N,k=Ne.fromUint8Array(w).toText();let D;if(y==="replied"){const{reply:M}=l;D=ni({status:y,reply:M,timestamp:BigInt(S),request_id:I})}else if(y==="rejected"){const{reject_code:M,reject_message:Y,error_code:z}=l;D=ni({status:y,reject_code:M,reject_message:Y,error_code:z,timestamp:BigInt(S),request_id:I})}else throw new Error(`Unknown status: ${y}`);const K=xt(B,Dt(new Uint8Array(D))),j=u==null?void 0:u.nodeKeys.get(k);if(!j)throw new Nt("Invalid signature from replica signed query: no matching node key found.");const q=bc.fromDer(j).rawKey;if(Br.verify(N.signature,new Uint8Array(K),new Uint8Array(q)))return l;throw new Nt(`Invalid signature from replica ${k} signed query.`)}return l}),this.config=e,Je(this,Pt,e.fetch||Bl()||fetch.bind(global),"f"),Je(this,Pr,e.fetchOptions,"f"),Je(this,Zr,e.callOptions,"f"),Je(this,Mr,(t=e.shouldFetchRootKey)!==null&&t!==void 0?t:!1,"f"),e.rootKey?this.rootKey=e.rootKey:ce(this,Mr,"f")?this.rootKey=null:this.rootKey=$t(gl);const i=Al(e.host);this.host=new URL(i),e.verifyQuerySignatures!==void 0&&Je(this,dr,e.verifyQuerySignatures,"f"),Je(this,gt,(n=e.retryTimes)!==null&&n!==void 0?n:3,"f");const o=()=>new vi({maxIterations:ce(this,gt,"f")});if(Je(this,cr,e.backoffStrategy||o,"f"),this.host.hostname.endsWith(xl)?this.host.hostname=ml:this.host.hostname.endsWith(El)?this.host.hostname=_l:this.host.hostname.endsWith(vl)&&(this.host.hostname=Il),e.credentials){const{name:l,password:u}=e.credentials;Je(this,wt,`${l}${u?":"+u:""}`,"f")}if(Je(this,St,Promise.resolve(e.identity||new ii),"f"),e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes>5)throw new Ke(`The maximum ingress expiry time is 5 minutes. Provided ingress expiry time is ${e.ingressExpiryInMinutes} minutes.`);if(e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes<=0)throw new Ke(`Ingress expiry time must be greater than 0. Provided ingress expiry time is ${e.ingressExpiryInMinutes} minutes.`);Je(this,ur,e.ingressExpiryInMinutes||5,"f"),this.addTransform("update",zs(is)),e.useQueryNonces&&this.addTransform("query",zs(is)),e.logToConsole&&this.log.subscribe(l=>{l.level==="error"?console.error(l.message):l.level==="warn"?console.warn(l.message):console.log(l.message)})}get waterMark(){return ce(this,Xr,"f")}static createSync(e={}){return new this(Object.assign({},e))}static async create(e={shouldFetchRootKey:!1}){const t=Jr.createSync(e),n=[t.syncTime()];return t.host.toString()!=="https://icp-api.io"&&e.shouldFetchRootKey&&n.push(t.fetchRootKey()),await Promise.all(n),t}static async from(e){var t;try{return"config"in e?await Jr.create(e.config):await Jr.create({fetch:e._fetch,fetchOptions:e._fetchOptions,callOptions:e._callOptions,host:e._host.toString(),identity:(t=e._identity)!==null&&t!==void 0?t:void 0})}catch{throw new Ke("Failed to create agent from provided agent")}}isLocal(){const e=this.host.hostname;return e==="127.0.0.1"||e.endsWith("127.0.0.1")}addTransform(e,t,n=t.priority||0){if(e==="update"){const i=ce(this,Nr,"f").findIndex(o=>(o.priority||0)<n);ce(this,Nr,"f").splice(i>=0?i:ce(this,Nr,"f").length,0,Object.assign(t,{priority:n}))}else if(e==="query"){const i=ce(this,Tr,"f").findIndex(o=>(o.priority||0)<n);ce(this,Tr,"f").splice(i>=0?i:ce(this,Tr,"f").length,0,Object.assign(t,{priority:n}))}}async getPrincipal(){if(!ce(this,St,"f"))throw new Un("This identity has expired due this application's security policy. Please refresh your authentication.");return(await ce(this,St,"f")).getPrincipal()}async call(e,t,n){var i,o;await ce(this,rt,"m",lr).call(this);const l=(i=t.callSync)!==null&&i!==void 0?i:!0,u=await(n!==void 0?await n:await ce(this,St,"f"));if(!u)throw new Un("This identity has expired due this application's security policy. Please refresh your authentication.");const y=Ne.from(e),b=t.effectiveCanisterId?Ne.from(t.effectiveCanisterId):y,I=u.getPrincipal()||Ne.anonymous();let B=new vn(ce(this,ur,"f")*Nn);Math.abs(ce(this,Sr,"f"))>1e3*30&&(B=new vn(ce(this,ur,"f")*Nn+ce(this,Sr,"f")));const N={request_type:ns.Call,canister_id:y,method_name:t.methodName,arg:t.arg,sender:I,ingress_expiry:B};let S=await this._transform({request:{body:null,method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ce(this,wt,"f")?{Authorization:"Basic "+btoa(ce(this,wt,"f"))}:{})},endpoint:"call",body:N}),w;t!=null&&t.nonce?w=k(t.nonce):S.body.nonce?w=k(S.body.nonce):w=void 0,N.nonce=w;function k(q){return new Uint8Array(q)}S=await u.transformRequest(S);const D=Oi(S.body),K=ce(this,cr,"f").call(this),j=an(N);try{const q=()=>(this.log.print(`fetching "/api/v3/canister/${b.toText()}/call" with request:`,S),ce(this,Pt,"f").call(this,""+new URL(`/api/v3/canister/${b.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},ce(this,Zr,"f")),S.request),{body:D}))),ie=()=>(this.log.print(`fetching "/api/v2/canister/${b.toText()}/call" with request:`,S),ce(this,Pt,"f").call(this,""+new URL(`/api/v2/canister/${b.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},ce(this,Zr,"f")),S.request),{body:D}))),Y=await ce(this,rt,"m",Wn).call(this,{request:l?q:ie,backoff:K,tries:0}),z=await Y.arrayBuffer(),J=Y.status===200&&z.byteLength>0?kt(z):null;if(J&&"certificate"in J){const re=await this.parseTimeFromResponse({certificate:J.certificate});Je(this,Xr,re,"f")}return{requestId:j,response:{ok:Y.ok,status:Y.status,statusText:Y.statusText,body:J,headers:jr(Y.headers)},requestDetails:N}}catch(q){if(q.message.includes("v3 api not supported."))return this.log.warn("v3 api not supported. Fall back to v2"),this.call(e,Object.assign(Object.assign({},t),{callSync:!1}),n);const ie=`Error while making call: ${(o=q.message)!==null&&o!==void 0?o:String(q)}`,M=new $f(ie,q,Ge(j),Ge(S.body.sender_pubkey),Ge(S.body.sender_sig),String(S.body.content.ingress_expiry._value));throw this.log.error(ie,M),M}}async query(e,t,n){var i,o,l,u;await ce(this,rt,"m",lr).call(this);const y=ce(this,cr,"f").call(this),b=t.effectiveCanisterId?Ne.from(t.effectiveCanisterId):Ne.from(e);this.log.print(`ecid ${b.toString()}`),this.log.print(`canisterId ${e.toString()}`);let I,B;const N=await(n!==void 0?n:ce(this,St,"f"));if(!N)throw new Un("This identity has expired due this application's security policy. Please refresh your authentication.");const S=Ne.from(e),w=(N==null?void 0:N.getPrincipal())||Ne.anonymous(),k={request_type:"query",canister_id:S,method_name:t.methodName,arg:t.arg,sender:w,ingress_expiry:new vn(ce(this,ur,"f")*Nn)},D=an(k);I=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ce(this,wt,"f")?{Authorization:"Basic "+btoa(ce(this,wt,"f"))}:{})},endpoint:"read",body:k}),I=await(N==null?void 0:N.transformRequest(I));const K=Oi(I.body),j={canister:S.toText(),ecid:b,transformedRequest:I,body:K,requestId:D,backoff:y,tries:0},q=async()=>({requestDetails:k,query:await ce(this,rt,"m",Bc).call(this,j)}),ie=async()=>{if(!ce(this,dr,"f"))return;const M=ce(this,fr,"f").get(b.toString());return M||(await this.fetchSubnetKeys(b.toString()),ce(this,fr,"f").get(b.toString()))};try{const[M,Y]=await Promise.all([q(),ie()]);B=M;const{requestDetails:z,query:J}=B,re=Object.assign(Object.assign({},J),{requestDetails:z});if(this.log.print("Query response:",re),!ce(this,dr,"f"))return re;try{return ce(this,Yn,"f").call(this,re,Y)}catch{this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),ce(this,fr,"f").delete(e.toString()),await this.fetchSubnetKeys(b.toString());const ye=ce(this,fr,"f").get(e.toString());if(!ye)throw new Nt("Invalid signature from replica signed query: no matching node key found.");return ce(this,Yn,"f").call(this,re,ye)}}catch(M){const Y=`Error while making call: ${(i=M.message)!==null&&i!==void 0?i:String(M)}`,z=new qf(Y,M,String(D),Ge((o=I==null?void 0:I.body)===null||o===void 0?void 0:o.sender_pubkey),Ge((l=I==null?void 0:I.body)===null||l===void 0?void 0:l.sender_sig),String((u=I==null?void 0:I.body)===null||u===void 0?void 0:u.content.ingress_expiry._value));throw this.log.error(Y,z),z}}async createReadStateRequest(e,t){await ce(this,rt,"m",lr).call(this);const n=await(t!==void 0?await t:await ce(this,St,"f"));if(!n)throw new Un("This identity has expired due this application's security policy. Please refresh your authentication.");const i=(n==null?void 0:n.getPrincipal())||Ne.anonymous(),o=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ce(this,wt,"f")?{Authorization:"Basic "+btoa(ce(this,wt,"f"))}:{})},endpoint:"read_state",body:{request_type:"read_state",paths:e.paths,sender:i,ingress_expiry:new vn(ce(this,ur,"f")*Nn)}});return n==null?void 0:n.transformRequest(o)}async readState(e,t,n,i){var o,l,u,y;function b(k){for(const D of k.paths){const[K,j]=D,q=Dt(new TextEncoder().encode("request_status"));if(dn(K,q))return j}}const I=b(t);await ce(this,rt,"m",lr).call(this);const B=typeof e=="string"?Ne.fromText(e):e,N=i??await this.createReadStateRequest(t,n),S=Oi(N.body);this.log.print(`fetching "/api/v2/canister/${B}/read_state" with request:`,N);const w=ce(this,cr,"f").call(this);try{const k=await ce(this,rt,"m",Wn).call(this,{request:()=>ce(this,Pt,"f").call(this,""+new URL(`/api/v2/canister/${B.toString()}/read_state`,this.host),Object.assign(Object.assign(Object.assign({},ce(this,Pr,"f")),N.request),{body:S})),backoff:w,tries:0});if(!k.ok)throw new Error(`Server returned an error:
  Code: ${k.status} (${k.statusText})
  Body: ${await k.text()}
`);const D=kt(await k.arrayBuffer());this.log.print("Read state response:",D);const K=await this.parseTimeFromResponse(D);return K>0&&(this.log.print("Read state response time:",K),Je(this,Xr,K,"f")),D}catch(k){const D=`Caught exception while attempting to read state: ${(o=k.message)!==null&&o!==void 0?o:String(k)}`,K=new Gf(D,k,String(I),Ge((l=N==null?void 0:N.body)===null||l===void 0?void 0:l.sender_pubkey),Ge((u=N==null?void 0:N.body)===null||u===void 0?void 0:u.sender_sig),String((y=N==null?void 0:N.body)===null||y===void 0?void 0:y.content.ingress_expiry._value));throw this.log.error(D,K),K}}async parseTimeFromResponse(e){let t;if(e.certificate){const n=kt(e.certificate);if(n&&"tree"in n)t=n.tree;else throw new Error("Could not decode time from response");const i=qr(["time"],t);if(i.status!==Ve.Found)throw new Error("Time was not found in the response or was not in its expected format.");if(!(i.value instanceof ArrayBuffer)&&!ArrayBuffer.isView(i))throw new Error("Time was not found in the response or was not in its expected format.");const o=Ts(Dt(i.value));return this.log.print("Time from response:",o),this.log.print("Time from response in milliseconds:",Number(o)),Number(o)}else this.log.warn("No certificate found in response");return 0}async syncTime(e){await ce(this,rt,"m",lr).call(this);const t=await cu(()=>Promise.resolve().then(()=>tl),void 0),n=Date.now();try{e||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const i=Jr.createSync({identity:new ii,host:this.host.toString(),fetch:ce(this,Pt,"f"),retryTimes:0}),l=(await t.request({canisterId:e??Ne.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),agent:i,paths:["time"]})).get("time");l&&(Je(this,Sr,Number(l)-Number(n),"f"),this.log.notify({message:`Syncing time: offset of ${ce(this,Sr,"f")}`,level:"info"}))}catch(i){this.log.error("Caught exception while attempting to sync time",i)}}async status(){const e=ce(this,wt,"f")?{Authorization:"Basic "+btoa(ce(this,wt,"f"))}:{};this.log.print('fetching "/api/v2/status"');const t=ce(this,cr,"f").call(this),n=await ce(this,rt,"m",Wn).call(this,{backoff:t,request:()=>ce(this,Pt,"f").call(this,""+new URL("/api/v2/status",this.host),Object.assign({headers:e},ce(this,Pr,"f"))),tries:0});return kt(await n.arrayBuffer())}async fetchRootKey(){let e;return ce(this,ar,"f")?e=await ce(this,ar,"f"):(Je(this,ar,new Promise((t,n)=>{this.status().then(i=>{const o=i.root_key;this.rootKey=o,t(o)}).catch(n)}),"f"),e=await ce(this,ar,"f")),Je(this,ar,null,"f"),e}invalidateIdentity(){Je(this,St,null,"f")}replaceIdentity(e){Je(this,St,Promise.resolve(e),"f")}async fetchSubnetKeys(e){await ce(this,rt,"m",lr).call(this);const t=Ne.from(e),i=(await lc({canisterId:t,paths:["subnet"],agent:this})).get("subnet");if(i&&typeof i=="object"&&"nodeKeys"in i)return ce(this,fr,"f").set(t.toText(),i),i}_transform(e){let t=Promise.resolve(e);if(e.endpoint==="call")for(const n of ce(this,Nr,"f"))t=t.then(i=>n(i).then(o=>o||i));else for(const n of ce(this,Tr,"f"))t=t.then(i=>n(i).then(o=>o||i));return t}}ar=new WeakMap,Mr=new WeakMap,St=new WeakMap,Pt=new WeakMap,Pr=new WeakMap,Zr=new WeakMap,Sr=new WeakMap,wt=new WeakMap,gt=new WeakMap,cr=new WeakMap,ur=new WeakMap,Xr=new WeakMap,Tr=new WeakMap,Nr=new WeakMap,fr=new WeakMap,dr=new WeakMap,Yn=new WeakMap,rt=new WeakSet,Bc=async function r(e){var t,n;const{ecid:i,transformedRequest:o,body:l,requestId:u,backoff:y,tries:b}=e,I=b===0?0:y.next();if(this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with tries:`,{tries:b,backoff:y,delay:I}),I===null)throw new Ke(`Timestamp failed to pass the watermark after retrying the configured ${ce(this,gt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);I>0&&await new Promise(w=>setTimeout(w,I));let B;try{this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with request:`,o);const w=await ce(this,Pt,"f").call(this,""+new URL(`/api/v2/canister/${i.toString()}/query`,this.host),Object.assign(Object.assign(Object.assign({},ce(this,Pr,"f")),o.request),{body:l}));if(w.status===200){const k=kt(await w.arrayBuffer());B=Object.assign(Object.assign({},k),{httpDetails:{ok:w.ok,status:w.status,statusText:w.statusText,headers:jr(w.headers)},requestId:u})}else throw new Ri(`Gateway returned an error:
  Code: ${w.status} (${w.statusText})
  Body: ${await w.text()}
`,{ok:w.ok,status:w.status,statusText:w.statusText,headers:jr(w.headers)})}catch(w){if(b<ce(this,gt,"f"))return this.log.warn(`Caught exception while attempting to make query:
  ${w}
  Retrying query.`),await ce(this,rt,"m",r).call(this,Object.assign(Object.assign({},e),{tries:b+1}));throw w}const N=(n=(t=B.signatures)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.timestamp;if(!ce(this,dr,"f"))return B;if(!N)throw new Error("Timestamp not found in query response. This suggests a malformed or malicious response.");const S=Number(BigInt(N)/BigInt(1e6));if(this.log.print("watermark and timestamp",{waterMark:this.waterMark,timestamp:S}),Number(this.waterMark)>S){const w=new Ke("Timestamp is below the watermark. Retrying query.");if(this.log.error("Timestamp is below",w,{timestamp:N,waterMark:this.waterMark}),b<ce(this,gt,"f"))return await ce(this,rt,"m",r).call(this,Object.assign(Object.assign({},e),{tries:b+1}));throw new Ke(`Timestamp failed to pass the watermark after retrying the configured ${ce(this,gt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`)}return B},Wn=async function r(e){const{request:t,backoff:n,tries:i}=e,o=i===0?0:n.next();if(o===null)throw new Ke(`Timestamp failed to pass the watermark after retrying the configured ${ce(this,gt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);o>0&&await new Promise(b=>setTimeout(b,o));let l;try{l=await t()}catch(b){if(ce(this,gt,"f")>i)return this.log.warn(`Caught exception while attempting to make request:
  ${b}
  Retrying request.`),await ce(this,rt,"m",r).call(this,{request:t,backoff:n,tries:i+1});throw b}if(l.ok)return l;const u=await l.clone().text(),y=`Server returned an error:
  Code: ${l.status} (${l.statusText})
  Body: ${u}
`;if(l.status===404&&l.url.includes("api/v3"))throw new Ri("v3 api not supported. Fall back to v2",{ok:l.ok,status:l.status,statusText:l.statusText,headers:jr(l.headers)});if(i<ce(this,gt,"f"))return await ce(this,rt,"m",r).call(this,{request:t,backoff:n,tries:i+1});throw new Ri(y,{ok:l.ok,status:l.status,statusText:l.statusText,headers:jr(l.headers)})},lr=async function(){if(!this.rootKey)if(this.rootKey===null&&ce(this,Mr,"f"))await this.fetchRootKey();else throw new Ke(`Invalid root key detected. The root key for this agent is ${this.rootKey} and the shouldFetchRootKey value is set to ${ce(this,Mr,"f")}. The root key should only be unknown if you are in local development. Otherwise you should avoid fetching and use the default IC Root Key or the known root key of your environment.`)};var Io;(function(r){r.Error="err",r.GetPrincipal="gp",r.GetPrincipalResponse="gpr",r.Query="q",r.QueryResponse="qr",r.Call="c",r.CallResponse="cr",r.ReadState="rs",r.ReadStateResponse="rsr",r.Status="s",r.StatusResponse="sr"})(Io||(Io={}));var li=globalThis&&globalThis.__classPrivateFieldSet||function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},Xt=globalThis&&globalThis.__classPrivateFieldGet||function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Zn,Xn,Ur,Or;function vo(r){return r!==null&&typeof r=="object"}class Ct{constructor(e){if(Zn.set(this,void 0),Xn.set(this,void 0),e.byteLength!==Ct.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");li(this,Zn,Dt(e),"f"),li(this,Xn,Ct.derEncode(e),"f")}static from(e){if(typeof e=="string"){const t=$t(e);return this.fromRaw(t)}else if(vo(e)){const t=e;if(vo(t)&&Object.hasOwnProperty.call(t,"__derEncodedPublicKey__"))return this.fromDer(t);if(ArrayBuffer.isView(t)){const n=t;return this.fromRaw(Dt(n.buffer))}else{if(t instanceof ArrayBuffer)return this.fromRaw(t);if("rawKey"in t)return this.fromRaw(t.rawKey);if("derKey"in t)return this.fromDer(t.derKey);if("toDer"in t)return this.fromDer(t.toDer())}}throw new Error("Cannot construct Ed25519PublicKey from the provided key.")}static fromRaw(e){return new Ct(e)}static fromDer(e){return new Ct(this.derDecode(e))}static derEncode(e){const t=wc(e,fi).buffer;return t.__derEncodedPublicKey__=void 0,t}static derDecode(e){const t=gc(e,fi);if(t.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return Dt(t)}get rawKey(){return Xt(this,Zn,"f")}get derKey(){return Xt(this,Xn,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}Zn=new WeakMap,Xn=new WeakMap;Ct.RAW_KEY_LENGTH=32;class rr extends Is{constructor(e,t){super(),Ur.set(this,void 0),Or.set(this,void 0),li(this,Ur,Ct.from(e),"f"),li(this,Or,new Uint8Array(t),"f")}static generate(e){if(e&&e.length!==32)throw new Error("Ed25519 Seed needs to be 32 bytes long.");e||(e=Br.utils.randomPrivateKey()),dn(e,new Uint8Array(new Array(32).fill(0)))&&console.warn("Seed is all zeros. This is not a secure seed. Please provide a seed with sufficient entropy if this is a production environment.");const t=new Uint8Array(32);for(let i=0;i<32;i++)t[i]=new Uint8Array(e)[i];const n=Br.getPublicKey(t);return rr.fromKeyPair(n,t)}static fromParsedJson(e){const[t,n]=e;return new rr(Ct.fromDer($t(t)),$t(n))}static fromJSON(e){const t=JSON.parse(e);if(Array.isArray(t)){if(typeof t[0]=="string"&&typeof t[1]=="string")return this.fromParsedJson([t[0],t[1]]);throw new Error("Deserialization error: JSON must have at least 2 items.")}throw new Error(`Deserialization error: Invalid JSON type for string: ${JSON.stringify(e)}`)}static fromKeyPair(e,t){return new rr(Ct.fromRaw(e),t)}static fromSecretKey(e){const t=Br.getPublicKey(new Uint8Array(e));return rr.fromKeyPair(t,e)}toJSON(){return[Ge(Xt(this,Ur,"f").toDer()),Ge(Xt(this,Or,"f"))]}getKeyPair(){return{secretKey:Xt(this,Or,"f"),publicKey:Xt(this,Ur,"f")}}getPublicKey(){return Xt(this,Ur,"f")}async sign(e){const t=new Uint8Array(e),n=Qr(Br.sign(t,Xt(this,Or,"f").slice(0,32)));return Object.defineProperty(n,"__signature__",{enumerable:!1,value:void 0}),n}static verify(e,t,n){const[i,o,l]=[e,t,n].map(u=>(typeof u=="string"&&(u=$t(u)),u instanceof Uint8Array&&(u=Dt(u.buffer)),new Uint8Array(u)));return Br.verify(i,o,l)}}Ur=new WeakMap,Or=new WeakMap;class Us extends Error{constructor(e){super(e),this.message=e,Object.setPrototypeOf(this,Us.prototype)}}function Bo(r){if(typeof global<"u"&&global.crypto&&global.crypto.subtle)return global.crypto.subtle;if(r)return r;if(typeof crypto<"u"&&crypto.subtle)return crypto.subtle;throw new Us("Global crypto was not available and none was provided. Please inlcude a SubtleCrypto implementation. See https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto")}class hi extends Is{constructor(e,t,n){super(),this._keyPair=e,this._derKey=t,this._subtleCrypto=n}static async generate(e){const{extractable:t=!1,keyUsages:n=["sign","verify"],subtleCrypto:i}=e??{},o=Bo(i),l=await o.generateKey({name:"ECDSA",namedCurve:"P-256"},t,n),u=await o.exportKey("spki",l.publicKey);return new this(l,u,o)}static async fromKeyPair(e,t){const n=Bo(t),i=await n.exportKey("spki",e.publicKey);return new hi(e,i,n)}getKeyPair(){return this._keyPair}getPublicKey(){const e=this._derKey,t=Object.create(this._keyPair.publicKey);return t.toDer=function(){return e},t}async sign(e){const t={name:"ECDSA",hash:{name:"SHA-256"}};return await this._subtleCrypto.sign(t,this._keyPair.privateKey,e)}}var Sl=globalThis&&globalThis.__classPrivateFieldSet||function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},vr=globalThis&&globalThis.__classPrivateFieldGet||function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Ft;class Tl{constructor(e){Ft.set(this,void 0),Sl(this,Ft,e,"f")}get rawKey(){return vr(this,Ft,"f").rawKey}get derKey(){return vr(this,Ft,"f").derKey}toDer(){return vr(this,Ft,"f").toDer()}getPublicKey(){return vr(this,Ft,"f")}getPrincipal(){if(!vr(this,Ft,"f").rawKey)throw new Error("Cannot get principal from a public key without a raw key.");return Ne.fromUint8Array(new Uint8Array(vr(this,Ft,"f").rawKey))}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}}Ft=new WeakMap;var Nl=globalThis&&globalThis.__classPrivateFieldSet||function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},Ul=globalThis&&globalThis.__classPrivateFieldGet||function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Ol=globalThis&&globalThis.__rest||function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t},Jn;const Rl=new TextEncoder().encode("ic-request-auth-delegation"),Fl=new TextEncoder().encode(`
ic-request`);function Gi(r){if(typeof r!="string"||r.length<64)throw new Error("Invalid public key.");return $t(r)}class Os{constructor(e,t,n){this.pubkey=e,this.expiration=t,this.targets=n}toCBOR(){return ut.value.map(Object.assign({pubkey:ut.value.bytes(this.pubkey),expiration:ut.value.u64(this.expiration.toString(16),16)},this.targets&&{targets:ut.value.array(this.targets.map(e=>ut.value.bytes(Cr(e.toUint8Array()))))}))}toJSON(){return Object.assign({expiration:this.expiration.toString(16),pubkey:Ge(this.pubkey)},this.targets&&{targets:this.targets.map(e=>e.toHex())})}}async function Pl(r,e,t,n){const i=new Os(e.toDer(),BigInt(+t)*BigInt(1e6),n),o=new Uint8Array([...Rl,...new Uint8Array(an(Object.assign({},i)))]),l=await r.sign(Cr(o));return{delegation:i,signature:l}}class di{constructor(e,t){this.delegations=e,this.publicKey=t}static async create(e,t,n=new Date(Date.now()+15*60*1e3),i={}){var o,l;const u=await Pl(e,t,n,i.targets);return new di([...((o=i.previous)===null||o===void 0?void 0:o.delegations)||[],u],((l=i.previous)===null||l===void 0?void 0:l.publicKey)||e.getPublicKey().toDer())}static fromJSON(e){const{publicKey:t,delegations:n}=typeof e=="string"?JSON.parse(e):e;if(!Array.isArray(n))throw new Error("Invalid delegations.");const i=n.map(o=>{const{delegation:l,signature:u}=o,{pubkey:y,expiration:b,targets:I}=l;if(I!==void 0&&!Array.isArray(I))throw new Error("Invalid targets.");return{delegation:new Os(Gi(y),BigInt("0x"+b),I&&I.map(B=>{if(typeof B!="string")throw new Error("Invalid target.");return Ne.fromHex(B)})),signature:Gi(u)}});return new this(i,Gi(t))}static fromDelegations(e,t){return new this(e,t)}toJSON(){return{delegations:this.delegations.map(e=>{const{delegation:t,signature:n}=e,{targets:i}=t;return{delegation:Object.assign({expiration:t.expiration.toString(16),pubkey:Ge(t.pubkey)},i&&{targets:i.map(o=>o.toHex())}),signature:Ge(n)}}),publicKey:Ge(this.publicKey)}}}class Ao extends Is{constructor(e,t){super(),this._inner=e,this._delegation=t}static fromDelegation(e,t){return new this(e,t)}getDelegation(){return this._delegation}getPublicKey(){return{derKey:this._delegation.publicKey,toDer:()=>this._delegation.publicKey}}sign(e){return this._inner.sign(e)}async transformRequest(e){const{body:t}=e,n=Ol(e,["body"]),i=await an(t);return Object.assign(Object.assign({},n),{body:{content:t,sender_sig:await this.sign(Cr(new Uint8Array([...Fl,...new Uint8Array(i)]))),sender_delegation:this._delegation.delegations,sender_pubkey:this._delegation.publicKey}})}}class pi extends Tl{constructor(e,t){super(e),Jn.set(this,void 0),Nl(this,Jn,t,"f")}get delegation(){return Ul(this,Jn,"f")}static fromDelegation(e,t){return new pi(e,t)}}Jn=new WeakMap;function Ll(r,e){for(const{delegation:i}of r.delegations)if(+new Date(Number(i.expiration/BigInt(1e6)))<=+Date.now())return!1;const t=[],n=e==null?void 0:e.scope;n&&(Array.isArray(n)?t.push(...n.map(i=>typeof i=="string"?Ne.fromText(i):i)):t.push(typeof n=="string"?Ne.fromText(n):n));for(const i of t){const o=i.toText();for(const{delegation:l}of r.delegations){if(l.targets===void 0)continue;let u=!0;for(const y of l.targets)if(y.toText()===o){u=!1;break}if(u)return!1}}return!0}var So;(function(r){r[r.ECDSA_WITH_SHA256=-7]="ECDSA_WITH_SHA256"})(So||(So={}));const To=["mousedown","mousemove","keydown","touchstart","wheel"];class No{constructor(e={}){var t;this.callbacks=[],this.idleTimeout=10*60*1e3,this.timeoutID=void 0;const{onIdle:n,idleTimeout:i=10*60*1e3}=e||{};this.callbacks=n?[n]:[],this.idleTimeout=i;const o=this._resetTimer.bind(this);window.addEventListener("load",o,!0),To.forEach(function(u){document.addEventListener(u,o,!0)});const l=(u,y)=>{let b;return(...I)=>{const B=this,N=function(){b=void 0,u.apply(B,I)};clearTimeout(b),b=window.setTimeout(N,y)}};if(e!=null&&e.captureScroll){const u=l(o,(t=e==null?void 0:e.scrollDebounce)!==null&&t!==void 0?t:100);window.addEventListener("scroll",u,!0)}o()}static create(e={}){return new this(e)}registerCallback(e){this.callbacks.push(e)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);const e=this._resetTimer.bind(this);To.forEach(function(t){document.removeEventListener(t,e,!0)}),this.callbacks.forEach(t=>t())}_resetTimer(){const e=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(e,this.idleTimeout)}}const Ml=(r,e)=>e.some(t=>r instanceof t);let Uo,Oo;function Dl(){return Uo||(Uo=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function kl(){return Oo||(Oo=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ac=new WeakMap,ds=new WeakMap,Sc=new WeakMap,Hi=new WeakMap,Rs=new WeakMap;function Cl(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",o),r.removeEventListener("error",l)},o=()=>{t(ir(r.result)),i()},l=()=>{n(r.error),i()};r.addEventListener("success",o),r.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&Ac.set(t,r)}).catch(()=>{}),Rs.set(e,r),e}function $l(r){if(ds.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",l),r.removeEventListener("abort",l)},o=()=>{t(),i()},l=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",o),r.addEventListener("error",l),r.addEventListener("abort",l)});ds.set(r,e)}let ps={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return ds.get(r);if(e==="objectStoreNames")return r.objectStoreNames||Sc.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ir(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function ql(r){ps=r(ps)}function Gl(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(Vi(this),e,...t);return Sc.set(n,e.sort?e.sort():[e]),ir(n)}:kl().includes(r)?function(...e){return r.apply(Vi(this),e),ir(Ac.get(this))}:function(...e){return ir(r.apply(Vi(this),e))}}function Hl(r){return typeof r=="function"?Gl(r):(r instanceof IDBTransaction&&$l(r),Ml(r,Dl())?new Proxy(r,ps):r)}function ir(r){if(r instanceof IDBRequest)return Cl(r);if(Hi.has(r))return Hi.get(r);const e=Hl(r);return e!==r&&(Hi.set(r,e),Rs.set(e,r)),e}const Vi=r=>Rs.get(r);function Vl(r,e,{blocked:t,upgrade:n,blocking:i,terminated:o}={}){const l=indexedDB.open(r,e),u=ir(l);return n&&l.addEventListener("upgradeneeded",y=>{n(ir(l.result),y.oldVersion,y.newVersion,ir(l.transaction),y)}),t&&l.addEventListener("blocked",y=>t(y.oldVersion,y.newVersion,y)),u.then(y=>{o&&y.addEventListener("close",()=>o()),i&&y.addEventListener("versionchange",b=>i(b.oldVersion,b.newVersion,b))}).catch(()=>{}),u}const Kl=["get","getKey","getAll","getAllKeys","count"],jl=["put","add","delete","clear"],Ki=new Map;function Ro(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(Ki.get(e))return Ki.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=jl.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||Kl.includes(t)))return;const o=async function(l,...u){const y=this.transaction(l,i?"readwrite":"readonly");let b=y.store;return n&&(b=b.index(u.shift())),(await Promise.all([b[t](...u),i&&y.done]))[0]};return Ki.set(e,o),o}ql(r=>({...r,get:(e,t,n)=>Ro(e,t)||r.get(e,t,n),has:(e,t)=>!!Ro(e,t)||r.has(e,t)}));const Tc="auth-client-db",Nc="ic-keyval",zl=async(r=Tc,e=Nc,t)=>(Uc&&(localStorage!=null&&localStorage.getItem(tr))&&(localStorage.removeItem(tr),localStorage.removeItem(Jt)),await Vl(r,t,{upgrade:n=>{n.objectStoreNames.contains(e)&&n.clear(e),n.createObjectStore(e)}}));async function Wl(r,e,t){return await r.get(e,t)}async function Yl(r,e,t,n){return await r.put(e,n,t)}async function Zl(r,e,t){return await r.delete(e,t)}class Fs{constructor(e,t){this._db=e,this._storeName=t}static async create(e){const{dbName:t=Tc,storeName:n=Nc,version:i=eh}=e??{},o=await zl(t,n,i);return new Fs(o,n)}async set(e,t){return await Yl(this._db,this._storeName,e,t)}async get(e){var t;return(t=await Wl(this._db,this._storeName,e))!==null&&t!==void 0?t:null}async remove(e){return await Zl(this._db,this._storeName,e)}}var Xl=globalThis&&globalThis.__classPrivateFieldSet||function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},Jl=globalThis&&globalThis.__classPrivateFieldGet||function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Qn;const Jt="identity",tr="delegation",Ql="iv",eh=1,Uc=typeof window<"u";class th{constructor(e="ic-",t){this.prefix=e,this._localStorage=t}get(e){return Promise.resolve(this._getLocalStorage().getItem(this.prefix+e))}set(e,t){return this._getLocalStorage().setItem(this.prefix+e,t),Promise.resolve()}remove(e){return this._getLocalStorage().removeItem(this.prefix+e),Promise.resolve()}_getLocalStorage(){if(this._localStorage)return this._localStorage;const e=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.localStorage:global.localStorage:window.localStorage;if(!e)throw new Error("Could not find local storage.");return e}}class rh{constructor(e){Qn.set(this,void 0),Xl(this,Qn,e??{},"f")}get _db(){return new Promise(e=>{if(this.initializedDb){e(this.initializedDb);return}Fs.create(Jl(this,Qn,"f")).then(t=>{this.initializedDb=t,e(t)})})}async get(e){return await(await this._db).get(e)}async set(e,t){await(await this._db).set(e,t)}async remove(e){await(await this._db).remove(e)}}Qn=new WeakMap;const nh="https://identity.internetcomputer.org",ih="#authorize",ji="ECDSA",zi="Ed25519",sh=500,oh="UserInterrupt";class bh{constructor(e,t,n,i,o,l,u,y){this._identity=e,this._key=t,this._chain=n,this._storage=i,this.idleManager=o,this._createOptions=l,this._idpWindow=u,this._eventHandler=y,this._registerDefaultIdleCallback()}static async create(e={}){var t,n,i;const o=(t=e.storage)!==null&&t!==void 0?t:new rh,l=(n=e.keyType)!==null&&n!==void 0?n:ji;let u=null;if(e.identity)u=e.identity;else{let B=await o.get(Jt);if(!B&&Uc)try{const N=new th,S=await N.get(tr),w=await N.get(Jt);S&&w&&l===ji&&(console.log("Discovered an identity stored in localstorage. Migrating to IndexedDB"),await o.set(tr,S),await o.set(Jt,w),B=S,await N.remove(tr),await N.remove(Jt))}catch(N){console.error("error while attempting to recover localstorage: "+N)}if(B)try{typeof B=="object"?l===zi&&typeof B=="string"?u=await rr.fromJSON(B):u=await hi.fromKeyPair(B):typeof B=="string"&&(u=rr.fromJSON(B))}catch{}}let y=new ii,b=null;if(u)try{const B=await o.get(tr);if(typeof B=="object"&&B!==null)throw new Error("Delegation chain is incorrectly stored. A delegation chain should be stored as a string.");e.identity?y=e.identity:B&&(b=di.fromJSON(B),Ll(b)?"toDer"in u?y=pi.fromDelegation(u,b):y=Ao.fromDelegation(u,b):(await Wi(o),u=null))}catch(B){console.error(B),await Wi(o),u=null}let I;return!((i=e.idleOptions)===null||i===void 0)&&i.disableIdle?I=void 0:(b||e.identity)&&(I=No.create(e.idleOptions)),u||(l===zi?(u=await rr.generate(),await o.set(Jt,JSON.stringify(u.toJSON()))):(e.storage&&l===ji&&console.warn(`You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '${zi}' as the key type, as it can serialize to a string`),u=await hi.generate(),await o.set(Jt,u.getKeyPair()))),new this(y,u,b,o,I,e)}_registerDefaultIdleCallback(){var e,t;const n=(e=this._createOptions)===null||e===void 0?void 0:e.idleOptions;!(n!=null&&n.onIdle)&&!(n!=null&&n.disableDefaultIdleCallback)&&((t=this.idleManager)===null||t===void 0||t.registerCallback(()=>{this.logout(),location.reload()}))}async _handleSuccess(e,t){var n,i;const o=e.delegations.map(b=>({delegation:new Os(b.delegation.pubkey,b.delegation.expiration,b.delegation.targets),signature:b.signature.buffer})),l=di.fromDelegations(o,e.userPublicKey.buffer),u=this._key;if(!u)return;this._chain=l,"toDer"in u?this._identity=pi.fromDelegation(u,this._chain):this._identity=Ao.fromDelegation(u,this._chain),(n=this._idpWindow)===null||n===void 0||n.close();const y=(i=this._createOptions)===null||i===void 0?void 0:i.idleOptions;!this.idleManager&&!(y!=null&&y.disableIdle)&&(this.idleManager=No.create(y),this._registerDefaultIdleCallback()),this._removeEventListener(),delete this._idpWindow,this._chain&&await this._storage.set(tr,JSON.stringify(this._chain.toJSON())),t==null||t(e)}getIdentity(){return this._identity}async isAuthenticated(){return!this.getIdentity().getPrincipal().isAnonymous()&&this._chain!==null}async login(e){var t,n,i,o;const l=BigInt(8)*BigInt(36e11),u=new URL(((t=e==null?void 0:e.identityProvider)===null||t===void 0?void 0:t.toString())||nh);u.hash=ih,(n=this._idpWindow)===null||n===void 0||n.close(),this._removeEventListener(),this._eventHandler=this._getEventHandler(u,Object.assign({maxTimeToLive:(i=e==null?void 0:e.maxTimeToLive)!==null&&i!==void 0?i:l},e)),window.addEventListener("message",this._eventHandler),this._idpWindow=(o=window.open(u.toString(),"idpWindow",e==null?void 0:e.windowOpenerFeatures))!==null&&o!==void 0?o:void 0;const y=()=>{this._idpWindow&&(this._idpWindow.closed?this._handleFailure(oh,e==null?void 0:e.onError):setTimeout(y,sh))};y()}_getEventHandler(e,t){return async n=>{var i,o,l;if(n.origin!==e.origin)return;const u=n.data;switch(u.kind){case"authorize-ready":{const y=Object.assign({kind:"authorize-client",sessionPublicKey:new Uint8Array((i=this._key)===null||i===void 0?void 0:i.getPublicKey().toDer()),maxTimeToLive:t==null?void 0:t.maxTimeToLive,allowPinAuthentication:t==null?void 0:t.allowPinAuthentication,derivationOrigin:(o=t==null?void 0:t.derivationOrigin)===null||o===void 0?void 0:o.toString()},t==null?void 0:t.customValues);(l=this._idpWindow)===null||l===void 0||l.postMessage(y,e.origin);break}case"authorize-client-success":try{await this._handleSuccess(u,t==null?void 0:t.onSuccess)}catch(y){this._handleFailure(y.message,t==null?void 0:t.onError)}break;case"authorize-client-failure":this._handleFailure(u.text,t==null?void 0:t.onError);break}}}_handleFailure(e,t){var n;(n=this._idpWindow)===null||n===void 0||n.close(),t==null||t(e),this._removeEventListener(),delete this._idpWindow}_removeEventListener(){this._eventHandler&&window.removeEventListener("message",this._eventHandler),this._eventHandler=void 0}async logout(e={}){if(await Wi(this._storage),this._identity=new ii,this._chain=null,e.returnTo)try{window.history.pushState({},"",e.returnTo)}catch{window.location.href=e.returnTo}}}async function Wi(r){await r.remove(Jt),await r.remove(tr),await r.remove(Ql)}export{bh as A,sn as C,Jr as H,wh as I,Ne as P,Eo as R,Ke as a,Cr as b,Ps as c,Lu as d,Pu as e,Xc as f,us as l,Ge as t};
