import{t as A,C as D,l as T,R as v,P as m,I as Je,g as B,h as X,d as Xe,i as Ye,j as Ze,k as Ie,H as De}from"./proxy-09190287.js";function Y(){const e=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.ic.agent:global.ic.agent:window.ic.agent;if(!e)throw new Error("No Agent could be found.");return e}const Le=5*60*1e3;function L(){return at(tt(et(),1e3),st(1e3,1.2),nt(Le))}function et(){let e=!0;return async()=>e?(e=!1,!0):!1}function tt(e,t){return async(n,a,s)=>{if(await e(n,a,s))return new Promise(c=>setTimeout(c,t))}}function nt(e){const t=Date.now()+e;return async(n,a,s)=>{if(Date.now()>t)throw new Error(`Request timed out after ${e} msec:
  Request ID: ${A(a)}
  Request status: ${s}
`)}}function st(e,t){let n=e;return()=>new Promise(a=>setTimeout(()=>{n*=t,a()},n))}function at(...e){return async(t,n,a)=>{for(const s of e)await s(t,n,a)}}async function ee(e,t,n,a=L(),s,c){var r;const i=[new TextEncoder().encode("request_status"),n],d=s??await((r=e.createReadStateRequest)===null||r===void 0?void 0:r.call(e,{paths:[i]})),l=await e.readState(t,{paths:[i]},void 0,d);if(e.rootKey==null)throw new Error("Agent root key not initialized before polling");const _=await D.create({certificate:l.certificate,rootKey:e.rootKey,canisterId:t,blsVerify:c}),N=T(_.lookup([...i,new TextEncoder().encode("status")]));let f;switch(typeof N>"u"?f=v.Unknown:f=new TextDecoder().decode(N),f){case v.Replied:return{reply:T(_.lookup([...i,"reply"])),certificate:_};case v.Received:case v.Unknown:case v.Processing:return await a(t,n,f),ee(e,t,n,a,d,c);case v.Rejected:{const p=new Uint8Array(T(_.lookup([...i,"reject_code"])))[0],b=new TextDecoder().decode(T(_.lookup([...i,"reject_message"])));throw new Error(`Call was rejected:
  Request ID: ${A(n)}
  Reject code: ${p}
  Reject text: ${b}
`)}case v.Done:throw new Error(`Call was marked as done but we never saw the reply:
  Request ID: ${A(n)}
`)}throw new Error("unreachable")}const rt=({IDL:e})=>{const t=e.Variant({mainnet:e.Null,testnet:e.Null}),n=e.Text,a=e.Record({network:t,address:n,min_confirmations:e.Opt(e.Nat32)}),s=e.Nat64,c=s,r=e.Nat32,i=e.Record({start_height:r,end_height:e.Opt(r),network:t}),d=e.Vec(e.Nat8),l=e.Record({tip_height:r,block_headers:e.Vec(d)}),_=e.Record({network:t}),N=e.Nat64,f=e.Vec(N),p=e.Record({network:t,filter:e.Opt(e.Variant({page:e.Vec(e.Nat8),min_confirmations:e.Nat32})),address:n}),b=e.Vec(e.Nat8),j=e.Record({txid:e.Vec(e.Nat8),vout:e.Nat32}),S=e.Record({height:e.Nat32,value:s,outpoint:j}),V=e.Record({next_page:e.Opt(e.Vec(e.Nat8)),tip_height:r,tip_block_hash:b,utxos:e.Vec(S)}),u=e.Record({transaction:e.Vec(e.Nat8),network:t}),o=e.Principal,w=e.Record({canister_id:o,num_requested_changes:e.Opt(e.Nat64)}),y=e.Variant({from_user:e.Record({user_id:e.Principal}),from_canister:e.Record({canister_version:e.Opt(e.Nat64),canister_id:e.Principal})}),R=e.Vec(e.Nat8),P=e.Variant({creation:e.Record({controllers:e.Vec(e.Principal)}),code_deployment:e.Record({mode:e.Variant({reinstall:e.Null,upgrade:e.Null,install:e.Null}),module_hash:e.Vec(e.Nat8)}),load_snapshot:e.Record({canister_version:e.Nat64,taken_at_timestamp:e.Nat64,snapshot_id:R}),controllers_change:e.Record({controllers:e.Vec(e.Principal)}),code_uninstall:e.Null}),C=e.Record({timestamp_nanos:e.Nat64,canister_version:e.Nat64,origin:y,details:P}),O=e.Record({controllers:e.Vec(e.Principal),module_hash:e.Opt(e.Vec(e.Nat8)),recent_changes:e.Vec(C),total_num_changes:e.Nat64}),g=e.Record({canister_id:o}),k=e.Variant({controllers:e.Null,public:e.Null,allowed_viewers:e.Vec(e.Principal)}),M=e.Record({freezing_threshold:e.Nat,controllers:e.Vec(e.Principal),reserved_cycles_limit:e.Nat,log_visibility:k,wasm_memory_limit:e.Nat,memory_allocation:e.Nat,compute_allocation:e.Nat}),$=e.Record({status:e.Variant({stopped:e.Null,stopping:e.Null,running:e.Null}),memory_size:e.Nat,cycles:e.Nat,settings:M,query_stats:e.Record({response_payload_bytes_total:e.Nat,num_instructions_total:e.Nat,num_calls_total:e.Nat,request_payload_bytes_total:e.Nat}),idle_cycles_burned_per_day:e.Nat,module_hash:e.Opt(e.Vec(e.Nat8)),reserved_cycles:e.Nat}),q=e.Record({canister_id:o}),F=e.Record({freezing_threshold:e.Opt(e.Nat),controllers:e.Opt(e.Vec(e.Principal)),reserved_cycles_limit:e.Opt(e.Nat),log_visibility:e.Opt(k),wasm_memory_limit:e.Opt(e.Nat),memory_allocation:e.Opt(e.Nat),compute_allocation:e.Opt(e.Nat)}),ae=e.Record({settings:e.Opt(F),sender_canister_version:e.Opt(e.Nat64)}),re=e.Record({canister_id:o}),ce=e.Record({canister_id:o}),oe=e.Record({canister_id:o,snapshot_id:R}),ie=e.Record({canister_id:o}),K=e.Variant({secp256k1:e.Null}),le=e.Record({key_id:e.Record({name:e.Text,curve:K}),canister_id:e.Opt(o),derivation_path:e.Vec(e.Vec(e.Nat8))}),_e=e.Record({public_key:e.Vec(e.Nat8),chain_code:e.Vec(e.Nat8)}),de=e.Record({canister_id:o}),ue=e.Record({idx:e.Nat64,timestamp_nanos:e.Nat64,content:e.Vec(e.Nat8)}),pe=e.Record({canister_log_records:e.Vec(ue)}),W=e.Record({value:e.Text,name:e.Text}),z=e.Record({status:e.Nat,body:e.Vec(e.Nat8),headers:e.Vec(W)}),ge=e.Record({url:e.Text,method:e.Variant({get:e.Null,head:e.Null,post:e.Null}),max_response_bytes:e.Opt(e.Nat64),body:e.Opt(e.Vec(e.Nat8)),transform:e.Opt(e.Record({function:e.Func([e.Record({context:e.Vec(e.Nat8),response:z})],[z],["query"]),context:e.Vec(e.Nat8)})),headers:e.Vec(W)}),Q=e.Variant({reinstall:e.Null,upgrade:e.Opt(e.Record({wasm_memory_persistence:e.Opt(e.Variant({keep:e.Null,replace:e.Null})),skip_pre_upgrade:e.Opt(e.Bool)})),install:e.Null}),U=e.Record({hash:e.Vec(e.Nat8)}),he=e.Record({arg:e.Vec(e.Nat8),wasm_module_hash:e.Vec(e.Nat8),mode:Q,chunk_hashes_list:e.Vec(U),target_canister:o,store_canister:e.Opt(o),sender_canister_version:e.Opt(e.Nat64)}),me=e.Vec(e.Nat8),fe=e.Record({arg:e.Vec(e.Nat8),wasm_module:me,mode:Q,canister_id:o,sender_canister_version:e.Opt(e.Nat64)}),ye=e.Record({canister_id:o}),G=e.Record({id:R,total_size:e.Nat64,taken_at_timestamp:e.Nat64}),Ne=e.Vec(G),be=e.Record({canister_id:o,sender_canister_version:e.Opt(e.Nat64),snapshot_id:R}),we=e.Record({start_at_timestamp_nanos:e.Nat64,subnet_id:e.Principal}),Re=e.Record({num_block_failures_total:e.Nat64,node_id:e.Principal,num_blocks_proposed_total:e.Nat64}),Te=e.Vec(e.Record({timestamp_nanos:e.Nat64,node_metrics:e.Vec(Re)})),Oe=e.Record({settings:e.Opt(F),specified_id:e.Opt(o),amount:e.Opt(e.Nat),sender_canister_version:e.Opt(e.Nat64)}),ve=e.Record({canister_id:o}),Ve=e.Record({canister_id:o,amount:e.Nat}),xe=e.Vec(e.Nat8),J=e.Variant({ed25519:e.Null,bip340secp256k1:e.Null}),ke=e.Record({key_id:e.Record({algorithm:J,name:e.Text}),canister_id:e.Opt(o),derivation_path:e.Vec(e.Vec(e.Nat8))}),Fe=e.Record({public_key:e.Vec(e.Nat8),chain_code:e.Vec(e.Nat8)}),je=e.Record({key_id:e.Record({name:e.Text,curve:K}),derivation_path:e.Vec(e.Vec(e.Nat8)),message_hash:e.Vec(e.Nat8)}),Pe=e.Record({signature:e.Vec(e.Nat8)}),Ce=e.Variant({bip341:e.Record({merkle_root_hash:e.Vec(e.Nat8)})}),qe=e.Record({aux:e.Opt(Ce),key_id:e.Record({algorithm:J,name:e.Text}),derivation_path:e.Vec(e.Vec(e.Nat8)),message:e.Vec(e.Nat8)}),Ae=e.Record({signature:e.Vec(e.Nat8)}),Ee=e.Record({canister_id:o}),Se=e.Record({canister_id:o}),Me=e.Record({canister_id:o}),$e=e.Vec(U),ze=e.Record({subnet_id:e.Principal}),Ue=e.Record({replica_version:e.Text}),Be=e.Record({replace_snapshot:e.Opt(R),canister_id:o}),He=G,Ke=e.Record({canister_id:o,sender_canister_version:e.Opt(e.Nat64)}),We=e.Record({canister_id:e.Principal,settings:F,sender_canister_version:e.Opt(e.Nat64)}),Qe=e.Record({chunk:e.Vec(e.Nat8),canister_id:e.Principal}),Ge=U;return e.Service({bitcoin_get_balance:e.Func([a],[c],[]),bitcoin_get_block_headers:e.Func([i],[l],[]),bitcoin_get_current_fee_percentiles:e.Func([_],[f],[]),bitcoin_get_utxos:e.Func([p],[V],[]),bitcoin_send_transaction:e.Func([u],[],[]),canister_info:e.Func([w],[O],[]),canister_status:e.Func([g],[$],[]),clear_chunk_store:e.Func([q],[],[]),create_canister:e.Func([ae],[re],[]),delete_canister:e.Func([ce],[],[]),delete_canister_snapshot:e.Func([oe],[],[]),deposit_cycles:e.Func([ie],[],[]),ecdsa_public_key:e.Func([le],[_e],[]),fetch_canister_logs:e.Func([de],[pe],["query"]),http_request:e.Func([ge],[z],[]),install_chunked_code:e.Func([he],[],[]),install_code:e.Func([fe],[],[]),list_canister_snapshots:e.Func([ye],[Ne],[]),load_canister_snapshot:e.Func([be],[],[]),node_metrics_history:e.Func([we],[Te],[]),provisional_create_canister_with_cycles:e.Func([Oe],[ve],[]),provisional_top_up_canister:e.Func([Ve],[],[]),raw_rand:e.Func([],[xe],[]),schnorr_public_key:e.Func([ke],[Fe],[]),sign_with_ecdsa:e.Func([je],[Pe],[]),sign_with_schnorr:e.Func([qe],[Ae],[]),start_canister:e.Func([Ee],[],[]),stop_canister:e.Func([Se],[],[]),stored_chunks:e.Func([Me],[$e],[]),subnet_info:e.Func([ze],[Ue],[]),take_canister_snapshot:e.Func([Be],[He],[]),uninstall_code:e.Func([Ke],[],[]),update_settings:e.Func([We],[],[]),upload_chunk:e.Func([Qe],[Ge],[])})};class te extends B{constructor(t,n,a,s){super(["Call failed:",`  Canister: ${t.toText()}`,`  Method: ${n} (${a})`,...Object.getOwnPropertyNames(s).map(c=>`  "${c}": ${JSON.stringify(s[c])}`)].join(`
`)),this.canisterId=t,this.methodName=n,this.type=a,this.props=s}}class ct extends te{constructor(t,n,a){var s;super(t,n,"query",{Status:a.status,Code:(s=Ye[a.reject_code])!==null&&s!==void 0?s:`Unknown Code "${a.reject_code}"`,Message:a.reject_message}),this.result=a}}class Z extends te{constructor(t,n,a,s,c,r,i){super(t,n,"update",Object.assign({"Request ID":A(a)},s.body?Object.assign(Object.assign({},i?{"Error code":i}:{}),{"Reject code":String(c),"Reject message":r}):{"HTTP status code":s.status.toString(),"HTTP status text":s.statusText})),this.requestId=a,this.response=s,this.reject_code=c,this.reject_message=r,this.error_code=i}}const h=Symbol.for("ic-agent-metadata");class E{constructor(t){this[h]=Object.freeze(t)}static agentOf(t){return t[h].config.agent}static interfaceOf(t){return t[h].service}static canisterIdOf(t){return m.from(t[h].config.canisterId)}static async install(t,n){const a=t.mode===void 0?{install:null}:t.mode,s=t.arg?[...new Uint8Array(t.arg)]:[],c=[...new Uint8Array(t.module)],r=typeof n.canisterId=="string"?m.fromText(n.canisterId):n.canisterId;await I(n).install_code({mode:a,arg:s,wasm_module:c,canister_id:r,sender_canister_version:[]})}static async createCanister(t,n){function a(c){return[{controllers:c.controllers?[c.controllers]:[],compute_allocation:c.compute_allocation?[c.compute_allocation]:[],freezing_threshold:c.freezing_threshold?[c.freezing_threshold]:[],memory_allocation:c.memory_allocation?[c.memory_allocation]:[],reserved_cycles_limit:[],log_visibility:[],wasm_memory_limit:[]}]}const{canister_id:s}=await I(t||{}).provisional_create_canister_with_cycles({amount:[],settings:a(n||{}),specified_id:[],sender_canister_version:[]});return s}static async createAndInstallCanister(t,n,a){const s=await this.createCanister(a);return await this.install(Object.assign({},n),Object.assign(Object.assign({},a),{canisterId:s})),this.createActor(t,Object.assign(Object.assign({},a),{canisterId:s}))}static createActorClass(t,n){const a=t({IDL:Je});class s extends E{constructor(r){if(!r.canisterId)throw new B(`Canister ID is required, but received ${typeof r.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);const i=typeof r.canisterId=="string"?m.fromText(r.canisterId):r.canisterId;super({config:Object.assign(Object.assign(Object.assign({},ne),r),{canisterId:i}),service:a});for(const[d,l]of a._fields)n!=null&&n.httpDetails&&l.annotations.push(H),n!=null&&n.certificate&&l.annotations.push(se),this[d]=ot(this,d,l,r.blsVerify)}}return s}static createActor(t,n){if(!n.canisterId)throw new B(`Canister ID is required, but received ${typeof n.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);return new(this.createActorClass(t))(n)}static createActorWithHttpDetails(t,n){return new(this.createActorClass(t,{httpDetails:!0}))(n)}static createActorWithExtendedDetails(t,n,a={httpDetails:!0,certificate:!0}){return new(this.createActorClass(t,a))(n)}}function x(e,t){const n=Ze(e,Ie.Buffer.from(t));switch(n.length){case 0:return;case 1:return n[0];default:return n}}const ne={pollingStrategyFactory:L},H="http-details",se="certificate";function ot(e,t,n,a){let s;n.annotations.includes("query")||n.annotations.includes("composite_query")?s=async(r,...i)=>{var d,l;r=Object.assign(Object.assign({},r),(l=(d=e[h].config).queryTransform)===null||l===void 0?void 0:l.call(d,t,i,Object.assign(Object.assign({},e[h].config),r)));const _=r.agent||e[h].config.agent||Y(),N=m.from(r.canisterId||e[h].config.canisterId),f=X(n.argTypes,i),p=await _.query(N,{methodName:t,arg:f,effectiveCanisterId:r.effectiveCanisterId}),b=Object.assign(Object.assign({},p.httpDetails),{requestDetails:p.requestDetails});switch(p.status){case"rejected":throw new ct(N,t,p);case"replied":return n.annotations.includes(H)?{httpDetails:b,result:x(n.retTypes,p.reply.arg)}:x(n.retTypes,p.reply.arg)}}:s=async(r,...i)=>{var d,l;r=Object.assign(Object.assign({},r),(l=(d=e[h].config).callTransform)===null||l===void 0?void 0:l.call(d,t,i,Object.assign(Object.assign({},e[h].config),r)));const _=r.agent||e[h].config.agent||Y(),{canisterId:N,effectiveCanisterId:f,pollingStrategyFactory:p}=Object.assign(Object.assign(Object.assign({},ne),e[h].config),r),b=m.from(N),j=f!==void 0?m.from(f):b,S=X(n.argTypes,i),{requestId:V,response:u,requestDetails:o}=await _.call(b,{methodName:t,arg:S,effectiveCanisterId:j});let w,y;if(u.body&&u.body.certificate){if(_.rootKey==null)throw new Error("Agent is missing root key");const O=u.body.certificate;y=await D.create({certificate:Xe(O),rootKey:_.rootKey,canisterId:m.from(N),blsVerify:a});const g=[new TextEncoder().encode("request_status"),V];switch(new TextDecoder().decode(T(y.lookup([...g,"status"])))){case"replied":w=T(y.lookup([...g,"reply"]));break;case"rejected":{const M=new Uint8Array(T(y.lookup([...g,"reject_code"])))[0],$=new TextDecoder().decode(T(y.lookup([...g,"reject_message"]))),q=T(y.lookup([...g,"error_code"])),F=q?new TextDecoder().decode(q):void 0;throw new Z(b,t,V,u,M,$,F)}}}else if(u.body&&"reject_message"in u.body){const{reject_code:O,reject_message:g,error_code:k}=u.body;throw new Z(b,t,V,u,O,g,k)}if(u.status===202){const O=p(),g=await ee(_,j,V,O,a);y=g.certificate,w=g.reply}const R=n.annotations.includes(H),P=n.annotations.includes(se),C=Object.assign(Object.assign({},u),{requestDetails:o});if(w!==void 0)return R&&P?{httpDetails:C,certificate:y,result:x(n.retTypes,w)}:P?{certificate:y,result:x(n.retTypes,w)}:R?{httpDetails:C,result:x(n.retTypes,w)}:x(n.retTypes,w);if(n.retTypes.length===0)return R?{httpDetails:u,result:void 0}:void 0;throw new Error(`Call was returned undefined, but type [${n.retTypes.join(",")}].`)};const c=(...r)=>s({},...r);return c.withOptions=r=>(...i)=>s(r,...i),c}function I(e){function t(n,a){if(e.effectiveCanisterId)return{effectiveCanisterId:m.from(e.effectiveCanisterId)};const s=a[0];let c=m.fromHex("");return s&&typeof s=="object"&&s.target_canister&&n==="install_chunked_code"&&(c=m.from(s.target_canister)),s&&typeof s=="object"&&s.canister_id&&(c=m.from(s.canister_id)),{effectiveCanisterId:c}}return E.createActor(rt,Object.assign(Object.assign(Object.assign({},e),{canisterId:m.fromHex("")}),{callTransform:t,queryTransform:t}))}const it=({IDL:e})=>{const t=e.Int,n=e.Record({principal:e.Principal,name:e.Text}),a=e.Record({id:e.Nat,title:e.Text,content:e.Text,orgId:e.Nat,author:e.Principal,timestamp:t}),s=e.Variant({inviteMember:e.Principal,changeName:e.Text,removeMember:e.Principal,publishBlogPost:a,general:e.Null,changeQuorum:e.Nat}),c=e.Record({id:e.Nat,status:e.Text,title:e.Text,creator:e.Principal,description:e.Text,deadline:t,voters:e.Vec(e.Tuple(e.Principal,e.Bool)),proposalType:s,votes_for:e.Nat,vote_arguments:e.Vec(e.Tuple(e.Principal,e.Text)),votes_against:e.Nat}),r=e.Record({id:e.Nat,members:e.Vec(e.Principal),owner:e.Principal,name:e.Text,proposals:e.Vec(c),quorum:e.Nat}),i=e.Record({orgName:e.Text,orgId:e.Nat,invitationId:e.Text,expiration:t});return e.Service({acceptInvitation:e.Func([e.Text],[e.Text],[]),addMember:e.Func([e.Nat,e.Principal],[e.Text],[]),createBlogPostProposal:e.Func([e.Nat,e.Text,e.Text,e.Text,t],[e.Nat],[]),createInvitationProposal:e.Func([e.Nat,e.Principal,e.Text,t],[e.Nat],[]),createMemberRemovalProposal:e.Func([e.Nat,e.Principal,e.Text,t],[e.Nat],[]),createNameChangeProposal:e.Func([e.Nat,e.Text,e.Text,t],[e.Nat],[]),createOrganization:e.Func([e.Text],[e.Nat],[]),createProposal:e.Func([e.Nat,e.Text,e.Text,t],[e.Nat],[]),createQuorumChangeProposal:e.Func([e.Nat,e.Nat,e.Text,t],[e.Nat],[]),createUser:e.Func([e.Text],[n],[]),createUserForTesting:e.Func([e.Text,e.Principal],[n],[]),finalizeProposal:e.Func([e.Nat,e.Nat],[e.Text],[]),generateInvitationLink:e.Func([e.Nat,e.Nat,e.Principal],[e.Opt(e.Text)],[]),getAllOrganizations:e.Func([],[e.Vec(r)],["query"]),getBlogPost:e.Func([e.Nat,e.Nat],[e.Opt(a)],["query"]),getBlogPosts:e.Func([e.Nat],[e.Vec(a)],["query"]),getMyInvitations:e.Func([],[e.Vec(i)],["query"]),getMyOrganizations:e.Func([],[e.Vec(r)],["query"]),getOrganization:e.Func([e.Nat],[e.Opt(r)],["query"]),getUserByPrincipal:e.Func([e.Principal],[e.Opt(n)],["query"]),respondToInvitation:e.Func([e.Text,e.Bool],[e.Text],[]),voteOnProposal:e.Func([e.Nat,e.Nat,e.Bool,e.Text],[e.Text],[])})},lt="c2lt4-zmaaa-aaaaa-qaaiq-cai",_t=(e,t={})=>{const n=t.agent||new De({...t.agentOptions});return t.agent&&t.agentOptions&&console.warn("Detected both agent and agentOptions passed to createActor. Ignoring agentOptions and proceeding with the provided agent."),n.fetchRootKey().catch(a=>{console.warn("Unable to fetch root key. Check to ensure that your local replica is running"),console.error(a)}),E.createActor(it,{agent:n,canisterId:e,...t.actorOptions})};_t(lt);export{E as A,lt as c,it as i};
