var zu=Object.defineProperty;var Wu=(t,e,r)=>e in t?zu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var wo=(t,e,r)=>(Wu(t,typeof e!="symbol"?e+"":e,r),r),mo=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)};var bo=(t,e,r)=>(mo(t,e,"read from private field"),r?r.call(t):e.get(t)),Qi=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)};var es=(t,e,r)=>(mo(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const f of s.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&n(f)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var ts;const _i=window,Zr=_i.trustedTypes,_o=Zr?Zr.createPolicy("lit-html",{createHTML:t=>t}):void 0,Ss="$lit$",ir=`lit$${(Math.random()+"").slice(9)}$`,va="?"+ir,Yu=`<${va}>`,vr=document,wn=()=>vr.createComment(""),mn=t=>t===null||typeof t!="object"&&typeof t!="function",Aa=Array.isArray,Zu=t=>Aa(t)||typeof(t==null?void 0:t[Symbol.iterator])=="function",rs=`[ 	
\f\r]`,nn=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,xo=/-->/g,Eo=/>/g,dr=RegExp(`>|${rs}(?:([^\\s"'>=/]+)(${rs}*=${rs}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),vo=/'/g,Ao=/"/g,Ba=/^(?:script|style|textarea|title)$/i,Lu=t=>(e,...r)=>({_$litType$:t,strings:e,values:r}),Du=Lu(1),bn=Symbol.for("lit-noChange"),Xe=Symbol.for("lit-nothing"),Bo=new WeakMap,xr=vr.createTreeWalker(vr,129,null,!1);function Ta(t,e){if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return _o!==void 0?_o.createHTML(e):e}const Xu=(t,e)=>{const r=t.length-1,n=[];let i,s=e===2?"<svg>":"",f=nn;for(let a=0;a<r;a++){const d=t[a];let g,E,A=-1,S=0;for(;S<d.length&&(f.lastIndex=S,E=f.exec(d),E!==null);)S=f.lastIndex,f===nn?E[1]==="!--"?f=xo:E[1]!==void 0?f=Eo:E[2]!==void 0?(Ba.test(E[2])&&(i=RegExp("</"+E[2],"g")),f=dr):E[3]!==void 0&&(f=dr):f===dr?E[0]===">"?(f=i??nn,A=-1):E[1]===void 0?A=-2:(A=f.lastIndex-E[2].length,g=E[1],f=E[3]===void 0?dr:E[3]==='"'?Ao:vo):f===Ao||f===vo?f=dr:f===xo||f===Eo?f=nn:(f=dr,i=void 0);const B=f===dr&&t[a+1].startsWith("/>")?" ":"";s+=f===nn?d+Yu:A>=0?(n.push(g),d.slice(0,A)+Ss+d.slice(A)+ir+B):d+ir+(A===-2?(n.push(void 0),a):B)}return[Ta(t,s+(t[r]||"<?>")+(e===2?"</svg>":"")),n]};class _n{constructor({strings:e,_$litType$:r},n){let i;this.parts=[];let s=0,f=0;const a=e.length-1,d=this.parts,[g,E]=Xu(e,r);if(this.el=_n.createElement(g,n),xr.currentNode=this.el.content,r===2){const A=this.el.content,S=A.firstChild;S.remove(),A.append(...S.childNodes)}for(;(i=xr.nextNode())!==null&&d.length<a;){if(i.nodeType===1){if(i.hasAttributes()){const A=[];for(const S of i.getAttributeNames())if(S.endsWith(Ss)||S.startsWith(ir)){const B=E[f++];if(A.push(S),B!==void 0){const w=i.getAttribute(B.toLowerCase()+Ss).split(ir),M=/([.?@])?(.*)/.exec(B);d.push({type:1,index:s,name:M[2],strings:w,ctor:M[1]==="."?Qu:M[1]==="?"?tf:M[1]==="@"?rf:ki})}else d.push({type:6,index:s})}for(const S of A)i.removeAttribute(S)}if(Ba.test(i.tagName)){const A=i.textContent.split(ir),S=A.length-1;if(S>0){i.textContent=Zr?Zr.emptyScript:"";for(let B=0;B<S;B++)i.append(A[B],wn()),xr.nextNode(),d.push({type:2,index:++s});i.append(A[S],wn())}}}else if(i.nodeType===8)if(i.data===va)d.push({type:2,index:s});else{let A=-1;for(;(A=i.data.indexOf(ir,A+1))!==-1;)d.push({type:7,index:s}),A+=ir.length-1}s++}}static createElement(e,r){const n=vr.createElement("template");return n.innerHTML=e,n}}function Lr(t,e,r=t,n){var i,s,f,a;if(e===bn)return e;let d=n!==void 0?(i=r._$Co)===null||i===void 0?void 0:i[n]:r._$Cl;const g=mn(e)?void 0:e._$litDirective$;return(d==null?void 0:d.constructor)!==g&&((s=d==null?void 0:d._$AO)===null||s===void 0||s.call(d,!1),g===void 0?d=void 0:(d=new g(t),d._$AT(t,r,n)),n!==void 0?((f=(a=r)._$Co)!==null&&f!==void 0?f:a._$Co=[])[n]=d:r._$Cl=d),d!==void 0&&(e=Lr(t,d._$AS(t,e.values),d,n)),e}class Ju{constructor(e,r){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=r}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){var r;const{el:{content:n},parts:i}=this._$AD,s=((r=e==null?void 0:e.creationScope)!==null&&r!==void 0?r:vr).importNode(n,!0);xr.currentNode=s;let f=xr.nextNode(),a=0,d=0,g=i[0];for(;g!==void 0;){if(a===g.index){let E;g.type===2?E=new Sn(f,f.nextSibling,this,e):g.type===1?E=new g.ctor(f,g.name,g.strings,this,e):g.type===6&&(E=new nf(f,this,e)),this._$AV.push(E),g=i[++d]}a!==(g==null?void 0:g.index)&&(f=xr.nextNode(),a++)}return xr.currentNode=vr,s}v(e){let r=0;for(const n of this._$AV)n!==void 0&&(n.strings!==void 0?(n._$AI(e,n,r),r+=n.strings.length-2):n._$AI(e[r])),r++}}class Sn{constructor(e,r,n,i){var s;this.type=2,this._$AH=Xe,this._$AN=void 0,this._$AA=e,this._$AB=r,this._$AM=n,this.options=i,this._$Cp=(s=i==null?void 0:i.isConnected)===null||s===void 0||s}get _$AU(){var e,r;return(r=(e=this._$AM)===null||e===void 0?void 0:e._$AU)!==null&&r!==void 0?r:this._$Cp}get parentNode(){let e=this._$AA.parentNode;const r=this._$AM;return r!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=r.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,r=this){e=Lr(this,e,r),mn(e)?e===Xe||e==null||e===""?(this._$AH!==Xe&&this._$AR(),this._$AH=Xe):e!==this._$AH&&e!==bn&&this._(e):e._$litType$!==void 0?this.g(e):e.nodeType!==void 0?this.$(e):Zu(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==Xe&&mn(this._$AH)?this._$AA.nextSibling.data=e:this.$(vr.createTextNode(e)),this._$AH=e}g(e){var r;const{values:n,_$litType$:i}=e,s=typeof i=="number"?this._$AC(e):(i.el===void 0&&(i.el=_n.createElement(Ta(i.h,i.h[0]),this.options)),i);if(((r=this._$AH)===null||r===void 0?void 0:r._$AD)===s)this._$AH.v(n);else{const f=new Ju(s,this),a=f.u(this.options);f.v(n),this.$(a),this._$AH=f}}_$AC(e){let r=Bo.get(e.strings);return r===void 0&&Bo.set(e.strings,r=new _n(e)),r}T(e){Aa(this._$AH)||(this._$AH=[],this._$AR());const r=this._$AH;let n,i=0;for(const s of e)i===r.length?r.push(n=new Sn(this.k(wn()),this.k(wn()),this,this.options)):n=r[i],n._$AI(s),i++;i<r.length&&(this._$AR(n&&n._$AB.nextSibling,i),r.length=i)}_$AR(e=this._$AA.nextSibling,r){var n;for((n=this._$AP)===null||n===void 0||n.call(this,!1,!0,r);e&&e!==this._$AB;){const i=e.nextSibling;e.remove(),e=i}}setConnected(e){var r;this._$AM===void 0&&(this._$Cp=e,(r=this._$AP)===null||r===void 0||r.call(this,e))}}class ki{constructor(e,r,n,i,s){this.type=1,this._$AH=Xe,this._$AN=void 0,this.element=e,this.name=r,this._$AM=i,this.options=s,n.length>2||n[0]!==""||n[1]!==""?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=Xe}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,r=this,n,i){const s=this.strings;let f=!1;if(s===void 0)e=Lr(this,e,r,0),f=!mn(e)||e!==this._$AH&&e!==bn,f&&(this._$AH=e);else{const a=e;let d,g;for(e=s[0],d=0;d<s.length-1;d++)g=Lr(this,a[n+d],r,d),g===bn&&(g=this._$AH[d]),f||(f=!mn(g)||g!==this._$AH[d]),g===Xe?e=Xe:e!==Xe&&(e+=(g??"")+s[d+1]),this._$AH[d]=g}f&&!i&&this.j(e)}j(e){e===Xe?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class Qu extends ki{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Xe?void 0:e}}const ef=Zr?Zr.emptyScript:"";class tf extends ki{constructor(){super(...arguments),this.type=4}j(e){e&&e!==Xe?this.element.setAttribute(this.name,ef):this.element.removeAttribute(this.name)}}class rf extends ki{constructor(e,r,n,i,s){super(e,r,n,i,s),this.type=5}_$AI(e,r=this){var n;if((e=(n=Lr(this,e,r,0))!==null&&n!==void 0?n:Xe)===bn)return;const i=this._$AH,s=e===Xe&&i!==Xe||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,f=e!==Xe&&(i===Xe||s);s&&this.element.removeEventListener(this.name,this,i),f&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var r,n;typeof this._$AH=="function"?this._$AH.call((n=(r=this.options)===null||r===void 0?void 0:r.host)!==null&&n!==void 0?n:this.element,e):this._$AH.handleEvent(e)}}class nf{constructor(e,r,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=r,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){Lr(this,e)}}const To=_i.litHtmlPolyfillSupport;To==null||To(_n,Sn),((ts=_i.litHtmlVersions)!==null&&ts!==void 0?ts:_i.litHtmlVersions=[]).push("2.8.0");const sf=(t,e,r)=>{var n,i;const s=(n=r==null?void 0:r.renderBefore)!==null&&n!==void 0?n:e;let f=s._$litPart$;if(f===void 0){const a=(i=r==null?void 0:r.renderBefore)!==null&&i!==void 0?i:null;s._$litPart$=f=new Sn(e.insertBefore(wn(),a),a,void 0,r??{})}return f._$AI(t),f};var Dr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function of(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Sa={},Nn={};Nn.byteLength=uf;Nn.toByteArray=lf;Nn.fromByteArray=pf;var Ft=[],ht=[],af=typeof Uint8Array<"u"?Uint8Array:Array,ns="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Rr=0,cf=ns.length;Rr<cf;++Rr)Ft[Rr]=ns[Rr],ht[ns.charCodeAt(Rr)]=Rr;ht["-".charCodeAt(0)]=62;ht["_".charCodeAt(0)]=63;function Na(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function uf(t){var e=Na(t),r=e[0],n=e[1];return(r+n)*3/4-n}function ff(t,e,r){return(e+r)*3/4-r}function lf(t){var e,r=Na(t),n=r[0],i=r[1],s=new af(ff(t,n,i)),f=0,a=i>0?n-4:n,d;for(d=0;d<a;d+=4)e=ht[t.charCodeAt(d)]<<18|ht[t.charCodeAt(d+1)]<<12|ht[t.charCodeAt(d+2)]<<6|ht[t.charCodeAt(d+3)],s[f++]=e>>16&255,s[f++]=e>>8&255,s[f++]=e&255;return i===2&&(e=ht[t.charCodeAt(d)]<<2|ht[t.charCodeAt(d+1)]>>4,s[f++]=e&255),i===1&&(e=ht[t.charCodeAt(d)]<<10|ht[t.charCodeAt(d+1)]<<4|ht[t.charCodeAt(d+2)]>>2,s[f++]=e>>8&255,s[f++]=e&255),s}function hf(t){return Ft[t>>18&63]+Ft[t>>12&63]+Ft[t>>6&63]+Ft[t&63]}function df(t,e,r){for(var n,i=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),i.push(hf(n));return i.join("")}function pf(t){for(var e,r=t.length,n=r%3,i=[],s=16383,f=0,a=r-n;f<a;f+=s)i.push(df(t,f,f+s>a?a:f+s));return n===1?(e=t[r-1],i.push(Ft[e>>2]+Ft[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(Ft[e>>10]+Ft[e>>4&63]+Ft[e<<2&63]+"=")),i.join("")}var In={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */In.read=function(t,e,r,n,i){var s,f,a=i*8-n-1,d=(1<<a)-1,g=d>>1,E=-7,A=r?i-1:0,S=r?-1:1,B=t[e+A];for(A+=S,s=B&(1<<-E)-1,B>>=-E,E+=a;E>0;s=s*256+t[e+A],A+=S,E-=8);for(f=s&(1<<-E)-1,s>>=-E,E+=n;E>0;f=f*256+t[e+A],A+=S,E-=8);if(s===0)s=1-g;else{if(s===d)return f?NaN:(B?-1:1)*(1/0);f=f+Math.pow(2,n),s=s-g}return(B?-1:1)*f*Math.pow(2,s-n)};In.write=function(t,e,r,n,i,s){var f,a,d,g=s*8-i-1,E=(1<<g)-1,A=E>>1,S=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,B=n?0:s-1,w=n?1:-1,M=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,f=E):(f=Math.floor(Math.log(e)/Math.LN2),e*(d=Math.pow(2,-f))<1&&(f--,d*=2),f+A>=1?e+=S/d:e+=S*Math.pow(2,1-A),e*d>=2&&(f++,d/=2),f+A>=E?(a=0,f=E):f+A>=1?(a=(e*d-1)*Math.pow(2,i),f=f+A):(a=e*Math.pow(2,A-1)*Math.pow(2,i),f=0));i>=8;t[r+B]=a&255,B+=w,a/=256,i-=8);for(f=f<<i|a,g+=i;g>0;t[r+B]=f&255,B+=w,f/=256,g-=8);t[r+B-w]|=M*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=Nn,r=In,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=z,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=s(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const p=new Uint8Array(1),u={foo:function(){return 42}};return Object.setPrototypeOf(u,Uint8Array.prototype),Object.setPrototypeOf(p,u),p.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function f(p){if(p>i)throw new RangeError('The value "'+p+'" is invalid for option "size"');const u=new Uint8Array(p);return Object.setPrototypeOf(u,a.prototype),u}function a(p,u,l){if(typeof p=="number"){if(typeof u=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return A(p)}return d(p,u,l)}a.poolSize=8192;function d(p,u,l){if(typeof p=="string")return S(p,u);if(ArrayBuffer.isView(p))return w(p);if(p==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p);if(V(p,ArrayBuffer)||p&&V(p.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(V(p,SharedArrayBuffer)||p&&V(p.buffer,SharedArrayBuffer)))return M(p,u,l);if(typeof p=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const v=p.valueOf&&p.valueOf();if(v!=null&&v!==p)return a.from(v,u,l);const F=C(p);if(F)return F;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof p[Symbol.toPrimitive]=="function")return a.from(p[Symbol.toPrimitive]("string"),u,l);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p)}a.from=function(p,u,l){return d(p,u,l)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function g(p){if(typeof p!="number")throw new TypeError('"size" argument must be of type number');if(p<0)throw new RangeError('The value "'+p+'" is invalid for option "size"')}function E(p,u,l){return g(p),p<=0?f(p):u!==void 0?typeof l=="string"?f(p).fill(u,l):f(p).fill(u):f(p)}a.alloc=function(p,u,l){return E(p,u,l)};function A(p){return g(p),f(p<0?0:Y(p)|0)}a.allocUnsafe=function(p){return A(p)},a.allocUnsafeSlow=function(p){return A(p)};function S(p,u){if((typeof u!="string"||u==="")&&(u="utf8"),!a.isEncoding(u))throw new TypeError("Unknown encoding: "+u);const l=q(p,u)|0;let v=f(l);const F=v.write(p,u);return F!==l&&(v=v.slice(0,F)),v}function B(p){const u=p.length<0?0:Y(p.length)|0,l=f(u);for(let v=0;v<u;v+=1)l[v]=p[v]&255;return l}function w(p){if(V(p,Uint8Array)){const u=new Uint8Array(p);return M(u.buffer,u.byteOffset,u.byteLength)}return B(p)}function M(p,u,l){if(u<0||p.byteLength<u)throw new RangeError('"offset" is outside of buffer bounds');if(p.byteLength<u+(l||0))throw new RangeError('"length" is outside of buffer bounds');let v;return u===void 0&&l===void 0?v=new Uint8Array(p):l===void 0?v=new Uint8Array(p,u):v=new Uint8Array(p,u,l),Object.setPrototypeOf(v,a.prototype),v}function C(p){if(a.isBuffer(p)){const u=Y(p.length)|0,l=f(u);return l.length===0||p.copy(l,0,0,u),l}if(p.length!==void 0)return typeof p.length!="number"||ne(p.length)?f(0):B(p);if(p.type==="Buffer"&&Array.isArray(p.data))return B(p.data)}function Y(p){if(p>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return p|0}function z(p){return+p!=p&&(p=0),a.alloc(+p)}a.isBuffer=function(u){return u!=null&&u._isBuffer===!0&&u!==a.prototype},a.compare=function(u,l){if(V(u,Uint8Array)&&(u=a.from(u,u.offset,u.byteLength)),V(l,Uint8Array)&&(l=a.from(l,l.offset,l.byteLength)),!a.isBuffer(u)||!a.isBuffer(l))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(u===l)return 0;let v=u.length,F=l.length;for(let K=0,j=Math.min(v,F);K<j;++K)if(u[K]!==l[K]){v=u[K],F=l[K];break}return v<F?-1:F<v?1:0},a.isEncoding=function(u){switch(String(u).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(u,l){if(!Array.isArray(u))throw new TypeError('"list" argument must be an Array of Buffers');if(u.length===0)return a.alloc(0);let v;if(l===void 0)for(l=0,v=0;v<u.length;++v)l+=u[v].length;const F=a.allocUnsafe(l);let K=0;for(v=0;v<u.length;++v){let j=u[v];if(V(j,Uint8Array))K+j.length>F.length?(a.isBuffer(j)||(j=a.from(j)),j.copy(F,K)):Uint8Array.prototype.set.call(F,j,K);else if(a.isBuffer(j))j.copy(F,K);else throw new TypeError('"list" argument must be an Array of Buffers');K+=j.length}return F};function q(p,u){if(a.isBuffer(p))return p.length;if(ArrayBuffer.isView(p)||V(p,ArrayBuffer))return p.byteLength;if(typeof p!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof p);const l=p.length,v=arguments.length>2&&arguments[2]===!0;if(!v&&l===0)return 0;let F=!1;for(;;)switch(u){case"ascii":case"latin1":case"binary":return l;case"utf8":case"utf-8":return o(p).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return l*2;case"hex":return l>>>1;case"base64":return _(p).length;default:if(F)return v?-1:o(p).length;u=(""+u).toLowerCase(),F=!0}}a.byteLength=q;function re(p,u,l){let v=!1;if((u===void 0||u<0)&&(u=0),u>this.length||((l===void 0||l>this.length)&&(l=this.length),l<=0)||(l>>>=0,u>>>=0,l<=u))return"";for(p||(p="utf8");;)switch(p){case"hex":return ie(this,u,l);case"utf8":case"utf-8":return U(this,u,l);case"ascii":return H(this,u,l);case"latin1":case"binary":return D(this,u,l);case"base64":return I(this,u,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return we(this,u,l);default:if(v)throw new TypeError("Unknown encoding: "+p);p=(p+"").toLowerCase(),v=!0}}a.prototype._isBuffer=!0;function P(p,u,l){const v=p[u];p[u]=p[l],p[l]=v}a.prototype.swap16=function(){const u=this.length;if(u%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let l=0;l<u;l+=2)P(this,l,l+1);return this},a.prototype.swap32=function(){const u=this.length;if(u%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let l=0;l<u;l+=4)P(this,l,l+3),P(this,l+1,l+2);return this},a.prototype.swap64=function(){const u=this.length;if(u%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let l=0;l<u;l+=8)P(this,l,l+7),P(this,l+1,l+6),P(this,l+2,l+5),P(this,l+3,l+4);return this},a.prototype.toString=function(){const u=this.length;return u===0?"":arguments.length===0?U(this,0,u):re.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(u){if(!a.isBuffer(u))throw new TypeError("Argument must be a Buffer");return this===u?!0:a.compare(this,u)===0},a.prototype.inspect=function(){let u="";const l=t.INSPECT_MAX_BYTES;return u=this.toString("hex",0,l).replace(/(.{2})/g,"$1 ").trim(),this.length>l&&(u+=" ... "),"<Buffer "+u+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(u,l,v,F,K){if(V(u,Uint8Array)&&(u=a.from(u,u.offset,u.byteLength)),!a.isBuffer(u))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof u);if(l===void 0&&(l=0),v===void 0&&(v=u?u.length:0),F===void 0&&(F=0),K===void 0&&(K=this.length),l<0||v>u.length||F<0||K>this.length)throw new RangeError("out of range index");if(F>=K&&l>=v)return 0;if(F>=K)return-1;if(l>=v)return 1;if(l>>>=0,v>>>=0,F>>>=0,K>>>=0,this===u)return 0;let j=K-F,_e=v-l;const Be=Math.min(j,_e),Ee=this.slice(F,K),be=u.slice(l,v);for(let Re=0;Re<Be;++Re)if(Ee[Re]!==be[Re]){j=Ee[Re],_e=be[Re];break}return j<_e?-1:_e<j?1:0};function L(p,u,l,v,F){if(p.length===0)return-1;if(typeof l=="string"?(v=l,l=0):l>2147483647?l=2147483647:l<-2147483648&&(l=-2147483648),l=+l,ne(l)&&(l=F?0:p.length-1),l<0&&(l=p.length+l),l>=p.length){if(F)return-1;l=p.length-1}else if(l<0)if(F)l=0;else return-1;if(typeof u=="string"&&(u=a.from(u,v)),a.isBuffer(u))return u.length===0?-1:Z(p,u,l,v,F);if(typeof u=="number")return u=u&255,typeof Uint8Array.prototype.indexOf=="function"?F?Uint8Array.prototype.indexOf.call(p,u,l):Uint8Array.prototype.lastIndexOf.call(p,u,l):Z(p,[u],l,v,F);throw new TypeError("val must be string, number or Buffer")}function Z(p,u,l,v,F){let K=1,j=p.length,_e=u.length;if(v!==void 0&&(v=String(v).toLowerCase(),v==="ucs2"||v==="ucs-2"||v==="utf16le"||v==="utf-16le")){if(p.length<2||u.length<2)return-1;K=2,j/=2,_e/=2,l/=2}function Be(be,Re){return K===1?be[Re]:be.readUInt16BE(Re*K)}let Ee;if(F){let be=-1;for(Ee=l;Ee<j;Ee++)if(Be(p,Ee)===Be(u,be===-1?0:Ee-be)){if(be===-1&&(be=Ee),Ee-be+1===_e)return be*K}else be!==-1&&(Ee-=Ee-be),be=-1}else for(l+_e>j&&(l=j-_e),Ee=l;Ee>=0;Ee--){let be=!0;for(let Re=0;Re<_e;Re++)if(Be(p,Ee+Re)!==Be(u,Re)){be=!1;break}if(be)return Ee}return-1}a.prototype.includes=function(u,l,v){return this.indexOf(u,l,v)!==-1},a.prototype.indexOf=function(u,l,v){return L(this,u,l,v,!0)},a.prototype.lastIndexOf=function(u,l,v){return L(this,u,l,v,!1)};function J(p,u,l,v){l=Number(l)||0;const F=p.length-l;v?(v=Number(v),v>F&&(v=F)):v=F;const K=u.length;v>K/2&&(v=K/2);let j;for(j=0;j<v;++j){const _e=parseInt(u.substr(j*2,2),16);if(ne(_e))return j;p[l+j]=_e}return j}function Q(p,u,l,v){return N(o(u,p.length-l),p,l,v)}function X(p,u,l,v){return N(c(u),p,l,v)}function he(p,u,l,v){return N(_(u),p,l,v)}function le(p,u,l,v){return N(y(u,p.length-l),p,l,v)}a.prototype.write=function(u,l,v,F){if(l===void 0)F="utf8",v=this.length,l=0;else if(v===void 0&&typeof l=="string")F=l,v=this.length,l=0;else if(isFinite(l))l=l>>>0,isFinite(v)?(v=v>>>0,F===void 0&&(F="utf8")):(F=v,v=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const K=this.length-l;if((v===void 0||v>K)&&(v=K),u.length>0&&(v<0||l<0)||l>this.length)throw new RangeError("Attempt to write outside buffer bounds");F||(F="utf8");let j=!1;for(;;)switch(F){case"hex":return J(this,u,l,v);case"utf8":case"utf-8":return Q(this,u,l,v);case"ascii":case"latin1":case"binary":return X(this,u,l,v);case"base64":return he(this,u,l,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return le(this,u,l,v);default:if(j)throw new TypeError("Unknown encoding: "+F);F=(""+F).toLowerCase(),j=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(p,u,l){return u===0&&l===p.length?e.fromByteArray(p):e.fromByteArray(p.slice(u,l))}function U(p,u,l){l=Math.min(p.length,l);const v=[];let F=u;for(;F<l;){const K=p[F];let j=null,_e=K>239?4:K>223?3:K>191?2:1;if(F+_e<=l){let Be,Ee,be,Re;switch(_e){case 1:K<128&&(j=K);break;case 2:Be=p[F+1],(Be&192)===128&&(Re=(K&31)<<6|Be&63,Re>127&&(j=Re));break;case 3:Be=p[F+1],Ee=p[F+2],(Be&192)===128&&(Ee&192)===128&&(Re=(K&15)<<12|(Be&63)<<6|Ee&63,Re>2047&&(Re<55296||Re>57343)&&(j=Re));break;case 4:Be=p[F+1],Ee=p[F+2],be=p[F+3],(Be&192)===128&&(Ee&192)===128&&(be&192)===128&&(Re=(K&15)<<18|(Be&63)<<12|(Ee&63)<<6|be&63,Re>65535&&Re<1114112&&(j=Re))}}j===null?(j=65533,_e=1):j>65535&&(j-=65536,v.push(j>>>10&1023|55296),j=56320|j&1023),v.push(j),F+=_e}return G(v)}const W=4096;function G(p){const u=p.length;if(u<=W)return String.fromCharCode.apply(String,p);let l="",v=0;for(;v<u;)l+=String.fromCharCode.apply(String,p.slice(v,v+=W));return l}function H(p,u,l){let v="";l=Math.min(p.length,l);for(let F=u;F<l;++F)v+=String.fromCharCode(p[F]&127);return v}function D(p,u,l){let v="";l=Math.min(p.length,l);for(let F=u;F<l;++F)v+=String.fromCharCode(p[F]);return v}function ie(p,u,l){const v=p.length;(!u||u<0)&&(u=0),(!l||l<0||l>v)&&(l=v);let F="";for(let K=u;K<l;++K)F+=pe[p[K]];return F}function we(p,u,l){const v=p.slice(u,l);let F="";for(let K=0;K<v.length-1;K+=2)F+=String.fromCharCode(v[K]+v[K+1]*256);return F}a.prototype.slice=function(u,l){const v=this.length;u=~~u,l=l===void 0?v:~~l,u<0?(u+=v,u<0&&(u=0)):u>v&&(u=v),l<0?(l+=v,l<0&&(l=0)):l>v&&(l=v),l<u&&(l=u);const F=this.subarray(u,l);return Object.setPrototypeOf(F,a.prototype),F};function oe(p,u,l){if(p%1!==0||p<0)throw new RangeError("offset is not uint");if(p+u>l)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(u,l,v){u=u>>>0,l=l>>>0,v||oe(u,l,this.length);let F=this[u],K=1,j=0;for(;++j<l&&(K*=256);)F+=this[u+j]*K;return F},a.prototype.readUintBE=a.prototype.readUIntBE=function(u,l,v){u=u>>>0,l=l>>>0,v||oe(u,l,this.length);let F=this[u+--l],K=1;for(;l>0&&(K*=256);)F+=this[u+--l]*K;return F},a.prototype.readUint8=a.prototype.readUInt8=function(u,l){return u=u>>>0,l||oe(u,1,this.length),this[u]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(u,l){return u=u>>>0,l||oe(u,2,this.length),this[u]|this[u+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(u,l){return u=u>>>0,l||oe(u,2,this.length),this[u]<<8|this[u+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(u,l){return u=u>>>0,l||oe(u,4,this.length),(this[u]|this[u+1]<<8|this[u+2]<<16)+this[u+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(u,l){return u=u>>>0,l||oe(u,4,this.length),this[u]*16777216+(this[u+1]<<16|this[u+2]<<8|this[u+3])},a.prototype.readBigUInt64LE=ye(function(u){u=u>>>0,$(u,"offset");const l=this[u],v=this[u+7];(l===void 0||v===void 0)&&O(u,this.length-8);const F=l+this[++u]*2**8+this[++u]*2**16+this[++u]*2**24,K=this[++u]+this[++u]*2**8+this[++u]*2**16+v*2**24;return BigInt(F)+(BigInt(K)<<BigInt(32))}),a.prototype.readBigUInt64BE=ye(function(u){u=u>>>0,$(u,"offset");const l=this[u],v=this[u+7];(l===void 0||v===void 0)&&O(u,this.length-8);const F=l*2**24+this[++u]*2**16+this[++u]*2**8+this[++u],K=this[++u]*2**24+this[++u]*2**16+this[++u]*2**8+v;return(BigInt(F)<<BigInt(32))+BigInt(K)}),a.prototype.readIntLE=function(u,l,v){u=u>>>0,l=l>>>0,v||oe(u,l,this.length);let F=this[u],K=1,j=0;for(;++j<l&&(K*=256);)F+=this[u+j]*K;return K*=128,F>=K&&(F-=Math.pow(2,8*l)),F},a.prototype.readIntBE=function(u,l,v){u=u>>>0,l=l>>>0,v||oe(u,l,this.length);let F=l,K=1,j=this[u+--F];for(;F>0&&(K*=256);)j+=this[u+--F]*K;return K*=128,j>=K&&(j-=Math.pow(2,8*l)),j},a.prototype.readInt8=function(u,l){return u=u>>>0,l||oe(u,1,this.length),this[u]&128?(255-this[u]+1)*-1:this[u]},a.prototype.readInt16LE=function(u,l){u=u>>>0,l||oe(u,2,this.length);const v=this[u]|this[u+1]<<8;return v&32768?v|4294901760:v},a.prototype.readInt16BE=function(u,l){u=u>>>0,l||oe(u,2,this.length);const v=this[u+1]|this[u]<<8;return v&32768?v|4294901760:v},a.prototype.readInt32LE=function(u,l){return u=u>>>0,l||oe(u,4,this.length),this[u]|this[u+1]<<8|this[u+2]<<16|this[u+3]<<24},a.prototype.readInt32BE=function(u,l){return u=u>>>0,l||oe(u,4,this.length),this[u]<<24|this[u+1]<<16|this[u+2]<<8|this[u+3]},a.prototype.readBigInt64LE=ye(function(u){u=u>>>0,$(u,"offset");const l=this[u],v=this[u+7];(l===void 0||v===void 0)&&O(u,this.length-8);const F=this[u+4]+this[u+5]*2**8+this[u+6]*2**16+(v<<24);return(BigInt(F)<<BigInt(32))+BigInt(l+this[++u]*2**8+this[++u]*2**16+this[++u]*2**24)}),a.prototype.readBigInt64BE=ye(function(u){u=u>>>0,$(u,"offset");const l=this[u],v=this[u+7];(l===void 0||v===void 0)&&O(u,this.length-8);const F=(l<<24)+this[++u]*2**16+this[++u]*2**8+this[++u];return(BigInt(F)<<BigInt(32))+BigInt(this[++u]*2**24+this[++u]*2**16+this[++u]*2**8+v)}),a.prototype.readFloatLE=function(u,l){return u=u>>>0,l||oe(u,4,this.length),r.read(this,u,!0,23,4)},a.prototype.readFloatBE=function(u,l){return u=u>>>0,l||oe(u,4,this.length),r.read(this,u,!1,23,4)},a.prototype.readDoubleLE=function(u,l){return u=u>>>0,l||oe(u,8,this.length),r.read(this,u,!0,52,8)},a.prototype.readDoubleBE=function(u,l){return u=u>>>0,l||oe(u,8,this.length),r.read(this,u,!1,52,8)};function fe(p,u,l,v,F,K){if(!a.isBuffer(p))throw new TypeError('"buffer" argument must be a Buffer instance');if(u>F||u<K)throw new RangeError('"value" argument is out of bounds');if(l+v>p.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(u,l,v,F){if(u=+u,l=l>>>0,v=v>>>0,!F){const _e=Math.pow(2,8*v)-1;fe(this,u,l,v,_e,0)}let K=1,j=0;for(this[l]=u&255;++j<v&&(K*=256);)this[l+j]=u/K&255;return l+v},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(u,l,v,F){if(u=+u,l=l>>>0,v=v>>>0,!F){const _e=Math.pow(2,8*v)-1;fe(this,u,l,v,_e,0)}let K=v-1,j=1;for(this[l+K]=u&255;--K>=0&&(j*=256);)this[l+K]=u/j&255;return l+v},a.prototype.writeUint8=a.prototype.writeUInt8=function(u,l,v){return u=+u,l=l>>>0,v||fe(this,u,l,1,255,0),this[l]=u&255,l+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(u,l,v){return u=+u,l=l>>>0,v||fe(this,u,l,2,65535,0),this[l]=u&255,this[l+1]=u>>>8,l+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(u,l,v){return u=+u,l=l>>>0,v||fe(this,u,l,2,65535,0),this[l]=u>>>8,this[l+1]=u&255,l+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(u,l,v){return u=+u,l=l>>>0,v||fe(this,u,l,4,4294967295,0),this[l+3]=u>>>24,this[l+2]=u>>>16,this[l+1]=u>>>8,this[l]=u&255,l+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(u,l,v){return u=+u,l=l>>>0,v||fe(this,u,l,4,4294967295,0),this[l]=u>>>24,this[l+1]=u>>>16,this[l+2]=u>>>8,this[l+3]=u&255,l+4};function ee(p,u,l,v,F){T(u,v,F,p,l,7);let K=Number(u&BigInt(4294967295));p[l++]=K,K=K>>8,p[l++]=K,K=K>>8,p[l++]=K,K=K>>8,p[l++]=K;let j=Number(u>>BigInt(32)&BigInt(4294967295));return p[l++]=j,j=j>>8,p[l++]=j,j=j>>8,p[l++]=j,j=j>>8,p[l++]=j,l}function m(p,u,l,v,F){T(u,v,F,p,l,7);let K=Number(u&BigInt(4294967295));p[l+7]=K,K=K>>8,p[l+6]=K,K=K>>8,p[l+5]=K,K=K>>8,p[l+4]=K;let j=Number(u>>BigInt(32)&BigInt(4294967295));return p[l+3]=j,j=j>>8,p[l+2]=j,j=j>>8,p[l+1]=j,j=j>>8,p[l]=j,l+8}a.prototype.writeBigUInt64LE=ye(function(u,l=0){return ee(this,u,l,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=ye(function(u,l=0){return m(this,u,l,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(u,l,v,F){if(u=+u,l=l>>>0,!F){const Be=Math.pow(2,8*v-1);fe(this,u,l,v,Be-1,-Be)}let K=0,j=1,_e=0;for(this[l]=u&255;++K<v&&(j*=256);)u<0&&_e===0&&this[l+K-1]!==0&&(_e=1),this[l+K]=(u/j>>0)-_e&255;return l+v},a.prototype.writeIntBE=function(u,l,v,F){if(u=+u,l=l>>>0,!F){const Be=Math.pow(2,8*v-1);fe(this,u,l,v,Be-1,-Be)}let K=v-1,j=1,_e=0;for(this[l+K]=u&255;--K>=0&&(j*=256);)u<0&&_e===0&&this[l+K+1]!==0&&(_e=1),this[l+K]=(u/j>>0)-_e&255;return l+v},a.prototype.writeInt8=function(u,l,v){return u=+u,l=l>>>0,v||fe(this,u,l,1,127,-128),u<0&&(u=255+u+1),this[l]=u&255,l+1},a.prototype.writeInt16LE=function(u,l,v){return u=+u,l=l>>>0,v||fe(this,u,l,2,32767,-32768),this[l]=u&255,this[l+1]=u>>>8,l+2},a.prototype.writeInt16BE=function(u,l,v){return u=+u,l=l>>>0,v||fe(this,u,l,2,32767,-32768),this[l]=u>>>8,this[l+1]=u&255,l+2},a.prototype.writeInt32LE=function(u,l,v){return u=+u,l=l>>>0,v||fe(this,u,l,4,2147483647,-2147483648),this[l]=u&255,this[l+1]=u>>>8,this[l+2]=u>>>16,this[l+3]=u>>>24,l+4},a.prototype.writeInt32BE=function(u,l,v){return u=+u,l=l>>>0,v||fe(this,u,l,4,2147483647,-2147483648),u<0&&(u=4294967295+u+1),this[l]=u>>>24,this[l+1]=u>>>16,this[l+2]=u>>>8,this[l+3]=u&255,l+4},a.prototype.writeBigInt64LE=ye(function(u,l=0){return ee(this,u,l,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=ye(function(u,l=0){return m(this,u,l,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function se(p,u,l,v,F,K){if(l+v>p.length)throw new RangeError("Index out of range");if(l<0)throw new RangeError("Index out of range")}function ue(p,u,l,v,F){return u=+u,l=l>>>0,F||se(p,u,l,4),r.write(p,u,l,v,23,4),l+4}a.prototype.writeFloatLE=function(u,l,v){return ue(this,u,l,!0,v)},a.prototype.writeFloatBE=function(u,l,v){return ue(this,u,l,!1,v)};function de(p,u,l,v,F){return u=+u,l=l>>>0,F||se(p,u,l,8),r.write(p,u,l,v,52,8),l+8}a.prototype.writeDoubleLE=function(u,l,v){return de(this,u,l,!0,v)},a.prototype.writeDoubleBE=function(u,l,v){return de(this,u,l,!1,v)},a.prototype.copy=function(u,l,v,F){if(!a.isBuffer(u))throw new TypeError("argument should be a Buffer");if(v||(v=0),!F&&F!==0&&(F=this.length),l>=u.length&&(l=u.length),l||(l=0),F>0&&F<v&&(F=v),F===v||u.length===0||this.length===0)return 0;if(l<0)throw new RangeError("targetStart out of bounds");if(v<0||v>=this.length)throw new RangeError("Index out of range");if(F<0)throw new RangeError("sourceEnd out of bounds");F>this.length&&(F=this.length),u.length-l<F-v&&(F=u.length-l+v);const K=F-v;return this===u&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(l,v,F):Uint8Array.prototype.set.call(u,this.subarray(v,F),l),K},a.prototype.fill=function(u,l,v,F){if(typeof u=="string"){if(typeof l=="string"?(F=l,l=0,v=this.length):typeof v=="string"&&(F=v,v=this.length),F!==void 0&&typeof F!="string")throw new TypeError("encoding must be a string");if(typeof F=="string"&&!a.isEncoding(F))throw new TypeError("Unknown encoding: "+F);if(u.length===1){const j=u.charCodeAt(0);(F==="utf8"&&j<128||F==="latin1")&&(u=j)}}else typeof u=="number"?u=u&255:typeof u=="boolean"&&(u=Number(u));if(l<0||this.length<l||this.length<v)throw new RangeError("Out of range index");if(v<=l)return this;l=l>>>0,v=v===void 0?this.length:v>>>0,u||(u=0);let K;if(typeof u=="number")for(K=l;K<v;++K)this[K]=u;else{const j=a.isBuffer(u)?u:a.from(u,F),_e=j.length;if(_e===0)throw new TypeError('The value "'+u+'" is invalid for argument "value"');for(K=0;K<v-l;++K)this[K+l]=j[K%_e]}return this};const te={};function ae(p,u,l){te[p]=class extends l{constructor(){super(),Object.defineProperty(this,"message",{value:u.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${p}]`,this.stack,delete this.name}get code(){return p}set code(F){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:F,writable:!0})}toString(){return`${this.name} [${p}]: ${this.message}`}}}ae("ERR_BUFFER_OUT_OF_BOUNDS",function(p){return p?`${p} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ae("ERR_INVALID_ARG_TYPE",function(p,u){return`The "${p}" argument must be of type number. Received type ${typeof u}`},TypeError),ae("ERR_OUT_OF_RANGE",function(p,u,l){let v=`The value of "${p}" is out of range.`,F=l;return Number.isInteger(l)&&Math.abs(l)>2**32?F=b(String(l)):typeof l=="bigint"&&(F=String(l),(l>BigInt(2)**BigInt(32)||l<-(BigInt(2)**BigInt(32)))&&(F=b(F)),F+="n"),v+=` It must be ${u}. Received ${F}`,v},RangeError);function b(p){let u="",l=p.length;const v=p[0]==="-"?1:0;for(;l>=v+4;l-=3)u=`_${p.slice(l-3,l)}${u}`;return`${p.slice(0,l)}${u}`}function x(p,u,l){$(u,"offset"),(p[u]===void 0||p[u+l]===void 0)&&O(u,p.length-(l+1))}function T(p,u,l,v,F,K){if(p>l||p<u){const j=typeof u=="bigint"?"n":"";let _e;throw K>3?u===0||u===BigInt(0)?_e=`>= 0${j} and < 2${j} ** ${(K+1)*8}${j}`:_e=`>= -(2${j} ** ${(K+1)*8-1}${j}) and < 2 ** ${(K+1)*8-1}${j}`:_e=`>= ${u}${j} and <= ${l}${j}`,new te.ERR_OUT_OF_RANGE("value",_e,p)}x(v,F,K)}function $(p,u){if(typeof p!="number")throw new te.ERR_INVALID_ARG_TYPE(u,"number",p)}function O(p,u,l){throw Math.floor(p)!==p?($(p,l),new te.ERR_OUT_OF_RANGE(l||"offset","an integer",p)):u<0?new te.ERR_BUFFER_OUT_OF_BOUNDS:new te.ERR_OUT_OF_RANGE(l||"offset",`>= ${l?1:0} and <= ${u}`,p)}const k=/[^+/0-9A-Za-z-_]/g;function h(p){if(p=p.split("=")[0],p=p.trim().replace(k,""),p.length<2)return"";for(;p.length%4!==0;)p=p+"=";return p}function o(p,u){u=u||1/0;let l;const v=p.length;let F=null;const K=[];for(let j=0;j<v;++j){if(l=p.charCodeAt(j),l>55295&&l<57344){if(!F){if(l>56319){(u-=3)>-1&&K.push(239,191,189);continue}else if(j+1===v){(u-=3)>-1&&K.push(239,191,189);continue}F=l;continue}if(l<56320){(u-=3)>-1&&K.push(239,191,189),F=l;continue}l=(F-55296<<10|l-56320)+65536}else F&&(u-=3)>-1&&K.push(239,191,189);if(F=null,l<128){if((u-=1)<0)break;K.push(l)}else if(l<2048){if((u-=2)<0)break;K.push(l>>6|192,l&63|128)}else if(l<65536){if((u-=3)<0)break;K.push(l>>12|224,l>>6&63|128,l&63|128)}else if(l<1114112){if((u-=4)<0)break;K.push(l>>18|240,l>>12&63|128,l>>6&63|128,l&63|128)}else throw new Error("Invalid code point")}return K}function c(p){const u=[];for(let l=0;l<p.length;++l)u.push(p.charCodeAt(l)&255);return u}function y(p,u){let l,v,F;const K=[];for(let j=0;j<p.length&&!((u-=2)<0);++j)l=p.charCodeAt(j),v=l>>8,F=l%256,K.push(F),K.push(v);return K}function _(p){return e.toByteArray(h(p))}function N(p,u,l,v){let F;for(F=0;F<v&&!(F+l>=u.length||F>=p.length);++F)u[F+l]=p[F];return F}function V(p,u){return p instanceof u||p!=null&&p.constructor!=null&&p.constructor.name!=null&&p.constructor.name===u.name}function ne(p){return p!==p}const pe=function(){const p="0123456789abcdef",u=new Array(256);for(let l=0;l<16;++l){const v=l*16;for(let F=0;F<16;++F)u[v+F]=p[l]+p[F]}return u}();function ye(p){return typeof BigInt>"u"?xe:p}function xe(){throw new Error("BigInt not supported")}})(Sa);var Ns;(function(t){t[t.SysFatal=1]="SysFatal",t[t.SysTransient=2]="SysTransient",t[t.DestinationInvalid=3]="DestinationInvalid",t[t.CanisterReject=4]="CanisterReject",t[t.CanisterError=5]="CanisterError"})(Ns||(Ns={}));const yf="modulepreload",gf=function(t){return"/"+t},So={},wf=function(e,r,n){if(!r||r.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(r.map(s=>{if(s=gf(s),s in So)return;So[s]=!0;const f=s.endsWith(".css"),a=f?'[rel="stylesheet"]':"";if(!!n)for(let E=i.length-1;E>=0;E--){const A=i[E];if(A.href===s&&(!f||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":yf,f||(g.as="script",g.crossOrigin=""),g.href=s,document.head.appendChild(g),f)return new Promise((E,A)=>{g.addEventListener("load",E),g.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=s,window.dispatchEvent(f),!f.defaultPrevented)throw s})},xi="abcdefghijklmnopqrstuvwxyz234567",Xr=Object.create(null);for(let t=0;t<xi.length;t++)Xr[xi[t]]=t;Xr[0]=Xr.o;Xr[1]=Xr.i;function mf(t){let e=0,r=0,n="";function i(s){return e<0?r|=s>>-e:r=s<<e&248,e>3?(e-=8,1):(e<4&&(n+=xi[r>>3],e+=5),0)}for(let s=0;s<t.length;)s+=i(t[s]);return n+(e<0?xi[r>>3]:"")}function bf(t){let e=0,r=0;const n=new Uint8Array(t.length*4/3|0);let i=0;function s(f){let a=Xr[f.toLowerCase()];if(a===void 0)throw new Error(`Invalid character: ${JSON.stringify(f)}`);a<<=3,r|=a>>>e,e+=5,e>=8&&(n[i++]=r,e-=8,e>0?r=a<<5-e&255:r=0)}for(const f of t)s(f);return n.slice(0,i)}const _f=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function xf(t){const e=new Uint8Array(t);let r=-1;for(let n=0;n<e.length;n++){const s=(e[n]^r)&255;r=_f[s]^r>>>8}return(r^-1)>>>0}function Ef(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Ia(t,...e){if(!Ef(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function No(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function vf(t,e){Ia(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const Or=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function is(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Tt(t,e){return t<<32-e|t>>>e}function Af(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Ra(t){return typeof t=="string"&&(t=Af(t)),Ia(t),t}class Bf{clone(){return this._cloneInto()}}function Ds(t){const e=n=>t().update(Ra(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Oa(t=32){if(Or&&typeof Or.getRandomValues=="function")return Or.getRandomValues(new Uint8Array(t));if(Or&&typeof Or.randomBytes=="function")return Or.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function Tf(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),f=Number(r>>i&s),a=Number(r&s),d=n?4:0,g=n?0:4;t.setUint32(e+d,f,n),t.setUint32(e+g,a,n)}function Sf(t,e,r){return t&e^~t&r}function Nf(t,e,r){return t&e^t&r^e&r}class Ua extends Bf{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=is(this.buffer)}update(e){No(this);const{view:r,buffer:n,blockLen:i}=this;e=Ra(e);const s=e.length;for(let f=0;f<s;){const a=Math.min(i-this.pos,s-f);if(a===i){const d=is(e);for(;i<=s-f;f+=i)this.process(d,f);continue}n.set(e.subarray(f,f+a),this.pos),this.pos+=a,f+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){No(this),vf(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:s}=this;let{pos:f}=this;r[f++]=128,this.buffer.subarray(f).fill(0),this.padOffset>i-f&&(this.process(n,0),f=0);for(let A=f;A<i;A++)r[A]=0;Tf(n,i-8,BigInt(this.length*8),s),this.process(n,0);const a=is(e),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const g=d/4,E=this.get();if(g>E.length)throw new Error("_sha2: outputLen bigger than state");for(let A=0;A<g;A++)a.setUint32(4*A,E[A],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:s,destroyed:f,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=f,i%r&&e.buffer.set(n),e}}const If=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Zt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Lt=new Uint32Array(64);class Fa extends Ua{constructor(){super(64,32,8,!1),this.A=Zt[0]|0,this.B=Zt[1]|0,this.C=Zt[2]|0,this.D=Zt[3]|0,this.E=Zt[4]|0,this.F=Zt[5]|0,this.G=Zt[6]|0,this.H=Zt[7]|0}get(){const{A:e,B:r,C:n,D:i,E:s,F:f,G:a,H:d}=this;return[e,r,n,i,s,f,a,d]}set(e,r,n,i,s,f,a,d){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=f|0,this.G=a|0,this.H=d|0}process(e,r){for(let A=0;A<16;A++,r+=4)Lt[A]=e.getUint32(r,!1);for(let A=16;A<64;A++){const S=Lt[A-15],B=Lt[A-2],w=Tt(S,7)^Tt(S,18)^S>>>3,M=Tt(B,17)^Tt(B,19)^B>>>10;Lt[A]=M+Lt[A-7]+w+Lt[A-16]|0}let{A:n,B:i,C:s,D:f,E:a,F:d,G:g,H:E}=this;for(let A=0;A<64;A++){const S=Tt(a,6)^Tt(a,11)^Tt(a,25),B=E+S+Sf(a,d,g)+If[A]+Lt[A]|0,M=(Tt(n,2)^Tt(n,13)^Tt(n,22))+Nf(n,i,s)|0;E=g,g=d,d=a,a=f+B|0,f=s,s=i,i=n,n=B+M|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,f=f+this.D|0,a=a+this.E|0,d=d+this.F|0,g=g+this.G|0,E=E+this.H|0,this.set(n,i,s,f,a,d,g,E)}roundClean(){Lt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Rf extends Fa{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Xs=Ds(()=>new Fa),Of=Ds(()=>new Rf);function Uf(t){return Of.create().update(new Uint8Array(t)).digest()}const Mn="__principal__",Ff=2,Io=4,Pf="aaaaa-aa",$f=t=>{var e;return new Uint8Array(((e=t.match(/.{1,2}/g))!==null&&e!==void 0?e:[]).map(r=>parseInt(r,16)))},kf=t=>t.reduce((e,r)=>e+r.toString(16).padStart(2,"0"),"");let ve=class Dn{constructor(e){this._arr=e,this._isPrincipal=!0}static anonymous(){return new this(new Uint8Array([Io]))}static managementCanister(){return this.fromText(Pf)}static selfAuthenticating(e){const r=Uf(e);return new this(new Uint8Array([...r,Ff]))}static from(e){if(typeof e=="string")return Dn.fromText(e);if(Object.getPrototypeOf(e)===Uint8Array.prototype)return new Dn(e);if(typeof e=="object"&&e!==null&&e._isPrincipal===!0)return new Dn(e._arr);throw new Error(`Impossible to convert ${JSON.stringify(e)} to Principal.`)}static fromHex(e){return new this($f(e))}static fromText(e){let r=e;if(e.includes(Mn)){const f=JSON.parse(e);Mn in f&&(r=f[Mn])}const n=r.toLowerCase().replace(/-/g,"");let i=bf(n);i=i.slice(4,i.length);const s=new this(i);if(s.toText()!==r)throw new Error(`Principal "${s.toText()}" does not have a valid checksum (original value "${r}" may not be a valid Principal ID).`);return s}static fromUint8Array(e){return new this(e)}isAnonymous(){return this._arr.byteLength===1&&this._arr[0]===Io}toUint8Array(){return this._arr}toHex(){return kf(this._arr).toUpperCase()}toText(){const e=new ArrayBuffer(4);new DataView(e).setUint32(0,xf(this._arr));const n=new Uint8Array(e),i=Uint8Array.from(this._arr),s=new Uint8Array([...n,...i]),a=mf(s).match(/.{1,5}/g);if(!a)throw new Error;return a.join("-")}toString(){return this.toText()}toJSON(){return{[Mn]:this.toText()}}compareTo(e){for(let r=0;r<Math.min(this._arr.length,e._arr.length);r++){if(this._arr[r]<e._arr[r])return"lt";if(this._arr[r]>e._arr[r])return"gt"}return this._arr.length<e._arr.length?"lt":this._arr.length>e._arr.length?"gt":"eq"}ltEq(e){const r=this.compareTo(e);return r=="lt"||r=="eq"}gtEq(e){const r=this.compareTo(e);return r=="gt"||r=="eq"}};function At(...t){const e=new Uint8Array(t.reduce((n,i)=>n+i.byteLength,0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e.buffer}function ke(t){return[...new Uint8Array(t)].map(e=>e.toString(16).padStart(2,"0")).join("")}const Mf=new RegExp(/^[0-9a-fA-F]+$/);function Kt(t){if(!Mf.test(t))throw new Error("Invalid hexadecimal string.");const e=[...t].reduce((r,n,i)=>(r[i/2|0]=(r[i/2|0]||"")+n,r),[]).map(r=>Number.parseInt(r,16));return new Uint8Array(e).buffer}function Pa(t,e){if(t.byteLength!==e.byteLength)return t.byteLength-e.byteLength;const r=new Uint8Array(t),n=new Uint8Array(e);for(let i=0;i<r.length;i++)if(r[i]!==n[i])return r[i]-n[i];return 0}function Rn(t,e){return Pa(t,e)===0}function hn(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function Ht(t){return t instanceof Uint8Array?hn(t):t instanceof ArrayBuffer?t:Array.isArray(t)?hn(new Uint8Array(t)):"buffer"in t?Ht(t.buffer):hn(new Uint8Array(t))}class qe extends Error{constructor(e){super(e),this.message=e,this.name="AgentError",this.__proto__=qe.prototype,Object.setPrototypeOf(this,qe.prototype)}}function Oe(...t){const e=new Uint8Array(t.reduce((n,i)=>n+i.byteLength,0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e}class en{constructor(e,r=(e==null?void 0:e.byteLength)||0){this._buffer=Ar(e||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,r)}save(){return this._view}restore(e){this._view=e}get buffer(){return Ar(this._view.slice())}get byteLength(){return this._view.byteLength}read(e){const r=this._view.subarray(0,e);return this._view=this._view.subarray(e),r.slice().buffer}readUint8(){const e=this._view[0];return this._view=this._view.subarray(1),e}write(e){const r=new Uint8Array(e),n=this._view.byteLength;this._view.byteOffset+this._view.byteLength+r.byteLength>=this._buffer.byteLength?this.alloc(r.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+r.byteLength),this._view.set(r,n)}get end(){return this._view.byteLength===0}alloc(e){const r=new ArrayBuffer((this._buffer.byteLength+e)*1.2|0),n=new Uint8Array(r,0,this._view.byteLength+e);n.set(this._view),this._buffer=r,this._view=n}}function ss(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function Ar(t){return t instanceof Uint8Array?ss(t):t instanceof ArrayBuffer?t:Array.isArray(t)?ss(new Uint8Array(t)):"buffer"in t?Ar(t.buffer):ss(new Uint8Array(t))}function Cf(t){const r=new TextEncoder().encode(t);let n=0;for(const i of r)n=(n*223+i)%2**32;return n}function Pt(t){if(/^_\d+_$/.test(t)||/^_0x[0-9a-fA-F]+_$/.test(t)){const e=+t.slice(1,-1);if(Number.isSafeInteger(e)&&e>=0&&e<2**32)return e}return Cf(t)}function $a(){throw new Error("unexpected end of buffer")}function Br(t,e){return t.byteLength<e&&$a(),t.read(e)}function Tr(t){const e=t.readUint8();return e===void 0&&$a(),e}function Ve(t){if(typeof t=="number"&&(t=BigInt(t)),t<BigInt(0))throw new Error("Cannot leb encode negative values.");const e=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,r=new en(new ArrayBuffer(e),0);for(;;){const n=Number(t&BigInt(127));if(t/=BigInt(128),t===BigInt(0)){r.write(new Uint8Array([n]));break}else r.write(new Uint8Array([n|128]))}return r.buffer}function Le(t){let e=BigInt(1),r=BigInt(0),n;do n=Tr(t),r+=BigInt(n&127).valueOf()*e,e*=BigInt(128);while(n>=128);return r}function We(t){typeof t=="number"&&(t=BigInt(t));const e=t<BigInt(0);e&&(t=-t-BigInt(1));const r=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,n=new en(new ArrayBuffer(r),0);for(;;){const s=i(t);if(t/=BigInt(128),e&&t===BigInt(0)&&s&64||!e&&t===BigInt(0)&&!(s&64)){n.write(new Uint8Array([s]));break}else n.write(new Uint8Array([s|128]))}function i(s){const f=s%BigInt(128);return Number(e?BigInt(128)-f-BigInt(1):f)}return n.buffer}function Qt(t){const e=new Uint8Array(t.buffer);let r=0;for(;r<e.byteLength;r++)if(e[r]<128){if(!(e[r]&64))return Le(t);break}const n=new Uint8Array(Br(t,r+1));let i=BigInt(0);for(let s=n.byteLength-1;s>=0;s--)i=i*BigInt(128)+BigInt(128-(n[s]&127)-1);return-i-BigInt(1)}function qf(t,e){if(BigInt(t)<BigInt(0))throw new Error("Cannot write negative values.");return ka(t,e)}function ka(t,e){t=BigInt(t);const r=new en(new ArrayBuffer(Math.min(1,e)),0);let n=0,i=BigInt(256),s=BigInt(0),f=Number(t%i);for(r.write(new Uint8Array([f]));++n<e;)t<0&&s===BigInt(0)&&f!==0&&(s=BigInt(1)),f=Number((t/i-s)%BigInt(256)),r.write(new Uint8Array([f])),i*=BigInt(256);return r.buffer}function Ma(t,e){let r=BigInt(Tr(t)),n=BigInt(1),i=0;for(;++i<e;){n*=BigInt(256);const s=BigInt(Tr(t));r=r+n*s}return r}function Vf(t,e){let r=Ma(t,e);const n=BigInt(2)**(BigInt(8)*BigInt(e-1)+BigInt(7));return r>=n&&(r-=n*BigInt(2)),r}function Is(t){const e=BigInt(t);if(t<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<e}const Xn="DIDL",Ro=400;function xn(t,e,r){return t.map((n,i)=>r(n,e[i]))}class Hf{constructor(){this._typs=[],this._idx=new Map}has(e){return this._idx.has(e.name)}add(e,r){const n=this._typs.length;this._idx.set(e.name,n),this._typs.push(r)}merge(e,r){const n=this._idx.get(e.name),i=this._idx.get(r);if(n===void 0)throw new Error("Missing type index for "+e);if(i===void 0)throw new Error("Missing type index for "+r);this._typs[n]=this._typs[i],this._typs.splice(i,1),this._idx.delete(r)}encode(){const e=Ve(this._typs.length),r=Oe(...this._typs);return Oe(e,r)}indexOf(e){if(!this._idx.has(e))throw new Error("Missing type index for "+e);return We(this._idx.get(e)||0)}}class Gf{visitType(e,r){throw new Error("Not implemented")}visitPrimitive(e,r){return this.visitType(e,r)}visitEmpty(e,r){return this.visitPrimitive(e,r)}visitBool(e,r){return this.visitPrimitive(e,r)}visitNull(e,r){return this.visitPrimitive(e,r)}visitReserved(e,r){return this.visitPrimitive(e,r)}visitText(e,r){return this.visitPrimitive(e,r)}visitNumber(e,r){return this.visitPrimitive(e,r)}visitInt(e,r){return this.visitNumber(e,r)}visitNat(e,r){return this.visitNumber(e,r)}visitFloat(e,r){return this.visitPrimitive(e,r)}visitFixedInt(e,r){return this.visitNumber(e,r)}visitFixedNat(e,r){return this.visitNumber(e,r)}visitPrincipal(e,r){return this.visitPrimitive(e,r)}visitConstruct(e,r){return this.visitType(e,r)}visitVec(e,r,n){return this.visitConstruct(e,n)}visitOpt(e,r,n){return this.visitConstruct(e,n)}visitRecord(e,r,n){return this.visitConstruct(e,n)}visitTuple(e,r,n){const i=r.map((s,f)=>[`_${f}_`,s]);return this.visitRecord(e,i,n)}visitVariant(e,r,n){return this.visitConstruct(e,n)}visitRec(e,r,n){return this.visitConstruct(r,n)}visitFunc(e,r){return this.visitConstruct(e,r)}visitService(e,r){return this.visitConstruct(e,r)}}class Mi{display(){return this.name}valueToString(e){return Ge(e)}buildTypeTable(e){e.has(this)||this._buildTypeTableImpl(e)}}class gt extends Mi{checkType(e){if(this.name!==e.name)throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`);return e}_buildTypeTableImpl(e){}}class hr extends Mi{checkType(e){if(e instanceof Wt){const r=e.getType();if(typeof r>"u")throw new Error("type mismatch with uninitialized type");return r}throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`)}encodeType(e){return e.indexOf(this.name)}}class Ca extends gt{accept(e,r){return e.visitEmpty(this,r)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return We(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class qa extends Mi{checkType(e){throw new Error("Method not implemented for unknown.")}accept(e,r){throw e.visitType(this,r)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(e,r){let n=r.decodeValue(e,r);Object(n)!==n&&(n=Object(n));let i;return r instanceof Wt?i=()=>r.getType():i=()=>r,Object.defineProperty(n,"type",{value:i,writable:!0,enumerable:!1,configurable:!0}),n}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class Va extends gt{accept(e,r){return e.visitBool(this,r)}covariant(e){if(typeof e=="boolean")return!0;throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(e){return new Uint8Array([e?1:0])}encodeType(){return We(-2)}decodeValue(e,r){switch(this.checkType(r),Tr(e)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class Ei extends gt{accept(e,r){return e.visitNull(this,r)}covariant(e){if(e===null)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return We(-1)}decodeValue(e,r){return this.checkType(r),null}get name(){return"null"}}class Jr extends gt{accept(e,r){return e.visitReserved(this,r)}covariant(e){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return We(-16)}decodeValue(e,r){return r.name!==this.name&&r.decodeValue(e,r),null}get name(){return"reserved"}}class Ha extends gt{accept(e,r){return e.visitText(this,r)}covariant(e){if(typeof e=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(e){const r=new TextEncoder().encode(e),n=Ve(r.byteLength);return Oe(n,r)}encodeType(){return We(-15)}decodeValue(e,r){this.checkType(r);const n=Le(e),i=Br(e,Number(n));return new TextDecoder("utf8",{fatal:!0}).decode(i)}get name(){return"text"}valueToString(e){return'"'+e+'"'}}class Ga extends gt{accept(e,r){return e.visitInt(this,r)}covariant(e){if(typeof e=="bigint"||Number.isInteger(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(e){return We(e)}encodeType(){return We(-4)}decodeValue(e,r){return this.checkType(r),Qt(e)}get name(){return"int"}valueToString(e){return e.toString()}}class ja extends gt{accept(e,r){return e.visitNat(this,r)}covariant(e){if(typeof e=="bigint"&&e>=BigInt(0)||Number.isInteger(e)&&e>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(e){return Ve(e)}encodeType(){return We(-3)}decodeValue(e,r){return this.checkType(r),Le(e)}get name(){return"nat"}valueToString(e){return e.toString()}}class Js extends gt{constructor(e){if(super(),this._bits=e,e!==32&&e!==64)throw new Error("not a valid float type")}accept(e,r){return e.visitFloat(this,r)}covariant(e){if(typeof e=="number"||e instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(e){const r=new ArrayBuffer(this._bits/8),n=new DataView(r);return this._bits===32?n.setFloat32(0,e,!0):n.setFloat64(0,e,!0),r}encodeType(){const e=this._bits===32?-13:-14;return We(e)}decodeValue(e,r){this.checkType(r);const n=Br(e,this._bits/8),i=new DataView(n);return this._bits===32?i.getFloat32(0,!0):i.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(e){return e.toString()}}class Sr extends gt{constructor(e){super(),this._bits=e}accept(e,r){return e.visitFixedInt(this,r)}covariant(e){const r=Is(this._bits-1)*BigInt(-1),n=Is(this._bits-1)-BigInt(1);let i=!1;if(typeof e=="bigint")i=e>=r&&e<=n;else if(Number.isInteger(e)){const s=BigInt(e);i=s>=r&&s<=n}else i=!1;if(i)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(e){return ka(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return We(-9-e)}decodeValue(e,r){this.checkType(r);const n=Vf(e,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`int${this._bits}`}valueToString(e){return e.toString()}}class ur extends gt{constructor(e){super(),this._bits=e}accept(e,r){return e.visitFixedNat(this,r)}covariant(e){const r=Is(this._bits);let n=!1;if(typeof e=="bigint"&&e>=BigInt(0)?n=e<r:Number.isInteger(e)&&e>=0?n=BigInt(e)<r:n=!1,n)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(e){return qf(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return We(-5-e)}decodeValue(e,r){this.checkType(r);const n=Ma(e,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`nat${this._bits}`}valueToString(e){return e.toString()}}class Ci extends hr{constructor(e){super(),this._type=e,this._blobOptimization=!1,e instanceof ur&&e._bits===8&&(this._blobOptimization=!0)}accept(e,r){return e.visitVec(this,this._type,r)}covariant(e){const r=this._type instanceof ur?this._type._bits:this._type instanceof Sr?this._type._bits:0;if(ArrayBuffer.isView(e)&&r==e.BYTES_PER_ELEMENT*8||Array.isArray(e)&&e.every((n,i)=>{try{return this._type.covariant(n)}catch(s){throw new Error(`Invalid ${this.display()} argument: 

index ${i} -> ${s.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(e){const r=Ve(e.length);if(this._blobOptimization)return Oe(r,new Uint8Array(e));if(ArrayBuffer.isView(e))return Oe(r,new Uint8Array(e.buffer));const n=new en(new ArrayBuffer(r.byteLength+e.length),0);n.write(r);for(const i of e){const s=this._type.encodeValue(i);n.write(new Uint8Array(s))}return n.buffer}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const r=We(-19),n=this._type.encodeType(e);e.add(this,Oe(r,n))}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof Ci))throw new Error("Not a vector type");const i=Number(Le(e));if(this._type instanceof ur){if(this._type._bits==8)return new Uint8Array(e.read(i));if(this._type._bits==16)return new Uint16Array(e.read(i*2));if(this._type._bits==32)return new Uint32Array(e.read(i*4));if(this._type._bits==64)return new BigUint64Array(e.read(i*8))}if(this._type instanceof Sr){if(this._type._bits==8)return new Int8Array(e.read(i));if(this._type._bits==16)return new Int16Array(e.read(i*2));if(this._type._bits==32)return new Int32Array(e.read(i*4));if(this._type._bits==64)return new BigInt64Array(e.read(i*8))}const s=[];for(let f=0;f<i;f++)s.push(this._type.decodeValue(e,n._type));return s}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(e){return"vec {"+e.map(n=>this._type.valueToString(n)).join("; ")+"}"}}class Nr extends hr{constructor(e){super(),this._type=e}accept(e,r){return e.visitOpt(this,this._type,r)}covariant(e){try{if(Array.isArray(e)&&(e.length===0||e.length===1&&this._type.covariant(e[0])))return!0}catch(r){throw new Error(`Invalid ${this.display()} argument: ${Ge(e)} 

-> ${r.message}`)}throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(e){return e.length===0?new Uint8Array([0]):Oe(new Uint8Array([1]),this._type.encodeValue(e[0]))}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const r=We(-18),n=this._type.encodeType(e);e.add(this,Oe(r,n))}decodeValue(e,r){if(r instanceof Ei)return[];if(r instanceof Jr)return[];let n=r;if(r instanceof Wt){const i=r.getType();if(typeof i>"u")throw new Error("type mismatch with uninitialized type");n=i}if(n instanceof Nr)switch(Tr(e)){case 0:return[];case 1:{const i=e.save();try{return[this._type.decodeValue(e,n._type)]}catch{return e.restore(i),n._type.decodeValue(e,n._type),[]}}default:throw new Error("Not an option value")}else{if(this._type instanceof Ei||this._type instanceof Nr||this._type instanceof Jr)return n.decodeValue(e,n),[];{const i=e.save();try{return[this._type.decodeValue(e,r)]}catch{return e.restore(i),n.decodeValue(e,r),[]}}}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(e){return e.length===0?"null":`opt ${this._type.valueToString(e[0])}`}}class On extends hr{constructor(e={}){super(),this._fields=Object.entries(e).sort((r,n)=>Pt(r[0])-Pt(n[0]))}accept(e,r){return e.visitRecord(this,this._fields,r)}tryAsTuple(){const e=[];for(let r=0;r<this._fields.length;r++){const[n,i]=this._fields[r];if(n!==`_${r}_`)return null;e.push(i)}return e}covariant(e){if(typeof e=="object"&&this._fields.every(([r,n])=>{if(!e.hasOwnProperty(r))throw new Error(`Record is missing key "${r}".`);try{return n.covariant(e[r])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

field ${r} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(e){const r=this._fields.map(([i])=>e[i]),n=xn(this._fields,r,([,i],s)=>i.encodeValue(s));return Oe(...n)}_buildTypeTableImpl(e){this._fields.forEach(([s,f])=>f.buildTypeTable(e));const r=We(-20),n=Ve(this._fields.length),i=this._fields.map(([s,f])=>Oe(Ve(Pt(s)),f.encodeType(e)));e.add(this,Oe(r,n,Oe(...i)))}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof On))throw new Error("Not a record type");const i={};let s=0,f=0;for(;f<n._fields.length;){const[a,d]=n._fields[f];if(s>=this._fields.length){d.decodeValue(e,d),f++;continue}const[g,E]=this._fields[s],A=Pt(this._fields[s][0]),S=Pt(a);if(A===S)i[g]=E.decodeValue(e,d),s++,f++;else if(S>A)if(E instanceof Nr||E instanceof Jr)i[g]=[],s++;else throw new Error("Cannot find required field "+g);else d.decodeValue(e,d),f++}for(const[a,d]of this._fields.slice(s))if(d instanceof Nr||d instanceof Jr)i[a]=[];else throw new Error("Cannot find required field "+a);return i}get name(){return`record {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}display(){return`record {${this._fields.map(([r,n])=>r+":"+n.display()).join("; ")}}`}valueToString(e){const r=this._fields.map(([i])=>e[i]);return`record {${xn(this._fields,r,([i,s],f)=>i+"="+s.valueToString(f)).join("; ")}}`}}class qi extends On{constructor(e){const r={};e.forEach((n,i)=>r["_"+i+"_"]=n),super(r),this._components=e}accept(e,r){return e.visitTuple(this,this._components,r)}covariant(e){if(Array.isArray(e)&&e.length>=this._fields.length&&this._components.every((r,n)=>{try{return r.covariant(e[n])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

index ${n} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(e){const r=xn(this._components,e,(n,i)=>n.encodeValue(i));return Oe(...r)}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof qi))throw new Error("not a tuple type");if(n._components.length<this._components.length)throw new Error("tuple mismatch");const i=[];for(const[s,f]of n._components.entries())s>=this._components.length?f.decodeValue(e,f):i.push(this._components[s].decodeValue(e,f));return i}display(){return`record {${this._components.map(r=>r.display()).join("; ")}}`}valueToString(e){return`record {${xn(this._components,e,(n,i)=>n.valueToString(i)).join("; ")}}`}}class Vi extends hr{constructor(e={}){super(),this._fields=Object.entries(e).sort((r,n)=>Pt(r[0])-Pt(n[0]))}accept(e,r){return e.visitVariant(this,this._fields,r)}covariant(e){if(typeof e=="object"&&Object.entries(e).length===1&&this._fields.every(([r,n])=>{try{return!e.hasOwnProperty(r)||n.covariant(e[r])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

variant ${r} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(e){for(let r=0;r<this._fields.length;r++){const[n,i]=this._fields[r];if(e.hasOwnProperty(n)){const s=Ve(r),f=i.encodeValue(e[n]);return Oe(s,f)}}throw Error("Variant has no data: "+e)}_buildTypeTableImpl(e){this._fields.forEach(([,s])=>{s.buildTypeTable(e)});const r=We(-21),n=Ve(this._fields.length),i=this._fields.map(([s,f])=>Oe(Ve(Pt(s)),f.encodeType(e)));e.add(this,Oe(r,n,...i))}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof Vi))throw new Error("Not a variant type");const i=Number(Le(e));if(i>=n._fields.length)throw Error("Invalid variant index: "+i);const[s,f]=n._fields[i];for(const[a,d]of this._fields)if(Pt(s)===Pt(a)){const g=d.decodeValue(e,f);return{[a]:g}}throw new Error("Cannot find field hash "+s)}get name(){return`variant {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}display(){return`variant {${this._fields.map(([r,n])=>r+(n.name==="null"?"":`:${n.display()}`)).join("; ")}}`}valueToString(e){for(const[r,n]of this._fields)if(e.hasOwnProperty(r)){const i=n.valueToString(e[r]);return i==="null"?`variant {${r}}`:`variant {${r}=${i}}`}throw new Error("Variant has no data: "+e)}}class Wt extends hr{constructor(){super(...arguments),this._id=Wt._counter++,this._type=void 0}accept(e,r){if(!this._type)throw Error("Recursive type uninitialized.");return e.visitRec(this,this._type,r)}fill(e){this._type=e}getType(){return this._type}covariant(e){if(this._type&&this._type.covariant(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(e)}_buildTypeTableImpl(e){if(!this._type)throw Error("Recursive type uninitialized.");e.add(this,new Uint8Array([])),this._type.buildTypeTable(e),e.merge(this,this._type.name)}decodeValue(e,r){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(e,r)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`μ${this.name}.${this._type.name}`}valueToString(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(e)}}Wt._counter=0;function Qs(t){if(Tr(t)!==1)throw new Error("Cannot decode principal");const r=Number(Le(t));return ve.fromUint8Array(new Uint8Array(Br(t,r)))}class Ka extends gt{accept(e,r){return e.visitPrincipal(this,r)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(e){const r=e.toUint8Array(),n=Ve(r.byteLength);return Oe(new Uint8Array([1]),n,r)}encodeType(){return We(-24)}decodeValue(e,r){return this.checkType(r),Qs(e)}get name(){return"principal"}valueToString(e){return`${this.name} "${e.toText()}"`}}class eo extends hr{constructor(e,r,n=[]){super(),this.argTypes=e,this.retTypes=r,this.annotations=n}static argsToString(e,r){if(e.length!==r.length)throw new Error("arity mismatch");return"("+e.map((n,i)=>n.valueToString(r[i])).join(", ")+")"}accept(e,r){return e.visitFunc(this,r)}covariant(e){if(Array.isArray(e)&&e.length===2&&e[0]&&e[0]._isPrincipal&&typeof e[1]=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue([e,r]){const n=e.toUint8Array(),i=Ve(n.byteLength),s=Oe(new Uint8Array([1]),i,n),f=new TextEncoder().encode(r),a=Ve(f.byteLength);return Oe(new Uint8Array([1]),s,a,f)}_buildTypeTableImpl(e){this.argTypes.forEach(g=>g.buildTypeTable(e)),this.retTypes.forEach(g=>g.buildTypeTable(e));const r=We(-22),n=Ve(this.argTypes.length),i=Oe(...this.argTypes.map(g=>g.encodeType(e))),s=Ve(this.retTypes.length),f=Oe(...this.retTypes.map(g=>g.encodeType(e))),a=Ve(this.annotations.length),d=Oe(...this.annotations.map(g=>this.encodeAnnotation(g)));e.add(this,Oe(r,n,i,s,f,a,d))}decodeValue(e){if(Tr(e)!==1)throw new Error("Cannot decode function reference");const n=Qs(e),i=Number(Le(e)),s=Br(e,i),a=new TextDecoder("utf8",{fatal:!0}).decode(s);return[n,a]}get name(){const e=this.argTypes.map(i=>i.name).join(", "),r=this.retTypes.map(i=>i.name).join(", "),n=" "+this.annotations.join(" ");return`(${e}) -> (${r})${n}`}valueToString([e,r]){return`func "${e.toText()}".${r}`}display(){const e=this.argTypes.map(i=>i.display()).join(", "),r=this.retTypes.map(i=>i.display()).join(", "),n=" "+this.annotations.join(" ");return`(${e}) → (${r})${n}`}encodeAnnotation(e){if(e==="query")return new Uint8Array([1]);if(e==="oneway")return new Uint8Array([2]);if(e==="composite_query")return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class za extends hr{constructor(e){super(),this._fields=Object.entries(e).sort((r,n)=>r[0]<n[0]?-1:r[0]>n[0]?1:0)}accept(e,r){return e.visitService(this,r)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ge(e)}`)}encodeValue(e){const r=e.toUint8Array(),n=Ve(r.length);return Oe(new Uint8Array([1]),n,r)}_buildTypeTableImpl(e){this._fields.forEach(([s,f])=>f.buildTypeTable(e));const r=We(-23),n=Ve(this._fields.length),i=this._fields.map(([s,f])=>{const a=new TextEncoder().encode(s),d=Ve(a.length);return Oe(d,a,f.encodeType(e))});e.add(this,Oe(r,n,...i))}decodeValue(e){return Qs(e)}get name(){return`service {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}valueToString(e){return`service "${e.toText()}"`}}function Ge(t){const e=JSON.stringify(t,(r,n)=>typeof n=="bigint"?`BigInt(${n})`:n);return e&&e.length>Ro?e.substring(0,Ro-3)+"...":e}function Rs(t,e){if(e.length<t.length)throw Error("Wrong number of message arguments");const r=new Hf;t.forEach(d=>d.buildTypeTable(r));const n=new TextEncoder().encode(Xn),i=r.encode(),s=Ve(e.length),f=Oe(...t.map(d=>d.encodeType(r))),a=Oe(...xn(t,e,(d,g)=>{try{d.covariant(g)}catch(E){throw new Error(E.message+`

`)}return d.encodeValue(g)}));return Oe(n,i,s,f,a)}function Wa(t,e){const r=new en(e);if(e.byteLength<Xn.length)throw new Error("Message length smaller than magic number");const n=Br(r,Xn.length),i=new TextDecoder().decode(n);if(i!==Xn)throw new Error("Wrong magic number: "+JSON.stringify(i));function s(B){const w=[],M=Number(Le(B));for(let z=0;z<M;z++){const q=Number(Qt(B));switch(q){case-18:case-19:{const re=Number(Qt(B));w.push([q,re]);break}case-20:case-21:{const re=[];let P=Number(Le(B)),L;for(;P--;){const Z=Number(Le(B));if(Z>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if(typeof L=="number"&&L>=Z)throw new Error("field id collision or not sorted");L=Z;const J=Number(Qt(B));re.push([Z,J])}w.push([q,re]);break}case-22:{const re=[];let P=Number(Le(B));for(;P--;)re.push(Number(Qt(B)));const L=[];let Z=Number(Le(B));for(;Z--;)L.push(Number(Qt(B)));const J=[];let Q=Number(Le(B));for(;Q--;)switch(Number(Le(B))){case 1:{J.push("query");break}case 2:{J.push("oneway");break}case 3:{J.push("composite_query");break}default:throw new Error("unknown annotation")}w.push([q,[re,L,J]]);break}case-23:{let re=Number(Le(B));const P=[];for(;re--;){const L=Number(Le(B)),Z=new TextDecoder().decode(Br(B,L)),J=Qt(B);P.push([Z,J])}w.push([q,P]);break}default:throw new Error("Illegal op_code: "+q)}}const C=[],Y=Number(Le(B));for(let z=0;z<Y;z++)C.push(Number(Qt(B)));return[w,C]}const[f,a]=s(r);if(a.length<t.length)throw new Error("Wrong number of return values");const d=f.map(B=>gc());function g(B){if(B<-24)throw new Error("future value not supported");if(B<0)switch(B){case-1:return Da;case-2:return La;case-3:return Qa;case-4:return Ja;case-5:return oc;case-6:return ac;case-7:return cc;case-8:return uc;case-9:return rc;case-10:return nc;case-11:return ic;case-12:return sc;case-13:return ec;case-14:return tc;case-15:return Xa;case-16:return Za;case-17:return Ya;case-24:return fc;default:throw new Error("Illegal op_code: "+B)}if(B>=f.length)throw new Error("type index out of range");return d[B]}function E(B){switch(B[0]){case-19:{const w=g(B[1]);return hc(w)}case-18:{const w=g(B[1]);return dc(w)}case-20:{const w={};for(const[Y,z]of B[1]){const q=`_${Y}_`;w[q]=g(z)}const M=pc(w),C=M.tryAsTuple();return Array.isArray(C)?lc(...C):M}case-21:{const w={};for(const[M,C]of B[1]){const Y=`_${M}_`;w[Y]=g(C)}return yc(w)}case-22:{const[w,M,C]=B[1];return wc(w.map(Y=>g(Y)),M.map(Y=>g(Y)),C)}case-23:{const w={},M=B[1];for(const[C,Y]of M){let z=g(Y);if(z instanceof Wt&&(z=z.getType()),!(z instanceof eo))throw new Error("Illegal service definition: services can only contain functions");w[C]=z}return mc(w)}default:throw new Error("Illegal op_code: "+B[0])}}f.forEach((B,w)=>{if(B[0]===-22){const M=E(B);d[w].fill(M)}}),f.forEach((B,w)=>{if(B[0]!==-22){const M=E(B);d[w].fill(M)}});const A=a.map(B=>g(B)),S=t.map((B,w)=>B.decodeValue(r,A[w]));for(let B=t.length;B<A.length;B++)A[B].decodeValue(r,A[B]);if(r.byteLength>0)throw new Error("decode: Left-over bytes");return S}const Ya=new Ca,Za=new Jr,jf=new qa,La=new Va,Da=new Ei,Xa=new Ha,Ja=new Ga,Qa=new ja,ec=new Js(32),tc=new Js(64),rc=new Sr(8),nc=new Sr(16),ic=new Sr(32),sc=new Sr(64),oc=new ur(8),ac=new ur(16),cc=new ur(32),uc=new ur(64),fc=new Ka;function lc(...t){return new qi(t)}function hc(t){return new Ci(t)}function dc(t){return new Nr(t)}function pc(t){return new On(t)}function yc(t){return new Vi(t)}function gc(){return new Wt}function wc(t,e,r=[]){return new eo(t,e,r)}function mc(t){return new za(t)}const Kf=Object.freeze(Object.defineProperty({__proto__:null,Bool:La,BoolClass:Va,ConstructType:hr,Empty:Ya,EmptyClass:Ca,FixedIntClass:Sr,FixedNatClass:ur,Float32:ec,Float64:tc,FloatClass:Js,Func:wc,FuncClass:eo,Int:Ja,Int16:nc,Int32:ic,Int64:sc,Int8:rc,IntClass:Ga,Nat:Qa,Nat16:ac,Nat32:cc,Nat64:uc,Nat8:oc,NatClass:ja,Null:Da,NullClass:Ei,Opt:dc,OptClass:Nr,PrimitiveType:gt,Principal:fc,PrincipalClass:Ka,Rec:gc,RecClass:Wt,Record:pc,RecordClass:On,Reserved:Za,ReservedClass:Jr,Service:mc,ServiceClass:za,Text:Xa,TextClass:Ha,Tuple:lc,TupleClass:qi,Type:Mi,Unknown:jf,UnknownClass:qa,Variant:yc,VariantClass:Vi,Vec:hc,VecClass:Ci,Visitor:Gf,decode:Wa,encode:Rs},Symbol.toStringTag,{value:"Module"}));var bc={},Un={};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){var e=Nn,r=In,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=z,t.INSPECT_MAX_BYTES=50;var i=2147483647;t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=s(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{var h=new Uint8Array(1),o={foo:function(){return 42}};return Object.setPrototypeOf(o,Uint8Array.prototype),Object.setPrototypeOf(h,o),h.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function f(h){if(h>i)throw new RangeError('The value "'+h+'" is invalid for option "size"');var o=new Uint8Array(h);return Object.setPrototypeOf(o,a.prototype),o}function a(h,o,c){if(typeof h=="number"){if(typeof o=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return A(h)}return d(h,o,c)}a.poolSize=8192;function d(h,o,c){if(typeof h=="string")return S(h,o);if(ArrayBuffer.isView(h))return w(h);if(h==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof h);if($(h,ArrayBuffer)||h&&$(h.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&($(h,SharedArrayBuffer)||h&&$(h.buffer,SharedArrayBuffer)))return M(h,o,c);if(typeof h=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var y=h.valueOf&&h.valueOf();if(y!=null&&y!==h)return a.from(y,o,c);var _=C(h);if(_)return _;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof h[Symbol.toPrimitive]=="function")return a.from(h[Symbol.toPrimitive]("string"),o,c);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof h)}a.from=function(h,o,c){return d(h,o,c)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function g(h){if(typeof h!="number")throw new TypeError('"size" argument must be of type number');if(h<0)throw new RangeError('The value "'+h+'" is invalid for option "size"')}function E(h,o,c){return g(h),h<=0?f(h):o!==void 0?typeof c=="string"?f(h).fill(o,c):f(h).fill(o):f(h)}a.alloc=function(h,o,c){return E(h,o,c)};function A(h){return g(h),f(h<0?0:Y(h)|0)}a.allocUnsafe=function(h){return A(h)},a.allocUnsafeSlow=function(h){return A(h)};function S(h,o){if((typeof o!="string"||o==="")&&(o="utf8"),!a.isEncoding(o))throw new TypeError("Unknown encoding: "+o);var c=q(h,o)|0,y=f(c),_=y.write(h,o);return _!==c&&(y=y.slice(0,_)),y}function B(h){for(var o=h.length<0?0:Y(h.length)|0,c=f(o),y=0;y<o;y+=1)c[y]=h[y]&255;return c}function w(h){if($(h,Uint8Array)){var o=new Uint8Array(h);return M(o.buffer,o.byteOffset,o.byteLength)}return B(h)}function M(h,o,c){if(o<0||h.byteLength<o)throw new RangeError('"offset" is outside of buffer bounds');if(h.byteLength<o+(c||0))throw new RangeError('"length" is outside of buffer bounds');var y;return o===void 0&&c===void 0?y=new Uint8Array(h):c===void 0?y=new Uint8Array(h,o):y=new Uint8Array(h,o,c),Object.setPrototypeOf(y,a.prototype),y}function C(h){if(a.isBuffer(h)){var o=Y(h.length)|0,c=f(o);return c.length===0||h.copy(c,0,0,o),c}if(h.length!==void 0)return typeof h.length!="number"||O(h.length)?f(0):B(h);if(h.type==="Buffer"&&Array.isArray(h.data))return B(h.data)}function Y(h){if(h>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return h|0}function z(h){return+h!=h&&(h=0),a.alloc(+h)}a.isBuffer=function(o){return o!=null&&o._isBuffer===!0&&o!==a.prototype},a.compare=function(o,c){if($(o,Uint8Array)&&(o=a.from(o,o.offset,o.byteLength)),$(c,Uint8Array)&&(c=a.from(c,c.offset,c.byteLength)),!a.isBuffer(o)||!a.isBuffer(c))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(o===c)return 0;for(var y=o.length,_=c.length,N=0,V=Math.min(y,_);N<V;++N)if(o[N]!==c[N]){y=o[N],_=c[N];break}return y<_?-1:_<y?1:0},a.isEncoding=function(o){switch(String(o).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(o,c){if(!Array.isArray(o))throw new TypeError('"list" argument must be an Array of Buffers');if(o.length===0)return a.alloc(0);var y;if(c===void 0)for(c=0,y=0;y<o.length;++y)c+=o[y].length;var _=a.allocUnsafe(c),N=0;for(y=0;y<o.length;++y){var V=o[y];if($(V,Uint8Array))N+V.length>_.length?a.from(V).copy(_,N):Uint8Array.prototype.set.call(_,V,N);else if(a.isBuffer(V))V.copy(_,N);else throw new TypeError('"list" argument must be an Array of Buffers');N+=V.length}return _};function q(h,o){if(a.isBuffer(h))return h.length;if(ArrayBuffer.isView(h)||$(h,ArrayBuffer))return h.byteLength;if(typeof h!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof h);var c=h.length,y=arguments.length>2&&arguments[2]===!0;if(!y&&c===0)return 0;for(var _=!1;;)switch(o){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return te(h).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return c*2;case"hex":return c>>>1;case"base64":return x(h).length;default:if(_)return y?-1:te(h).length;o=(""+o).toLowerCase(),_=!0}}a.byteLength=q;function re(h,o,c){var y=!1;if((o===void 0||o<0)&&(o=0),o>this.length||((c===void 0||c>this.length)&&(c=this.length),c<=0)||(c>>>=0,o>>>=0,c<=o))return"";for(h||(h="utf8");;)switch(h){case"hex":return ie(this,o,c);case"utf8":case"utf-8":return U(this,o,c);case"ascii":return H(this,o,c);case"latin1":case"binary":return D(this,o,c);case"base64":return I(this,o,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return we(this,o,c);default:if(y)throw new TypeError("Unknown encoding: "+h);h=(h+"").toLowerCase(),y=!0}}a.prototype._isBuffer=!0;function P(h,o,c){var y=h[o];h[o]=h[c],h[c]=y}a.prototype.swap16=function(){var o=this.length;if(o%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var c=0;c<o;c+=2)P(this,c,c+1);return this},a.prototype.swap32=function(){var o=this.length;if(o%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var c=0;c<o;c+=4)P(this,c,c+3),P(this,c+1,c+2);return this},a.prototype.swap64=function(){var o=this.length;if(o%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var c=0;c<o;c+=8)P(this,c,c+7),P(this,c+1,c+6),P(this,c+2,c+5),P(this,c+3,c+4);return this},a.prototype.toString=function(){var o=this.length;return o===0?"":arguments.length===0?U(this,0,o):re.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(o){if(!a.isBuffer(o))throw new TypeError("Argument must be a Buffer");return this===o?!0:a.compare(this,o)===0},a.prototype.inspect=function(){var o="",c=t.INSPECT_MAX_BYTES;return o=this.toString("hex",0,c).replace(/(.{2})/g,"$1 ").trim(),this.length>c&&(o+=" ... "),"<Buffer "+o+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(o,c,y,_,N){if($(o,Uint8Array)&&(o=a.from(o,o.offset,o.byteLength)),!a.isBuffer(o))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof o);if(c===void 0&&(c=0),y===void 0&&(y=o?o.length:0),_===void 0&&(_=0),N===void 0&&(N=this.length),c<0||y>o.length||_<0||N>this.length)throw new RangeError("out of range index");if(_>=N&&c>=y)return 0;if(_>=N)return-1;if(c>=y)return 1;if(c>>>=0,y>>>=0,_>>>=0,N>>>=0,this===o)return 0;for(var V=N-_,ne=y-c,pe=Math.min(V,ne),ye=this.slice(_,N),xe=o.slice(c,y),p=0;p<pe;++p)if(ye[p]!==xe[p]){V=ye[p],ne=xe[p];break}return V<ne?-1:ne<V?1:0};function L(h,o,c,y,_){if(h.length===0)return-1;if(typeof c=="string"?(y=c,c=0):c>2147483647?c=2147483647:c<-2147483648&&(c=-2147483648),c=+c,O(c)&&(c=_?0:h.length-1),c<0&&(c=h.length+c),c>=h.length){if(_)return-1;c=h.length-1}else if(c<0)if(_)c=0;else return-1;if(typeof o=="string"&&(o=a.from(o,y)),a.isBuffer(o))return o.length===0?-1:Z(h,o,c,y,_);if(typeof o=="number")return o=o&255,typeof Uint8Array.prototype.indexOf=="function"?_?Uint8Array.prototype.indexOf.call(h,o,c):Uint8Array.prototype.lastIndexOf.call(h,o,c):Z(h,[o],c,y,_);throw new TypeError("val must be string, number or Buffer")}function Z(h,o,c,y,_){var N=1,V=h.length,ne=o.length;if(y!==void 0&&(y=String(y).toLowerCase(),y==="ucs2"||y==="ucs-2"||y==="utf16le"||y==="utf-16le")){if(h.length<2||o.length<2)return-1;N=2,V/=2,ne/=2,c/=2}function pe(l,v){return N===1?l[v]:l.readUInt16BE(v*N)}var ye;if(_){var xe=-1;for(ye=c;ye<V;ye++)if(pe(h,ye)===pe(o,xe===-1?0:ye-xe)){if(xe===-1&&(xe=ye),ye-xe+1===ne)return xe*N}else xe!==-1&&(ye-=ye-xe),xe=-1}else for(c+ne>V&&(c=V-ne),ye=c;ye>=0;ye--){for(var p=!0,u=0;u<ne;u++)if(pe(h,ye+u)!==pe(o,u)){p=!1;break}if(p)return ye}return-1}a.prototype.includes=function(o,c,y){return this.indexOf(o,c,y)!==-1},a.prototype.indexOf=function(o,c,y){return L(this,o,c,y,!0)},a.prototype.lastIndexOf=function(o,c,y){return L(this,o,c,y,!1)};function J(h,o,c,y){c=Number(c)||0;var _=h.length-c;y?(y=Number(y),y>_&&(y=_)):y=_;var N=o.length;y>N/2&&(y=N/2);for(var V=0;V<y;++V){var ne=parseInt(o.substr(V*2,2),16);if(O(ne))return V;h[c+V]=ne}return V}function Q(h,o,c,y){return T(te(o,h.length-c),h,c,y)}function X(h,o,c,y){return T(ae(o),h,c,y)}function he(h,o,c,y){return T(x(o),h,c,y)}function le(h,o,c,y){return T(b(o,h.length-c),h,c,y)}a.prototype.write=function(o,c,y,_){if(c===void 0)_="utf8",y=this.length,c=0;else if(y===void 0&&typeof c=="string")_=c,y=this.length,c=0;else if(isFinite(c))c=c>>>0,isFinite(y)?(y=y>>>0,_===void 0&&(_="utf8")):(_=y,y=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var N=this.length-c;if((y===void 0||y>N)&&(y=N),o.length>0&&(y<0||c<0)||c>this.length)throw new RangeError("Attempt to write outside buffer bounds");_||(_="utf8");for(var V=!1;;)switch(_){case"hex":return J(this,o,c,y);case"utf8":case"utf-8":return Q(this,o,c,y);case"ascii":case"latin1":case"binary":return X(this,o,c,y);case"base64":return he(this,o,c,y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return le(this,o,c,y);default:if(V)throw new TypeError("Unknown encoding: "+_);_=(""+_).toLowerCase(),V=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(h,o,c){return o===0&&c===h.length?e.fromByteArray(h):e.fromByteArray(h.slice(o,c))}function U(h,o,c){c=Math.min(h.length,c);for(var y=[],_=o;_<c;){var N=h[_],V=null,ne=N>239?4:N>223?3:N>191?2:1;if(_+ne<=c){var pe,ye,xe,p;switch(ne){case 1:N<128&&(V=N);break;case 2:pe=h[_+1],(pe&192)===128&&(p=(N&31)<<6|pe&63,p>127&&(V=p));break;case 3:pe=h[_+1],ye=h[_+2],(pe&192)===128&&(ye&192)===128&&(p=(N&15)<<12|(pe&63)<<6|ye&63,p>2047&&(p<55296||p>57343)&&(V=p));break;case 4:pe=h[_+1],ye=h[_+2],xe=h[_+3],(pe&192)===128&&(ye&192)===128&&(xe&192)===128&&(p=(N&15)<<18|(pe&63)<<12|(ye&63)<<6|xe&63,p>65535&&p<1114112&&(V=p))}}V===null?(V=65533,ne=1):V>65535&&(V-=65536,y.push(V>>>10&1023|55296),V=56320|V&1023),y.push(V),_+=ne}return G(y)}var W=4096;function G(h){var o=h.length;if(o<=W)return String.fromCharCode.apply(String,h);for(var c="",y=0;y<o;)c+=String.fromCharCode.apply(String,h.slice(y,y+=W));return c}function H(h,o,c){var y="";c=Math.min(h.length,c);for(var _=o;_<c;++_)y+=String.fromCharCode(h[_]&127);return y}function D(h,o,c){var y="";c=Math.min(h.length,c);for(var _=o;_<c;++_)y+=String.fromCharCode(h[_]);return y}function ie(h,o,c){var y=h.length;(!o||o<0)&&(o=0),(!c||c<0||c>y)&&(c=y);for(var _="",N=o;N<c;++N)_+=k[h[N]];return _}function we(h,o,c){for(var y=h.slice(o,c),_="",N=0;N<y.length-1;N+=2)_+=String.fromCharCode(y[N]+y[N+1]*256);return _}a.prototype.slice=function(o,c){var y=this.length;o=~~o,c=c===void 0?y:~~c,o<0?(o+=y,o<0&&(o=0)):o>y&&(o=y),c<0?(c+=y,c<0&&(c=0)):c>y&&(c=y),c<o&&(c=o);var _=this.subarray(o,c);return Object.setPrototypeOf(_,a.prototype),_};function oe(h,o,c){if(h%1!==0||h<0)throw new RangeError("offset is not uint");if(h+o>c)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(o,c,y){o=o>>>0,c=c>>>0,y||oe(o,c,this.length);for(var _=this[o],N=1,V=0;++V<c&&(N*=256);)_+=this[o+V]*N;return _},a.prototype.readUintBE=a.prototype.readUIntBE=function(o,c,y){o=o>>>0,c=c>>>0,y||oe(o,c,this.length);for(var _=this[o+--c],N=1;c>0&&(N*=256);)_+=this[o+--c]*N;return _},a.prototype.readUint8=a.prototype.readUInt8=function(o,c){return o=o>>>0,c||oe(o,1,this.length),this[o]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(o,c){return o=o>>>0,c||oe(o,2,this.length),this[o]|this[o+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(o,c){return o=o>>>0,c||oe(o,2,this.length),this[o]<<8|this[o+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(o,c){return o=o>>>0,c||oe(o,4,this.length),(this[o]|this[o+1]<<8|this[o+2]<<16)+this[o+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(o,c){return o=o>>>0,c||oe(o,4,this.length),this[o]*16777216+(this[o+1]<<16|this[o+2]<<8|this[o+3])},a.prototype.readIntLE=function(o,c,y){o=o>>>0,c=c>>>0,y||oe(o,c,this.length);for(var _=this[o],N=1,V=0;++V<c&&(N*=256);)_+=this[o+V]*N;return N*=128,_>=N&&(_-=Math.pow(2,8*c)),_},a.prototype.readIntBE=function(o,c,y){o=o>>>0,c=c>>>0,y||oe(o,c,this.length);for(var _=c,N=1,V=this[o+--_];_>0&&(N*=256);)V+=this[o+--_]*N;return N*=128,V>=N&&(V-=Math.pow(2,8*c)),V},a.prototype.readInt8=function(o,c){return o=o>>>0,c||oe(o,1,this.length),this[o]&128?(255-this[o]+1)*-1:this[o]},a.prototype.readInt16LE=function(o,c){o=o>>>0,c||oe(o,2,this.length);var y=this[o]|this[o+1]<<8;return y&32768?y|4294901760:y},a.prototype.readInt16BE=function(o,c){o=o>>>0,c||oe(o,2,this.length);var y=this[o+1]|this[o]<<8;return y&32768?y|4294901760:y},a.prototype.readInt32LE=function(o,c){return o=o>>>0,c||oe(o,4,this.length),this[o]|this[o+1]<<8|this[o+2]<<16|this[o+3]<<24},a.prototype.readInt32BE=function(o,c){return o=o>>>0,c||oe(o,4,this.length),this[o]<<24|this[o+1]<<16|this[o+2]<<8|this[o+3]},a.prototype.readFloatLE=function(o,c){return o=o>>>0,c||oe(o,4,this.length),r.read(this,o,!0,23,4)},a.prototype.readFloatBE=function(o,c){return o=o>>>0,c||oe(o,4,this.length),r.read(this,o,!1,23,4)},a.prototype.readDoubleLE=function(o,c){return o=o>>>0,c||oe(o,8,this.length),r.read(this,o,!0,52,8)},a.prototype.readDoubleBE=function(o,c){return o=o>>>0,c||oe(o,8,this.length),r.read(this,o,!1,52,8)};function fe(h,o,c,y,_,N){if(!a.isBuffer(h))throw new TypeError('"buffer" argument must be a Buffer instance');if(o>_||o<N)throw new RangeError('"value" argument is out of bounds');if(c+y>h.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(o,c,y,_){if(o=+o,c=c>>>0,y=y>>>0,!_){var N=Math.pow(2,8*y)-1;fe(this,o,c,y,N,0)}var V=1,ne=0;for(this[c]=o&255;++ne<y&&(V*=256);)this[c+ne]=o/V&255;return c+y},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(o,c,y,_){if(o=+o,c=c>>>0,y=y>>>0,!_){var N=Math.pow(2,8*y)-1;fe(this,o,c,y,N,0)}var V=y-1,ne=1;for(this[c+V]=o&255;--V>=0&&(ne*=256);)this[c+V]=o/ne&255;return c+y},a.prototype.writeUint8=a.prototype.writeUInt8=function(o,c,y){return o=+o,c=c>>>0,y||fe(this,o,c,1,255,0),this[c]=o&255,c+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(o,c,y){return o=+o,c=c>>>0,y||fe(this,o,c,2,65535,0),this[c]=o&255,this[c+1]=o>>>8,c+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(o,c,y){return o=+o,c=c>>>0,y||fe(this,o,c,2,65535,0),this[c]=o>>>8,this[c+1]=o&255,c+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(o,c,y){return o=+o,c=c>>>0,y||fe(this,o,c,4,4294967295,0),this[c+3]=o>>>24,this[c+2]=o>>>16,this[c+1]=o>>>8,this[c]=o&255,c+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(o,c,y){return o=+o,c=c>>>0,y||fe(this,o,c,4,4294967295,0),this[c]=o>>>24,this[c+1]=o>>>16,this[c+2]=o>>>8,this[c+3]=o&255,c+4},a.prototype.writeIntLE=function(o,c,y,_){if(o=+o,c=c>>>0,!_){var N=Math.pow(2,8*y-1);fe(this,o,c,y,N-1,-N)}var V=0,ne=1,pe=0;for(this[c]=o&255;++V<y&&(ne*=256);)o<0&&pe===0&&this[c+V-1]!==0&&(pe=1),this[c+V]=(o/ne>>0)-pe&255;return c+y},a.prototype.writeIntBE=function(o,c,y,_){if(o=+o,c=c>>>0,!_){var N=Math.pow(2,8*y-1);fe(this,o,c,y,N-1,-N)}var V=y-1,ne=1,pe=0;for(this[c+V]=o&255;--V>=0&&(ne*=256);)o<0&&pe===0&&this[c+V+1]!==0&&(pe=1),this[c+V]=(o/ne>>0)-pe&255;return c+y},a.prototype.writeInt8=function(o,c,y){return o=+o,c=c>>>0,y||fe(this,o,c,1,127,-128),o<0&&(o=255+o+1),this[c]=o&255,c+1},a.prototype.writeInt16LE=function(o,c,y){return o=+o,c=c>>>0,y||fe(this,o,c,2,32767,-32768),this[c]=o&255,this[c+1]=o>>>8,c+2},a.prototype.writeInt16BE=function(o,c,y){return o=+o,c=c>>>0,y||fe(this,o,c,2,32767,-32768),this[c]=o>>>8,this[c+1]=o&255,c+2},a.prototype.writeInt32LE=function(o,c,y){return o=+o,c=c>>>0,y||fe(this,o,c,4,2147483647,-2147483648),this[c]=o&255,this[c+1]=o>>>8,this[c+2]=o>>>16,this[c+3]=o>>>24,c+4},a.prototype.writeInt32BE=function(o,c,y){return o=+o,c=c>>>0,y||fe(this,o,c,4,2147483647,-2147483648),o<0&&(o=4294967295+o+1),this[c]=o>>>24,this[c+1]=o>>>16,this[c+2]=o>>>8,this[c+3]=o&255,c+4};function ee(h,o,c,y,_,N){if(c+y>h.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("Index out of range")}function m(h,o,c,y,_){return o=+o,c=c>>>0,_||ee(h,o,c,4),r.write(h,o,c,y,23,4),c+4}a.prototype.writeFloatLE=function(o,c,y){return m(this,o,c,!0,y)},a.prototype.writeFloatBE=function(o,c,y){return m(this,o,c,!1,y)};function se(h,o,c,y,_){return o=+o,c=c>>>0,_||ee(h,o,c,8),r.write(h,o,c,y,52,8),c+8}a.prototype.writeDoubleLE=function(o,c,y){return se(this,o,c,!0,y)},a.prototype.writeDoubleBE=function(o,c,y){return se(this,o,c,!1,y)},a.prototype.copy=function(o,c,y,_){if(!a.isBuffer(o))throw new TypeError("argument should be a Buffer");if(y||(y=0),!_&&_!==0&&(_=this.length),c>=o.length&&(c=o.length),c||(c=0),_>0&&_<y&&(_=y),_===y||o.length===0||this.length===0)return 0;if(c<0)throw new RangeError("targetStart out of bounds");if(y<0||y>=this.length)throw new RangeError("Index out of range");if(_<0)throw new RangeError("sourceEnd out of bounds");_>this.length&&(_=this.length),o.length-c<_-y&&(_=o.length-c+y);var N=_-y;return this===o&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(c,y,_):Uint8Array.prototype.set.call(o,this.subarray(y,_),c),N},a.prototype.fill=function(o,c,y,_){if(typeof o=="string"){if(typeof c=="string"?(_=c,c=0,y=this.length):typeof y=="string"&&(_=y,y=this.length),_!==void 0&&typeof _!="string")throw new TypeError("encoding must be a string");if(typeof _=="string"&&!a.isEncoding(_))throw new TypeError("Unknown encoding: "+_);if(o.length===1){var N=o.charCodeAt(0);(_==="utf8"&&N<128||_==="latin1")&&(o=N)}}else typeof o=="number"?o=o&255:typeof o=="boolean"&&(o=Number(o));if(c<0||this.length<c||this.length<y)throw new RangeError("Out of range index");if(y<=c)return this;c=c>>>0,y=y===void 0?this.length:y>>>0,o||(o=0);var V;if(typeof o=="number")for(V=c;V<y;++V)this[V]=o;else{var ne=a.isBuffer(o)?o:a.from(o,_),pe=ne.length;if(pe===0)throw new TypeError('The value "'+o+'" is invalid for argument "value"');for(V=0;V<y-c;++V)this[V+c]=ne[V%pe]}return this};var ue=/[^+/0-9A-Za-z-_]/g;function de(h){if(h=h.split("=")[0],h=h.trim().replace(ue,""),h.length<2)return"";for(;h.length%4!==0;)h=h+"=";return h}function te(h,o){o=o||1/0;for(var c,y=h.length,_=null,N=[],V=0;V<y;++V){if(c=h.charCodeAt(V),c>55295&&c<57344){if(!_){if(c>56319){(o-=3)>-1&&N.push(239,191,189);continue}else if(V+1===y){(o-=3)>-1&&N.push(239,191,189);continue}_=c;continue}if(c<56320){(o-=3)>-1&&N.push(239,191,189),_=c;continue}c=(_-55296<<10|c-56320)+65536}else _&&(o-=3)>-1&&N.push(239,191,189);if(_=null,c<128){if((o-=1)<0)break;N.push(c)}else if(c<2048){if((o-=2)<0)break;N.push(c>>6|192,c&63|128)}else if(c<65536){if((o-=3)<0)break;N.push(c>>12|224,c>>6&63|128,c&63|128)}else if(c<1114112){if((o-=4)<0)break;N.push(c>>18|240,c>>12&63|128,c>>6&63|128,c&63|128)}else throw new Error("Invalid code point")}return N}function ae(h){for(var o=[],c=0;c<h.length;++c)o.push(h.charCodeAt(c)&255);return o}function b(h,o){for(var c,y,_,N=[],V=0;V<h.length&&!((o-=2)<0);++V)c=h.charCodeAt(V),y=c>>8,_=c%256,N.push(_),N.push(y);return N}function x(h){return e.toByteArray(de(h))}function T(h,o,c,y){for(var _=0;_<y&&!(_+c>=o.length||_>=h.length);++_)o[_+c]=h[_];return _}function $(h,o){return h instanceof o||h!=null&&h.constructor!=null&&h.constructor.name!=null&&h.constructor.name===o.name}function O(h){return h!==h}var k=function(){for(var h="0123456789abcdef",o=new Array(256),c=0;c<16;++c)for(var y=c*16,_=0;_<16;++_)o[y+_]=h[c]+h[_];return o}()})(Un);var _c={exports:{}};(function(t){(function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,f="[BigNumber Error] ",a=f+"Number primitive has more than 15 significant digits: ",d=1e14,g=14,E=9007199254740991,A=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],S=1e7,B=1e9;function w(L){var Z,J,Q,X=m.prototype={constructor:m,toString:null,valueOf:null},he=new m(1),le=20,I=4,U=-7,W=21,G=-1e7,H=1e7,D=!1,ie=1,we=0,oe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},fe="0123456789abcdefghijklmnopqrstuvwxyz",ee=!0;function m(b,x){var T,$,O,k,h,o,c,y,_=this;if(!(_ instanceof m))return new m(b,x);if(x==null){if(b&&b._isBigNumber===!0){_.s=b.s,!b.c||b.e>H?_.c=_.e=null:b.e<G?_.c=[_.e=0]:(_.e=b.e,_.c=b.c.slice());return}if((o=typeof b=="number")&&b*0==0){if(_.s=1/b<0?(b=-b,-1):1,b===~~b){for(k=0,h=b;h>=10;h/=10,k++);k>H?_.c=_.e=null:(_.e=k,_.c=[b]);return}y=String(b)}else{if(!n.test(y=String(b)))return Q(_,y,o);_.s=y.charCodeAt(0)==45?(y=y.slice(1),-1):1}(k=y.indexOf("."))>-1&&(y=y.replace(".","")),(h=y.search(/e/i))>0?(k<0&&(k=h),k+=+y.slice(h+1),y=y.substring(0,h)):k<0&&(k=y.length)}else{if(z(x,2,fe.length,"Base"),x==10&&ee)return _=new m(b),te(_,le+_.e+1,I);if(y=String(b),o=typeof b=="number"){if(b*0!=0)return Q(_,y,o,x);if(_.s=1/b<0?(y=y.slice(1),-1):1,m.DEBUG&&y.replace(/^0\.0*|\./,"").length>15)throw Error(a+b)}else _.s=y.charCodeAt(0)===45?(y=y.slice(1),-1):1;for(T=fe.slice(0,x),k=h=0,c=y.length;h<c;h++)if(T.indexOf($=y.charAt(h))<0){if($=="."){if(h>k){k=c;continue}}else if(!O&&(y==y.toUpperCase()&&(y=y.toLowerCase())||y==y.toLowerCase()&&(y=y.toUpperCase()))){O=!0,h=-1,k=0;continue}return Q(_,String(b),o,x)}o=!1,y=J(y,x,10,_.s),(k=y.indexOf("."))>-1?y=y.replace(".",""):k=y.length}for(h=0;y.charCodeAt(h)===48;h++);for(c=y.length;y.charCodeAt(--c)===48;);if(y=y.slice(h,++c)){if(c-=h,o&&m.DEBUG&&c>15&&(b>E||b!==s(b)))throw Error(a+_.s*b);if((k=k-h-1)>H)_.c=_.e=null;else if(k<G)_.c=[_.e=0];else{if(_.e=k,_.c=[],h=(k+1)%g,k<0&&(h+=g),h<c){for(h&&_.c.push(+y.slice(0,h)),c-=g;h<c;)_.c.push(+y.slice(h,h+=g));h=g-(y=y.slice(h)).length}else h-=c;for(;h--;y+="0");_.c.push(+y)}}else _.c=[_.e=0]}m.clone=w,m.ROUND_UP=0,m.ROUND_DOWN=1,m.ROUND_CEIL=2,m.ROUND_FLOOR=3,m.ROUND_HALF_UP=4,m.ROUND_HALF_DOWN=5,m.ROUND_HALF_EVEN=6,m.ROUND_HALF_CEIL=7,m.ROUND_HALF_FLOOR=8,m.EUCLID=9,m.config=m.set=function(b){var x,T;if(b!=null)if(typeof b=="object"){if(b.hasOwnProperty(x="DECIMAL_PLACES")&&(T=b[x],z(T,0,B,x),le=T),b.hasOwnProperty(x="ROUNDING_MODE")&&(T=b[x],z(T,0,8,x),I=T),b.hasOwnProperty(x="EXPONENTIAL_AT")&&(T=b[x],T&&T.pop?(z(T[0],-B,0,x),z(T[1],0,B,x),U=T[0],W=T[1]):(z(T,-B,B,x),U=-(W=T<0?-T:T))),b.hasOwnProperty(x="RANGE"))if(T=b[x],T&&T.pop)z(T[0],-B,-1,x),z(T[1],1,B,x),G=T[0],H=T[1];else if(z(T,-B,B,x),T)G=-(H=T<0?-T:T);else throw Error(f+x+" cannot be zero: "+T);if(b.hasOwnProperty(x="CRYPTO"))if(T=b[x],T===!!T)if(T)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))D=T;else throw D=!T,Error(f+"crypto unavailable");else D=T;else throw Error(f+x+" not true or false: "+T);if(b.hasOwnProperty(x="MODULO_MODE")&&(T=b[x],z(T,0,9,x),ie=T),b.hasOwnProperty(x="POW_PRECISION")&&(T=b[x],z(T,0,B,x),we=T),b.hasOwnProperty(x="FORMAT"))if(T=b[x],typeof T=="object")oe=T;else throw Error(f+x+" not an object: "+T);if(b.hasOwnProperty(x="ALPHABET"))if(T=b[x],typeof T=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(T))ee=T.slice(0,10)=="0123456789",fe=T;else throw Error(f+x+" invalid: "+T)}else throw Error(f+"Object expected: "+b);return{DECIMAL_PLACES:le,ROUNDING_MODE:I,EXPONENTIAL_AT:[U,W],RANGE:[G,H],CRYPTO:D,MODULO_MODE:ie,POW_PRECISION:we,FORMAT:oe,ALPHABET:fe}},m.isBigNumber=function(b){if(!b||b._isBigNumber!==!0)return!1;if(!m.DEBUG)return!0;var x,T,$=b.c,O=b.e,k=b.s;e:if({}.toString.call($)=="[object Array]"){if((k===1||k===-1)&&O>=-B&&O<=B&&O===s(O)){if($[0]===0){if(O===0&&$.length===1)return!0;break e}if(x=(O+1)%g,x<1&&(x+=g),String($[0]).length==x){for(x=0;x<$.length;x++)if(T=$[x],T<0||T>=d||T!==s(T))break e;if(T!==0)return!0}}}else if($===null&&O===null&&(k===null||k===1||k===-1))return!0;throw Error(f+"Invalid BigNumber: "+b)},m.maximum=m.max=function(){return ue(arguments,-1)},m.minimum=m.min=function(){return ue(arguments,1)},m.random=function(){var b=9007199254740992,x=Math.random()*b&2097151?function(){return s(Math.random()*b)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(T){var $,O,k,h,o,c=0,y=[],_=new m(he);if(T==null?T=le:z(T,0,B),h=i(T/g),D)if(crypto.getRandomValues){for($=crypto.getRandomValues(new Uint32Array(h*=2));c<h;)o=$[c]*131072+($[c+1]>>>11),o>=9e15?(O=crypto.getRandomValues(new Uint32Array(2)),$[c]=O[0],$[c+1]=O[1]):(y.push(o%1e14),c+=2);c=h/2}else if(crypto.randomBytes){for($=crypto.randomBytes(h*=7);c<h;)o=($[c]&31)*281474976710656+$[c+1]*1099511627776+$[c+2]*4294967296+$[c+3]*16777216+($[c+4]<<16)+($[c+5]<<8)+$[c+6],o>=9e15?crypto.randomBytes(7).copy($,c):(y.push(o%1e14),c+=7);c=h/7}else throw D=!1,Error(f+"crypto unavailable");if(!D)for(;c<h;)o=x(),o<9e15&&(y[c++]=o%1e14);for(h=y[--c],T%=g,h&&T&&(o=A[g-T],y[c]=s(h/o)*o);y[c]===0;y.pop(),c--);if(c<0)y=[k=0];else{for(k=-1;y[0]===0;y.splice(0,1),k-=g);for(c=1,o=y[0];o>=10;o/=10,c++);c<g&&(k-=g-c)}return _.e=k,_.c=y,_}}(),m.sum=function(){for(var b=1,x=arguments,T=new m(x[0]);b<x.length;)T=T.plus(x[b++]);return T},J=function(){var b="0123456789";function x(T,$,O,k){for(var h,o=[0],c,y=0,_=T.length;y<_;){for(c=o.length;c--;o[c]*=$);for(o[0]+=k.indexOf(T.charAt(y++)),h=0;h<o.length;h++)o[h]>O-1&&(o[h+1]==null&&(o[h+1]=0),o[h+1]+=o[h]/O|0,o[h]%=O)}return o.reverse()}return function(T,$,O,k,h){var o,c,y,_,N,V,ne,pe,ye=T.indexOf("."),xe=le,p=I;for(ye>=0&&(_=we,we=0,T=T.replace(".",""),pe=new m($),V=pe.pow(T.length-ye),we=_,pe.c=x(P(C(V.c),V.e,"0"),10,O,b),pe.e=pe.c.length),ne=x(T,$,O,h?(o=fe,b):(o=b,fe)),y=_=ne.length;ne[--_]==0;ne.pop());if(!ne[0])return o.charAt(0);if(ye<0?--y:(V.c=ne,V.e=y,V.s=k,V=Z(V,pe,xe,p,O),ne=V.c,N=V.r,y=V.e),c=y+xe+1,ye=ne[c],_=O/2,N=N||c<0||ne[c+1]!=null,N=p<4?(ye!=null||N)&&(p==0||p==(V.s<0?3:2)):ye>_||ye==_&&(p==4||N||p==6&&ne[c-1]&1||p==(V.s<0?8:7)),c<1||!ne[0])T=N?P(o.charAt(1),-xe,o.charAt(0)):o.charAt(0);else{if(ne.length=c,N)for(--O;++ne[--c]>O;)ne[c]=0,c||(++y,ne=[1].concat(ne));for(_=ne.length;!ne[--_];);for(ye=0,T="";ye<=_;T+=o.charAt(ne[ye++]));T=P(T,y,o.charAt(0))}return T}}(),Z=function(){function b($,O,k){var h,o,c,y,_=0,N=$.length,V=O%S,ne=O/S|0;for($=$.slice();N--;)c=$[N]%S,y=$[N]/S|0,h=ne*c+y*V,o=V*c+h%S*S+_,_=(o/k|0)+(h/S|0)+ne*y,$[N]=o%k;return _&&($=[_].concat($)),$}function x($,O,k,h){var o,c;if(k!=h)c=k>h?1:-1;else for(o=c=0;o<k;o++)if($[o]!=O[o]){c=$[o]>O[o]?1:-1;break}return c}function T($,O,k,h){for(var o=0;k--;)$[k]-=o,o=$[k]<O[k]?1:0,$[k]=o*h+$[k]-O[k];for(;!$[0]&&$.length>1;$.splice(0,1));}return function($,O,k,h,o){var c,y,_,N,V,ne,pe,ye,xe,p,u,l,v,F,K,j,_e,Be=$.s==O.s?1:-1,Ee=$.c,be=O.c;if(!Ee||!Ee[0]||!be||!be[0])return new m(!$.s||!O.s||(Ee?be&&Ee[0]==be[0]:!be)?NaN:Ee&&Ee[0]==0||!be?Be*0:Be/0);for(ye=new m(Be),xe=ye.c=[],y=$.e-O.e,Be=k+y+1,o||(o=d,y=M($.e/g)-M(O.e/g),Be=Be/g|0),_=0;be[_]==(Ee[_]||0);_++);if(be[_]>(Ee[_]||0)&&y--,Be<0)xe.push(1),N=!0;else{for(F=Ee.length,j=be.length,_=0,Be+=2,V=s(o/(be[0]+1)),V>1&&(be=b(be,V,o),Ee=b(Ee,V,o),j=be.length,F=Ee.length),v=j,p=Ee.slice(0,j),u=p.length;u<j;p[u++]=0);_e=be.slice(),_e=[0].concat(_e),K=be[0],be[1]>=o/2&&K++;do{if(V=0,c=x(be,p,j,u),c<0){if(l=p[0],j!=u&&(l=l*o+(p[1]||0)),V=s(l/K),V>1)for(V>=o&&(V=o-1),ne=b(be,V,o),pe=ne.length,u=p.length;x(ne,p,pe,u)==1;)V--,T(ne,j<pe?_e:be,pe,o),pe=ne.length,c=1;else V==0&&(c=V=1),ne=be.slice(),pe=ne.length;if(pe<u&&(ne=[0].concat(ne)),T(p,ne,u,o),u=p.length,c==-1)for(;x(be,p,j,u)<1;)V++,T(p,j<u?_e:be,u,o),u=p.length}else c===0&&(V++,p=[0]);xe[_++]=V,p[0]?p[u++]=Ee[v]||0:(p=[Ee[v]],u=1)}while((v++<F||p[0]!=null)&&Be--);N=p[0]!=null,xe[0]||xe.splice(0,1)}if(o==d){for(_=1,Be=xe[0];Be>=10;Be/=10,_++);te(ye,k+(ye.e=_+y*g-1)+1,h,N)}else ye.e=y,ye.r=+N;return ye}}();function se(b,x,T,$){var O,k,h,o,c;if(T==null?T=I:z(T,0,8),!b.c)return b.toString();if(O=b.c[0],h=b.e,x==null)c=C(b.c),c=$==1||$==2&&(h<=U||h>=W)?re(c,h):P(c,h,"0");else if(b=te(new m(b),x,T),k=b.e,c=C(b.c),o=c.length,$==1||$==2&&(x<=k||k<=U)){for(;o<x;c+="0",o++);c=re(c,k)}else if(x-=h,c=P(c,k,"0"),k+1>o){if(--x>0)for(c+=".";x--;c+="0");}else if(x+=k-o,x>0)for(k+1==o&&(c+=".");x--;c+="0");return b.s<0&&O?"-"+c:c}function ue(b,x){for(var T,$,O=1,k=new m(b[0]);O<b.length;O++)$=new m(b[O]),(!$.s||(T=Y(k,$))===x||T===0&&k.s===x)&&(k=$);return k}function de(b,x,T){for(var $=1,O=x.length;!x[--O];x.pop());for(O=x[0];O>=10;O/=10,$++);return(T=$+T*g-1)>H?b.c=b.e=null:T<G?b.c=[b.e=0]:(b.e=T,b.c=x),b}Q=function(){var b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,x=/^([^.]+)\.$/,T=/^\.([^.]+)$/,$=/^-?(Infinity|NaN)$/,O=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(k,h,o,c){var y,_=o?h:h.replace(O,"");if($.test(_))k.s=isNaN(_)?null:_<0?-1:1;else{if(!o&&(_=_.replace(b,function(N,V,ne){return y=(ne=ne.toLowerCase())=="x"?16:ne=="b"?2:8,!c||c==y?V:N}),c&&(y=c,_=_.replace(x,"$1").replace(T,"0.$1")),h!=_))return new m(_,y);if(m.DEBUG)throw Error(f+"Not a"+(c?" base "+c:"")+" number: "+h);k.s=null}k.c=k.e=null}}();function te(b,x,T,$){var O,k,h,o,c,y,_,N=b.c,V=A;if(N){e:{for(O=1,o=N[0];o>=10;o/=10,O++);if(k=x-O,k<0)k+=g,h=x,c=N[y=0],_=s(c/V[O-h-1]%10);else if(y=i((k+1)/g),y>=N.length)if($){for(;N.length<=y;N.push(0));c=_=0,O=1,k%=g,h=k-g+1}else break e;else{for(c=o=N[y],O=1;o>=10;o/=10,O++);k%=g,h=k-g+O,_=h<0?0:s(c/V[O-h-1]%10)}if($=$||x<0||N[y+1]!=null||(h<0?c:c%V[O-h-1]),$=T<4?(_||$)&&(T==0||T==(b.s<0?3:2)):_>5||_==5&&(T==4||$||T==6&&(k>0?h>0?c/V[O-h]:0:N[y-1])%10&1||T==(b.s<0?8:7)),x<1||!N[0])return N.length=0,$?(x-=b.e+1,N[0]=V[(g-x%g)%g],b.e=-x||0):N[0]=b.e=0,b;if(k==0?(N.length=y,o=1,y--):(N.length=y+1,o=V[g-k],N[y]=h>0?s(c/V[O-h]%V[h])*o:0),$)for(;;)if(y==0){for(k=1,h=N[0];h>=10;h/=10,k++);for(h=N[0]+=o,o=1;h>=10;h/=10,o++);k!=o&&(b.e++,N[0]==d&&(N[0]=1));break}else{if(N[y]+=o,N[y]!=d)break;N[y--]=0,o=1}for(k=N.length;N[--k]===0;N.pop());}b.e>H?b.c=b.e=null:b.e<G&&(b.c=[b.e=0])}return b}function ae(b){var x,T=b.e;return T===null?b.toString():(x=C(b.c),x=T<=U||T>=W?re(x,T):P(x,T,"0"),b.s<0?"-"+x:x)}return X.absoluteValue=X.abs=function(){var b=new m(this);return b.s<0&&(b.s=1),b},X.comparedTo=function(b,x){return Y(this,new m(b,x))},X.decimalPlaces=X.dp=function(b,x){var T,$,O,k=this;if(b!=null)return z(b,0,B),x==null?x=I:z(x,0,8),te(new m(k),b+k.e+1,x);if(!(T=k.c))return null;if($=((O=T.length-1)-M(this.e/g))*g,O=T[O])for(;O%10==0;O/=10,$--);return $<0&&($=0),$},X.dividedBy=X.div=function(b,x){return Z(this,new m(b,x),le,I)},X.dividedToIntegerBy=X.idiv=function(b,x){return Z(this,new m(b,x),0,1)},X.exponentiatedBy=X.pow=function(b,x){var T,$,O,k,h,o,c,y,_,N=this;if(b=new m(b),b.c&&!b.isInteger())throw Error(f+"Exponent not an integer: "+ae(b));if(x!=null&&(x=new m(x)),o=b.e>14,!N.c||!N.c[0]||N.c[0]==1&&!N.e&&N.c.length==1||!b.c||!b.c[0])return _=new m(Math.pow(+ae(N),o?b.s*(2-q(b)):+ae(b))),x?_.mod(x):_;if(c=b.s<0,x){if(x.c?!x.c[0]:!x.s)return new m(NaN);$=!c&&N.isInteger()&&x.isInteger(),$&&(N=N.mod(x))}else{if(b.e>9&&(N.e>0||N.e<-1||(N.e==0?N.c[0]>1||o&&N.c[1]>=24e7:N.c[0]<8e13||o&&N.c[0]<=9999975e7)))return k=N.s<0&&q(b)?-0:0,N.e>-1&&(k=1/k),new m(c?1/k:k);we&&(k=i(we/g+2))}for(o?(T=new m(.5),c&&(b.s=1),y=q(b)):(O=Math.abs(+ae(b)),y=O%2),_=new m(he);;){if(y){if(_=_.times(N),!_.c)break;k?_.c.length>k&&(_.c.length=k):$&&(_=_.mod(x))}if(O){if(O=s(O/2),O===0)break;y=O%2}else if(b=b.times(T),te(b,b.e+1,1),b.e>14)y=q(b);else{if(O=+ae(b),O===0)break;y=O%2}N=N.times(N),k?N.c&&N.c.length>k&&(N.c.length=k):$&&(N=N.mod(x))}return $?_:(c&&(_=he.div(_)),x?_.mod(x):k?te(_,we,I,h):_)},X.integerValue=function(b){var x=new m(this);return b==null?b=I:z(b,0,8),te(x,x.e+1,b)},X.isEqualTo=X.eq=function(b,x){return Y(this,new m(b,x))===0},X.isFinite=function(){return!!this.c},X.isGreaterThan=X.gt=function(b,x){return Y(this,new m(b,x))>0},X.isGreaterThanOrEqualTo=X.gte=function(b,x){return(x=Y(this,new m(b,x)))===1||x===0},X.isInteger=function(){return!!this.c&&M(this.e/g)>this.c.length-2},X.isLessThan=X.lt=function(b,x){return Y(this,new m(b,x))<0},X.isLessThanOrEqualTo=X.lte=function(b,x){return(x=Y(this,new m(b,x)))===-1||x===0},X.isNaN=function(){return!this.s},X.isNegative=function(){return this.s<0},X.isPositive=function(){return this.s>0},X.isZero=function(){return!!this.c&&this.c[0]==0},X.minus=function(b,x){var T,$,O,k,h=this,o=h.s;if(b=new m(b,x),x=b.s,!o||!x)return new m(NaN);if(o!=x)return b.s=-x,h.plus(b);var c=h.e/g,y=b.e/g,_=h.c,N=b.c;if(!c||!y){if(!_||!N)return _?(b.s=-x,b):new m(N?h:NaN);if(!_[0]||!N[0])return N[0]?(b.s=-x,b):new m(_[0]?h:I==3?-0:0)}if(c=M(c),y=M(y),_=_.slice(),o=c-y){for((k=o<0)?(o=-o,O=_):(y=c,O=N),O.reverse(),x=o;x--;O.push(0));O.reverse()}else for($=(k=(o=_.length)<(x=N.length))?o:x,o=x=0;x<$;x++)if(_[x]!=N[x]){k=_[x]<N[x];break}if(k&&(O=_,_=N,N=O,b.s=-b.s),x=($=N.length)-(T=_.length),x>0)for(;x--;_[T++]=0);for(x=d-1;$>o;){if(_[--$]<N[$]){for(T=$;T&&!_[--T];_[T]=x);--_[T],_[$]+=d}_[$]-=N[$]}for(;_[0]==0;_.splice(0,1),--y);return _[0]?de(b,_,y):(b.s=I==3?-1:1,b.c=[b.e=0],b)},X.modulo=X.mod=function(b,x){var T,$,O=this;return b=new m(b,x),!O.c||!b.s||b.c&&!b.c[0]?new m(NaN):!b.c||O.c&&!O.c[0]?new m(O):(ie==9?($=b.s,b.s=1,T=Z(O,b,0,3),b.s=$,T.s*=$):T=Z(O,b,0,ie),b=O.minus(T.times(b)),!b.c[0]&&ie==1&&(b.s=O.s),b)},X.multipliedBy=X.times=function(b,x){var T,$,O,k,h,o,c,y,_,N,V,ne,pe,ye,xe,p=this,u=p.c,l=(b=new m(b,x)).c;if(!u||!l||!u[0]||!l[0])return!p.s||!b.s||u&&!u[0]&&!l||l&&!l[0]&&!u?b.c=b.e=b.s=null:(b.s*=p.s,!u||!l?b.c=b.e=null:(b.c=[0],b.e=0)),b;for($=M(p.e/g)+M(b.e/g),b.s*=p.s,c=u.length,N=l.length,c<N&&(pe=u,u=l,l=pe,O=c,c=N,N=O),O=c+N,pe=[];O--;pe.push(0));for(ye=d,xe=S,O=N;--O>=0;){for(T=0,V=l[O]%xe,ne=l[O]/xe|0,h=c,k=O+h;k>O;)y=u[--h]%xe,_=u[h]/xe|0,o=ne*y+_*V,y=V*y+o%xe*xe+pe[k]+T,T=(y/ye|0)+(o/xe|0)+ne*_,pe[k--]=y%ye;pe[k]=T}return T?++$:pe.splice(0,1),de(b,pe,$)},X.negated=function(){var b=new m(this);return b.s=-b.s||null,b},X.plus=function(b,x){var T,$=this,O=$.s;if(b=new m(b,x),x=b.s,!O||!x)return new m(NaN);if(O!=x)return b.s=-x,$.minus(b);var k=$.e/g,h=b.e/g,o=$.c,c=b.c;if(!k||!h){if(!o||!c)return new m(O/0);if(!o[0]||!c[0])return c[0]?b:new m(o[0]?$:O*0)}if(k=M(k),h=M(h),o=o.slice(),O=k-h){for(O>0?(h=k,T=c):(O=-O,T=o),T.reverse();O--;T.push(0));T.reverse()}for(O=o.length,x=c.length,O-x<0&&(T=c,c=o,o=T,x=O),O=0;x;)O=(o[--x]=o[x]+c[x]+O)/d|0,o[x]=d===o[x]?0:o[x]%d;return O&&(o=[O].concat(o),++h),de(b,o,h)},X.precision=X.sd=function(b,x){var T,$,O,k=this;if(b!=null&&b!==!!b)return z(b,1,B),x==null?x=I:z(x,0,8),te(new m(k),b,x);if(!(T=k.c))return null;if(O=T.length-1,$=O*g+1,O=T[O]){for(;O%10==0;O/=10,$--);for(O=T[0];O>=10;O/=10,$++);}return b&&k.e+1>$&&($=k.e+1),$},X.shiftedBy=function(b){return z(b,-E,E),this.times("1e"+b)},X.squareRoot=X.sqrt=function(){var b,x,T,$,O,k=this,h=k.c,o=k.s,c=k.e,y=le+4,_=new m("0.5");if(o!==1||!h||!h[0])return new m(!o||o<0&&(!h||h[0])?NaN:h?k:1/0);if(o=Math.sqrt(+ae(k)),o==0||o==1/0?(x=C(h),(x.length+c)%2==0&&(x+="0"),o=Math.sqrt(+x),c=M((c+1)/2)-(c<0||c%2),o==1/0?x="5e"+c:(x=o.toExponential(),x=x.slice(0,x.indexOf("e")+1)+c),T=new m(x)):T=new m(o+""),T.c[0]){for(c=T.e,o=c+y,o<3&&(o=0);;)if(O=T,T=_.times(O.plus(Z(k,O,y,1))),C(O.c).slice(0,o)===(x=C(T.c)).slice(0,o))if(T.e<c&&--o,x=x.slice(o-3,o+1),x=="9999"||!$&&x=="4999"){if(!$&&(te(O,O.e+le+2,0),O.times(O).eq(k))){T=O;break}y+=4,o+=4,$=1}else{(!+x||!+x.slice(1)&&x.charAt(0)=="5")&&(te(T,T.e+le+2,1),b=!T.times(T).eq(k));break}}return te(T,T.e+le+1,I,b)},X.toExponential=function(b,x){return b!=null&&(z(b,0,B),b++),se(this,b,x,1)},X.toFixed=function(b,x){return b!=null&&(z(b,0,B),b=b+this.e+1),se(this,b,x)},X.toFormat=function(b,x,T){var $,O=this;if(T==null)b!=null&&x&&typeof x=="object"?(T=x,x=null):b&&typeof b=="object"?(T=b,b=x=null):T=oe;else if(typeof T!="object")throw Error(f+"Argument not an object: "+T);if($=O.toFixed(b,x),O.c){var k,h=$.split("."),o=+T.groupSize,c=+T.secondaryGroupSize,y=T.groupSeparator||"",_=h[0],N=h[1],V=O.s<0,ne=V?_.slice(1):_,pe=ne.length;if(c&&(k=o,o=c,c=k,pe-=k),o>0&&pe>0){for(k=pe%o||o,_=ne.substr(0,k);k<pe;k+=o)_+=y+ne.substr(k,o);c>0&&(_+=y+ne.slice(k)),V&&(_="-"+_)}$=N?_+(T.decimalSeparator||"")+((c=+T.fractionGroupSize)?N.replace(new RegExp("\\d{"+c+"}\\B","g"),"$&"+(T.fractionGroupSeparator||"")):N):_}return(T.prefix||"")+$+(T.suffix||"")},X.toFraction=function(b){var x,T,$,O,k,h,o,c,y,_,N,V,ne=this,pe=ne.c;if(b!=null&&(o=new m(b),!o.isInteger()&&(o.c||o.s!==1)||o.lt(he)))throw Error(f+"Argument "+(o.isInteger()?"out of range: ":"not an integer: ")+ae(o));if(!pe)return new m(ne);for(x=new m(he),y=T=new m(he),$=c=new m(he),V=C(pe),k=x.e=V.length-ne.e-1,x.c[0]=A[(h=k%g)<0?g+h:h],b=!b||o.comparedTo(x)>0?k>0?x:y:o,h=H,H=1/0,o=new m(V),c.c[0]=0;_=Z(o,x,0,1),O=T.plus(_.times($)),O.comparedTo(b)!=1;)T=$,$=O,y=c.plus(_.times(O=y)),c=O,x=o.minus(_.times(O=x)),o=O;return O=Z(b.minus(T),$,0,1),c=c.plus(O.times(y)),T=T.plus(O.times($)),c.s=y.s=ne.s,k=k*2,N=Z(y,$,k,I).minus(ne).abs().comparedTo(Z(c,T,k,I).minus(ne).abs())<1?[y,$]:[c,T],H=h,N},X.toNumber=function(){return+ae(this)},X.toPrecision=function(b,x){return b!=null&&z(b,1,B),se(this,b,x,2)},X.toString=function(b){var x,T=this,$=T.s,O=T.e;return O===null?$?(x="Infinity",$<0&&(x="-"+x)):x="NaN":(b==null?x=O<=U||O>=W?re(C(T.c),O):P(C(T.c),O,"0"):b===10&&ee?(T=te(new m(T),le+O+1,I),x=P(C(T.c),T.e,"0")):(z(b,2,fe.length,"Base"),x=J(P(C(T.c),O,"0"),10,b,$,!0)),$<0&&T.c[0]&&(x="-"+x)),x},X.valueOf=X.toJSON=function(){return ae(this)},X._isBigNumber=!0,L!=null&&m.set(L),m}function M(L){var Z=L|0;return L>0||L===Z?Z:Z-1}function C(L){for(var Z,J,Q=1,X=L.length,he=L[0]+"";Q<X;){for(Z=L[Q++]+"",J=g-Z.length;J--;Z="0"+Z);he+=Z}for(X=he.length;he.charCodeAt(--X)===48;);return he.slice(0,X+1||1)}function Y(L,Z){var J,Q,X=L.c,he=Z.c,le=L.s,I=Z.s,U=L.e,W=Z.e;if(!le||!I)return null;if(J=X&&!X[0],Q=he&&!he[0],J||Q)return J?Q?0:-I:le;if(le!=I)return le;if(J=le<0,Q=U==W,!X||!he)return Q?0:!X^J?1:-1;if(!Q)return U>W^J?1:-1;for(I=(U=X.length)<(W=he.length)?U:W,le=0;le<I;le++)if(X[le]!=he[le])return X[le]>he[le]^J?1:-1;return U==W?0:U>W^J?1:-1}function z(L,Z,J,Q){if(L<Z||L>J||L!==s(L))throw Error(f+(Q||"Argument")+(typeof L=="number"?L<Z||L>J?" out of range: ":" not an integer: ":" not a primitive number: ")+String(L))}function q(L){var Z=L.c.length-1;return M(L.e/g)==Z&&L.c[Z]%2!=0}function re(L,Z){return(L.length>1?L.charAt(0)+"."+L.slice(1):L)+(Z<0?"e":"e+")+Z}function P(L,Z,J){var Q,X;if(Z<0){for(X=J+".";++Z;X+=J);L=X+L}else if(Q=L.length,++Z>Q){for(X=J,Z-=Q;--Z;X+=J);L+=X}else Z<Q&&(L=L.slice(0,Z)+"."+L.slice(Z));return L}r=w(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(Dr)})(_c);var Hi=_c.exports,zf=function(e,r,n){var i=new e.Uint8Array(n),s=r.pushInt,f=r.pushInt32,a=r.pushInt32Neg,d=r.pushInt64,g=r.pushInt64Neg,E=r.pushFloat,A=r.pushFloatSingle,S=r.pushFloatDouble,B=r.pushTrue,w=r.pushFalse,M=r.pushUndefined,C=r.pushNull,Y=r.pushInfinity,z=r.pushInfinityNeg,q=r.pushNaN,re=r.pushNaNNeg,P=r.pushArrayStart,L=r.pushArrayStartFixed,Z=r.pushArrayStartFixed32,J=r.pushArrayStartFixed64,Q=r.pushObjectStart,X=r.pushObjectStartFixed,he=r.pushObjectStartFixed32,le=r.pushObjectStartFixed64,I=r.pushByteString,U=r.pushByteStringStart,W=r.pushUtf8String,G=r.pushUtf8StringStart,H=r.pushSimpleUnassigned,D=r.pushTagStart,ie=r.pushTagStart4,we=r.pushTagStart8,oe=r.pushTagUnassigned,fe=r.pushBreak,ee=e.Math.pow,m=0,se=0,ue=0;function de(R){for(R=R|0,m=0,se=R;(m|0)<(se|0)&&(ue=Ku[i[m]&255](i[m]|0)|0,!((ue|0)>0)););return ue|0}function te(R){return R=R|0,((m|0)+(R|0)|0)<(se|0)?0:1}function ae(R){return R=R|0,i[R|0]<<8|i[R+1|0]|0}function b(R){return R=R|0,i[R|0]<<24|i[R+1|0]<<16|i[R+2|0]<<8|i[R+3|0]|0}function x(R){return R=R|0,s(R|0),m=m+1|0,0}function T(R){return R=R|0,te(1)|0?1:(s(i[m+1|0]|0),m=m+2|0,0)}function $(R){return R=R|0,te(2)|0?1:(s(ae(m+1|0)|0),m=m+3|0,0)}function O(R){return R=R|0,te(4)|0?1:(f(ae(m+1|0)|0,ae(m+3|0)|0),m=m+5|0,0)}function k(R){return R=R|0,te(8)|0?1:(d(ae(m+1|0)|0,ae(m+3|0)|0,ae(m+5|0)|0,ae(m+7|0)|0),m=m+9|0,0)}function h(R){return R=R|0,s(-1-(R-32|0)|0),m=m+1|0,0}function o(R){return R=R|0,te(1)|0?1:(s(-1-(i[m+1|0]|0)|0),m=m+2|0,0)}function c(R){R=R|0;var Ne=0;return te(2)|0?1:(Ne=ae(m+1|0)|0,s(-1-(Ne|0)|0),m=m+3|0,0)}function y(R){return R=R|0,te(4)|0?1:(a(ae(m+1|0)|0,ae(m+3|0)|0),m=m+5|0,0)}function _(R){return R=R|0,te(8)|0?1:(g(ae(m+1|0)|0,ae(m+3|0)|0,ae(m+5|0)|0,ae(m+7|0)|0),m=m+9|0,0)}function N(R){R=R|0;var Ne=0,Ie=0,Te=0;return Te=R-64|0,te(Te|0)|0?1:(Ne=m+1|0,Ie=(m+1|0)+(Te|0)|0,I(Ne|0,Ie|0),m=Ie|0,0)}function V(R){R=R|0;var Ne=0,Ie=0,Te=0;return te(1)|0||(Te=i[m+1|0]|0,Ne=m+2|0,Ie=(m+2|0)+(Te|0)|0,te(Te+1|0)|0)?1:(I(Ne|0,Ie|0),m=Ie|0,0)}function ne(R){R=R|0;var Ne=0,Ie=0,Te=0;return te(2)|0||(Te=ae(m+1|0)|0,Ne=m+3|0,Ie=(m+3|0)+(Te|0)|0,te(Te+2|0)|0)?1:(I(Ne|0,Ie|0),m=Ie|0,0)}function pe(R){R=R|0;var Ne=0,Ie=0,Te=0;return te(4)|0||(Te=b(m+1|0)|0,Ne=m+5|0,Ie=(m+5|0)+(Te|0)|0,te(Te+4|0)|0)?1:(I(Ne|0,Ie|0),m=Ie|0,0)}function ye(R){return R=R|0,1}function xe(R){return R=R|0,U(),m=m+1|0,0}function p(R){R=R|0;var Ne=0,Ie=0,Te=0;return Te=R-96|0,te(Te|0)|0?1:(Ne=m+1|0,Ie=(m+1|0)+(Te|0)|0,W(Ne|0,Ie|0),m=Ie|0,0)}function u(R){R=R|0;var Ne=0,Ie=0,Te=0;return te(1)|0||(Te=i[m+1|0]|0,Ne=m+2|0,Ie=(m+2|0)+(Te|0)|0,te(Te+1|0)|0)?1:(W(Ne|0,Ie|0),m=Ie|0,0)}function l(R){R=R|0;var Ne=0,Ie=0,Te=0;return te(2)|0||(Te=ae(m+1|0)|0,Ne=m+3|0,Ie=(m+3|0)+(Te|0)|0,te(Te+2|0)|0)?1:(W(Ne|0,Ie|0),m=Ie|0,0)}function v(R){R=R|0;var Ne=0,Ie=0,Te=0;return te(4)|0||(Te=b(m+1|0)|0,Ne=m+5|0,Ie=(m+5|0)+(Te|0)|0,te(Te+4|0)|0)?1:(W(Ne|0,Ie|0),m=Ie|0,0)}function F(R){return R=R|0,1}function K(R){return R=R|0,G(),m=m+1|0,0}function j(R){return R=R|0,L(R-128|0),m=m+1|0,0}function _e(R){return R=R|0,te(1)|0?1:(L(i[m+1|0]|0),m=m+2|0,0)}function Be(R){return R=R|0,te(2)|0?1:(L(ae(m+1|0)|0),m=m+3|0,0)}function Ee(R){return R=R|0,te(4)|0?1:(Z(ae(m+1|0)|0,ae(m+3|0)|0),m=m+5|0,0)}function be(R){return R=R|0,te(8)|0?1:(J(ae(m+1|0)|0,ae(m+3|0)|0,ae(m+5|0)|0,ae(m+7|0)|0),m=m+9|0,0)}function Re(R){return R=R|0,P(),m=m+1|0,0}function $e(R){R=R|0;var Ne=0;return Ne=R-160|0,te(Ne|0)|0?1:(X(Ne|0),m=m+1|0,0)}function Zi(R){return R=R|0,te(1)|0?1:(X(i[m+1|0]|0),m=m+2|0,0)}function Li(R){return R=R|0,te(2)|0?1:(X(ae(m+1|0)|0),m=m+3|0,0)}function Di(R){return R=R|0,te(4)|0?1:(he(ae(m+1|0)|0,ae(m+3|0)|0),m=m+5|0,0)}function Xi(R){return R=R|0,te(8)|0?1:(le(ae(m+1|0)|0,ae(m+3|0)|0,ae(m+5|0)|0,ae(m+7|0)|0),m=m+9|0,0)}function Ji(R){return R=R|0,Q(),m=m+1|0,0}function Yt(R){return R=R|0,D(R-192|0|0),m=m+1|0,0}function Pd(R){return R=R|0,D(R|0),m=m+1|0,0}function $d(R){return R=R|0,D(R|0),m=m+1|0,0}function kd(R){return R=R|0,D(R|0),m=m+1|0,0}function Md(R){return R=R|0,D(R|0),m=m+1|0,0}function Ze(R){return R=R|0,D(R-192|0|0),m=m+1|0,0}function Cd(R){return R=R|0,D(R|0),m=m+1|0,0}function qd(R){return R=R|0,D(R|0),m=m+1|0,0}function Vd(R){return R=R|0,D(R|0),m=m+1|0,0}function Ou(R){return R=R|0,te(1)|0?1:(D(i[m+1|0]|0),m=m+2|0,0)}function Uu(R){return R=R|0,te(2)|0?1:(D(ae(m+1|0)|0),m=m+3|0,0)}function Fu(R){return R=R|0,te(4)|0?1:(ie(ae(m+1|0)|0,ae(m+3|0)|0),m=m+5|0,0)}function Pu(R){return R=R|0,te(8)|0?1:(we(ae(m+1|0)|0,ae(m+3|0)|0,ae(m+5|0)|0,ae(m+7|0)|0),m=m+9|0,0)}function je(R){return R=R|0,H((R|0)-224|0),m=m+1|0,0}function $u(R){return R=R|0,w(),m=m+1|0,0}function ku(R){return R=R|0,B(),m=m+1|0,0}function Mu(R){return R=R|0,C(),m=m+1|0,0}function Cu(R){return R=R|0,M(),m=m+1|0,0}function qu(R){return R=R|0,te(1)|0?1:(H(i[m+1|0]|0),m=m+2|0,0)}function Vu(R){R=R|0;var Ne=0,Ie=0,Te=1,kn=0,rn=0,Hd=0;return te(2)|0?1:(Ne=i[m+1|0]|0,Ie=i[m+2|0]|0,(Ne|0)&128&&(Te=-1),kn=+(((Ne|0)&124)>>2),rn=+(((Ne|0)&3)<<8|Ie),+kn==0?E(+(+Te*5960464477539063e-23*+rn)):+kn==31?+Te==1?+rn>0?q():Y():+rn>0?re():z():E(+(+Te*ee(2,+(+kn-25))*+(1024+rn))),m=m+3|0,0)}function Hu(R){return R=R|0,te(4)|0?1:(A(i[m+1|0]|0,i[m+2|0]|0,i[m+3|0]|0,i[m+4|0]|0),m=m+5|0,0)}function Gu(R){return R=R|0,te(8)|0?1:(S(i[m+1|0]|0,i[m+2|0]|0,i[m+3|0]|0,i[m+4|0]|0,i[m+5|0]|0,i[m+6|0]|0,i[m+7|0]|0,i[m+8|0]|0),m=m+9|0,0)}function Fe(R){return R=R|0,1}function ju(R){return R=R|0,fe(),m=m+1|0,0}var Ku=[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,T,$,O,k,Fe,Fe,Fe,Fe,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,o,c,y,_,Fe,Fe,Fe,Fe,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,V,ne,pe,ye,Fe,Fe,Fe,xe,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,u,l,v,F,Fe,Fe,Fe,K,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,_e,Be,Ee,be,Fe,Fe,Fe,Re,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,Zi,Li,Di,Xi,Fe,Fe,Fe,Ji,Yt,Yt,Yt,Yt,Yt,Yt,Ze,Ze,Ze,Ze,Ze,Ze,Ze,Ze,Ze,Ze,Ze,Ze,Ze,Ze,Ze,Ze,Ze,Ze,Ou,Uu,Fu,Pu,Fe,Fe,Fe,Fe,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,$u,ku,Mu,Cu,qu,Vu,Hu,Gu,Fe,Fe,Fe,ju];return{parse:de}},Gi={},it={};const to=Hi.BigNumber;it.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7};it.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36};it.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31};it.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23};it.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")};it.SHIFT32=Math.pow(2,32);it.SHIFT16=Math.pow(2,16);it.MAX_SAFE_HIGH=2097151;it.NEG_ONE=new to(-1);it.TEN=new to(10);it.TWO=new to(2);it.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5};(function(t){const{Buffer:e}=Un,r=Hi.BigNumber,n=it,i=n.SHIFT32,s=n.SHIFT16,f=2097151;t.parseHalf=function(g){var E,A,S;return S=g[0]&128?-1:1,E=(g[0]&124)>>2,A=(g[0]&3)<<8|g[1],E?E===31?S*(A?0/0:1/0):S*Math.pow(2,E-25)*(1024+A):S*5960464477539063e-23*A};function a(d){return d<16?"0"+d.toString(16):d.toString(16)}t.arrayBufferToBignumber=function(d){const g=d.byteLength;let E="";for(let A=0;A<g;A++)E+=a(d[A]);return new r(E,16)},t.buildMap=d=>{const g=new Map,E=Object.keys(d),A=E.length;for(let S=0;S<A;S++)g.set(E[S],d[E[S]]);return g},t.buildInt32=(d,g)=>d*s+g,t.buildInt64=(d,g,E,A)=>{const S=t.buildInt32(d,g),B=t.buildInt32(E,A);return S>f?new r(S).times(i).plus(B):S*i+B},t.writeHalf=function(g,E){const A=e.allocUnsafe(4);A.writeFloatBE(E,0);const S=A.readUInt32BE(0);if(S&8191)return!1;var B=S>>16&32768;const w=S>>23&255,M=S&8388607;if(w>=113&&w<=142)B+=(w-112<<10)+(M>>13);else if(w>=103&&w<113){if(M&(1<<126-w)-1)return!1;B+=M+8388608>>126-w}else return!1;return g.writeUInt16BE(B,0),!0},t.keySorter=function(d,g){var E=d[0].byteLength,A=g[0].byteLength;return E>A?1:A>E?-1:d[0].compare(g[0])},t.isNegativeZero=d=>d===0&&1/d<0,t.nextPowerOf2=d=>{let g=0;if(d&&!(d&d-1))return d;for(;d!==0;)d>>=1,g+=1;return 1<<g}})(Gi);const ro=it,Wf=ro.MT,Cn=ro.SIMPLE,os=ro.SYMS;let Yf=class Os{constructor(e){if(typeof e!="number")throw new Error("Invalid Simple type: "+typeof e);if(e<0||e>255||(e|0)!==e)throw new Error("value must be a small positive integer: "+e);this.value=e}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(e){return e._pushInt(this.value,Wf.SIMPLE_FLOAT)}static isSimple(e){return e instanceof Os}static decode(e,r){switch(r==null&&(r=!0),e){case Cn.FALSE:return!1;case Cn.TRUE:return!0;case Cn.NULL:return r?null:os.NULL;case Cn.UNDEFINED:return r?void 0:os.UNDEFINED;case-1:if(!r)throw new Error("Invalid BREAK");return os.BREAK;default:return new Os(e)}}};var xc=Yf;let Zf=class Us{constructor(e,r,n){if(this.tag=e,this.value=r,this.err=n,typeof this.tag!="number")throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(this.tag|0)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(e){return e._pushTag(this.tag),e.pushAny(this.value)}convert(e){var r,n;if(n=e!=null?e[this.tag]:void 0,typeof n!="function"&&(n=Us["_tag"+this.tag],typeof n!="function"))return this;try{return n.call(Us,this.value)}catch(i){return r=i,this.err=r,this}}};var Ec=Zf;const vc=self.location?self.location.protocol+"//"+self.location.host:"",Fs=self.URL;let Lf=class{constructor(e="",r=vc){this.super=new Fs(e,r),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set origin(e){this.super.origin=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set searchParams(e){this.super.searchParams=e}set username(e){this.super.username=e}createObjectURL(e){return this.super.createObjectURL(e)}revokeObjectURL(e){this.super.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function Df(t){if(typeof t=="string")return new Fs(t).toString();if(!(t instanceof Fs)){const e=t.username&&t.password?`${t.username}:${t.password}@`:"",r=t.auth?t.auth+"@":"",n=t.port?":"+t.port:"",i=t.protocol?t.protocol+"//":"",s=t.host||"",f=t.hostname||"",a=t.search||(t.query?"?"+t.query:""),d=t.hash||"",g=t.pathname||"",E=t.path||g+a;return`${i}${e||r}${s||f+n}${E}${d}`}}var Ac={URLWithLegacySupport:Lf,URLSearchParams:self.URLSearchParams,defaultBase:vc,format:Df};const{URLWithLegacySupport:Oo,format:Xf}=Ac;var Jf=(t,e={},r={},n)=>{let i=e.protocol?e.protocol.replace(":",""):"http";i=(r[i]||n||i)+":";let s;try{s=new Oo(t)}catch{s={}}const f=Object.assign({},e,{protocol:i||s.protocol,host:e.host||s.host});return new Oo(t,Xf(f)).toString()};const{URLWithLegacySupport:Qf,format:el,URLSearchParams:tl,defaultBase:rl}=Ac,nl=Jf;var Bc={URL:Qf,URLSearchParams:tl,format:el,relative:nl,defaultBase:rl};const{Buffer:Ur}=Un,Uo=In,il=Hi.BigNumber,sl=zf,st=Gi,Ue=it,ol=xc,al=Ec,{URL:cl}=Bc;let Ps=class $s{constructor(e){e=e||{},!e.size||e.size<65536?e.size=65536:e.size=st.nextPowerOf2(e.size),this._heap=new ArrayBuffer(e.size),this._heap8=new Uint8Array(this._heap),this._buffer=Ur.from(this._heap),this._reset(),this._knownTags=Object.assign({0:r=>new Date(r),1:r=>new Date(r*1e3),2:r=>st.arrayBufferToBignumber(r),3:r=>Ue.NEG_ONE.minus(st.arrayBufferToBignumber(r)),4:r=>Ue.TEN.pow(r[0]).times(r[1]),5:r=>Ue.TWO.pow(r[0]).times(r[1]),32:r=>new cl(r),35:r=>new RegExp(r)},e.tags),this.parser=sl(Dr,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var e=this._parents.pop();if(e.length>0)throw new Error(`Missing ${e.length} elements`);switch(e.type){case Ue.PARENT.TAG:this._push(this.createTag(e.ref[0],e.ref[1]));break;case Ue.PARENT.BYTE_STRING:this._push(this.createByteString(e.ref,e.length));break;case Ue.PARENT.UTF8_STRING:this._push(this.createUtf8String(e.ref,e.length));break;case Ue.PARENT.MAP:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(e.ref,e.length));break;case Ue.PARENT.OBJECT:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(e.ref,e.length));break;case Ue.PARENT.ARRAY:this._push(this.createArray(e.ref,e.length));break}this._currentParent&&this._currentParent.type===Ue.PARENT.TAG&&this._dec()}_dec(){const e=this._currentParent;e.length<0||(e.length--,e.length===0&&this._closeParent())}_push(e,r){const n=this._currentParent;switch(n.values++,n.type){case Ue.PARENT.ARRAY:case Ue.PARENT.BYTE_STRING:case Ue.PARENT.UTF8_STRING:n.length>-1?this._ref[this._ref.length-n.length]=e:this._ref.push(e),this._dec();break;case Ue.PARENT.OBJECT:n.tmpKey!=null?(this._ref[n.tmpKey]=e,n.tmpKey=null,this._dec()):(n.tmpKey=e,typeof n.tmpKey!="string"&&(n.type=Ue.PARENT.MAP,n.ref=st.buildMap(n.ref)));break;case Ue.PARENT.MAP:n.tmpKey!=null?(this._ref.set(n.tmpKey,e),n.tmpKey=null,this._dec()):n.tmpKey=e;break;case Ue.PARENT.TAG:this._ref.push(e),r||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(e,r,n){this._parents[this._depth]={type:r,length:n,ref:e,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:Ue.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(e,r){const n=this._knownTags[e];return n?n(r):new al(e,r)}createMap(e,r){return e}createObject(e,r){return e}createArray(e,r){return e}createByteString(e,r){return Ur.concat(e)}createByteStringFromHeap(e,r){return e===r?Ur.alloc(0):Ur.from(this._heap.slice(e,r))}createInt(e){return e}createInt32(e,r){return st.buildInt32(e,r)}createInt64(e,r,n,i){return st.buildInt64(e,r,n,i)}createFloat(e){return e}createFloatSingle(e,r,n,i){return Uo.read([e,r,n,i],0,!1,23,4)}createFloatDouble(e,r,n,i,s,f,a,d){return Uo.read([e,r,n,i,s,f,a,d],0,!1,52,8)}createInt32Neg(e,r){return-1-st.buildInt32(e,r)}createInt64Neg(e,r,n,i){const s=st.buildInt32(e,r),f=st.buildInt32(n,i);return s>Ue.MAX_SAFE_HIGH?Ue.NEG_ONE.minus(new il(s).times(Ue.SHIFT32).plus(f)):-1-(s*Ue.SHIFT32+f)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(e,r){return e.join("")}createUtf8StringFromHeap(e,r){return e===r?"":this._buffer.toString("utf8",e,r)}createSimpleUnassigned(e){return new ol(e)}pushInt(e){this._push(this.createInt(e))}pushInt32(e,r){this._push(this.createInt32(e,r))}pushInt64(e,r,n,i){this._push(this.createInt64(e,r,n,i))}pushFloat(e){this._push(this.createFloat(e))}pushFloatSingle(e,r,n,i){this._push(this.createFloatSingle(e,r,n,i))}pushFloatDouble(e,r,n,i,s,f,a,d){this._push(this.createFloatDouble(e,r,n,i,s,f,a,d))}pushInt32Neg(e,r){this._push(this.createInt32Neg(e,r))}pushInt64Neg(e,r,n,i){this._push(this.createInt64Neg(e,r,n,i))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],Ue.PARENT.ARRAY,-1)}pushArrayStartFixed(e){this._createArrayStartFixed(e)}pushArrayStartFixed32(e,r){const n=st.buildInt32(e,r);this._createArrayStartFixed(n)}pushArrayStartFixed64(e,r,n,i){const s=st.buildInt64(e,r,n,i);this._createArrayStartFixed(s)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(e){this._createObjectStartFixed(e)}pushObjectStartFixed32(e,r){const n=st.buildInt32(e,r);this._createObjectStartFixed(n)}pushObjectStartFixed64(e,r,n,i){const s=st.buildInt64(e,r,n,i);this._createObjectStartFixed(s)}pushByteStringStart(){this._parents[this._depth]={type:Ue.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(e,r){this._push(this.createByteStringFromHeap(e,r))}pushUtf8StringStart(){this._parents[this._depth]={type:Ue.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(e,r){this._push(this.createUtf8StringFromHeap(e,r))}pushSimpleUnassigned(e){this._push(this.createSimpleUnassigned(e))}pushTagStart(e){this._parents[this._depth]={type:Ue.PARENT.TAG,length:1,ref:[e]}}pushTagStart4(e,r){this.pushTagStart(st.buildInt32(e,r))}pushTagStart8(e,r,n,i){this.pushTagStart(st.buildInt64(e,r,n,i))}pushTagUnassigned(e){this._push(this.createTag(e))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(e){if(e===0){this._push(this.createObject({}));return}this._createParent({},Ue.PARENT.OBJECT,e)}_createArrayStartFixed(e){if(e===0){this._push(this.createArray([]));return}this._createParent(new Array(e),Ue.PARENT.ARRAY,e)}_decode(e){if(e.byteLength===0)throw new Error("Input too short");this._reset(),this._heap8.set(e);const r=this.parser.parse(e.byteLength);if(this._depth>1){for(;this._currentParent.length===0;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(r>0)throw new Error("Failed to parse");if(this._res.length===0)throw new Error("No valid result")}decodeFirst(e){return this._decode(e),this._res[0]}decodeAll(e){return this._decode(e),this._res}static decode(e,r){return typeof e=="string"&&(e=Ur.from(e,r||"hex")),new $s({size:e.length}).decodeFirst(e)}static decodeAll(e,r){return typeof e=="string"&&(e=Ur.from(e,r||"hex")),new $s({size:e.length}).decodeAll(e)}};Ps.decodeFirst=Ps.decode;var Tc=Ps;const{Buffer:as}=Un,ul=Tc,fl=Gi;class no extends ul{createTag(e,r){return`${e}(${r})`}createInt(e){return super.createInt(e).toString()}createInt32(e,r){return super.createInt32(e,r).toString()}createInt64(e,r,n,i){return super.createInt64(e,r,n,i).toString()}createInt32Neg(e,r){return super.createInt32Neg(e,r).toString()}createInt64Neg(e,r,n,i){return super.createInt64Neg(e,r,n,i).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(e){const r=super.createFloat(e);return fl.isNegativeZero(e)?"-0_1":`${r}_1`}createFloatSingle(e,r,n,i){return`${super.createFloatSingle(e,r,n,i)}_2`}createFloatDouble(e,r,n,i,s,f,a,d){return`${super.createFloatDouble(e,r,n,i,s,f,a,d)}_3`}createByteString(e,r){const n=e.join(", ");return r===-1?`(_ ${n})`:`h'${n}`}createByteStringFromHeap(e,r){return`h'${as.from(super.createByteStringFromHeap(e,r)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(e){return`simple(${e})`}createArray(e,r){const n=super.createArray(e,r);return r===-1?`[_ ${n.join(", ")}]`:`[${n.join(", ")}]`}createMap(e,r){const n=super.createMap(e),i=Array.from(n.keys()).reduce(Fo(n),"");return r===-1?`{_ ${i}}`:`{${i}}`}createObject(e,r){const n=super.createObject(e),i=Object.keys(n).reduce(Fo(n),"");return r===-1?`{_ ${i}}`:`{${i}}`}createUtf8String(e,r){const n=e.join(", ");return r===-1?`(_ ${n})`:`"${n}"`}createUtf8StringFromHeap(e,r){return`"${as.from(super.createUtf8StringFromHeap(e,r)).toString("utf8")}"`}static diagnose(e,r){return typeof e=="string"&&(e=as.from(e,r||"hex")),new no().decodeFirst(e)}}var ll=no;function Fo(t){return(e,r)=>e?`${e}, ${r}: ${t[r]}`:`${r}: ${t[r]}`}const{Buffer:Ot}=Un,{URL:hl}=Bc,ks=Hi.BigNumber,cs=Gi,Ye=it,wt=Ye.MT,qn=Ye.NUMBYTES,Po=Ye.SHIFT32,$o=Ye.SYMS,Fr=Ye.TAG,dl=Ye.MT.SIMPLE_FLOAT<<5|Ye.NUMBYTES.TWO,pl=Ye.MT.SIMPLE_FLOAT<<5|Ye.NUMBYTES.FOUR,yl=Ye.MT.SIMPLE_FLOAT<<5|Ye.NUMBYTES.EIGHT,gl=Ye.MT.SIMPLE_FLOAT<<5|Ye.SIMPLE.TRUE,wl=Ye.MT.SIMPLE_FLOAT<<5|Ye.SIMPLE.FALSE,ml=Ye.MT.SIMPLE_FLOAT<<5|Ye.SIMPLE.UNDEFINED,ko=Ye.MT.SIMPLE_FLOAT<<5|Ye.SIMPLE.NULL,bl=new ks("0x20000000000000"),_l=Ot.from("f97e00","hex"),xl=Ot.from("f9fc00","hex"),El=Ot.from("f97c00","hex");function vl(t){return{}.toString.call(t).slice(8,-1)}class vi{constructor(e){e=e||{},this.streaming=typeof e.stream=="function",this.onData=e.stream,this.semanticTypes=[[hl,this._pushUrl],[ks,this._pushBigNumber]];const r=e.genTypes||[],n=r.length;for(let i=0;i<n;i++)this.addSemanticType(r[i][0],r[i][1]);this._reset()}addSemanticType(e,r){const n=this.semanticTypes.length;for(let i=0;i<n;i++)if(this.semanticTypes[i][0]===e){const f=this.semanticTypes[i][1];return this.semanticTypes[i][1]=r,f}return this.semanticTypes.push([e,r]),null}push(e){return e&&(this.result[this.offset]=e,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=e.length,this.offset++,this.streaming&&this.onData(this.finalize())),!0}pushWrite(e,r,n){return this.result[this.offset]=e,this.resultMethod[this.offset]=r,this.resultLength[this.offset]=n,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(e){return this.pushWrite(e,1,1)}_pushUInt16BE(e){return this.pushWrite(e,2,2)}_pushUInt32BE(e){return this.pushWrite(e,3,4)}_pushDoubleBE(e){return this.pushWrite(e,4,8)}_pushNaN(){return this.push(_l)}_pushInfinity(e){const r=e<0?xl:El;return this.push(r)}_pushFloat(e){const r=Ot.allocUnsafe(2);if(cs.writeHalf(r,e)&&cs.parseHalf(r)===e)return this._pushUInt8(dl)&&this.push(r);const n=Ot.allocUnsafe(4);return n.writeFloatBE(e,0),n.readFloatBE(0)===e?this._pushUInt8(pl)&&this.push(n):this._pushUInt8(yl)&&this._pushDoubleBE(e)}_pushInt(e,r,n){const i=r<<5;return e<24?this._pushUInt8(i|e):e<=255?this._pushUInt8(i|qn.ONE)&&this._pushUInt8(e):e<=65535?this._pushUInt8(i|qn.TWO)&&this._pushUInt16BE(e):e<=4294967295?this._pushUInt8(i|qn.FOUR)&&this._pushUInt32BE(e):e<=Number.MAX_SAFE_INTEGER?this._pushUInt8(i|qn.EIGHT)&&this._pushUInt32BE(Math.floor(e/Po))&&this._pushUInt32BE(e%Po):r===wt.NEG_INT?this._pushFloat(n):this._pushFloat(e)}_pushIntNum(e){return e<0?this._pushInt(-e-1,wt.NEG_INT,e):this._pushInt(e,wt.POS_INT)}_pushNumber(e){switch(!1){case e===e:return this._pushNaN(e);case isFinite(e):return this._pushInfinity(e);case e%1!==0:return this._pushIntNum(e);default:return this._pushFloat(e)}}_pushString(e){const r=Ot.byteLength(e,"utf8");return this._pushInt(r,wt.UTF8_STRING)&&this.pushWrite(e,5,r)}_pushBoolean(e){return this._pushUInt8(e?gl:wl)}_pushUndefined(e){return this._pushUInt8(ml)}_pushArray(e,r){const n=r.length;if(!e._pushInt(n,wt.ARRAY))return!1;for(let i=0;i<n;i++)if(!e.pushAny(r[i]))return!1;return!0}_pushTag(e){return this._pushInt(e,wt.TAG)}_pushDate(e,r){return e._pushTag(Fr.DATE_EPOCH)&&e.pushAny(Math.round(r/1e3))}_pushBuffer(e,r){return e._pushInt(r.length,wt.BYTE_STRING)&&e.push(r)}_pushNoFilter(e,r){return e._pushBuffer(e,r.slice())}_pushRegexp(e,r){return e._pushTag(Fr.REGEXP)&&e.pushAny(r.source)}_pushSet(e,r){if(!e._pushInt(r.size,wt.ARRAY))return!1;for(const n of r)if(!e.pushAny(n))return!1;return!0}_pushUrl(e,r){return e._pushTag(Fr.URI)&&e.pushAny(r.format())}_pushBigint(e){let r=Fr.POS_BIGINT;e.isNegative()&&(e=e.negated().minus(1),r=Fr.NEG_BIGINT);let n=e.toString(16);n.length%2&&(n="0"+n);const i=Ot.from(n,"hex");return this._pushTag(r)&&this._pushBuffer(this,i)}_pushBigNumber(e,r){if(r.isNaN())return e._pushNaN();if(!r.isFinite())return e._pushInfinity(r.isNegative()?-1/0:1/0);if(r.isInteger())return e._pushBigint(r);if(!(e._pushTag(Fr.DECIMAL_FRAC)&&e._pushInt(2,wt.ARRAY)))return!1;const n=r.decimalPlaces(),i=r.multipliedBy(new ks(10).pow(n));return e._pushIntNum(-n)?i.abs().isLessThan(bl)?e._pushIntNum(i.toNumber()):e._pushBigint(i):!1}_pushMap(e,r){return e._pushInt(r.size,wt.MAP)?this._pushRawMap(r.size,Array.from(r)):!1}_pushObject(e){if(!e)return this._pushUInt8(ko);for(var r=this.semanticTypes.length,n=0;n<r;n++)if(e instanceof this.semanticTypes[n][0])return this.semanticTypes[n][1].call(e,this,e);var i=e.encodeCBOR;if(typeof i=="function")return i.call(e,this);var s=Object.keys(e),f=s.length;return this._pushInt(f,wt.MAP)?this._pushRawMap(f,s.map(a=>[a,e[a]])):!1}_pushRawMap(e,r){r=r.map(function(i){return i[0]=vi.encode(i[0]),i}).sort(cs.keySorter);for(var n=0;n<e;n++)if(!this.push(r[n][0])||!this.pushAny(r[n][1]))return!1;return!0}write(e){return this.pushAny(e)}pushAny(e){var r=vl(e);switch(r){case"Number":return this._pushNumber(e);case"String":return this._pushString(e);case"Boolean":return this._pushBoolean(e);case"Object":return this._pushObject(e);case"Array":return this._pushArray(this,e);case"Uint8Array":return this._pushBuffer(this,Ot.isBuffer(e)?e:Ot.from(e));case"Null":return this._pushUInt8(ko);case"Undefined":return this._pushUndefined(e);case"Map":return this._pushMap(this,e);case"Set":return this._pushSet(this,e);case"URL":return this._pushUrl(this,e);case"BigNumber":return this._pushBigNumber(this,e);case"Date":return this._pushDate(this,e);case"RegExp":return this._pushRegexp(this,e);case"Symbol":switch(e){case $o.NULL:return this._pushObject(null);case $o.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+e.toString())}default:throw new Error("Unknown type: "+typeof e+", "+(e?e.toString():""))}}finalize(){if(this.offset===0)return null;for(var e=this.result,r=this.resultLength,n=this.resultMethod,i=this.offset,s=0,f=0;f<i;f++)s+=r[f];var a=Ot.allocUnsafe(s),d=0,g=0;for(f=0;f<i;f++){switch(g=r[f],n[f]){case 0:e[f].copy(a,d);break;case 1:a.writeUInt8(e[f],d,!0);break;case 2:a.writeUInt16BE(e[f],d,!0);break;case 3:a.writeUInt32BE(e[f],d,!0);break;case 4:a.writeDoubleBE(e[f],d,!0);break;case 5:a.write(e[f],d,g,"utf8");break;default:throw new Error("unkown method")}d+=g}var E=a;return this._reset(),E}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(e){const r=new vi;if(!r.pushAny(e))throw new Error("Failed to encode input");return r.finalize()}}var Al=vi;(function(t){t.Diagnose=ll,t.Decoder=Tc,t.Encoder=Al,t.Simple=xc,t.Tagged=Ec,t.decodeAll=t.Decoder.decodeAll,t.decodeFirst=t.Decoder.decodeFirst,t.diagnose=t.Diagnose.diagnose,t.encode=t.Encoder.encode,t.decode=t.Decoder.decode,t.leveldb={decode:t.Decoder.decodeAll,encode:t.Encoder.encode,buffer:!0,name:"cbor"}})(bc);const Sc=of(bc);function vt(t){return hn(Xs.create().update(new Uint8Array(t)).digest())}function Jn(t){if(t instanceof Sc.Tagged)return Jn(t.value);if(typeof t=="string")return Nc(t);if(typeof t=="number")return vt(Ve(t));if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))return vt(t);if(Array.isArray(t)){const e=t.map(Jn);return vt(At(...e))}else{if(t&&typeof t=="object"&&t._isPrincipal)return vt(t.toUint8Array());if(typeof t=="object"&&t!==null&&typeof t.toHash=="function")return Jn(t.toHash());if(typeof t=="object")return Ai(t);if(typeof t=="bigint")return vt(Ve(t))}throw Object.assign(new Error(`Attempt to hash a value of unsupported type: ${t}`),{value:t})}const Nc=t=>{const e=new TextEncoder().encode(t);return vt(e)};function En(t){return Ai(t)}function Ai(t){const n=Object.entries(t).filter(([,f])=>f!==void 0).map(([f,a])=>{const d=Nc(f),g=Jn(a);return[d,g]}).sort(([f],[a])=>Pa(f,a)),i=At(...n.map(f=>At(...f)));return vt(i)}var Bl=globalThis&&globalThis.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};const Tl=new TextEncoder().encode(`
ic-request`);class io{getPrincipal(){return this._principal||(this._principal=ve.selfAuthenticating(new Uint8Array(this.getPublicKey().toDer()))),this._principal}async transformRequest(e){const{body:r}=e,n=Bl(e,["body"]),i=En(r);return Object.assign(Object.assign({},n),{body:{content:r,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign(At(Tl,i))}})}}class Bi{getPrincipal(){return ve.anonymous()}async transformRequest(e){return Object.assign(Object.assign({},e),{body:{content:e.body}})}}var ft={},tn={},Pe={};Object.defineProperty(Pe,"__esModule",{value:!0});const Sl=9007199254740992;function zt(t,...e){const r=new Uint8Array(t.byteLength+e.reduce((i,s)=>i+s.byteLength,0));r.set(new Uint8Array(t),0);let n=t.byteLength;for(const i of e)r.set(new Uint8Array(i),n),n+=i.byteLength;return r.buffer}function Bt(t,e,r){r=r.replace(/[^0-9a-fA-F]/g,"");const n=2**(e-24);r=r.slice(-n*2).padStart(n*2,"0");const i=[(t<<5)+e].concat(r.match(/../g).map(s=>parseInt(s,16)));return new Uint8Array(i).buffer}function ji(t,e){if(e<24)return new Uint8Array([(t<<5)+e]).buffer;{const r=e<=255?24:e<=65535?25:e<=4294967295?26:27;return Bt(t,r,e.toString(16))}}function Ic(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);n<128?e.push(n):n<2048?e.push(192|n>>6,128|n&63):n<55296||n>=57344?e.push(224|n>>12,128|n>>6&63,128|n&63):(r++,n=(n&1023)<<10|t.charCodeAt(r)&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63))}return zt(new Uint8Array(ji(3,t.length)),new Uint8Array(e))}function Nl(t,e){if(t==14277111)return zt(new Uint8Array([217,217,247]),e);if(t<24)return zt(new Uint8Array([192+t]),e);{const r=t<=255?24:t<=65535?25:t<=4294967295?26:27,n=2**(r-24),i=t.toString(16).slice(-n*2).padStart(n*2,"0"),s=[192+r].concat(i.match(/../g).map(f=>parseInt(f,16)));return new Uint8Array(s).buffer}}Pe.tagged=Nl;function Fn(t){return new Uint8Array(t).buffer}Pe.raw=Fn;function so(t){if(isNaN(t))throw new RangeError("Invalid number.");t=Math.min(Math.max(0,t),23);const e=[0+t];return new Uint8Array(e).buffer}Pe.uSmall=so;function Rc(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),255),t=t.toString(16),Bt(0,24,t)}Pe.u8=Rc;function Oc(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),65535),t=t.toString(16),Bt(0,25,t)}Pe.u16=Oc;function Uc(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),4294967295),t=t.toString(16),Bt(0,26,t)}Pe.u32=Uc;function oo(t,e){if(typeof t=="string"&&e==16){if(t.match(/[^0-9a-fA-F]/))throw new RangeError("Invalid number.");return Bt(0,27,t)}if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),Sl),t=t.toString(16),Bt(0,27,t)}Pe.u64=oo;function Fc(t){if(isNaN(t))throw new RangeError("Invalid number.");if(t===0)return so(0);t=Math.min(Math.max(0,-t),24)-1;const e=[32+t];return new Uint8Array(e).buffer}Pe.iSmall=Fc;function Pc(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,-t-1),255),t=t.toString(16),Bt(1,24,t)}Pe.i8=Pc;function $c(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,-t-1),65535),t=t.toString(16),Bt(1,25,t)}Pe.i16=$c;function kc(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,-t-1),4294967295),t=t.toString(16),Bt(1,26,t)}Pe.i32=kc;function Mc(t,e){if(typeof t=="string"&&e==16){if(t.startsWith("-")?t=t.slice(1):t="0",t.match(/[^0-9a-fA-F]/)||t.length>16)throw new RangeError("Invalid number.");let r=!1,n=t.split("").reduceRight((i,s)=>{if(r)return s+i;let f=parseInt(s,16)-1;return f>=0?(r=!0,f.toString(16)+i):"f"+i},"");return r?Bt(1,27,n):oo(0)}if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,-t-1),9007199254740992),t=t.toString(16),Bt(1,27,t)}Pe.i64=Mc;function Il(t){return t>=0?t<24?so(t):t<=255?Rc(t):t<=65535?Oc(t):t<=4294967295?Uc(t):oo(t):t>=-24?Fc(t):t>=-255?Pc(t):t>=-65535?$c(t):t>=-4294967295?kc(t):Mc(t)}Pe.number=Il;function Rl(t){return zt(ji(2,t.byteLength),t)}Pe.bytes=Rl;function Ol(t){return Ic(t)}Pe.string=Ol;function Ul(t){return zt(ji(4,t.length),...t)}Pe.array=Ul;function Fl(t,e=!1){t instanceof Map||(t=new Map(Object.entries(t)));let r=Array.from(t.entries());return e&&(r=r.sort(([n],[i])=>n.localeCompare(i))),zt(ji(5,t.size),...r.map(([n,i])=>zt(Ic(n),i)))}Pe.map=Fl;function Pl(t){const e=new Float32Array([t]);return zt(new Uint8Array([224+26]),new Uint8Array(e.buffer))}Pe.singleFloat=Pl;function $l(t){const e=new Float64Array([t]);return zt(new Uint8Array([224+27]),new Uint8Array(e.buffer))}Pe.doubleFloat=$l;function kl(t){return t?Cc():qc()}Pe.bool=kl;function Cc(){return Fn(new Uint8Array([224+21]))}Pe.true_=Cc;function qc(){return Fn(new Uint8Array([224+20]))}Pe.false_=qc;function Ml(){return Fn(new Uint8Array([224+22]))}Pe.null_=Ml;function Cl(){return Fn(new Uint8Array([224+23]))}Pe.undefined_=Cl;var ql=Dr&&Dr.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(tn,"__esModule",{value:!0});const bt=ql(Pe),Vl=[ArrayBuffer,Uint8Array,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array];class Vc{constructor(e,r=!1){this._serializer=e,this._stable=r,this.name="jsonDefault",this.priority=-100}match(e){return["undefined","boolean","number","string","object"].indexOf(typeof e)!=-1}encode(e){switch(typeof e){case"undefined":return bt.undefined_();case"boolean":return bt.bool(e);case"number":return Math.floor(e)===e?bt.number(e):bt.doubleFloat(e);case"string":return bt.string(e);case"object":if(e===null)return bt.null_();if(Array.isArray(e))return bt.array(e.map(r=>this._serializer.serializeValue(r)));if(Vl.find(r=>e instanceof r))return bt.bytes(e.buffer);if(Object.getOwnPropertyNames(e).indexOf("toJSON")!==-1)return this.encode(e.toJSON());if(e instanceof Map){const r=new Map;for(const[n,i]of e.entries())r.set(n,this._serializer.serializeValue(i));return bt.map(r,this._stable)}else{const r=new Map;for(const[n,i]of Object.entries(e))r.set(n,this._serializer.serializeValue(i));return bt.map(r,this._stable)}default:throw new Error("Invalid value.")}}}tn.JsonDefaultCborEncoder=Vc;class Hc{constructor(){this.name="cborEncoder",this.priority=-90}match(e){return typeof e=="object"&&typeof e.toCBOR=="function"}encode(e){return e.toCBOR()}}tn.ToCborEncoder=Hc;class Gc{constructor(){this._encoders=new Set}static withDefaultEncoders(e=!1){const r=new this;return r.addEncoder(new Vc(r,e)),r.addEncoder(new Hc),r}removeEncoder(e){for(const r of this._encoders.values())r.name==e&&this._encoders.delete(r)}addEncoder(e){this._encoders.add(e)}getEncoderFor(e){let r=null;for(const n of this._encoders)(!r||n.priority>r.priority)&&n.match(e)&&(r=n);if(r===null)throw new Error("Could not find an encoder for value.");return r}serializeValue(e){return this.getEncoderFor(e).encode(e)}serialize(e){return this.serializeValue(e)}}tn.CborSerializer=Gc;class Hl extends Gc{serialize(e){return bt.raw(new Uint8Array([...new Uint8Array([217,217,247]),...new Uint8Array(super.serializeValue(e))]))}}tn.SelfDescribeCborSerializer=Hl;(function(t){function e(i){for(var s in i)t.hasOwnProperty(s)||(t[s]=i[s])}var r=Dr&&Dr.__importStar||function(i){if(i&&i.__esModule)return i;var s={};if(i!=null)for(var f in i)Object.hasOwnProperty.call(i,f)&&(s[f]=i[f]);return s.default=i,s};Object.defineProperty(t,"__esModule",{value:!0}),e(tn);const n=r(Pe);t.value=n})(ft);class Gl{get name(){return"Principal"}get priority(){return 0}match(e){return e&&e._isPrincipal===!0}encode(e){return ft.value.bytes(e.toUint8Array())}}class jl{get name(){return"Buffer"}get priority(){return 1}match(e){return e instanceof ArrayBuffer||ArrayBuffer.isView(e)}encode(e){return ft.value.bytes(new Uint8Array(e))}}class Kl{get name(){return"BigInt"}get priority(){return 1}match(e){return typeof e=="bigint"}encode(e){return e>BigInt(0)?ft.value.tagged(2,ft.value.bytes(Kt(e.toString(16)))):ft.value.tagged(3,ft.value.bytes(Kt((BigInt("-1")*e).toString(16))))}}const Ki=ft.SelfDescribeCborSerializer.withDefaultEncoders(!0);Ki.addEncoder(new Gl);Ki.addEncoder(new jl);Ki.addEncoder(new Kl);var Ms;(function(t){t[t.Uint64LittleEndian=71]="Uint64LittleEndian",t[t.Semantic=55799]="Semantic"})(Ms||(Ms={}));function us(t){return Ki.serialize(t)}function Mo(t){const e=t.byteLength;let r=BigInt(0);for(let n=0;n<e;n++)r=r*BigInt(256)+BigInt(t[n]);return r}class zl extends Sc.Decoder{createByteString(e){return At(...e)}createByteStringFromHeap(e,r){return e===r?new ArrayBuffer(0):new Uint8Array(this._heap.slice(e,r))}}function Gt(t){const e=new Uint8Array(t),r=new zl({size:e.byteLength,tags:{2:n=>Mo(n),3:n=>-Mo(n),[Ms.Semantic]:n=>n}});try{return r.decodeFirst(e)}catch(n){throw new Error(`Failed to decode CBOR: ${n}, input: ${ke(e)}`)}}const Vn=()=>{if(typeof window<"u"&&window.crypto&&window.crypto.getRandomValues){const t=new Uint32Array(1);return window.crypto.getRandomValues(t),t[0]}if(typeof crypto<"u"&&crypto.getRandomValues){const t=new Uint32Array(1);return crypto.getRandomValues(t),t[0]}return typeof crypto<"u"&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(Math.random()*4294967295)};var Cs;(function(t){t.Call="call"})(Cs||(Cs={}));function qs(){const t=new ArrayBuffer(16),e=new DataView(t),r=Vn(),n=Vn(),i=Vn(),s=Vn();return e.setUint32(0,r),e.setUint32(4,n),e.setUint32(8,i),e.setUint32(12,s),t}const Co=BigInt(1e6),Wl=60*1e3;class Hn{constructor(e){if(e<90*1e3){const a=BigInt(Date.now()+e)*Co/BigInt(1e9);this._value=a*BigInt(1e9);return}const s=BigInt(Math.floor(Date.now()+e-Wl))*Co/BigInt(1e9)/BigInt(60)*BigInt(60)*BigInt(1e9);this._value=s}toCBOR(){return ft.value.u64(this._value.toString(16),16)}toHash(){return Ve(this._value)}}function qo(t=qs){return async e=>{const r=e.request.headers;e.request.headers=r,e.endpoint==="call"&&(e.body.nonce=t())}}function on(t){const e=[];return t.forEach((r,n)=>{e.push([n,r])}),e}class fs extends qe{constructor(e,r){super(e),this.response=r,this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}class Yl extends qe{constructor(e,r,n,i,s,f){super(e),this.response=r,this.requestId=n,this.senderPubkey=i,this.senderSig=s,this.ingressExpiry=f,this.name="AgentCallError",Object.setPrototypeOf(this,new.target.prototype)}}class Zl extends qe{constructor(e,r,n,i,s,f){super(e),this.response=r,this.requestId=n,this.senderPubkey=i,this.senderSig=s,this.ingressExpiry=f,this.name="AgentQueryError",Object.setPrototypeOf(this,new.target.prototype)}}class Ll extends qe{constructor(e,r,n,i,s,f){super(e),this.response=r,this.requestId=n,this.senderPubkey=i,this.senderSig=s,this.ingressExpiry=f,this.name="AgentReadStateError",Object.setPrototypeOf(this,new.target.prototype)}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ao=BigInt(0),co=BigInt(1),Dl=BigInt(2);function zi(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function lr(t){if(!zi(t))throw new Error("Uint8Array expected")}function dn(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const Xl=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ir(t){lr(t);let e="";for(let r=0;r<t.length;r++)e+=Xl[t[r]];return e}function jc(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?ao:BigInt("0x"+t)}const $t={_0:48,_9:57,A:65,F:70,a:97,f:102};function Vo(t){if(t>=$t._0&&t<=$t._9)return t-$t._0;if(t>=$t.A&&t<=$t.F)return t-($t.A-10);if(t>=$t.a&&t<=$t.f)return t-($t.a-10)}function Kc(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const f=Vo(t.charCodeAt(s)),a=Vo(t.charCodeAt(s+1));if(f===void 0||a===void 0){const d=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+s)}n[i]=f*16+a}return n}function Et(t){return jc(Ir(t))}function pn(t){return lr(t),jc(Ir(Uint8Array.from(t).reverse()))}function et(t,e){return Kc(t.toString(16).padStart(e*2,"0"))}function Ti(t,e){return et(t,e).reverse()}function ct(t,e,r){let n;if(typeof e=="string")try{n=Kc(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(zi(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function Ke(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];lr(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}function uo(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}const ls=t=>typeof t=="bigint"&&ao<=t;function zc(t,e,r){return ls(t)&&ls(e)&&ls(r)&&e<=t&&t<r}function sr(t,e,r,n){if(!zc(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function yn(t){let e;for(e=0;t>ao;t>>=co,e+=1);return e}function Jl(t,e){return t>>BigInt(e)&co}const Qn=t=>(Dl<<BigInt(t-1))-co,Ql={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||zi(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Pn(t,e,r={}){const n=(i,s,f)=>{const a=Ql[s];if(typeof a!="function")throw new Error("invalid validator function");const d=t[i];if(!(f&&d===void 0)&&!a(d,t))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+d)};for(const[i,s]of Object.entries(e))n(i,s,!1);for(const[i,s]of Object.entries(r))n(i,s,!0);return t}const Ho=()=>{throw new Error("not implemented")};function vn(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(i!==void 0)return i;const s=t(r,...n);return e.set(r,s),s}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Je=BigInt(0),Me=BigInt(1),or=BigInt(2),e0=BigInt(3),Vs=BigInt(4),Go=BigInt(5),jo=BigInt(8);function Ce(t,e){const r=t%e;return r>=Je?r:e+r}function t0(t,e,r){if(e<Je)throw new Error("invalid exponent, negatives unsupported");if(r<=Je)throw new Error("invalid modulus");if(r===Me)return Je;let n=Me;for(;e>Je;)e&Me&&(n=n*t%r),t=t*t%r,e>>=Me;return n}function St(t,e,r){let n=t;for(;e-- >Je;)n*=n,n%=r;return n}function Ko(t,e){if(t===Je)throw new Error("invert: expected non-zero number");if(e<=Je)throw new Error("invert: expected positive modulus, got "+e);let r=Ce(t,e),n=e,i=Je,s=Me;for(;r!==Je;){const a=n/r,d=n%r,g=i-s*a;n=r,r=d,i=s,s=g}if(n!==Me)throw new Error("invert: does not exist");return Ce(i,e)}function r0(t){const e=(t-Me)/or;let r,n,i;for(r=t-Me,n=0;r%or===Je;r/=or,n++);for(i=or;i<t&&t0(i,e,t)!==t-Me;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const f=(t+Me)/Vs;return function(d,g){const E=d.pow(g,f);if(!d.eql(d.sqr(E),g))throw new Error("Cannot find square root");return E}}const s=(r+Me)/or;return function(a,d){if(a.pow(d,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let g=n,E=a.pow(a.mul(a.ONE,i),r),A=a.pow(d,s),S=a.pow(d,r);for(;!a.eql(S,a.ONE);){if(a.eql(S,a.ZERO))return a.ZERO;let B=1;for(let M=a.sqr(S);B<g&&!a.eql(M,a.ONE);B++)M=a.sqr(M);const w=a.pow(E,Me<<BigInt(g-B-1));E=a.sqr(w),A=a.mul(A,w),S=a.mul(S,E),g=B}return A}}function n0(t){if(t%Vs===e0){const e=(t+Me)/Vs;return function(n,i){const s=n.pow(i,e);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(t%jo===Go){const e=(t-Go)/jo;return function(n,i){const s=n.mul(i,or),f=n.pow(s,e),a=n.mul(i,f),d=n.mul(n.mul(a,or),f),g=n.mul(a,n.sub(d,n.ONE));if(!n.eql(n.sqr(g),i))throw new Error("Cannot find square root");return g}}return r0(t)}const i0=(t,e)=>(Ce(t,e)&Me)===Me,s0=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Wc(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=s0.reduce((n,i)=>(n[i]="function",n),e);return Pn(t,r)}function ei(t,e,r){if(r<Je)throw new Error("invalid exponent, negatives unsupported");if(r===Je)return t.ONE;if(r===Me)return e;let n=t.ONE,i=e;for(;r>Je;)r&Me&&(n=t.mul(n,i)),i=t.sqr(i),r>>=Me;return n}function ti(t,e){const r=new Array(e.length),n=e.reduce((s,f,a)=>t.is0(f)?s:(r[a]=s,t.mul(s,f)),t.ONE),i=t.inv(n);return e.reduceRight((s,f,a)=>t.is0(f)?s:(r[a]=t.mul(s,r[a]),t.mul(s,f)),i),r}function o0(t){const e=(t-Me)/or;return(r,n)=>r.pow(n,e)}function Yc(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function $n(t,e,r=!1,n={}){if(t<=Je)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:i,nByteLength:s}=Yc(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let f;const a=Object.freeze({ORDER:t,isLE:r,BITS:i,BYTES:s,MASK:Qn(i),ZERO:Je,ONE:Me,create:d=>Ce(d,t),isValid:d=>{if(typeof d!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof d);return Je<=d&&d<t},is0:d=>d===Je,isOdd:d=>(d&Me)===Me,neg:d=>Ce(-d,t),eql:(d,g)=>d===g,sqr:d=>Ce(d*d,t),add:(d,g)=>Ce(d+g,t),sub:(d,g)=>Ce(d-g,t),mul:(d,g)=>Ce(d*g,t),pow:(d,g)=>ei(a,d,g),div:(d,g)=>Ce(d*Ko(g,t),t),sqrN:d=>d*d,addN:(d,g)=>d+g,subN:(d,g)=>d-g,mulN:(d,g)=>d*g,inv:d=>Ko(d,t),sqrt:n.sqrt||(d=>(f||(f=n0(t)),f(a,d))),invertBatch:d=>ti(a,d),cmov:(d,g,E)=>E?g:d,toBytes:d=>r?Ti(d,s):et(d,s),fromBytes:d=>{if(d.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+d.length);return r?pn(d):Et(d)}});return Object.freeze(a)}function Zc(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Lc(t){const e=Zc(t);return e+Math.ceil(e/2)}function a0(t,e,r=!1){const n=t.length,i=Zc(e),s=Lc(e);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);const f=r?pn(t):Et(t),a=Ce(f,e-Me)+Me;return r?Ti(a,i):et(a,i)}const c0=Et;function er(t,e){if(An(t),An(e),t<0||t>=1<<8*e)throw new Error("invalid I2OSP input: "+t);const r=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)r[n]=t&255,t>>>=8;return new Uint8Array(r)}function u0(t,e){const r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}function An(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function f0(t,e,r,n){lr(t),lr(e),An(r),e.length>255&&(e=n(Ke(uo("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:s}=n,f=Math.ceil(r/i);if(r>65535||f>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=Ke(e,er(e.length,1)),d=er(0,s),g=er(r,2),E=new Array(f),A=n(Ke(d,t,g,er(0,1),a));E[0]=n(Ke(A,er(1,1),a));for(let B=1;B<=f;B++){const w=[u0(A,E[B-1]),er(B+1,1),a];E[B]=n(Ke(...w))}return Ke(...E).slice(0,r)}function l0(t,e,r,n,i){if(lr(t),lr(e),An(r),e.length>255){const s=Math.ceil(2*n/8);e=i.create({dkLen:s}).update(uo("H2C-OVERSIZE-DST-")).update(e).digest()}if(r>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(t).update(er(r,2)).update(e).update(er(e.length,1)).digest()}function zo(t,e,r){Pn(r,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:n,k:i,m:s,hash:f,expand:a,DST:d}=r;lr(t),An(e);const g=typeof d=="string"?uo(d):d,E=n.toString(2).length,A=Math.ceil((E+i)/8),S=e*s*A;let B;if(a==="xmd")B=f0(t,g,S,f);else if(a==="xof")B=l0(t,g,S,i,f);else if(a==="_internal_pass")B=t;else throw new Error('expand must be "xmd" or "xof"');const w=new Array(e);for(let M=0;M<e;M++){const C=new Array(s);for(let Y=0;Y<s;Y++){const z=A*(Y+M*s),q=B.subarray(z,z+A);C[Y]=Ce(c0(q),n)}w[M]=C}return w}function Dc(t,e){const r=e.map(n=>Array.from(n).reverse());return(n,i)=>{const[s,f,a,d]=r.map(g=>g.reduce((E,A)=>t.add(t.mul(E,n),A)));return n=t.div(s,f),i=t.mul(i,t.div(a,d)),{x:n,y:i}}}function Wo(t,e,r){if(typeof e!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){const s=zo(n,2,{...r,DST:r.DST,...i}),f=t.fromAffine(e(s[0])),a=t.fromAffine(e(s[1])),d=f.add(a).clearCofactor();return d.assertValidity(),d},encodeToCurve(n,i){const s=zo(n,1,{...r,DST:r.encodeDST,...i}),f=t.fromAffine(e(s[0])).clearCofactor();return f.assertValidity(),f},mapToCurve(n){if(!Array.isArray(n))throw new Error("mapToCurve: expected array of bigints");for(const s of n)if(typeof s!="bigint")throw new Error("mapToCurve: expected array of bigints");const i=t.fromAffine(e(n)).clearCofactor();return i.assertValidity(),i}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Yo=BigInt(0),Gn=BigInt(1);function hs(t,e){const r=e.negate();return t?r:e}function Xc(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function ds(t,e){Xc(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1);return{windows:r,windowSize:n}}function h0(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function d0(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const ps=new WeakMap,Jc=new WeakMap;function ys(t){return Jc.get(t)||1}function Qc(t,e){return{constTimeNegate:hs,hasPrecomputes(r){return ys(r)!==1},unsafeLadder(r,n,i=t.ZERO){let s=r;for(;n>Yo;)n&Gn&&(i=i.add(s)),s=s.double(),n>>=Gn;return i},precomputeWindow(r,n){const{windows:i,windowSize:s}=ds(n,e),f=[];let a=r,d=a;for(let g=0;g<i;g++){d=a,f.push(d);for(let E=1;E<s;E++)d=d.add(a),f.push(d);a=d.double()}return f},wNAF(r,n,i){const{windows:s,windowSize:f}=ds(r,e);let a=t.ZERO,d=t.BASE;const g=BigInt(2**r-1),E=2**r,A=BigInt(r);for(let S=0;S<s;S++){const B=S*f;let w=Number(i&g);i>>=A,w>f&&(w-=E,i+=Gn);const M=B,C=B+Math.abs(w)-1,Y=S%2!==0,z=w<0;w===0?d=d.add(hs(Y,n[M])):a=a.add(hs(z,n[C]))}return{p:a,f:d}},wNAFUnsafe(r,n,i,s=t.ZERO){const{windows:f,windowSize:a}=ds(r,e),d=BigInt(2**r-1),g=2**r,E=BigInt(r);for(let A=0;A<f;A++){const S=A*a;if(i===Yo)break;let B=Number(i&d);if(i>>=E,B>a&&(B-=g,i+=Gn),B===0)continue;let w=n[S+Math.abs(B)-1];B<0&&(w=w.negate()),s=s.add(w)}return s},getPrecomputes(r,n,i){let s=ps.get(n);return s||(s=this.precomputeWindow(n,r),r!==1&&ps.set(n,i(s))),s},wNAFCached(r,n,i){const s=ys(r);return this.wNAF(s,this.getPrecomputes(s,r,i),n)},wNAFCachedUnsafe(r,n,i,s){const f=ys(r);return f===1?this.unsafeLadder(r,n,s):this.wNAFUnsafe(f,this.getPrecomputes(f,r,i),n,s)},setWindowSize(r,n){Xc(n,e),Jc.set(r,n),ps.delete(r)}}}function eu(t,e,r,n){if(h0(r,t),d0(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=t.ZERO,s=yn(BigInt(r.length)),f=s>12?s-3:s>4?s-2:s?2:1,a=(1<<f)-1,d=new Array(a+1).fill(i),g=Math.floor((e.BITS-1)/f)*f;let E=i;for(let A=g;A>=0;A-=f){d.fill(i);for(let B=0;B<n.length;B++){const w=n[B],M=Number(w>>BigInt(A)&BigInt(a));d[M]=d[M].add(r[B])}let S=i;for(let B=d.length-1,w=i;B>0;B--)w=w.add(d[B]),S=S.add(w);if(E=E.add(S),A!==0)for(let B=0;B<f;B++)E=E.double()}return E}function tu(t){return Wc(t.Fp),Pn(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Yc(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function p0(t){const e=tu(t);Pn(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const br=BigInt(0),He=BigInt(1),Dt=BigInt(2),Si=BigInt(3),Zo=BigInt(4);function Lo(t){const e=p0(t),{Fp:r}=e,n=$n(e.n,e.nBitLength),i=e.toBytes||((M,C,Y)=>{const z=C.toAffine();return Ke(Uint8Array.from([4]),r.toBytes(z.x),r.toBytes(z.y))}),s=e.fromBytes||(M=>{const C=M.subarray(1),Y=r.fromBytes(C.subarray(0,r.BYTES)),z=r.fromBytes(C.subarray(r.BYTES,2*r.BYTES));return{x:Y,y:z}});function f(M){const{a:C,b:Y}=e,z=r.sqr(M),q=r.mul(z,M);return r.add(r.add(q,r.mul(M,C)),Y)}if(!r.eql(r.sqr(e.Gy),f(e.Gx)))throw new Error("bad generator point: equation left != right");function a(M){return zc(M,He,e.n)}function d(M){const{allowedPrivateKeyLengths:C,nByteLength:Y,wrapPrivateKey:z,n:q}=e;if(C&&typeof M!="bigint"){if(zi(M)&&(M=Ir(M)),typeof M!="string"||!C.includes(M.length))throw new Error("invalid private key");M=M.padStart(Y*2,"0")}let re;try{re=typeof M=="bigint"?M:Et(ct("private key",M,Y))}catch{throw new Error("invalid private key, expected hex or "+Y+" bytes, got "+typeof M)}return z&&(re=Ce(re,q)),sr("private key",re,He,q),re}function g(M){if(!(M instanceof S))throw new Error("ProjectivePoint expected")}const E=vn((M,C)=>{const{px:Y,py:z,pz:q}=M;if(r.eql(q,r.ONE))return{x:Y,y:z};const re=M.is0();C==null&&(C=re?r.ONE:r.inv(q));const P=r.mul(Y,C),L=r.mul(z,C),Z=r.mul(q,C);if(re)return{x:r.ZERO,y:r.ZERO};if(!r.eql(Z,r.ONE))throw new Error("invZ was invalid");return{x:P,y:L}}),A=vn(M=>{if(M.is0()){if(e.allowInfinityPoint&&!r.is0(M.py))return;throw new Error("bad point: ZERO")}const{x:C,y:Y}=M.toAffine();if(!r.isValid(C)||!r.isValid(Y))throw new Error("bad point: x or y not FE");const z=r.sqr(Y),q=f(C);if(!r.eql(z,q))throw new Error("bad point: equation left != right");if(!M.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class S{constructor(C,Y,z){if(this.px=C,this.py=Y,this.pz=z,C==null||!r.isValid(C))throw new Error("x required");if(Y==null||!r.isValid(Y))throw new Error("y required");if(z==null||!r.isValid(z))throw new Error("z required");Object.freeze(this)}static fromAffine(C){const{x:Y,y:z}=C||{};if(!C||!r.isValid(Y)||!r.isValid(z))throw new Error("invalid affine point");if(C instanceof S)throw new Error("projective point not allowed");const q=re=>r.eql(re,r.ZERO);return q(Y)&&q(z)?S.ZERO:new S(Y,z,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(C){const Y=r.invertBatch(C.map(z=>z.pz));return C.map((z,q)=>z.toAffine(Y[q])).map(S.fromAffine)}static fromHex(C){const Y=S.fromAffine(s(ct("pointHex",C)));return Y.assertValidity(),Y}static fromPrivateKey(C){return S.BASE.multiply(d(C))}static msm(C,Y){return eu(S,n,C,Y)}_setWindowSize(C){w.setWindowSize(this,C)}assertValidity(){A(this)}hasEvenY(){const{y:C}=this.toAffine();if(r.isOdd)return!r.isOdd(C);throw new Error("Field doesn't support isOdd")}equals(C){g(C);const{px:Y,py:z,pz:q}=this,{px:re,py:P,pz:L}=C,Z=r.eql(r.mul(Y,L),r.mul(re,q)),J=r.eql(r.mul(z,L),r.mul(P,q));return Z&&J}negate(){return new S(this.px,r.neg(this.py),this.pz)}double(){const{a:C,b:Y}=e,z=r.mul(Y,Si),{px:q,py:re,pz:P}=this;let L=r.ZERO,Z=r.ZERO,J=r.ZERO,Q=r.mul(q,q),X=r.mul(re,re),he=r.mul(P,P),le=r.mul(q,re);return le=r.add(le,le),J=r.mul(q,P),J=r.add(J,J),L=r.mul(C,J),Z=r.mul(z,he),Z=r.add(L,Z),L=r.sub(X,Z),Z=r.add(X,Z),Z=r.mul(L,Z),L=r.mul(le,L),J=r.mul(z,J),he=r.mul(C,he),le=r.sub(Q,he),le=r.mul(C,le),le=r.add(le,J),J=r.add(Q,Q),Q=r.add(J,Q),Q=r.add(Q,he),Q=r.mul(Q,le),Z=r.add(Z,Q),he=r.mul(re,P),he=r.add(he,he),Q=r.mul(he,le),L=r.sub(L,Q),J=r.mul(he,X),J=r.add(J,J),J=r.add(J,J),new S(L,Z,J)}add(C){g(C);const{px:Y,py:z,pz:q}=this,{px:re,py:P,pz:L}=C;let Z=r.ZERO,J=r.ZERO,Q=r.ZERO;const X=e.a,he=r.mul(e.b,Si);let le=r.mul(Y,re),I=r.mul(z,P),U=r.mul(q,L),W=r.add(Y,z),G=r.add(re,P);W=r.mul(W,G),G=r.add(le,I),W=r.sub(W,G),G=r.add(Y,q);let H=r.add(re,L);return G=r.mul(G,H),H=r.add(le,U),G=r.sub(G,H),H=r.add(z,q),Z=r.add(P,L),H=r.mul(H,Z),Z=r.add(I,U),H=r.sub(H,Z),Q=r.mul(X,G),Z=r.mul(he,U),Q=r.add(Z,Q),Z=r.sub(I,Q),Q=r.add(I,Q),J=r.mul(Z,Q),I=r.add(le,le),I=r.add(I,le),U=r.mul(X,U),G=r.mul(he,G),I=r.add(I,U),U=r.sub(le,U),U=r.mul(X,U),G=r.add(G,U),le=r.mul(I,G),J=r.add(J,le),le=r.mul(H,G),Z=r.mul(W,Z),Z=r.sub(Z,le),le=r.mul(W,I),Q=r.mul(H,Q),Q=r.add(Q,le),new S(Z,J,Q)}subtract(C){return this.add(C.negate())}is0(){return this.equals(S.ZERO)}wNAF(C){return w.wNAFCached(this,C,S.normalizeZ)}multiplyUnsafe(C){const{endo:Y,n:z}=e;sr("scalar",C,br,z);const q=S.ZERO;if(C===br)return q;if(this.is0()||C===He)return this;if(!Y||w.hasPrecomputes(this))return w.wNAFCachedUnsafe(this,C,S.normalizeZ);let{k1neg:re,k1:P,k2neg:L,k2:Z}=Y.splitScalar(C),J=q,Q=q,X=this;for(;P>br||Z>br;)P&He&&(J=J.add(X)),Z&He&&(Q=Q.add(X)),X=X.double(),P>>=He,Z>>=He;return re&&(J=J.negate()),L&&(Q=Q.negate()),Q=new S(r.mul(Q.px,Y.beta),Q.py,Q.pz),J.add(Q)}multiply(C){const{endo:Y,n:z}=e;sr("scalar",C,He,z);let q,re;if(Y){const{k1neg:P,k1:L,k2neg:Z,k2:J}=Y.splitScalar(C);let{p:Q,f:X}=this.wNAF(L),{p:he,f:le}=this.wNAF(J);Q=w.constTimeNegate(P,Q),he=w.constTimeNegate(Z,he),he=new S(r.mul(he.px,Y.beta),he.py,he.pz),q=Q.add(he),re=X.add(le)}else{const{p:P,f:L}=this.wNAF(C);q=P,re=L}return S.normalizeZ([q,re])[0]}multiplyAndAddUnsafe(C,Y,z){const q=S.BASE,re=(L,Z)=>Z===br||Z===He||!L.equals(q)?L.multiplyUnsafe(Z):L.multiply(Z),P=re(this,Y).add(re(C,z));return P.is0()?void 0:P}toAffine(C){return E(this,C)}isTorsionFree(){const{h:C,isTorsionFree:Y}=e;if(C===He)return!0;if(Y)return Y(S,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:C,clearCofactor:Y}=e;return C===He?this:Y?Y(S,this):this.multiplyUnsafe(e.h)}toRawBytes(C=!0){return dn("isCompressed",C),this.assertValidity(),i(S,this,C)}toHex(C=!0){return dn("isCompressed",C),Ir(this.toRawBytes(C))}}S.BASE=new S(e.Gx,e.Gy,r.ONE),S.ZERO=new S(r.ZERO,r.ONE,r.ZERO);const B=e.nBitLength,w=Qc(S,e.endo?Math.ceil(B/2):B);return{CURVE:e,ProjectivePoint:S,normPrivateKeyToScalar:d,weierstrassEquation:f,isWithinCurveOrder:a}}function y0(t,e){const r=t.ORDER;let n=br;for(let w=r-He;w%Dt===br;w/=Dt)n+=He;const i=n,s=Dt<<i-He-He,f=s*Dt,a=(r-He)/f,d=(a-He)/Dt,g=f-He,E=s,A=t.pow(e,a),S=t.pow(e,(a+He)/Dt);let B=(w,M)=>{let C=A,Y=t.pow(M,g),z=t.sqr(Y);z=t.mul(z,M);let q=t.mul(w,z);q=t.pow(q,d),q=t.mul(q,Y),Y=t.mul(q,M),z=t.mul(q,w);let re=t.mul(z,Y);q=t.pow(re,E);let P=t.eql(q,t.ONE);Y=t.mul(z,S),q=t.mul(re,C),z=t.cmov(Y,z,P),re=t.cmov(q,re,P);for(let L=i;L>He;L--){let Z=L-Dt;Z=Dt<<Z-He;let J=t.pow(re,Z);const Q=t.eql(J,t.ONE);Y=t.mul(z,C),C=t.mul(C,C),J=t.mul(re,C),z=t.cmov(Y,z,Q),re=t.cmov(J,re,Q)}return{isValid:P,value:z}};if(t.ORDER%Zo===Si){const w=(t.ORDER-Si)/Zo,M=t.sqrt(t.neg(e));B=(C,Y)=>{let z=t.sqr(Y);const q=t.mul(C,Y);z=t.mul(z,q);let re=t.pow(z,w);re=t.mul(re,q);const P=t.mul(re,M),L=t.mul(t.sqr(re),Y),Z=t.eql(L,C);let J=t.cmov(P,re,Z);return{isValid:Z,value:J}}}return B}function ru(t,e){if(Wc(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const r=y0(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,s,f,a,d,g,E,A;i=t.sqr(n),i=t.mul(i,e.Z),s=t.sqr(i),s=t.add(s,i),f=t.add(s,t.ONE),f=t.mul(f,e.B),a=t.cmov(e.Z,t.neg(s),!t.eql(s,t.ZERO)),a=t.mul(a,e.A),s=t.sqr(f),g=t.sqr(a),d=t.mul(g,e.A),s=t.add(s,d),s=t.mul(s,f),g=t.mul(g,a),d=t.mul(g,e.B),s=t.add(s,d),E=t.mul(i,f);const{isValid:S,value:B}=r(s,g);A=t.mul(i,n),A=t.mul(A,B),E=t.cmov(E,f,S),A=t.cmov(A,B,S);const w=t.isOdd(n)===t.isOdd(A);return A=t.cmov(t.neg(A),A,w),E=t.div(E,a),{x:E,y:A}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const g0=BigInt(0),jn=BigInt(1),Do=BigInt(2),jr=BigInt(3);function w0(t){const e=[];for(;t>jn;t>>=jn)(t&jn)===g0?e.unshift(0):(t&jr)===jr?(e.unshift(-1),t+=jn):e.unshift(1);return e}function m0(t){const{Fp:e,Fr:r,Fp2:n,Fp6:i,Fp12:s}=t.fields,f=t.params.xNegative,a=t.params.twistType,d=Lo({n:r.ORDER,...t.G1}),g=Object.assign(d,Wo(d.ProjectivePoint,t.G1.mapToCurve,{...t.htfDefaults,...t.G1.htfDefaults})),E=Lo({n:r.ORDER,...t.G2}),A=Object.assign(E,Wo(E.ProjectivePoint,t.G2.mapToCurve,{...t.htfDefaults,...t.G2.htfDefaults}));let S;if(a==="multiplicative")S=(ee,m,se,ue,de,te)=>s.mul014(ue,ee,n.mul(m,de),n.mul(se,te));else if(a==="divisive")S=(ee,m,se,ue,de,te)=>s.mul034(ue,n.mul(se,te),n.mul(m,de),ee);else throw new Error("bls: unknown twist type");const B=n.div(n.ONE,n.mul(n.ONE,Do));function w(ee,m,se,ue){const de=n.sqr(se),te=n.sqr(ue),ae=n.mulByB(n.mul(te,jr)),b=n.mul(ae,jr),x=n.sub(n.sub(n.sqr(n.add(se,ue)),te),de),T=n.sub(ae,de),$=n.mul(n.sqr(m),jr),O=n.neg(x);return ee.push([T,$,O]),m=n.mul(n.mul(n.mul(n.sub(de,b),m),se),B),se=n.sub(n.sqr(n.mul(n.add(de,b),B)),n.mul(n.sqr(ae),jr)),ue=n.mul(de,x),{Rx:m,Ry:se,Rz:ue}}function M(ee,m,se,ue,de,te){const ae=n.sub(se,n.mul(te,ue)),b=n.sub(m,n.mul(de,ue)),x=n.sub(n.mul(ae,de),n.mul(b,te)),T=n.neg(ae),$=b;ee.push([x,T,$]);const O=n.sqr(b),k=n.mul(O,b),h=n.mul(O,m),o=n.add(n.sub(k,n.mul(h,Do)),n.mul(n.sqr(ae),ue));return m=n.mul(b,o),se=n.sub(n.mul(n.sub(h,o),ae),n.mul(k,se)),ue=n.mul(ue,k),{Rx:m,Ry:se,Rz:ue}}const C=w0(t.params.ateLoopSize),Y=vn(ee=>{const m=ee,{x:se,y:ue}=m.toAffine(),de=se,te=ue,ae=n.neg(ue);let b=de,x=te,T=n.ONE;const $=[];for(const O of C){const k=[];({Rx:b,Ry:x,Rz:T}=w(k,b,x,T)),O&&({Rx:b,Ry:x,Rz:T}=M(k,b,x,T,de,O===-1?ae:te)),$.push(k)}if(t.postPrecompute){const O=$[$.length-1];t.postPrecompute(b,x,T,de,te,M.bind(null,O))}return $});function z(ee,m=!1){let se=s.ONE;if(ee.length){const ue=ee[0][0].length;for(let de=0;de<ue;de++){se=s.sqr(se);for(const[te,ae,b]of ee)for(const[x,T,$]of te[de])se=S(x,T,$,se,ae,b)}}return f&&(se=s.conjugate(se)),m?s.finalExponentiate(se):se}function q(ee,m=!0){const se=[];g.ProjectivePoint.normalizeZ(ee.map(({g1:ue})=>ue)),A.ProjectivePoint.normalizeZ(ee.map(({g2:ue})=>ue));for(const{g1:ue,g2:de}of ee){if(ue.equals(g.ProjectivePoint.ZERO)||de.equals(A.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");ue.assertValidity(),de.assertValidity();const te=ue.toAffine();se.push([Y(de),te.x,te.y])}return z(se,m)}function re(ee,m,se=!0){return q([{g1:ee,g2:m}],se)}const P={randomPrivateKey:()=>{const ee=Lc(r.ORDER);return a0(t.randomBytes(ee),r.ORDER)},calcPairingPrecomputes:Y},{ShortSignature:L}=t.G1,{Signature:Z}=t.G2;function J(ee){return ee instanceof g.ProjectivePoint?ee:g.ProjectivePoint.fromHex(ee)}function Q(ee,m){return ee instanceof g.ProjectivePoint?ee:g.hashToCurve(ct("point",ee),m)}function X(ee){return ee instanceof A.ProjectivePoint?ee:Z.fromHex(ee)}function he(ee,m){return ee instanceof A.ProjectivePoint?ee:A.hashToCurve(ct("point",ee),m)}function le(ee){return g.ProjectivePoint.fromPrivateKey(ee).toRawBytes(!0)}function I(ee){return A.ProjectivePoint.fromPrivateKey(ee).toRawBytes(!0)}function U(ee,m,se){const ue=he(ee,se);ue.assertValidity();const de=ue.multiply(g.normPrivateKeyToScalar(m));return ee instanceof A.ProjectivePoint?de:Z.toRawBytes(de)}function W(ee,m,se){const ue=Q(ee,se);ue.assertValidity();const de=ue.multiply(g.normPrivateKeyToScalar(m));return ee instanceof g.ProjectivePoint?de:L.toRawBytes(de)}function G(ee,m,se,ue){const de=J(se),te=he(m,ue),ae=g.ProjectivePoint.BASE,b=X(ee),x=q([{g1:de.negate(),g2:te},{g1:ae,g2:b}]);return s.eql(x,s.ONE)}function H(ee,m,se,ue){const de=X(se),te=Q(m,ue),ae=A.ProjectivePoint.BASE,b=J(ee),x=q([{g1:te,g2:de},{g1:b,g2:ae.negate()}]);return s.eql(x,s.ONE)}function D(ee){if(!Array.isArray(ee)||ee.length===0)throw new Error("expected non-empty array")}function ie(ee){D(ee);const se=ee.map(J).reduce((ue,de)=>ue.add(de),g.ProjectivePoint.ZERO);return ee[0]instanceof g.ProjectivePoint?(se.assertValidity(),se):se.toRawBytes(!0)}function we(ee){D(ee);const se=ee.map(X).reduce((ue,de)=>ue.add(de),A.ProjectivePoint.ZERO);return ee[0]instanceof A.ProjectivePoint?(se.assertValidity(),se):Z.toRawBytes(se)}function oe(ee){D(ee);const se=ee.map(J).reduce((ue,de)=>ue.add(de),g.ProjectivePoint.ZERO);return ee[0]instanceof g.ProjectivePoint?(se.assertValidity(),se):L.toRawBytes(se)}function fe(ee,m,se,ue){if(D(m),se.length!==m.length)throw new Error("amount of public keys and messages should be equal");const de=X(ee),te=m.map(T=>he(T,ue)),ae=se.map(J),b=new Map;for(let T=0;T<ae.length;T++){const $=ae[T],O=te[T];let k=b.get(O);k===void 0&&(k=[],b.set(O,k)),k.push($)}const x=[];try{for(const[T,$]of b){const O=$.reduce((k,h)=>k.add(h));x.push({g1:O,g2:T})}return x.push({g1:g.ProjectivePoint.BASE.negate(),g2:de}),s.eql(q(x),s.ONE)}catch{return!1}}return g.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:le,getPublicKeyForShortSignatures:I,sign:U,signShortSignature:W,verify:G,verifyBatch:fe,verifyShortSignature:H,aggregatePublicKeys:ie,aggregateSignatures:we,aggregateShortSignatures:oe,millerLoopBatch:z,pairing:re,pairingBatch:q,G1:g,G2:A,Signature:Z,ShortSignature:L,fields:{Fr:r,Fp:e,Fp2:n,Fp6:i,Fp12:s},params:{ateLoopSize:t.params.ateLoopSize,r:t.params.r,G1b:t.G1.b,G2b:t.G2.b},utils:P}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const b0=BigInt(0),Kr=BigInt(1),qt=BigInt(2),Xo=BigInt(3);function gs(t,e,r,n,i=1,s){const f=BigInt(s===void 0?n:s),a=r**BigInt(n),d=[];for(let g=0;g<i;g++){const E=BigInt(g+1),A=[];for(let S=0,B=Kr;S<n;S++){const w=(E*B-E)/f%a;A.push(t.pow(e,w)),B*=r}d.push(A)}return d}function _0(t,e,r){const n=e.pow(r,(t.ORDER-Kr)/Xo),i=e.pow(r,(t.ORDER-Kr)/qt);function s(S,B){const w=e.mul(e.frobeniusMap(S,1),n),M=e.mul(e.frobeniusMap(B,1),i);return[w,M]}const f=e.pow(r,(t.ORDER**qt-Kr)/Xo),a=e.pow(r,(t.ORDER**qt-Kr)/qt);if(!e.eql(a,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function d(S,B){return[e.mul(S,f),e.neg(B)]}const g=S=>(B,w)=>{const M=w.toAffine(),C=S(M.x,M.y);return B.fromAffine({x:C[0],y:C[1]})},E=g(s),A=g(d);return{psi:s,psi2:d,G2psi:E,G2psi2:A,PSI_X:n,PSI_Y:i,PSI2_X:f,PSI2_Y:a}}function x0(t){const{ORDER:e}=t,r=$n(e),n=r.create(t.NONRESIDUE||BigInt(-1)),i=o0(e),s=r.div(r.ONE,qt),f=gs(r,n,r.ORDER,2)[0],a=({c0:I,c1:U},{c0:W,c1:G})=>({c0:r.add(I,W),c1:r.add(U,G)}),d=({c0:I,c1:U},{c0:W,c1:G})=>({c0:r.sub(I,W),c1:r.sub(U,G)}),g=({c0:I,c1:U},W)=>{if(typeof W=="bigint")return{c0:r.mul(I,W),c1:r.mul(U,W)};const{c0:G,c1:H}=W;let D=r.mul(I,G),ie=r.mul(U,H);const we=r.sub(D,ie),oe=r.sub(r.mul(r.add(I,U),r.add(G,H)),r.add(D,ie));return{c0:we,c1:oe}},E=({c0:I,c1:U})=>{const W=r.add(I,U),G=r.sub(I,U),H=r.add(I,I);return{c0:r.mul(W,G),c1:r.mul(H,U)}},A=I=>{if(I.length!==2)throw new Error("invalid tuple");const U=I.map(W=>r.create(W));return{c0:U[0],c1:U[1]}},S=e*e,B=A(t.FP2_NONRESIDUE),w={ORDER:S,isLE:r.isLE,NONRESIDUE:B,BITS:yn(S),BYTES:Math.ceil(yn(S)/8),MASK:Qn(yn(S)),ZERO:{c0:r.ZERO,c1:r.ZERO},ONE:{c0:r.ONE,c1:r.ZERO},create:I=>I,isValid:({c0:I,c1:U})=>typeof I=="bigint"&&typeof U=="bigint",is0:({c0:I,c1:U})=>r.is0(I)&&r.is0(U),eql:({c0:I,c1:U},{c0:W,c1:G})=>r.eql(I,W)&&r.eql(U,G),neg:({c0:I,c1:U})=>({c0:r.neg(I),c1:r.neg(U)}),pow:(I,U)=>ei(w,I,U),invertBatch:I=>ti(w,I),add:a,sub:d,mul:g,sqr:E,addN:a,subN:d,mulN:g,sqrN:E,div:(I,U)=>w.mul(I,typeof U=="bigint"?r.inv(r.create(U)):w.inv(U)),inv:({c0:I,c1:U})=>{const W=r.inv(r.create(I*I+U*U));return{c0:r.mul(W,r.create(I)),c1:r.mul(W,r.create(-U))}},sqrt:I=>{if(t.Fp2sqrt)return t.Fp2sqrt(I);const{c0:U,c1:W}=I;if(r.is0(W))return r.eql(i(r,U),r.ONE)?w.create({c0:r.sqrt(U),c1:r.ZERO}):w.create({c0:r.ZERO,c1:r.sqrt(r.div(U,n))});const G=r.sqrt(r.sub(r.sqr(U),r.mul(r.sqr(W),n)));let H=r.mul(r.add(G,U),s);const D=i(r,H);!r.is0(D)&&!r.eql(D,r.ONE)&&(H=r.sub(H,G));const ie=r.sqrt(H),we=w.create({c0:ie,c1:r.div(r.mul(W,s),ie)});if(!w.eql(w.sqr(we),I))throw new Error("Cannot find square root");const oe=we,fe=w.neg(oe),{re:ee,im:m}=w.reim(oe),{re:se,im:ue}=w.reim(fe);return m>ue||m===ue&&ee>se?oe:fe},isOdd:I=>{const{re:U,im:W}=w.reim(I),G=U%qt,H=U===b0,D=W%qt;return BigInt(G||H&&D)==Kr},fromBytes(I){if(I.length!==w.BYTES)throw new Error("fromBytes invalid length="+I.length);return{c0:r.fromBytes(I.subarray(0,r.BYTES)),c1:r.fromBytes(I.subarray(r.BYTES))}},toBytes:({c0:I,c1:U})=>Ke(r.toBytes(I),r.toBytes(U)),cmov:({c0:I,c1:U},{c0:W,c1:G},H)=>({c0:r.cmov(I,W,H),c1:r.cmov(U,G,H)}),reim:({c0:I,c1:U})=>({re:I,im:U}),mulByNonresidue:({c0:I,c1:U})=>w.mul({c0:I,c1:U},B),mulByB:t.Fp2mulByB,fromBigTuple:A,frobeniusMap:({c0:I,c1:U},W)=>({c0:I,c1:r.mul(U,f[W%2])})},M=({c0:I,c1:U,c2:W},{c0:G,c1:H,c2:D})=>({c0:w.add(I,G),c1:w.add(U,H),c2:w.add(W,D)}),C=({c0:I,c1:U,c2:W},{c0:G,c1:H,c2:D})=>({c0:w.sub(I,G),c1:w.sub(U,H),c2:w.sub(W,D)}),Y=({c0:I,c1:U,c2:W},G)=>{if(typeof G=="bigint")return{c0:w.mul(I,G),c1:w.mul(U,G),c2:w.mul(W,G)};const{c0:H,c1:D,c2:ie}=G,we=w.mul(I,H),oe=w.mul(U,D),fe=w.mul(W,ie);return{c0:w.add(we,w.mulByNonresidue(w.sub(w.mul(w.add(U,W),w.add(D,ie)),w.add(oe,fe)))),c1:w.add(w.sub(w.mul(w.add(I,U),w.add(H,D)),w.add(we,oe)),w.mulByNonresidue(fe)),c2:w.sub(w.add(oe,w.mul(w.add(I,W),w.add(H,ie))),w.add(we,fe))}},z=({c0:I,c1:U,c2:W})=>{let G=w.sqr(I),H=w.mul(w.mul(I,U),qt),D=w.mul(w.mul(U,W),qt),ie=w.sqr(W);return{c0:w.add(w.mulByNonresidue(D),G),c1:w.add(w.mulByNonresidue(ie),H),c2:w.sub(w.sub(w.add(w.add(H,w.sqr(w.add(w.sub(I,U),W))),D),G),ie)}},[q,re]=gs(w,B,r.ORDER,6,2,3),P={ORDER:w.ORDER,isLE:w.isLE,BITS:3*w.BITS,BYTES:3*w.BYTES,MASK:Qn(3*w.BITS),ZERO:{c0:w.ZERO,c1:w.ZERO,c2:w.ZERO},ONE:{c0:w.ONE,c1:w.ZERO,c2:w.ZERO},create:I=>I,isValid:({c0:I,c1:U,c2:W})=>w.isValid(I)&&w.isValid(U)&&w.isValid(W),is0:({c0:I,c1:U,c2:W})=>w.is0(I)&&w.is0(U)&&w.is0(W),neg:({c0:I,c1:U,c2:W})=>({c0:w.neg(I),c1:w.neg(U),c2:w.neg(W)}),eql:({c0:I,c1:U,c2:W},{c0:G,c1:H,c2:D})=>w.eql(I,G)&&w.eql(U,H)&&w.eql(W,D),sqrt:Ho,div:(I,U)=>P.mul(I,typeof U=="bigint"?r.inv(r.create(U)):P.inv(U)),pow:(I,U)=>ei(P,I,U),invertBatch:I=>ti(P,I),add:M,sub:C,mul:Y,sqr:z,addN:M,subN:C,mulN:Y,sqrN:z,inv:({c0:I,c1:U,c2:W})=>{let G=w.sub(w.sqr(I),w.mulByNonresidue(w.mul(W,U))),H=w.sub(w.mulByNonresidue(w.sqr(W)),w.mul(I,U)),D=w.sub(w.sqr(U),w.mul(I,W)),ie=w.inv(w.add(w.mulByNonresidue(w.add(w.mul(W,H),w.mul(U,D))),w.mul(I,G)));return{c0:w.mul(ie,G),c1:w.mul(ie,H),c2:w.mul(ie,D)}},fromBytes:I=>{if(I.length!==P.BYTES)throw new Error("fromBytes invalid length="+I.length);return{c0:w.fromBytes(I.subarray(0,w.BYTES)),c1:w.fromBytes(I.subarray(w.BYTES,2*w.BYTES)),c2:w.fromBytes(I.subarray(2*w.BYTES))}},toBytes:({c0:I,c1:U,c2:W})=>Ke(w.toBytes(I),w.toBytes(U),w.toBytes(W)),cmov:({c0:I,c1:U,c2:W},{c0:G,c1:H,c2:D},ie)=>({c0:w.cmov(I,G,ie),c1:w.cmov(U,H,ie),c2:w.cmov(W,D,ie)}),fromBigSix:I=>{if(!Array.isArray(I)||I.length!==6)throw new Error("invalid Fp6 usage");return{c0:w.fromBigTuple(I.slice(0,2)),c1:w.fromBigTuple(I.slice(2,4)),c2:w.fromBigTuple(I.slice(4,6))}},frobeniusMap:({c0:I,c1:U,c2:W},G)=>({c0:w.frobeniusMap(I,G),c1:w.mul(w.frobeniusMap(U,G),q[G%6]),c2:w.mul(w.frobeniusMap(W,G),re[G%6])}),mulByFp2:({c0:I,c1:U,c2:W},G)=>({c0:w.mul(I,G),c1:w.mul(U,G),c2:w.mul(W,G)}),mulByNonresidue:({c0:I,c1:U,c2:W})=>({c0:w.mulByNonresidue(W),c1:I,c2:U}),mul1:({c0:I,c1:U,c2:W},G)=>({c0:w.mulByNonresidue(w.mul(W,G)),c1:w.mul(I,G),c2:w.mul(U,G)}),mul01({c0:I,c1:U,c2:W},G,H){let D=w.mul(I,G),ie=w.mul(U,H);return{c0:w.add(w.mulByNonresidue(w.sub(w.mul(w.add(U,W),H),ie)),D),c1:w.sub(w.sub(w.mul(w.add(G,H),w.add(I,U)),D),ie),c2:w.add(w.sub(w.mul(w.add(I,W),G),D),ie)}}},L=gs(w,B,r.ORDER,12,1,6)[0],Z=({c0:I,c1:U},{c0:W,c1:G})=>({c0:P.add(I,W),c1:P.add(U,G)}),J=({c0:I,c1:U},{c0:W,c1:G})=>({c0:P.sub(I,W),c1:P.sub(U,G)}),Q=({c0:I,c1:U},W)=>{if(typeof W=="bigint")return{c0:P.mul(I,W),c1:P.mul(U,W)};let{c0:G,c1:H}=W,D=P.mul(I,G),ie=P.mul(U,H);return{c0:P.add(D,P.mulByNonresidue(ie)),c1:P.sub(P.mul(P.add(I,U),P.add(G,H)),P.add(D,ie))}},X=({c0:I,c1:U})=>{let W=P.mul(I,U);return{c0:P.sub(P.sub(P.mul(P.add(P.mulByNonresidue(U),I),P.add(I,U)),W),P.mulByNonresidue(W)),c1:P.add(W,W)}};function he(I,U){const W=w.sqr(I),G=w.sqr(U);return{first:w.add(w.mulByNonresidue(G),W),second:w.sub(w.sub(w.sqr(w.add(I,U)),W),G)}}const le={ORDER:w.ORDER,isLE:P.isLE,BITS:2*w.BITS,BYTES:2*w.BYTES,MASK:Qn(2*w.BITS),ZERO:{c0:P.ZERO,c1:P.ZERO},ONE:{c0:P.ONE,c1:P.ZERO},create:I=>I,isValid:({c0:I,c1:U})=>P.isValid(I)&&P.isValid(U),is0:({c0:I,c1:U})=>P.is0(I)&&P.is0(U),neg:({c0:I,c1:U})=>({c0:P.neg(I),c1:P.neg(U)}),eql:({c0:I,c1:U},{c0:W,c1:G})=>P.eql(I,W)&&P.eql(U,G),sqrt:Ho,inv:({c0:I,c1:U})=>{let W=P.inv(P.sub(P.sqr(I),P.mulByNonresidue(P.sqr(U))));return{c0:P.mul(I,W),c1:P.neg(P.mul(U,W))}},div:(I,U)=>le.mul(I,typeof U=="bigint"?r.inv(r.create(U)):le.inv(U)),pow:(I,U)=>ei(le,I,U),invertBatch:I=>ti(le,I),add:Z,sub:J,mul:Q,sqr:X,addN:Z,subN:J,mulN:Q,sqrN:X,fromBytes:I=>{if(I.length!==le.BYTES)throw new Error("fromBytes invalid length="+I.length);return{c0:P.fromBytes(I.subarray(0,P.BYTES)),c1:P.fromBytes(I.subarray(P.BYTES))}},toBytes:({c0:I,c1:U})=>Ke(P.toBytes(I),P.toBytes(U)),cmov:({c0:I,c1:U},{c0:W,c1:G},H)=>({c0:P.cmov(I,W,H),c1:P.cmov(U,G,H)}),fromBigTwelve:I=>({c0:P.fromBigSix(I.slice(0,6)),c1:P.fromBigSix(I.slice(6,12))}),frobeniusMap(I,U){const{c0:W,c1:G,c2:H}=P.frobeniusMap(I.c1,U),D=L[U%12];return{c0:P.frobeniusMap(I.c0,U),c1:P.create({c0:w.mul(W,D),c1:w.mul(G,D),c2:w.mul(H,D)})}},mulByFp2:({c0:I,c1:U},W)=>({c0:P.mulByFp2(I,W),c1:P.mulByFp2(U,W)}),conjugate:({c0:I,c1:U})=>({c0:I,c1:P.neg(U)}),mul014:({c0:I,c1:U},W,G,H)=>{let D=P.mul01(I,W,G),ie=P.mul1(U,H);return{c0:P.add(P.mulByNonresidue(ie),D),c1:P.sub(P.sub(P.mul01(P.add(U,I),W,w.add(G,H)),D),ie)}},mul034:({c0:I,c1:U},W,G,H)=>{const D=P.create({c0:w.mul(I.c0,W),c1:w.mul(I.c1,W),c2:w.mul(I.c2,W)}),ie=P.mul01(U,G,H),we=P.mul01(P.add(I,U),w.add(W,G),H);return{c0:P.add(P.mulByNonresidue(ie),D),c1:P.sub(we,P.add(D,ie))}},_cyclotomicSquare:t.Fp12cyclotomicSquare,_cyclotomicExp:t.Fp12cyclotomicExp,finalExponentiate:t.Fp12finalExponentiate};return{Fp:r,Fp2:w,Fp6:P,Fp4Square:he,Fp12:le}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const at=BigInt(0),Ni=BigInt(1),De=BigInt(2),Kn=BigInt(3),gn=BigInt(4),tr=BigInt("0xd201000000010000"),E0=yn(tr),{Fp:ge,Fp2:me,Fp6:Hs,Fp4Square:ws,Fp12:Se}=x0({ORDER:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),FP2_NONRESIDUE:[Ni,Ni],Fp2mulByB:({c0:t,c1:e})=>{const r=ge.mul(t,gn),n=ge.mul(e,gn);return{c0:ge.sub(r,n),c1:ge.add(r,n)}},Fp12cyclotomicSquare:({c0:t,c1:e})=>{const{c0:r,c1:n,c2:i}=t,{c0:s,c1:f,c2:a}=e,{first:d,second:g}=ws(r,f),{first:E,second:A}=ws(s,i),{first:S,second:B}=ws(n,a),w=me.mulByNonresidue(B);return{c0:Hs.create({c0:me.add(me.mul(me.sub(d,r),De),d),c1:me.add(me.mul(me.sub(E,n),De),E),c2:me.add(me.mul(me.sub(S,i),De),S)}),c1:Hs.create({c0:me.add(me.mul(me.add(w,s),De),w),c1:me.add(me.mul(me.add(g,f),De),g),c2:me.add(me.mul(me.add(A,a),De),A)})}},Fp12cyclotomicExp(t,e){let r=Se.ONE;for(let n=E0-1;n>=0;n--)r=Se._cyclotomicSquare(r),Jl(e,n)&&(r=Se.mul(r,t));return r},Fp12finalExponentiate:t=>{const e=tr,r=Se.div(Se.frobeniusMap(t,6),t),n=Se.mul(Se.frobeniusMap(r,2),r),i=Se.conjugate(Se._cyclotomicExp(n,e)),s=Se.mul(Se.conjugate(Se._cyclotomicSquare(n)),i),f=Se.conjugate(Se._cyclotomicExp(s,e)),a=Se.conjugate(Se._cyclotomicExp(f,e)),d=Se.mul(Se.conjugate(Se._cyclotomicExp(a,e)),Se._cyclotomicSquare(i)),g=Se.conjugate(Se._cyclotomicExp(d,e)),E=Se.frobeniusMap(Se.mul(i,a),2),A=Se.frobeniusMap(Se.mul(f,n),3),S=Se.frobeniusMap(Se.mul(d,Se.conjugate(n)),1),B=Se.mul(Se.mul(g,Se.conjugate(s)),n);return Se.mul(Se.mul(Se.mul(E,A),S),B)}}),Jo=$n(BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001")),v0=Dc(me,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(t=>t.map(e=>me.fromBigTuple(e.map(BigInt))))),A0=Dc(ge,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(e=>BigInt(e)))),B0=ru(me,{A:me.create({c0:ge.create(at),c1:ge.create(BigInt(240))}),B:me.create({c0:ge.create(BigInt(1012)),c1:ge.create(BigInt(1012))}),Z:me.create({c0:ge.create(BigInt(-2)),c1:ge.create(BigInt(-1))})}),T0=ru(ge,{A:ge.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:ge.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:ge.create(BigInt(11))}),{G2psi:Qo,G2psi2:S0}=_0(ge,me,me.div(me.ONE,me.NONRESIDUE)),ms=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:ge.ORDER,m:2,k:128,expand:"xmd",hash:Xs}),Ii=Bn(ge.toBytes(at),{infinity:!0,compressed:!0});function zn(t){t=t.slice();const e=t[0]&224,r=!!(e>>7&1),n=!!(e>>6&1),i=!!(e>>5&1);return t[0]&=31,{compressed:r,infinity:n,sort:i,value:t}}function Bn(t,e){if(t[0]&224)throw new Error("setMask: non-empty mask");return e.compressed&&(t[0]|=128),e.infinity&&(t[0]|=64),e.sort&&(t[0]|=32),t}function ea(t){t.assertValidity();const e=t.equals(dt.G1.ProjectivePoint.ZERO),{x:r,y:n}=t.toAffine();if(e)return Ii.slice();const i=ge.ORDER,s=!!(n*De/i);return Bn(et(r,ge.BYTES),{compressed:!0,sort:s})}function ta(t){t.assertValidity();const e=ge.BYTES;if(t.equals(dt.G2.ProjectivePoint.ZERO))return Ke(Ii,et(at,e));const{x:r,y:n}=t.toAffine(),{re:i,im:s}=me.reim(r),{re:f,im:a}=me.reim(n),g=!!((a>at?a*De:f*De)/ge.ORDER&Ni),E=i;return Ke(Bn(et(s,e),{sort:g,compressed:!0}),et(E,e))}const dt=m0({fields:{Fp:ge,Fp2:me,Fp6:Hs,Fp12:Se,Fr:Jo},G1:{Fp:ge,h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1"),a:ge.ZERO,b:gn,htfDefaults:{...ms,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(t,e)=>{const r=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),n=new t(ge.mul(e.px,r),e.py,e.pz);return e.multiplyUnsafe(tr).negate().multiplyUnsafe(tr).equals(n)},clearCofactor:(t,e)=>e.multiplyUnsafe(tr).add(e),mapToCurve:t=>{const{x:e,y:r}=T0(ge.create(t[0]));return A0(e,r)},fromBytes:t=>{const{compressed:e,infinity:r,sort:n,value:i}=zn(t);if(i.length===48&&e){const s=ge.ORDER,f=Et(i),a=ge.create(f&ge.MASK);if(r){if(a!==at)throw new Error("G1: non-empty compressed point at infinity");return{x:at,y:at}}const d=ge.add(ge.pow(a,Kn),ge.create(dt.params.G1b));let g=ge.sqrt(d);if(!g)throw new Error("invalid compressed G1 point");return g*De/s!==BigInt(n)&&(g=ge.neg(g)),{x:ge.create(a),y:ge.create(g)}}else if(i.length===96&&!e){const s=Et(i.subarray(0,ge.BYTES)),f=Et(i.subarray(ge.BYTES));if(r){if(s!==at||f!==at)throw new Error("G1: non-empty point at infinity");return dt.G1.ProjectivePoint.ZERO.toAffine()}return{x:ge.create(s),y:ge.create(f)}}else throw new Error("invalid point G1, expected 48/96 bytes")},toBytes:(t,e,r)=>{const n=e.equals(t.ZERO),{x:i,y:s}=e.toAffine();if(r){if(n)return Ii.slice();const f=ge.ORDER,a=!!(s*De/f);return Bn(et(i,ge.BYTES),{compressed:!0,sort:a})}else return n?Ke(new Uint8Array([64]),new Uint8Array(2*ge.BYTES-1)):Ke(et(i,ge.BYTES),et(s,ge.BYTES))},ShortSignature:{fromHex(t){const{infinity:e,sort:r,value:n}=zn(ct("signatureHex",t,48)),i=ge.ORDER,s=Et(n);if(e)return dt.G1.ProjectivePoint.ZERO;const f=ge.create(s&ge.MASK),a=ge.add(ge.pow(f,Kn),ge.create(dt.params.G1b));let d=ge.sqrt(a);if(!d)throw new Error("invalid compressed G1 point");const g=BigInt(r);d*De/i!==g&&(d=ge.neg(d));const E=dt.G1.ProjectivePoint.fromAffine({x:f,y:d});return E.assertValidity(),E},toRawBytes(t){return ea(t)},toHex(t){return Ir(ea(t))}}},G2:{Fp:me,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),Gx:me.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:me.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")]),a:me.ZERO,b:me.fromBigTuple([gn,gn]),hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...ms},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:t=>{const{x:e,y:r}=B0(me.fromBigTuple(t));return v0(e,r)},isTorsionFree:(t,e)=>e.multiplyUnsafe(tr).negate().equals(Qo(t,e)),clearCofactor:(t,e)=>{const r=tr;let n=e.multiplyUnsafe(r).negate(),i=Qo(t,e),s=e.double();return s=S0(t,s),s=s.subtract(i),i=n.add(i),i=i.multiplyUnsafe(r).negate(),s=s.add(i),s=s.subtract(n),s.subtract(e)},fromBytes:t=>{const{compressed:e,infinity:r,sort:n,value:i}=zn(t);if(!e&&!r&&n||!e&&r&&n||n&&r&&e)throw new Error("invalid encoding flag: "+(t[0]&224));const s=ge.BYTES,f=(a,d,g)=>Et(a.slice(d,g));if(i.length===96&&e){const a=dt.params.G2b,d=ge.ORDER;if(r){if(i.reduce((M,C)=>M!==0?C+1:C,0)>0)throw new Error("invalid compressed G2 point");return{x:me.ZERO,y:me.ZERO}}const g=f(i,0,s),E=f(i,s,2*s),A=me.create({c0:ge.create(E),c1:ge.create(g)}),S=me.add(me.pow(A,Kn),a);let B=me.sqrt(S);const w=B.c1===at?B.c0*De/d:B.c1*De/d?Ni:at;return B=n&&w>0?B:me.neg(B),{x:A,y:B}}else if(i.length===192&&!e){if(r){if(i.reduce((A,S)=>A!==0?S+1:S,0)>0)throw new Error("invalid uncompressed G2 point");return{x:me.ZERO,y:me.ZERO}}const a=f(i,0,s),d=f(i,s,2*s),g=f(i,2*s,3*s),E=f(i,3*s,4*s);return{x:me.fromBigTuple([d,a]),y:me.fromBigTuple([E,g])}}else throw new Error("invalid point G2, expected 96/192 bytes")},toBytes:(t,e,r)=>{const{BYTES:n,ORDER:i}=ge,s=e.equals(t.ZERO),{x:f,y:a}=e.toAffine();if(r){if(s)return Ke(Ii,et(at,n));const d=!!(a.c1===at?a.c0*De/i:a.c1*De/i);return Ke(Bn(et(f.c1,n),{compressed:!0,sort:d}),et(f.c0,n))}else{if(s)return Ke(new Uint8Array([64]),new Uint8Array(4*n-1));const{re:d,im:g}=me.reim(f),{re:E,im:A}=me.reim(a);return Ke(et(g,n),et(d,n),et(A,n),et(E,n))}},Signature:{fromHex(t){const{infinity:e,sort:r,value:n}=zn(ct("signatureHex",t)),i=ge.ORDER,s=n.length/2;if(s!==48&&s!==96)throw new Error("invalid compressed signature length, must be 96 or 192");const f=Et(n.slice(0,s)),a=Et(n.slice(s));if(e)return dt.G2.ProjectivePoint.ZERO;const d=ge.create(f&ge.MASK),g=ge.create(a),E=me.create({c0:g,c1:d}),A=me.add(me.pow(E,Kn),dt.params.G2b);let S=me.sqrt(A);if(!S)throw new Error("Failed to find a square root");const{re:B,im:w}=me.reim(S),M=BigInt(r),C=w>at&&w*De/i!==M,Y=w===at&&B*De/i!==M;(C||Y)&&(S=me.neg(S));const z=dt.G2.ProjectivePoint.fromAffine({x:E,y:S});return z.assertValidity(),z},toRawBytes(t){return ta(t)},toHex(t){return Ir(ta(t))}}},params:{ateLoopSize:tr,r:Jo.ORDER,xNegative:!0,twistType:"multiplicative"},htfDefaults:ms,hash:Xs,randomBytes:Oa});function N0(t,e,r){const n=typeof t=="string"?t:ke(t),i=typeof e=="string"?e:ke(e),s=typeof r=="string"?r:ke(r);return dt.verifyShortSignature(i,s,n)}const nu=t=>Le(new en(t)),fo=t=>{const e=nu(t);return new Date(Number(e)/1e6)};var I0=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},R0=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},ri;class Ut extends qe{constructor(e){super(`Invalid certificate: ${e}`)}}var lt;(function(t){t[t.Empty=0]="Empty",t[t.Fork=1]="Fork",t[t.Labeled=2]="Labeled",t[t.Leaf=3]="Leaf",t[t.Pruned=4]="Pruned"})(lt||(lt={}));function O0(t,e){const r=new Uint8Array(t),n=new Uint8Array(e);for(let i=0;i<r.length;i++)if(r[i]>n[i])return!0;return!1}class Er{constructor(e,r,n,i,s=5,f=!1){this._rootKey=r,this._canisterId=n,this._blsVerify=i,this._maxAgeInMinutes=s,ri.set(this,!1),I0(this,ri,f,"f"),this.cert=Gt(new Uint8Array(e))}static async create(e){const r=Er.createUnverified(e);return await r.verify(),r}static createUnverified(e){let r=e.blsVerify;return r||(r=N0),new Er(e.certificate,e.rootKey,e.canisterId,r,e.maxAgeInMinutes,e.disableTimeVerification)}lookup(e){return Qr(e,this.cert.tree)}lookup_label(e){return this.lookup([e])}async verify(){const e=await ni(this.cert.tree),r=await this._checkDelegationAndGetKey(this.cert.delegation),n=this.cert.signature,i=F0(r),s=At(an("ic-state-root"),e);let f=!1;const a=yt(this.lookup(["time"]));if(!a)throw new Ut("Certificate does not contain a time");if(!R0(this,ri,"f")){const g=this._maxAgeInMinutes*60*1e3,E=Date.now(),A=E-g,S=E+3e5,B=fo(a);if(B.getTime()<A)throw new Ut(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: `+B.toISOString()+" Current time: "+new Date(E).toISOString());if(B.getTime()>S)throw new Ut("Certificate is signed more than 5 minutes in the future. Certificate time: "+B.toISOString()+" Current time: "+new Date(E).toISOString())}try{f=await this._blsVerify(new Uint8Array(i),new Uint8Array(n),new Uint8Array(s))}catch{f=!1}if(!f)throw new Ut("Signature verification failed")}async _checkDelegationAndGetKey(e){if(!e)return this._rootKey;const r=await Er.createUnverified({certificate:e.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,maxAgeInMinutes:1/0});if(r.cert.delegation)throw new Ut("Delegation certificates cannot be nested");if(await r.verify(),this._canisterId.toString()!==Sh&&!iu({canisterId:this._canisterId,subnetId:ve.fromUint8Array(new Uint8Array(e.subnet_id)),tree:r.cert.tree}))throw new Ut(`Canister ${this._canisterId} not in range of delegations for subnet 0x${ke(e.subnet_id)}`);const n=yt(r.lookup(["subnet",e.subnet_id,"public_key"]));if(!n)throw new Error(`Could not find subnet key for subnet 0x${ke(e.subnet_id)}`);return n}}ri=new WeakMap;const sn=Kt("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),U0=96;function F0(t){const e=sn.byteLength+U0;if(t.byteLength!==e)throw new TypeError(`BLS DER-encoded public key must be ${e} bytes long`);const r=t.slice(0,sn.byteLength);if(!Rn(r,sn))throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${sn}, but get ${r}`);return t.slice(sn.byteLength)}function yt(t){if(t.status===ze.Found){if(t.value instanceof ArrayBuffer)return t.value;if(t.value instanceof Uint8Array)return t.value.buffer}}async function ni(t){switch(t[0]){case lt.Empty:return vt(an("ic-hashtree-empty"));case lt.Pruned:return t[1];case lt.Leaf:return vt(At(an("ic-hashtree-leaf"),t[1]));case lt.Labeled:return vt(At(an("ic-hashtree-labeled"),t[1],await ni(t[2])));case lt.Fork:return vt(At(an("ic-hashtree-fork"),await ni(t[1]),await ni(t[2])));default:throw new Error("unreachable")}}function an(t){const e=new Uint8Array([t.length]),r=new TextEncoder().encode(t);return At(e,r)}var ze;(function(t){t.Unknown="unknown",t.Absent="absent",t.Found="found"})(ze||(ze={}));var Vt;(function(t){t.Less="less",t.Greater="greater"})(Vt||(Vt={}));function Qr(t,e){if(t.length===0)switch(e[0]){case lt.Leaf:{if(!e[1])throw new Error("Invalid tree structure for leaf");return e[1]instanceof ArrayBuffer?{status:ze.Found,value:e[1]}:e[1]instanceof Uint8Array?{status:ze.Found,value:e[1].buffer}:{status:ze.Found,value:e[1]}}default:return{status:ze.Found,value:e}}const r=typeof t[0]=="string"?new TextEncoder().encode(t[0]):t[0],n=ii(r,e);switch(n.status){case ze.Found:return Qr(t.slice(1),n.value);case Vt.Greater:case Vt.Less:return{status:ze.Absent};default:return n}}function Gs(t){switch(t[0]){case lt.Empty:return[];case lt.Fork:return Gs(t[1]).concat(Gs(t[2]));default:return[t]}}function ii(t,e){switch(e[0]){case lt.Labeled:return O0(t,e[1])?{status:Vt.Greater}:Rn(t,e[1])?{status:ze.Found,value:e[2]}:{status:Vt.Less};case lt.Fork:const r=ii(t,e[1]);switch(r.status){case Vt.Greater:{const n=ii(t,e[2]);return n.status===Vt.Less?{status:ze.Absent}:n}case ze.Unknown:{let n=ii(t,e[2]);return n.status===Vt.Less?{status:ze.Unknown}:n}default:return r}case lt.Pruned:return{status:ze.Unknown};default:return{status:ze.Absent}}}function iu(t){const{canisterId:e,subnetId:r,tree:n}=t,i=Qr(["subnet",r.toUint8Array(),"canister_ranges"],n);if(i.status!==ze.Found||!(i.value instanceof ArrayBuffer))throw new Error(`Could not find canister ranges for subnet ${r}`);return Gt(i.value).map(d=>[ve.fromUint8Array(d[0]),ve.fromUint8Array(d[1])]).some(d=>d[0].ltEq(e)&&d[1].gtEq(e))}class P0{constructor(e,r,n){this.key=e,this.path=r,this.decodeStrategy=n}}const su=async t=>{const{agent:e,paths:r}=t,n=ve.from(t.canisterId),i=[...new Set(r)],s=i.map(d=>js(d,n)),f=new Map,a=i.map((d,g)=>(async()=>{var E;try{const A=await e.readState(n,{paths:[s[g]]});if(e.rootKey==null)throw new Error("Agent is missing root key");const S=await Er.create({certificate:A.certificate,rootKey:e.rootKey,canisterId:n,disableTimeVerification:!0}),B=(C,Y)=>{if(Y==="subnet"){if(e.rootKey==null)throw new Error("Agent is missing root key");const z=ou(A.certificate,n,e.rootKey);return{path:Y,data:z}}else return{path:Y,data:yt(C.lookup(js(Y,n)))}},{path:w,data:M}=B(S,i[g]);if(!M)console.warn(`Expected to find result for path ${w}, but instead found nothing.`),typeof w=="string"?f.set(w,null):f.set(w.key,null);else switch(w){case"time":{f.set(w,fo(M));break}case"controllers":{f.set(w,k0(M));break}case"module_hash":{f.set(w,ra(M));break}case"subnet":{f.set(w,M);break}case"candid":{f.set(w,new TextDecoder().decode(M));break}default:if(typeof w!="string"&&"key"in w&&"path"in w)switch(w.decodeStrategy){case"raw":f.set(w.key,M);break;case"leb128":{f.set(w.key,nu(M));break}case"cbor":{f.set(w.key,au(M));break}case"hex":{f.set(w.key,ra(M));break}case"utf-8":f.set(w.key,$0(M))}}}catch(A){if(!((E=A==null?void 0:A.message)===null||E===void 0)&&E.includes("Invalid certificate"))throw new qe(A.message);typeof d!="string"&&"key"in d&&"path"in d?f.set(d.key,null):f.set(d,null),console.group(),console.warn(`Expected to find result for path ${d}, but instead found nothing.`),console.warn(A),console.groupEnd()}})());return await Promise.all(a),f},ou=(t,e,r)=>{if(!e._isPrincipal)throw new Error("Invalid canisterId");const n=Gt(new Uint8Array(t)),i=n.tree;let s=n.delegation,f;if(s&&s.subnet_id?f=ve.fromUint8Array(new Uint8Array(s.subnet_id)):!s&&typeof r<"u"?(f=ve.selfAuthenticating(new Uint8Array(r)),s={subnet_id:f.toUint8Array(),certificate:new ArrayBuffer(0)}):(f=ve.selfAuthenticating(ve.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),s={subnet_id:f.toUint8Array(),certificate:new ArrayBuffer(0)}),!iu({canisterId:e,subnetId:f,tree:i}))throw new Error("Canister not in range");const d=Qr(["subnet",s.subnet_id,"node"],i);if(d.status!==ze.Found)throw new Error("Node not found");if(d.value instanceof ArrayBuffer)throw new Error("Invalid node tree");const g=Gs(d.value),E=new Map;return g.forEach(A=>{const S=ve.from(new Uint8Array(A[1])).toText(),B=Qr(["public_key"],A[2]);if(B.status!==ze.Found)throw new Error("Public key not found");const w=B.value;if(w.byteLength!==44)throw new Error("Invalid public key length");E.set(S,w)}),{subnetId:ve.fromUint8Array(new Uint8Array(s.subnet_id)).toText(),nodeKeys:E}},js=(t,e)=>{const r=new TextEncoder,n=s=>new DataView(r.encode(s).buffer).buffer,i=new DataView(e.toUint8Array().buffer).buffer;switch(t){case"time":return[n("time")];case"controllers":return[n("canister"),i,n("controllers")];case"module_hash":return[n("canister"),i,n("module_hash")];case"subnet":return[n("subnet")];case"candid":return[n("canister"),i,n("metadata"),n("candid:service")];default:if("key"in t&&"path"in t)if(typeof t.path=="string"||t.path instanceof ArrayBuffer){const s=t.path,f=typeof s=="string"?n(s):s;return[n("canister"),i,n("metadata"),f]}else return t.path}throw new Error(`An unexpeected error was encountered while encoding your path for canister status. Please ensure that your path, ${t} was formatted correctly.`)},ra=t=>ke(t),au=t=>Gt(t),$0=t=>new TextDecoder().decode(t),k0=t=>au(t).map(r=>ve.fromUint8Array(new Uint8Array(r))),M0=Object.freeze(Object.defineProperty({__proto__:null,CustomPath:P0,encodePath:js,fetchNodeKeys:ou,request:su},Symbol.toStringTag,{value:"Module"})),Wn=BigInt(2**32-1),Ks=BigInt(32);function cu(t,e=!1){return e?{h:Number(t&Wn),l:Number(t>>Ks&Wn)}:{h:Number(t>>Ks&Wn)|0,l:Number(t&Wn)|0}}function C0(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:f}=cu(t[i],e);[r[i],n[i]]=[s,f]}return[r,n]}const q0=(t,e)=>BigInt(t>>>0)<<Ks|BigInt(e>>>0),V0=(t,e,r)=>t>>>r,H0=(t,e,r)=>t<<32-r|e>>>r,G0=(t,e,r)=>t>>>r|e<<32-r,j0=(t,e,r)=>t<<32-r|e>>>r,K0=(t,e,r)=>t<<64-r|e>>>r-32,z0=(t,e,r)=>t>>>r-32|e<<64-r,W0=(t,e)=>e,Y0=(t,e)=>t,Z0=(t,e,r)=>t<<r|e>>>32-r,L0=(t,e,r)=>e<<r|t>>>32-r,D0=(t,e,r)=>e<<r-32|t>>>64-r,X0=(t,e,r)=>t<<r-32|e>>>64-r;function J0(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}const Q0=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),eh=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,th=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),rh=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,nh=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),ih=(t,e,r,n,i,s)=>e+r+n+i+s+(t/2**32|0)|0,sh={fromBig:cu,split:C0,toBig:q0,shrSH:V0,shrSL:H0,rotrSH:G0,rotrSL:j0,rotrBH:K0,rotrBL:z0,rotr32H:W0,rotr32L:Y0,rotlSH:Z0,rotlSL:L0,rotlBH:D0,rotlBL:X0,add:J0,add3L:Q0,add3H:eh,add4L:th,add4H:rh,add5H:ih,add5L:nh},Ae=sh,[oh,ah]=(()=>Ae.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))))(),Xt=new Uint32Array(80),Jt=new Uint32Array(80);class ch extends Ua{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:n,Bl:i,Ch:s,Cl:f,Dh:a,Dl:d,Eh:g,El:E,Fh:A,Fl:S,Gh:B,Gl:w,Hh:M,Hl:C}=this;return[e,r,n,i,s,f,a,d,g,E,A,S,B,w,M,C]}set(e,r,n,i,s,f,a,d,g,E,A,S,B,w,M,C){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=f|0,this.Dh=a|0,this.Dl=d|0,this.Eh=g|0,this.El=E|0,this.Fh=A|0,this.Fl=S|0,this.Gh=B|0,this.Gl=w|0,this.Hh=M|0,this.Hl=C|0}process(e,r){for(let q=0;q<16;q++,r+=4)Xt[q]=e.getUint32(r),Jt[q]=e.getUint32(r+=4);for(let q=16;q<80;q++){const re=Xt[q-15]|0,P=Jt[q-15]|0,L=Ae.rotrSH(re,P,1)^Ae.rotrSH(re,P,8)^Ae.shrSH(re,P,7),Z=Ae.rotrSL(re,P,1)^Ae.rotrSL(re,P,8)^Ae.shrSL(re,P,7),J=Xt[q-2]|0,Q=Jt[q-2]|0,X=Ae.rotrSH(J,Q,19)^Ae.rotrBH(J,Q,61)^Ae.shrSH(J,Q,6),he=Ae.rotrSL(J,Q,19)^Ae.rotrBL(J,Q,61)^Ae.shrSL(J,Q,6),le=Ae.add4L(Z,he,Jt[q-7],Jt[q-16]),I=Ae.add4H(le,L,X,Xt[q-7],Xt[q-16]);Xt[q]=I|0,Jt[q]=le|0}let{Ah:n,Al:i,Bh:s,Bl:f,Ch:a,Cl:d,Dh:g,Dl:E,Eh:A,El:S,Fh:B,Fl:w,Gh:M,Gl:C,Hh:Y,Hl:z}=this;for(let q=0;q<80;q++){const re=Ae.rotrSH(A,S,14)^Ae.rotrSH(A,S,18)^Ae.rotrBH(A,S,41),P=Ae.rotrSL(A,S,14)^Ae.rotrSL(A,S,18)^Ae.rotrBL(A,S,41),L=A&B^~A&M,Z=S&w^~S&C,J=Ae.add5L(z,P,Z,ah[q],Jt[q]),Q=Ae.add5H(J,Y,re,L,oh[q],Xt[q]),X=J|0,he=Ae.rotrSH(n,i,28)^Ae.rotrBH(n,i,34)^Ae.rotrBH(n,i,39),le=Ae.rotrSL(n,i,28)^Ae.rotrBL(n,i,34)^Ae.rotrBL(n,i,39),I=n&s^n&a^s&a,U=i&f^i&d^f&d;Y=M|0,z=C|0,M=B|0,C=w|0,B=A|0,w=S|0,{h:A,l:S}=Ae.add(g|0,E|0,Q|0,X|0),g=a|0,E=d|0,a=s|0,d=f|0,s=n|0,f=i|0;const W=Ae.add3L(X,le,U);n=Ae.add3H(W,Q,he,I),i=W|0}({h:n,l:i}=Ae.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:f}=Ae.add(this.Bh|0,this.Bl|0,s|0,f|0),{h:a,l:d}=Ae.add(this.Ch|0,this.Cl|0,a|0,d|0),{h:g,l:E}=Ae.add(this.Dh|0,this.Dl|0,g|0,E|0),{h:A,l:S}=Ae.add(this.Eh|0,this.El|0,A|0,S|0),{h:B,l:w}=Ae.add(this.Fh|0,this.Fl|0,B|0,w|0),{h:M,l:C}=Ae.add(this.Gh|0,this.Gl|0,M|0,C|0),{h:Y,l:z}=Ae.add(this.Hh|0,this.Hl|0,Y|0,z|0),this.set(n,i,s,f,a,d,g,E,A,S,B,w,M,C,Y,z)}roundClean(){Xt.fill(0),Jt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const uh=Ds(()=>new ch);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const mt=BigInt(0),ut=BigInt(1),Yn=BigInt(2),fh=BigInt(8),lh={zip215:!0};function hh(t){const e=tu(t);return Pn(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function dh(t){const e=hh(t),{Fp:r,n,prehash:i,hash:s,randomBytes:f,nByteLength:a,h:d}=e,g=Yn<<BigInt(a*8)-ut,E=r.create,A=$n(e.n,e.nBitLength),S=e.uvRatio||((G,H)=>{try{return{isValid:!0,value:r.sqrt(G*r.inv(H))}}catch{return{isValid:!1,value:mt}}}),B=e.adjustScalarBytes||(G=>G),w=e.domain||((G,H,D)=>{if(dn("phflag",D),H.length||D)throw new Error("Contexts/pre-hash are not supported");return G});function M(G,H){sr("coordinate "+G,H,mt,g)}function C(G){if(!(G instanceof q))throw new Error("ExtendedPoint expected")}const Y=vn((G,H)=>{const{ex:D,ey:ie,ez:we}=G,oe=G.is0();H==null&&(H=oe?fh:r.inv(we));const fe=E(D*H),ee=E(ie*H),m=E(we*H);if(oe)return{x:mt,y:ut};if(m!==ut)throw new Error("invZ was invalid");return{x:fe,y:ee}}),z=vn(G=>{const{a:H,d:D}=e;if(G.is0())throw new Error("bad point: ZERO");const{ex:ie,ey:we,ez:oe,et:fe}=G,ee=E(ie*ie),m=E(we*we),se=E(oe*oe),ue=E(se*se),de=E(ee*H),te=E(se*E(de+m)),ae=E(ue+E(D*E(ee*m)));if(te!==ae)throw new Error("bad point: equation left != right (1)");const b=E(ie*we),x=E(oe*fe);if(b!==x)throw new Error("bad point: equation left != right (2)");return!0});class q{constructor(H,D,ie,we){this.ex=H,this.ey=D,this.ez=ie,this.et=we,M("x",H),M("y",D),M("z",ie),M("t",we),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(H){if(H instanceof q)throw new Error("extended point not allowed");const{x:D,y:ie}=H||{};return M("x",D),M("y",ie),new q(D,ie,ut,E(D*ie))}static normalizeZ(H){const D=r.invertBatch(H.map(ie=>ie.ez));return H.map((ie,we)=>ie.toAffine(D[we])).map(q.fromAffine)}static msm(H,D){return eu(q,A,H,D)}_setWindowSize(H){L.setWindowSize(this,H)}assertValidity(){z(this)}equals(H){C(H);const{ex:D,ey:ie,ez:we}=this,{ex:oe,ey:fe,ez:ee}=H,m=E(D*ee),se=E(oe*we),ue=E(ie*ee),de=E(fe*we);return m===se&&ue===de}is0(){return this.equals(q.ZERO)}negate(){return new q(E(-this.ex),this.ey,this.ez,E(-this.et))}double(){const{a:H}=e,{ex:D,ey:ie,ez:we}=this,oe=E(D*D),fe=E(ie*ie),ee=E(Yn*E(we*we)),m=E(H*oe),se=D+ie,ue=E(E(se*se)-oe-fe),de=m+fe,te=de-ee,ae=m-fe,b=E(ue*te),x=E(de*ae),T=E(ue*ae),$=E(te*de);return new q(b,x,$,T)}add(H){C(H);const{a:D,d:ie}=e,{ex:we,ey:oe,ez:fe,et:ee}=this,{ex:m,ey:se,ez:ue,et:de}=H;if(D===BigInt(-1)){const _=E((oe-we)*(se+m)),N=E((oe+we)*(se-m)),V=E(N-_);if(V===mt)return this.double();const ne=E(fe*Yn*de),pe=E(ee*Yn*ue),ye=pe+ne,xe=N+_,p=pe-ne,u=E(ye*V),l=E(xe*p),v=E(ye*p),F=E(V*xe);return new q(u,l,F,v)}const te=E(we*m),ae=E(oe*se),b=E(ee*ie*de),x=E(fe*ue),T=E((we+oe)*(m+se)-te-ae),$=x-b,O=x+b,k=E(ae-D*te),h=E(T*$),o=E(O*k),c=E(T*k),y=E($*O);return new q(h,o,y,c)}subtract(H){return this.add(H.negate())}wNAF(H){return L.wNAFCached(this,H,q.normalizeZ)}multiply(H){const D=H;sr("scalar",D,ut,n);const{p:ie,f:we}=this.wNAF(D);return q.normalizeZ([ie,we])[0]}multiplyUnsafe(H,D=q.ZERO){const ie=H;return sr("scalar",ie,mt,n),ie===mt?P:this.is0()||ie===ut?this:L.wNAFCachedUnsafe(this,ie,q.normalizeZ,D)}isSmallOrder(){return this.multiplyUnsafe(d).is0()}isTorsionFree(){return L.unsafeLadder(this,n).is0()}toAffine(H){return Y(this,H)}clearCofactor(){const{h:H}=e;return H===ut?this:this.multiplyUnsafe(H)}static fromHex(H,D=!1){const{d:ie,a:we}=e,oe=r.BYTES;H=ct("pointHex",H,oe),dn("zip215",D);const fe=H.slice(),ee=H[oe-1];fe[oe-1]=ee&-129;const m=pn(fe),se=D?g:r.ORDER;sr("pointHex.y",m,mt,se);const ue=E(m*m),de=E(ue-ut),te=E(ie*ue-we);let{isValid:ae,value:b}=S(de,te);if(!ae)throw new Error("Point.fromHex: invalid y coordinate");const x=(b&ut)===ut,T=(ee&128)!==0;if(!D&&b===mt&&T)throw new Error("Point.fromHex: x=0 and x_0=1");return T!==x&&(b=E(-b)),q.fromAffine({x:b,y:m})}static fromPrivateKey(H){return Q(H).point}toRawBytes(){const{x:H,y:D}=this.toAffine(),ie=Ti(D,r.BYTES);return ie[ie.length-1]|=H&ut?128:0,ie}toHex(){return Ir(this.toRawBytes())}}q.BASE=new q(e.Gx,e.Gy,ut,E(e.Gx*e.Gy)),q.ZERO=new q(mt,ut,ut,mt);const{BASE:re,ZERO:P}=q,L=Qc(q,a*8);function Z(G){return Ce(G,n)}function J(G){return Z(pn(G))}function Q(G){const H=r.BYTES;G=ct("private key",G,H);const D=ct("hashed private key",s(G),2*H),ie=B(D.slice(0,H)),we=D.slice(H,2*H),oe=J(ie),fe=re.multiply(oe),ee=fe.toRawBytes();return{head:ie,prefix:we,scalar:oe,point:fe,pointBytes:ee}}function X(G){return Q(G).pointBytes}function he(G=new Uint8Array,...H){const D=Ke(...H);return J(s(w(D,ct("context",G),!!i)))}function le(G,H,D={}){G=ct("message",G),i&&(G=i(G));const{prefix:ie,scalar:we,pointBytes:oe}=Q(H),fe=he(D.context,ie,G),ee=re.multiply(fe).toRawBytes(),m=he(D.context,ee,oe,G),se=Z(fe+m*we);sr("signature.s",se,mt,n);const ue=Ke(ee,Ti(se,r.BYTES));return ct("result",ue,r.BYTES*2)}const I=lh;function U(G,H,D,ie=I){const{context:we,zip215:oe}=ie,fe=r.BYTES;G=ct("signature",G,2*fe),H=ct("message",H),D=ct("publicKey",D,fe),oe!==void 0&&dn("zip215",oe),i&&(H=i(H));const ee=pn(G.slice(fe,2*fe));let m,se,ue;try{m=q.fromHex(D,oe),se=q.fromHex(G.slice(0,fe),oe),ue=re.multiplyUnsafe(ee)}catch{return!1}if(!oe&&m.isSmallOrder())return!1;const de=he(we,se.toRawBytes(),m.toRawBytes(),H);return se.add(m.multiplyUnsafe(de)).subtract(ue).clearCofactor().equals(q.ZERO)}return re._setWindowSize(8),{CURVE:e,getPublicKey:X,sign:le,verify:U,ExtendedPoint:q,utils:{getExtendedPublicKey:Q,randomPrivateKey:()=>f(r.BYTES),precompute(G=8,H=q.BASE){return H._setWindowSize(G),H.multiply(BigInt(3)),H}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const lo=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),na=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const ph=BigInt(1),ia=BigInt(2);BigInt(3);const yh=BigInt(5),gh=BigInt(8);function wh(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=lo,a=t*t%s*t%s,d=St(a,ia,s)*a%s,g=St(d,ph,s)*t%s,E=St(g,yh,s)*g%s,A=St(E,e,s)*E%s,S=St(A,r,s)*A%s,B=St(S,n,s)*S%s,w=St(B,i,s)*B%s,M=St(w,i,s)*B%s,C=St(M,e,s)*E%s;return{pow_p_5_8:St(C,ia,s)*t%s,b2:a}}function mh(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function bh(t,e){const r=lo,n=Ce(e*e*e,r),i=Ce(n*n*e,r),s=wh(t*i).pow_p_5_8;let f=Ce(t*n*s,r);const a=Ce(e*f*f,r),d=f,g=Ce(f*na,r),E=a===t,A=a===Ce(-t,r),S=a===Ce(-t*na,r);return E&&(f=d),(A||S)&&(f=g),i0(f,r)&&(f=Ce(-f,r)),{isValid:E||A,value:f}}const _h=(()=>$n(lo,void 0,!0))(),xh=(()=>({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:_h,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:gh,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:uh,randomBytes:Oa,adjustScalarBytes:mh,uvRatio:bh}))(),kr=(()=>dh(xh))();var sa=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},ot=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},rt,cn,uu,fu;class Eh{constructor(e={}){rt.set(this,void 0),cn.set(this,void 0),this[uu]=this.entries.bind(this),this[fu]="ExpirableMap";const{source:r=[],expirationTime:n=10*60*1e3}=e,i=Date.now();sa(this,rt,new Map([...r].map(([s,f])=>[s,{value:f,timestamp:i}])),"f"),sa(this,cn,n,"f")}prune(){const e=Date.now();for(const[r,n]of ot(this,rt,"f").entries())e-n.timestamp>ot(this,cn,"f")&&ot(this,rt,"f").delete(r);return this}set(e,r){this.prune();const n={value:r,timestamp:Date.now()};return ot(this,rt,"f").set(e,n),this}get(e){const r=ot(this,rt,"f").get(e);if(r!==void 0){if(Date.now()-r.timestamp>ot(this,cn,"f")){ot(this,rt,"f").delete(e);return}return r.value}}clear(){ot(this,rt,"f").clear()}entries(){const e=ot(this,rt,"f").entries();return function*(){for(const[n,i]of e)yield[n,i.value]}()}values(){const e=ot(this,rt,"f").values();return function*(){for(const n of e)yield n.value}()}keys(){return ot(this,rt,"f").keys()}forEach(e,r){for(const[n,i]of ot(this,rt,"f").entries())e.call(r,i.value,n,this)}has(e){return ot(this,rt,"f").has(e)}delete(e){return ot(this,rt,"f").delete(e)}get size(){return ot(this,rt,"f").size}}rt=new WeakMap,cn=new WeakMap,uu=Symbol.iterator,fu=Symbol.toStringTag;const oa=t=>{if(t<=127)return 1;if(t<=255)return 2;if(t<=65535)return 3;if(t<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")},aa=(t,e,r)=>{if(r<=127)return t[e]=r,1;if(r<=255)return t[e]=129,t[e+1]=r,2;if(r<=65535)return t[e]=130,t[e+1]=r>>8,t[e+2]=r,3;if(r<=16777215)return t[e]=131,t[e+1]=r>>16,t[e+2]=r>>8,t[e+3]=r,4;throw new Error("Length too long (> 4 bytes)")},zs=(t,e)=>{if(t[e]<128)return 1;if(t[e]===128)throw new Error("Invalid length 0");if(t[e]===129)return 2;if(t[e]===130)return 3;if(t[e]===131)return 4;throw new Error("Length too long (> 4 bytes)")},vh=(t,e)=>{const r=zs(t,e);if(r===1)return t[e];if(r===2)return t[e+1];if(r===3)return(t[e+1]<<8)+t[e+2];if(r===4)return(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];throw new Error("Length too long (> 4 bytes)")};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);const Ri=Uint8Array.from([48,5,6,3,43,101,112]);Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);function lu(t,e){const r=2+oa(t.byteLength+1),n=e.byteLength+r+t.byteLength;let i=0;const s=new Uint8Array(1+oa(n)+n);return s[i++]=48,i+=aa(s,i,n),s.set(e,i),i+=e.byteLength,s[i++]=3,i+=aa(s,i,t.byteLength+1),s[i++]=0,s.set(new Uint8Array(t),i),s}const hu=(t,e)=>{let r=0;const n=(a,d)=>{if(i[r++]!==a)throw new Error("Expected: "+d)},i=new Uint8Array(t);if(n(48,"sequence"),r+=zs(i,r),!Rn(i.slice(r,r+e.byteLength),e))throw new Error("Not the expected OID.");r+=e.byteLength,n(3,"bit string");const s=vh(i,r)-1;r+=zs(i,r),n(0,"0 padding");const f=i.slice(r);if(s!==f.length)throw new Error(`DER payload mismatch: Expected length ${s} actual length ${f.length}`);return f};var ca=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},ua=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},si,oi;let du=class un{constructor(e){if(si.set(this,void 0),oi.set(this,void 0),e.byteLength!==un.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");ca(this,si,e,"f"),ca(this,oi,un.derEncode(e),"f")}static from(e){return this.fromDer(e.toDer())}static fromRaw(e){return new un(e)}static fromDer(e){return new un(this.derDecode(e))}static derEncode(e){return lu(e,Ri).buffer}static derDecode(e){const r=hu(e,Ri);if(r.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return r}get rawKey(){return ua(this,si,"f")}get derKey(){return ua(this,oi,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}};si=new WeakMap,oi=new WeakMap;du.RAW_KEY_LENGTH=32;class Ah{constructor(){this.observers=[]}subscribe(e){this.observers.push(e)}unsubscribe(e){this.observers=this.observers.filter(r=>r!==e)}notify(e,...r){this.observers.forEach(n=>n(e,...r))}}class Bh extends Ah{constructor(){super()}print(e,...r){this.notify({message:e,level:"info"},...r)}warn(e,...r){this.notify({message:e,level:"warn"},...r)}error(e,r,...n){this.notify({message:e,level:"error",error:r},...n)}}var Nt=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},tt=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},It,ai,ci,ui,fi,li,hi,di,Mr;const pu=.5,yu=1.5,gu=500,wu=6e4,mu=9e5,bu=10;class Wi{constructor(e=Wi.default){It.set(this,void 0),ai.set(this,void 0),ci.set(this,void 0),ui.set(this,void 0),fi.set(this,void 0),li.set(this,void 0),hi.set(this,void 0),di.set(this,void 0),Mr.set(this,0);const{initialInterval:r=gu,randomizationFactor:n=pu,multiplier:i=yu,maxInterval:s=wu,maxElapsedTime:f=mu,maxIterations:a=bu,date:d=Date}=e;Nt(this,It,r,"f"),Nt(this,ai,n,"f"),Nt(this,ci,i,"f"),Nt(this,ui,s,"f"),Nt(this,di,d,"f"),Nt(this,fi,d.now(),"f"),Nt(this,li,f,"f"),Nt(this,hi,a,"f")}get ellapsedTimeInMsec(){return tt(this,di,"f").now()-tt(this,fi,"f")}get currentInterval(){return tt(this,It,"f")}get count(){return tt(this,Mr,"f")}get randomValueFromInterval(){const e=tt(this,ai,"f")*tt(this,It,"f"),r=tt(this,It,"f")-e,n=tt(this,It,"f")+e;return Math.random()*(n-r)+r}incrementCurrentInterval(){var e;return Nt(this,It,Math.min(tt(this,It,"f")*tt(this,ci,"f"),tt(this,ui,"f")),"f"),Nt(this,Mr,(e=tt(this,Mr,"f"),e++,e),"f"),tt(this,It,"f")}next(){return this.ellapsedTimeInMsec>=tt(this,li,"f")||tt(this,Mr,"f")>=tt(this,hi,"f")?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}}It=new WeakMap,ai=new WeakMap,ci=new WeakMap,ui=new WeakMap,fi=new WeakMap,li=new WeakMap,hi=new WeakMap,di=new WeakMap,Mr=new WeakMap;Wi.default={initialInterval:gu,randomizationFactor:pu,multiplier:yu,maxInterval:wu,maxElapsedTime:mu,maxIterations:bu,date:Date};var Qe=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},ce=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},nt,pr,Yr,Rt,Mt,zr,fn,Cr,_t,xt,yr,gr,ln,qr,Vr,wr,_r,_u,pi,yi,mr,Ct;(function(t){t.Received="received",t.Processing="processing",t.Replied="replied",t.Rejected="rejected",t.Unknown="unknown",t.Done="done"})(Ct||(Ct={}));const Zn=60*1e3,Th="308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae",Sh="aaaaa-aa",Nh="ic0.app",Ih=".ic0.app",Rh="icp0.io",Oh=".icp0.io",Uh="icp-api.io",Fh=".icp-api.io";class bs extends qe{constructor(e){super(e),this.message=e}}class Ln extends qe{constructor(e){super(e),this.message=e}}function Ph(){let t;if(typeof window<"u")if(window.fetch)t=window.fetch.bind(window);else throw new bs("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.");else if(typeof global<"u")if(global.fetch)t=global.fetch.bind(global);else throw new bs("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.");else typeof self<"u"&&self.fetch&&(t=self.fetch.bind(self));if(t)return t;throw new bs("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.")}function $h(t){let e;if(t!==void 0)!t.match(/^[a-z]+:/)&&typeof window<"u"?e=new URL(window.location.protocol+"//"+t):e=new URL(t);else{const r=["ic0.app","icp0.io","127.0.0.1","localhost"],n=[".github.dev",".gitpod.io"],i=typeof window<"u"?window.location:void 0,s=i==null?void 0:i.hostname;let f;s&&typeof s=="string"&&(n.some(a=>s.endsWith(a))?f=s:f=r.find(a=>s.endsWith(a))),i&&f?e=new URL(`${i.protocol}//${f}${i.port?":"+i.port:""}`):e=new URL("https://icp-api.io")}return e.toString()}class Wr{constructor(e={}){var r,n;nt.add(this),pr.set(this,null),Yr.set(this,!1),Rt.set(this,void 0),Mt.set(this,void 0),zr.set(this,void 0),fn.set(this,void 0),Cr.set(this,0),_t.set(this,void 0),xt.set(this,void 0),yr.set(this,void 0),gr.set(this,void 0),this._isAgent=!0,this.config={},ln.set(this,0),this.log=new Bh,qr.set(this,[]),Vr.set(this,[]),wr.set(this,new Eh({expirationTime:5*60*1e3})),_r.set(this,!0),yi.set(this,(f,a)=>{if(ce(this,_r,"f")===!1)return f;if(!a)throw new Ut("Invalid signature from replica signed query: no matching node key found.");const{status:d,signatures:g=[],requestId:E}=f,A=Ht(new TextEncoder().encode("\vic-response"));for(const S of g){const{timestamp:B,identity:w}=S,M=ve.fromUint8Array(w).toText();let C;if(d==="replied"){const{reply:P}=f;C=Ai({status:d,reply:P,timestamp:BigInt(B),request_id:E})}else if(d==="rejected"){const{reject_code:P,reject_message:L,error_code:Z}=f;C=Ai({status:d,reject_code:P,reject_message:L,error_code:Z,timestamp:BigInt(B),request_id:E})}else throw new Error(`Unknown status: ${d}`);const Y=At(A,Ht(new Uint8Array(C))),z=a==null?void 0:a.nodeKeys.get(M);if(!z)throw new Ut("Invalid signature from replica signed query: no matching node key found.");const q=du.fromDer(z).rawKey;if(kr.verify(S.signature,new Uint8Array(Y),new Uint8Array(q)))return f;throw new Ut(`Invalid signature from replica ${M} signed query.`)}return f}),this.config=e,Qe(this,Mt,e.fetch||Ph()||fetch.bind(global),"f"),Qe(this,zr,e.fetchOptions,"f"),Qe(this,fn,e.callOptions,"f"),Qe(this,Yr,(r=e.shouldFetchRootKey)!==null&&r!==void 0?r:!1,"f"),e.rootKey?this.rootKey=e.rootKey:ce(this,Yr,"f")?this.rootKey=null:this.rootKey=Kt(Th);const i=$h(e.host);this.host=new URL(i),e.verifyQuerySignatures!==void 0&&Qe(this,_r,e.verifyQuerySignatures,"f"),Qe(this,xt,(n=e.retryTimes)!==null&&n!==void 0?n:3,"f");const s=()=>new Wi({maxIterations:ce(this,xt,"f")});if(Qe(this,yr,e.backoffStrategy||s,"f"),this.host.hostname.endsWith(Ih)?this.host.hostname=Nh:this.host.hostname.endsWith(Oh)?this.host.hostname=Rh:this.host.hostname.endsWith(Fh)&&(this.host.hostname=Uh),e.credentials){const{name:f,password:a}=e.credentials;Qe(this,_t,`${f}${a?":"+a:""}`,"f")}if(Qe(this,Rt,Promise.resolve(e.identity||new Bi),"f"),e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes>5)throw new qe(`The maximum ingress expiry time is 5 minutes. Provided ingress expiry time is ${e.ingressExpiryInMinutes} minutes.`);if(e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes<=0)throw new qe(`Ingress expiry time must be greater than 0. Provided ingress expiry time is ${e.ingressExpiryInMinutes} minutes.`);Qe(this,gr,e.ingressExpiryInMinutes||5,"f"),this.addTransform("update",qo(qs)),e.useQueryNonces&&this.addTransform("query",qo(qs)),e.logToConsole&&this.log.subscribe(f=>{f.level==="error"?console.error(f.message):f.level==="warn"?console.warn(f.message):console.log(f.message)})}get waterMark(){return ce(this,ln,"f")}static createSync(e={}){return new this(Object.assign({},e))}static async create(e={shouldFetchRootKey:!1}){const r=Wr.createSync(e),n=[r.syncTime()];return r.host.toString()!=="https://icp-api.io"&&e.shouldFetchRootKey&&n.push(r.fetchRootKey()),await Promise.all(n),r}static async from(e){var r;try{return"config"in e?await Wr.create(e.config):await Wr.create({fetch:e._fetch,fetchOptions:e._fetchOptions,callOptions:e._callOptions,host:e._host.toString(),identity:(r=e._identity)!==null&&r!==void 0?r:void 0})}catch{throw new qe("Failed to create agent from provided agent")}}isLocal(){const e=this.host.hostname;return e==="127.0.0.1"||e.endsWith("127.0.0.1")}addTransform(e,r,n=r.priority||0){if(e==="update"){const i=ce(this,Vr,"f").findIndex(s=>(s.priority||0)<n);ce(this,Vr,"f").splice(i>=0?i:ce(this,Vr,"f").length,0,Object.assign(r,{priority:n}))}else if(e==="query"){const i=ce(this,qr,"f").findIndex(s=>(s.priority||0)<n);ce(this,qr,"f").splice(i>=0?i:ce(this,qr,"f").length,0,Object.assign(r,{priority:n}))}}async getPrincipal(){if(!ce(this,Rt,"f"))throw new Ln("This identity has expired due this application's security policy. Please refresh your authentication.");return(await ce(this,Rt,"f")).getPrincipal()}async call(e,r,n){var i,s;await ce(this,nt,"m",mr).call(this);const f=(i=r.callSync)!==null&&i!==void 0?i:!0,a=await(n!==void 0?await n:await ce(this,Rt,"f"));if(!a)throw new Ln("This identity has expired due this application's security policy. Please refresh your authentication.");const d=ve.from(e),g=r.effectiveCanisterId?ve.from(r.effectiveCanisterId):d,E=a.getPrincipal()||ve.anonymous();let A=new Hn(ce(this,gr,"f")*Zn);Math.abs(ce(this,Cr,"f"))>1e3*30&&(A=new Hn(ce(this,gr,"f")*Zn+ce(this,Cr,"f")));const S={request_type:Cs.Call,canister_id:d,method_name:r.methodName,arg:r.arg,sender:E,ingress_expiry:A};let B=await this._transform({request:{body:null,method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ce(this,_t,"f")?{Authorization:"Basic "+btoa(ce(this,_t,"f"))}:{})},endpoint:"call",body:S}),w;r!=null&&r.nonce?w=M(r.nonce):B.body.nonce?w=M(B.body.nonce):w=void 0,S.nonce=w;function M(q){return new Uint8Array(q)}B=await a.transformRequest(B);const C=us(B.body),Y=ce(this,yr,"f").call(this),z=En(S);try{const q=()=>(this.log.print(`fetching "/api/v3/canister/${g.toText()}/call" with request:`,B),ce(this,Mt,"f").call(this,""+new URL(`/api/v3/canister/${g.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},ce(this,fn,"f")),B.request),{body:C}))),re=()=>(this.log.print(`fetching "/api/v2/canister/${g.toText()}/call" with request:`,B),ce(this,Mt,"f").call(this,""+new URL(`/api/v2/canister/${g.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},ce(this,fn,"f")),B.request),{body:C}))),L=await ce(this,nt,"m",pi).call(this,{request:f?q:re,backoff:Y,tries:0}),Z=await L.arrayBuffer(),J=L.status===200&&Z.byteLength>0?Gt(Z):null;if(J&&"certificate"in J){const Q=await this.parseTimeFromResponse({certificate:J.certificate});Qe(this,ln,Q,"f")}return{requestId:z,response:{ok:L.ok,status:L.status,statusText:L.statusText,body:J,headers:on(L.headers)},requestDetails:S}}catch(q){if(q.message.includes("v3 api not supported."))return this.log.warn("v3 api not supported. Fall back to v2"),this.call(e,Object.assign(Object.assign({},r),{callSync:!1}),n);const re=`Error while making call: ${(s=q.message)!==null&&s!==void 0?s:String(q)}`,P=new Yl(re,q,ke(z),ke(B.body.sender_pubkey),ke(B.body.sender_sig),String(B.body.content.ingress_expiry._value));throw this.log.error(re,P),P}}async query(e,r,n){var i,s,f,a;await ce(this,nt,"m",mr).call(this);const d=ce(this,yr,"f").call(this),g=r.effectiveCanisterId?ve.from(r.effectiveCanisterId):ve.from(e);this.log.print(`ecid ${g.toString()}`),this.log.print(`canisterId ${e.toString()}`);let E,A;const S=await(n!==void 0?n:ce(this,Rt,"f"));if(!S)throw new Ln("This identity has expired due this application's security policy. Please refresh your authentication.");const B=ve.from(e),w=(S==null?void 0:S.getPrincipal())||ve.anonymous(),M={request_type:"query",canister_id:B,method_name:r.methodName,arg:r.arg,sender:w,ingress_expiry:new Hn(ce(this,gr,"f")*Zn)},C=En(M);E=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ce(this,_t,"f")?{Authorization:"Basic "+btoa(ce(this,_t,"f"))}:{})},endpoint:"read",body:M}),E=await(S==null?void 0:S.transformRequest(E));const Y=us(E.body),z={canister:B.toText(),ecid:g,transformedRequest:E,body:Y,requestId:C,backoff:d,tries:0},q=async()=>({requestDetails:M,query:await ce(this,nt,"m",_u).call(this,z)}),re=async()=>{if(!ce(this,_r,"f"))return;const P=ce(this,wr,"f").get(g.toString());return P||(await this.fetchSubnetKeys(g.toString()),ce(this,wr,"f").get(g.toString()))};try{const[P,L]=await Promise.all([q(),re()]);A=P;const{requestDetails:Z,query:J}=A,Q=Object.assign(Object.assign({},J),{requestDetails:Z});if(this.log.print("Query response:",Q),!ce(this,_r,"f"))return Q;try{return ce(this,yi,"f").call(this,Q,L)}catch{this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),ce(this,wr,"f").delete(e.toString()),await this.fetchSubnetKeys(g.toString());const he=ce(this,wr,"f").get(e.toString());if(!he)throw new Ut("Invalid signature from replica signed query: no matching node key found.");return ce(this,yi,"f").call(this,Q,he)}}catch(P){const L=`Error while making call: ${(i=P.message)!==null&&i!==void 0?i:String(P)}`,Z=new Zl(L,P,String(C),ke((s=E==null?void 0:E.body)===null||s===void 0?void 0:s.sender_pubkey),ke((f=E==null?void 0:E.body)===null||f===void 0?void 0:f.sender_sig),String((a=E==null?void 0:E.body)===null||a===void 0?void 0:a.content.ingress_expiry._value));throw this.log.error(L,Z),Z}}async createReadStateRequest(e,r){await ce(this,nt,"m",mr).call(this);const n=await(r!==void 0?await r:await ce(this,Rt,"f"));if(!n)throw new Ln("This identity has expired due this application's security policy. Please refresh your authentication.");const i=(n==null?void 0:n.getPrincipal())||ve.anonymous(),s=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ce(this,_t,"f")?{Authorization:"Basic "+btoa(ce(this,_t,"f"))}:{})},endpoint:"read_state",body:{request_type:"read_state",paths:e.paths,sender:i,ingress_expiry:new Hn(ce(this,gr,"f")*Zn)}});return n==null?void 0:n.transformRequest(s)}async readState(e,r,n,i){var s,f,a,d;function g(M){for(const C of M.paths){const[Y,z]=C,q=Ht(new TextEncoder().encode("request_status"));if(Rn(Y,q))return z}}const E=g(r);await ce(this,nt,"m",mr).call(this);const A=typeof e=="string"?ve.fromText(e):e,S=i??await this.createReadStateRequest(r,n),B=us(S.body);this.log.print(`fetching "/api/v2/canister/${A}/read_state" with request:`,S);const w=ce(this,yr,"f").call(this);try{const M=await ce(this,nt,"m",pi).call(this,{request:()=>ce(this,Mt,"f").call(this,""+new URL(`/api/v2/canister/${A.toString()}/read_state`,this.host),Object.assign(Object.assign(Object.assign({},ce(this,zr,"f")),S.request),{body:B})),backoff:w,tries:0});if(!M.ok)throw new Error(`Server returned an error:
  Code: ${M.status} (${M.statusText})
  Body: ${await M.text()}
`);const C=Gt(await M.arrayBuffer());this.log.print("Read state response:",C);const Y=await this.parseTimeFromResponse(C);return Y>0&&(this.log.print("Read state response time:",Y),Qe(this,ln,Y,"f")),C}catch(M){const C=`Caught exception while attempting to read state: ${(s=M.message)!==null&&s!==void 0?s:String(M)}`,Y=new Ll(C,M,String(E),ke((f=S==null?void 0:S.body)===null||f===void 0?void 0:f.sender_pubkey),ke((a=S==null?void 0:S.body)===null||a===void 0?void 0:a.sender_sig),String((d=S==null?void 0:S.body)===null||d===void 0?void 0:d.content.ingress_expiry._value));throw this.log.error(C,Y),Y}}async parseTimeFromResponse(e){let r;if(e.certificate){const n=Gt(e.certificate);if(n&&"tree"in n)r=n.tree;else throw new Error("Could not decode time from response");const i=Qr(["time"],r);if(i.status!==ze.Found)throw new Error("Time was not found in the response or was not in its expected format.");if(!(i.value instanceof ArrayBuffer)&&!ArrayBuffer.isView(i))throw new Error("Time was not found in the response or was not in its expected format.");const s=fo(Ht(i.value));return this.log.print("Time from response:",s),this.log.print("Time from response in milliseconds:",Number(s)),Number(s)}else this.log.warn("No certificate found in response");return 0}async syncTime(e){await ce(this,nt,"m",mr).call(this);const r=await wf(()=>Promise.resolve().then(()=>M0),void 0),n=Date.now();try{e||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const i=Wr.createSync({identity:new Bi,host:this.host.toString(),fetch:ce(this,Mt,"f"),retryTimes:0}),f=(await r.request({canisterId:e??ve.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),agent:i,paths:["time"]})).get("time");f&&(Qe(this,Cr,Number(f)-Number(n),"f"),this.log.notify({message:`Syncing time: offset of ${ce(this,Cr,"f")}`,level:"info"}))}catch(i){this.log.error("Caught exception while attempting to sync time",i)}}async status(){const e=ce(this,_t,"f")?{Authorization:"Basic "+btoa(ce(this,_t,"f"))}:{};this.log.print('fetching "/api/v2/status"');const r=ce(this,yr,"f").call(this),n=await ce(this,nt,"m",pi).call(this,{backoff:r,request:()=>ce(this,Mt,"f").call(this,""+new URL("/api/v2/status",this.host),Object.assign({headers:e},ce(this,zr,"f"))),tries:0});return Gt(await n.arrayBuffer())}async fetchRootKey(){let e;return ce(this,pr,"f")?e=await ce(this,pr,"f"):(Qe(this,pr,new Promise((r,n)=>{this.status().then(i=>{const s=i.root_key;this.rootKey=s,r(s)}).catch(n)}),"f"),e=await ce(this,pr,"f")),Qe(this,pr,null,"f"),e}invalidateIdentity(){Qe(this,Rt,null,"f")}replaceIdentity(e){Qe(this,Rt,Promise.resolve(e),"f")}async fetchSubnetKeys(e){await ce(this,nt,"m",mr).call(this);const r=ve.from(e),i=(await su({canisterId:r,paths:["subnet"],agent:this})).get("subnet");if(i&&typeof i=="object"&&"nodeKeys"in i)return ce(this,wr,"f").set(r.toText(),i),i}_transform(e){let r=Promise.resolve(e);if(e.endpoint==="call")for(const n of ce(this,Vr,"f"))r=r.then(i=>n(i).then(s=>s||i));else for(const n of ce(this,qr,"f"))r=r.then(i=>n(i).then(s=>s||i));return r}}pr=new WeakMap,Yr=new WeakMap,Rt=new WeakMap,Mt=new WeakMap,zr=new WeakMap,fn=new WeakMap,Cr=new WeakMap,_t=new WeakMap,xt=new WeakMap,yr=new WeakMap,gr=new WeakMap,ln=new WeakMap,qr=new WeakMap,Vr=new WeakMap,wr=new WeakMap,_r=new WeakMap,yi=new WeakMap,nt=new WeakSet,_u=async function t(e){var r,n;const{ecid:i,transformedRequest:s,body:f,requestId:a,backoff:d,tries:g}=e,E=g===0?0:d.next();if(this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with tries:`,{tries:g,backoff:d,delay:E}),E===null)throw new qe(`Timestamp failed to pass the watermark after retrying the configured ${ce(this,xt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);E>0&&await new Promise(w=>setTimeout(w,E));let A;try{this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with request:`,s);const w=await ce(this,Mt,"f").call(this,""+new URL(`/api/v2/canister/${i.toString()}/query`,this.host),Object.assign(Object.assign(Object.assign({},ce(this,zr,"f")),s.request),{body:f}));if(w.status===200){const M=Gt(await w.arrayBuffer());A=Object.assign(Object.assign({},M),{httpDetails:{ok:w.ok,status:w.status,statusText:w.statusText,headers:on(w.headers)},requestId:a})}else throw new fs(`Gateway returned an error:
  Code: ${w.status} (${w.statusText})
  Body: ${await w.text()}
`,{ok:w.ok,status:w.status,statusText:w.statusText,headers:on(w.headers)})}catch(w){if(g<ce(this,xt,"f"))return this.log.warn(`Caught exception while attempting to make query:
  ${w}
  Retrying query.`),await ce(this,nt,"m",t).call(this,Object.assign(Object.assign({},e),{tries:g+1}));throw w}const S=(n=(r=A.signatures)===null||r===void 0?void 0:r[0])===null||n===void 0?void 0:n.timestamp;if(!ce(this,_r,"f"))return A;if(!S)throw new Error("Timestamp not found in query response. This suggests a malformed or malicious response.");const B=Number(BigInt(S)/BigInt(1e6));if(this.log.print("watermark and timestamp",{waterMark:this.waterMark,timestamp:B}),Number(this.waterMark)>B){const w=new qe("Timestamp is below the watermark. Retrying query.");if(this.log.error("Timestamp is below",w,{timestamp:S,waterMark:this.waterMark}),g<ce(this,xt,"f"))return await ce(this,nt,"m",t).call(this,Object.assign(Object.assign({},e),{tries:g+1}));throw new qe(`Timestamp failed to pass the watermark after retrying the configured ${ce(this,xt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`)}return A},pi=async function t(e){const{request:r,backoff:n,tries:i}=e,s=i===0?0:n.next();if(s===null)throw new qe(`Timestamp failed to pass the watermark after retrying the configured ${ce(this,xt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);s>0&&await new Promise(g=>setTimeout(g,s));let f;try{f=await r()}catch(g){if(ce(this,xt,"f")>i)return this.log.warn(`Caught exception while attempting to make request:
  ${g}
  Retrying request.`),await ce(this,nt,"m",t).call(this,{request:r,backoff:n,tries:i+1});throw g}if(f.ok)return f;const a=await f.clone().text(),d=`Server returned an error:
  Code: ${f.status} (${f.statusText})
  Body: ${a}
`;if(f.status===404&&f.url.includes("api/v3"))throw new fs("v3 api not supported. Fall back to v2",{ok:f.ok,status:f.status,statusText:f.statusText,headers:on(f.headers)});if(i<ce(this,xt,"f"))return await ce(this,nt,"m",t).call(this,{request:r,backoff:n,tries:i+1});throw new fs(d,{ok:f.ok,status:f.status,statusText:f.statusText,headers:on(f.headers)})},mr=async function(){if(!this.rootKey)if(this.rootKey===null&&ce(this,Yr,"f"))await this.fetchRootKey();else throw new qe(`Invalid root key detected. The root key for this agent is ${this.rootKey} and the shouldFetchRootKey value is set to ${ce(this,Yr,"f")}. The root key should only be unknown if you are in local development. Otherwise you should avoid fetching and use the default IC Root Key or the known root key of your environment.`)};var fa;(function(t){t.Error="err",t.GetPrincipal="gp",t.GetPrincipalResponse="gpr",t.Query="q",t.QueryResponse="qr",t.Call="c",t.CallResponse="cr",t.ReadState="rs",t.ReadStateResponse="rsr",t.Status="s",t.StatusResponse="sr"})(fa||(fa={}));function la(){const t=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.ic.agent:global.ic.agent:window.ic.agent;if(!t)throw new Error("No Agent could be found.");return t}const kh=5*60*1e3;function xu(){return Hh(Ch(Mh(),1e3),Vh(1e3,1.2),qh(kh))}function Mh(){let t=!0;return async()=>t?(t=!1,!0):!1}function Ch(t,e){return async(r,n,i)=>{if(await t(r,n,i))return new Promise(s=>setTimeout(s,e))}}function qh(t){const e=Date.now()+t;return async(r,n,i)=>{if(Date.now()>e)throw new Error(`Request timed out after ${t} msec:
  Request ID: ${ke(n)}
  Request status: ${i}
`)}}function Vh(t,e){let r=t;return()=>new Promise(n=>setTimeout(()=>{r*=e,n()},r))}function Hh(...t){return async(e,r,n)=>{for(const i of t)await i(e,r,n)}}async function Eu(t,e,r,n=xu(),i,s){var f;const a=[new TextEncoder().encode("request_status"),r],d=i??await((f=t.createReadStateRequest)===null||f===void 0?void 0:f.call(t,{paths:[a]})),g=await t.readState(e,{paths:[a]},void 0,d);if(t.rootKey==null)throw new Error("Agent root key not initialized before polling");const E=await Er.create({certificate:g.certificate,rootKey:t.rootKey,canisterId:e,blsVerify:s}),A=yt(E.lookup([...a,new TextEncoder().encode("status")]));let S;switch(typeof A>"u"?S=Ct.Unknown:S=new TextDecoder().decode(A),S){case Ct.Replied:return{reply:yt(E.lookup([...a,"reply"])),certificate:E};case Ct.Received:case Ct.Unknown:case Ct.Processing:return await n(e,r,S),Eu(t,e,r,n,d,s);case Ct.Rejected:{const B=new Uint8Array(yt(E.lookup([...a,"reject_code"])))[0],w=new TextDecoder().decode(yt(E.lookup([...a,"reject_message"])));throw new Error(`Call was rejected:
  Request ID: ${ke(r)}
  Reject code: ${B}
  Reject text: ${w}
`)}case Ct.Done:throw new Error(`Call was marked as done but we never saw the reply:
  Request ID: ${ke(r)}
`)}throw new Error("unreachable")}const Gh=({IDL:t})=>{const e=t.Variant({mainnet:t.Null,testnet:t.Null}),r=t.Text,n=t.Record({network:e,address:r,min_confirmations:t.Opt(t.Nat32)}),i=t.Nat64,s=i,f=t.Nat32,a=t.Record({start_height:f,end_height:t.Opt(f),network:e}),d=t.Vec(t.Nat8),g=t.Record({tip_height:f,block_headers:t.Vec(d)}),E=t.Record({network:e}),A=t.Nat64,S=t.Vec(A),B=t.Record({network:e,filter:t.Opt(t.Variant({page:t.Vec(t.Nat8),min_confirmations:t.Nat32})),address:r}),w=t.Vec(t.Nat8),M=t.Record({txid:t.Vec(t.Nat8),vout:t.Nat32}),C=t.Record({height:t.Nat32,value:i,outpoint:M}),Y=t.Record({next_page:t.Opt(t.Vec(t.Nat8)),tip_height:f,tip_block_hash:w,utxos:t.Vec(C)}),z=t.Record({transaction:t.Vec(t.Nat8),network:e}),q=t.Principal,re=t.Record({canister_id:q,num_requested_changes:t.Opt(t.Nat64)}),P=t.Variant({from_user:t.Record({user_id:t.Principal}),from_canister:t.Record({canister_version:t.Opt(t.Nat64),canister_id:t.Principal})}),L=t.Vec(t.Nat8),Z=t.Variant({creation:t.Record({controllers:t.Vec(t.Principal)}),code_deployment:t.Record({mode:t.Variant({reinstall:t.Null,upgrade:t.Null,install:t.Null}),module_hash:t.Vec(t.Nat8)}),load_snapshot:t.Record({canister_version:t.Nat64,taken_at_timestamp:t.Nat64,snapshot_id:L}),controllers_change:t.Record({controllers:t.Vec(t.Principal)}),code_uninstall:t.Null}),J=t.Record({timestamp_nanos:t.Nat64,canister_version:t.Nat64,origin:P,details:Z}),Q=t.Record({controllers:t.Vec(t.Principal),module_hash:t.Opt(t.Vec(t.Nat8)),recent_changes:t.Vec(J),total_num_changes:t.Nat64}),X=t.Record({canister_id:q}),he=t.Variant({controllers:t.Null,public:t.Null,allowed_viewers:t.Vec(t.Principal)}),le=t.Record({freezing_threshold:t.Nat,controllers:t.Vec(t.Principal),reserved_cycles_limit:t.Nat,log_visibility:he,wasm_memory_limit:t.Nat,memory_allocation:t.Nat,compute_allocation:t.Nat}),I=t.Record({status:t.Variant({stopped:t.Null,stopping:t.Null,running:t.Null}),memory_size:t.Nat,cycles:t.Nat,settings:le,query_stats:t.Record({response_payload_bytes_total:t.Nat,num_instructions_total:t.Nat,num_calls_total:t.Nat,request_payload_bytes_total:t.Nat}),idle_cycles_burned_per_day:t.Nat,module_hash:t.Opt(t.Vec(t.Nat8)),reserved_cycles:t.Nat}),U=t.Record({canister_id:q}),W=t.Record({freezing_threshold:t.Opt(t.Nat),controllers:t.Opt(t.Vec(t.Principal)),reserved_cycles_limit:t.Opt(t.Nat),log_visibility:t.Opt(he),wasm_memory_limit:t.Opt(t.Nat),memory_allocation:t.Opt(t.Nat),compute_allocation:t.Opt(t.Nat)}),G=t.Record({settings:t.Opt(W),sender_canister_version:t.Opt(t.Nat64)}),H=t.Record({canister_id:q}),D=t.Record({canister_id:q}),ie=t.Record({canister_id:q,snapshot_id:L}),we=t.Record({canister_id:q}),oe=t.Variant({secp256k1:t.Null}),fe=t.Record({key_id:t.Record({name:t.Text,curve:oe}),canister_id:t.Opt(q),derivation_path:t.Vec(t.Vec(t.Nat8))}),ee=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),m=t.Record({canister_id:q}),se=t.Record({idx:t.Nat64,timestamp_nanos:t.Nat64,content:t.Vec(t.Nat8)}),ue=t.Record({canister_log_records:t.Vec(se)}),de=t.Record({value:t.Text,name:t.Text}),te=t.Record({status:t.Nat,body:t.Vec(t.Nat8),headers:t.Vec(de)}),ae=t.Record({url:t.Text,method:t.Variant({get:t.Null,head:t.Null,post:t.Null}),max_response_bytes:t.Opt(t.Nat64),body:t.Opt(t.Vec(t.Nat8)),transform:t.Opt(t.Record({function:t.Func([t.Record({context:t.Vec(t.Nat8),response:te})],[te],["query"]),context:t.Vec(t.Nat8)})),headers:t.Vec(de)}),b=t.Variant({reinstall:t.Null,upgrade:t.Opt(t.Record({wasm_memory_persistence:t.Opt(t.Variant({keep:t.Null,replace:t.Null})),skip_pre_upgrade:t.Opt(t.Bool)})),install:t.Null}),x=t.Record({hash:t.Vec(t.Nat8)}),T=t.Record({arg:t.Vec(t.Nat8),wasm_module_hash:t.Vec(t.Nat8),mode:b,chunk_hashes_list:t.Vec(x),target_canister:q,store_canister:t.Opt(q),sender_canister_version:t.Opt(t.Nat64)}),$=t.Vec(t.Nat8),O=t.Record({arg:t.Vec(t.Nat8),wasm_module:$,mode:b,canister_id:q,sender_canister_version:t.Opt(t.Nat64)}),k=t.Record({canister_id:q}),h=t.Record({id:L,total_size:t.Nat64,taken_at_timestamp:t.Nat64}),o=t.Vec(h),c=t.Record({canister_id:q,sender_canister_version:t.Opt(t.Nat64),snapshot_id:L}),y=t.Record({start_at_timestamp_nanos:t.Nat64,subnet_id:t.Principal}),_=t.Record({num_block_failures_total:t.Nat64,node_id:t.Principal,num_blocks_proposed_total:t.Nat64}),N=t.Vec(t.Record({timestamp_nanos:t.Nat64,node_metrics:t.Vec(_)})),V=t.Record({settings:t.Opt(W),specified_id:t.Opt(q),amount:t.Opt(t.Nat),sender_canister_version:t.Opt(t.Nat64)}),ne=t.Record({canister_id:q}),pe=t.Record({canister_id:q,amount:t.Nat}),ye=t.Vec(t.Nat8),xe=t.Variant({ed25519:t.Null,bip340secp256k1:t.Null}),p=t.Record({key_id:t.Record({algorithm:xe,name:t.Text}),canister_id:t.Opt(q),derivation_path:t.Vec(t.Vec(t.Nat8))}),u=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),l=t.Record({key_id:t.Record({name:t.Text,curve:oe}),derivation_path:t.Vec(t.Vec(t.Nat8)),message_hash:t.Vec(t.Nat8)}),v=t.Record({signature:t.Vec(t.Nat8)}),F=t.Variant({bip341:t.Record({merkle_root_hash:t.Vec(t.Nat8)})}),K=t.Record({aux:t.Opt(F),key_id:t.Record({algorithm:xe,name:t.Text}),derivation_path:t.Vec(t.Vec(t.Nat8)),message:t.Vec(t.Nat8)}),j=t.Record({signature:t.Vec(t.Nat8)}),_e=t.Record({canister_id:q}),Be=t.Record({canister_id:q}),Ee=t.Record({canister_id:q}),be=t.Vec(x),Re=t.Record({subnet_id:t.Principal}),$e=t.Record({replica_version:t.Text}),Zi=t.Record({replace_snapshot:t.Opt(L),canister_id:q}),Li=h,Di=t.Record({canister_id:q,sender_canister_version:t.Opt(t.Nat64)}),Xi=t.Record({canister_id:t.Principal,settings:W,sender_canister_version:t.Opt(t.Nat64)}),Ji=t.Record({chunk:t.Vec(t.Nat8),canister_id:t.Principal}),Yt=x;return t.Service({bitcoin_get_balance:t.Func([n],[s],[]),bitcoin_get_block_headers:t.Func([a],[g],[]),bitcoin_get_current_fee_percentiles:t.Func([E],[S],[]),bitcoin_get_utxos:t.Func([B],[Y],[]),bitcoin_send_transaction:t.Func([z],[],[]),canister_info:t.Func([re],[Q],[]),canister_status:t.Func([X],[I],[]),clear_chunk_store:t.Func([U],[],[]),create_canister:t.Func([G],[H],[]),delete_canister:t.Func([D],[],[]),delete_canister_snapshot:t.Func([ie],[],[]),deposit_cycles:t.Func([we],[],[]),ecdsa_public_key:t.Func([fe],[ee],[]),fetch_canister_logs:t.Func([m],[ue],["query"]),http_request:t.Func([ae],[te],[]),install_chunked_code:t.Func([T],[],[]),install_code:t.Func([O],[],[]),list_canister_snapshots:t.Func([k],[o],[]),load_canister_snapshot:t.Func([c],[],[]),node_metrics_history:t.Func([y],[N],[]),provisional_create_canister_with_cycles:t.Func([V],[ne],[]),provisional_top_up_canister:t.Func([pe],[],[]),raw_rand:t.Func([],[ye],[]),schnorr_public_key:t.Func([p],[u],[]),sign_with_ecdsa:t.Func([l],[v],[]),sign_with_schnorr:t.Func([K],[j],[]),start_canister:t.Func([_e],[],[]),stop_canister:t.Func([Be],[],[]),stored_chunks:t.Func([Ee],[be],[]),subnet_info:t.Func([Re],[$e],[]),take_canister_snapshot:t.Func([Zi],[Li],[]),uninstall_code:t.Func([Di],[],[]),update_settings:t.Func([Xi],[],[]),upload_chunk:t.Func([Ji],[Yt],[])})};class vu extends qe{constructor(e,r,n,i){super(["Call failed:",`  Canister: ${e.toText()}`,`  Method: ${r} (${n})`,...Object.getOwnPropertyNames(i).map(s=>`  "${s}": ${JSON.stringify(i[s])}`)].join(`
`)),this.canisterId=e,this.methodName=r,this.type=n,this.props=i}}class jh extends vu{constructor(e,r,n){var i;super(e,r,"query",{Status:n.status,Code:(i=Ns[n.reject_code])!==null&&i!==void 0?i:`Unknown Code "${n.reject_code}"`,Message:n.reject_message}),this.result=n}}class ha extends vu{constructor(e,r,n,i,s,f,a){super(e,r,"update",Object.assign({"Request ID":ke(n)},i.body?Object.assign(Object.assign({},a?{"Error code":a}:{}),{"Reject code":String(s),"Reject message":f}):{"HTTP status code":i.status.toString(),"HTTP status text":i.statusText})),this.requestId=n,this.response=i,this.reject_code=s,this.reject_message=f,this.error_code=a}}const pt=Symbol.for("ic-agent-metadata");class Yi{constructor(e){this[pt]=Object.freeze(e)}static agentOf(e){return e[pt].config.agent}static interfaceOf(e){return e[pt].service}static canisterIdOf(e){return ve.from(e[pt].config.canisterId)}static async install(e,r){const n=e.mode===void 0?{install:null}:e.mode,i=e.arg?[...new Uint8Array(e.arg)]:[],s=[...new Uint8Array(e.module)],f=typeof r.canisterId=="string"?ve.fromText(r.canisterId):r.canisterId;await da(r).install_code({mode:n,arg:i,wasm_module:s,canister_id:f,sender_canister_version:[]})}static async createCanister(e,r){function n(s){return[{controllers:s.controllers?[s.controllers]:[],compute_allocation:s.compute_allocation?[s.compute_allocation]:[],freezing_threshold:s.freezing_threshold?[s.freezing_threshold]:[],memory_allocation:s.memory_allocation?[s.memory_allocation]:[],reserved_cycles_limit:[],log_visibility:[],wasm_memory_limit:[]}]}const{canister_id:i}=await da(e||{}).provisional_create_canister_with_cycles({amount:[],settings:n(r||{}),specified_id:[],sender_canister_version:[]});return i}static async createAndInstallCanister(e,r,n){const i=await this.createCanister(n);return await this.install(Object.assign({},r),Object.assign(Object.assign({},n),{canisterId:i})),this.createActor(e,Object.assign(Object.assign({},n),{canisterId:i}))}static createActorClass(e,r){const n=e({IDL:Kf});class i extends Yi{constructor(f){if(!f.canisterId)throw new qe(`Canister ID is required, but received ${typeof f.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);const a=typeof f.canisterId=="string"?ve.fromText(f.canisterId):f.canisterId;super({config:Object.assign(Object.assign(Object.assign({},Au),f),{canisterId:a}),service:n});for(const[d,g]of n._fields)r!=null&&r.httpDetails&&g.annotations.push(Ws),r!=null&&r.certificate&&g.annotations.push(Bu),this[d]=Kh(this,d,g,f.blsVerify)}}return i}static createActor(e,r){if(!r.canisterId)throw new qe(`Canister ID is required, but received ${typeof r.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);return new(this.createActorClass(e))(r)}static createActorWithHttpDetails(e,r){return new(this.createActorClass(e,{httpDetails:!0}))(r)}static createActorWithExtendedDetails(e,r,n={httpDetails:!0,certificate:!0}){return new(this.createActorClass(e,n))(r)}}function Pr(t,e){const r=Wa(t,Sa.Buffer.from(e));switch(r.length){case 0:return;case 1:return r[0];default:return r}}const Au={pollingStrategyFactory:xu},Ws="http-details",Bu="certificate";function Kh(t,e,r,n){let i;r.annotations.includes("query")||r.annotations.includes("composite_query")?i=async(f,...a)=>{var d,g;f=Object.assign(Object.assign({},f),(g=(d=t[pt].config).queryTransform)===null||g===void 0?void 0:g.call(d,e,a,Object.assign(Object.assign({},t[pt].config),f)));const E=f.agent||t[pt].config.agent||la(),A=ve.from(f.canisterId||t[pt].config.canisterId),S=Rs(r.argTypes,a),B=await E.query(A,{methodName:e,arg:S,effectiveCanisterId:f.effectiveCanisterId}),w=Object.assign(Object.assign({},B.httpDetails),{requestDetails:B.requestDetails});switch(B.status){case"rejected":throw new jh(A,e,B);case"replied":return r.annotations.includes(Ws)?{httpDetails:w,result:Pr(r.retTypes,B.reply.arg)}:Pr(r.retTypes,B.reply.arg)}}:i=async(f,...a)=>{var d,g;f=Object.assign(Object.assign({},f),(g=(d=t[pt].config).callTransform)===null||g===void 0?void 0:g.call(d,e,a,Object.assign(Object.assign({},t[pt].config),f)));const E=f.agent||t[pt].config.agent||la(),{canisterId:A,effectiveCanisterId:S,pollingStrategyFactory:B}=Object.assign(Object.assign(Object.assign({},Au),t[pt].config),f),w=ve.from(A),M=S!==void 0?ve.from(S):w,C=Rs(r.argTypes,a),{requestId:Y,response:z,requestDetails:q}=await E.call(w,{methodName:e,arg:C,effectiveCanisterId:M});let re,P;if(z.body&&z.body.certificate){if(E.rootKey==null)throw new Error("Agent is missing root key");const Q=z.body.certificate;P=await Er.create({certificate:Ar(Q),rootKey:E.rootKey,canisterId:ve.from(A),blsVerify:n});const X=[new TextEncoder().encode("request_status"),Y];switch(new TextDecoder().decode(yt(P.lookup([...X,"status"])))){case"replied":re=yt(P.lookup([...X,"reply"]));break;case"rejected":{const le=new Uint8Array(yt(P.lookup([...X,"reject_code"])))[0],I=new TextDecoder().decode(yt(P.lookup([...X,"reject_message"]))),U=yt(P.lookup([...X,"error_code"])),W=U?new TextDecoder().decode(U):void 0;throw new ha(w,e,Y,z,le,I,W)}}}else if(z.body&&"reject_message"in z.body){const{reject_code:Q,reject_message:X,error_code:he}=z.body;throw new ha(w,e,Y,z,Q,X,he)}if(z.status===202){const Q=B(),X=await Eu(E,M,Y,Q,n);P=X.certificate,re=X.reply}const L=r.annotations.includes(Ws),Z=r.annotations.includes(Bu),J=Object.assign(Object.assign({},z),{requestDetails:q});if(re!==void 0)return L&&Z?{httpDetails:J,certificate:P,result:Pr(r.retTypes,re)}:Z?{certificate:P,result:Pr(r.retTypes,re)}:L?{httpDetails:J,result:Pr(r.retTypes,re)}:Pr(r.retTypes,re);if(r.retTypes.length===0)return L?{httpDetails:z,result:void 0}:void 0;throw new Error(`Call was returned undefined, but type [${r.retTypes.join(",")}].`)};const s=(...f)=>i({},...f);return s.withOptions=f=>(...a)=>i(f,...a),s}function da(t){function e(r,n){if(t.effectiveCanisterId)return{effectiveCanisterId:ve.from(t.effectiveCanisterId)};const i=n[0];let s=ve.fromHex("");return i&&typeof i=="object"&&i.target_canister&&r==="install_chunked_code"&&(s=ve.from(i.target_canister)),i&&typeof i=="object"&&i.canister_id&&(s=ve.from(i.canister_id)),{effectiveCanisterId:s}}return Yi.createActor(Gh,Object.assign(Object.assign(Object.assign({},t),{canisterId:ve.fromHex("")}),{callTransform:e,queryTransform:e}))}const zh=({IDL:t})=>{const e=t.Record({id:t.Nat,title:t.Text,creator:t.Principal,description:t.Text,voters:t.Vec(t.Tuple(t.Principal,t.Bool)),votes_for:t.Nat,vote_arguments:t.Vec(t.Tuple(t.Principal,t.Text)),votes_against:t.Nat}),r=t.Record({id:t.Nat,members:t.Vec(t.Principal),owner:t.Principal,name:t.Text,proposals:t.Vec(e)});return t.Service({addMember:t.Func([t.Nat,t.Principal],[t.Text],[]),createOrganization:t.Func([t.Text],[t.Nat],[]),createProposal:t.Func([t.Nat,t.Text,t.Text],[t.Nat],[]),getAllOrganizations:t.Func([],[t.Vec(r)],["query"]),getOrganization:t.Func([t.Nat],[t.Opt(r)],["query"]),voteOnProposal:t.Func([t.Nat,t.Nat,t.Bool,t.Text],[t.Text],[])})},Wh="bw4dl-smaaa-aaaaa-qaacq-cai",Yh=(t,e={})=>{const r=e.agent||new Wr({...e.agentOptions});return e.agent&&e.agentOptions&&console.warn("Detected both agent and agentOptions passed to createActor. Ignoring agentOptions and proceeding with the provided agent."),r.fetchRootKey().catch(n=>{console.warn("Unable to fetch root key. Check to ensure that your local replica is running"),console.error(n)}),Yi.createActor(zh,{agent:r,canisterId:t,...e.actorOptions})},Zh=Yh(Wh),Lh="/assets/logo2-7dd16e40.svg";var $i,Tn,Ys;class Dh{constructor(){Qi(this,Tn);wo(this,"greeting","");Qi(this,$i,async e=>{e.preventDefault();const r=document.getElementById("name").value;this.greeting=await Zh.greet(r),es(this,Tn,Ys).call(this)});es(this,Tn,Ys).call(this)}}$i=new WeakMap,Tn=new WeakSet,Ys=function(){let e=Du`
      <main>
        <img src="${Lh}" alt="DFINITY logo" />
        <br />
        <br />
        <form action="#">
          <label for="name">Enter your name: &nbsp;</label>
          <input id="name" alt="Name" type="text" />
          <button type="submit">Click Me!</button>
        </form>
        <section id="greeting">${this.greeting}</section>
      </main>
    `;sf(e,document.getElementById("root")),document.querySelector("form").addEventListener("submit",bo(this,$i))};new Dh;var Oi=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},rr=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},gi,wi,Hr,Gr;function pa(t){return t!==null&&typeof t=="object"}class jt{constructor(e){if(gi.set(this,void 0),wi.set(this,void 0),e.byteLength!==jt.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");Oi(this,gi,Ht(e),"f"),Oi(this,wi,jt.derEncode(e),"f")}static from(e){if(typeof e=="string"){const r=Kt(e);return this.fromRaw(r)}else if(pa(e)){const r=e;if(pa(r)&&Object.hasOwnProperty.call(r,"__derEncodedPublicKey__"))return this.fromDer(r);if(ArrayBuffer.isView(r)){const n=r;return this.fromRaw(Ht(n.buffer))}else{if(r instanceof ArrayBuffer)return this.fromRaw(r);if("rawKey"in r)return this.fromRaw(r.rawKey);if("derKey"in r)return this.fromDer(r.derKey);if("toDer"in r)return this.fromDer(r.toDer())}}throw new Error("Cannot construct Ed25519PublicKey from the provided key.")}static fromRaw(e){return new jt(e)}static fromDer(e){return new jt(this.derDecode(e))}static derEncode(e){const r=lu(e,Ri).buffer;return r.__derEncodedPublicKey__=void 0,r}static derDecode(e){const r=hu(e,Ri);if(r.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return Ht(r)}get rawKey(){return rr(this,gi,"f")}get derKey(){return rr(this,wi,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}gi=new WeakMap,wi=new WeakMap;jt.RAW_KEY_LENGTH=32;class cr extends io{constructor(e,r){super(),Hr.set(this,void 0),Gr.set(this,void 0),Oi(this,Hr,jt.from(e),"f"),Oi(this,Gr,new Uint8Array(r),"f")}static generate(e){if(e&&e.length!==32)throw new Error("Ed25519 Seed needs to be 32 bytes long.");e||(e=kr.utils.randomPrivateKey()),Rn(e,new Uint8Array(new Array(32).fill(0)))&&console.warn("Seed is all zeros. This is not a secure seed. Please provide a seed with sufficient entropy if this is a production environment.");const r=new Uint8Array(32);for(let i=0;i<32;i++)r[i]=new Uint8Array(e)[i];const n=kr.getPublicKey(r);return cr.fromKeyPair(n,r)}static fromParsedJson(e){const[r,n]=e;return new cr(jt.fromDer(Kt(r)),Kt(n))}static fromJSON(e){const r=JSON.parse(e);if(Array.isArray(r)){if(typeof r[0]=="string"&&typeof r[1]=="string")return this.fromParsedJson([r[0],r[1]]);throw new Error("Deserialization error: JSON must have at least 2 items.")}throw new Error(`Deserialization error: Invalid JSON type for string: ${JSON.stringify(e)}`)}static fromKeyPair(e,r){return new cr(jt.fromRaw(e),r)}static fromSecretKey(e){const r=kr.getPublicKey(new Uint8Array(e));return cr.fromKeyPair(r,e)}toJSON(){return[ke(rr(this,Hr,"f").toDer()),ke(rr(this,Gr,"f"))]}getKeyPair(){return{secretKey:rr(this,Gr,"f"),publicKey:rr(this,Hr,"f")}}getPublicKey(){return rr(this,Hr,"f")}async sign(e){const r=new Uint8Array(e),n=hn(kr.sign(r,rr(this,Gr,"f").slice(0,32)));return Object.defineProperty(n,"__signature__",{enumerable:!1,value:void 0}),n}static verify(e,r,n){const[i,s,f]=[e,r,n].map(a=>(typeof a=="string"&&(a=Kt(a)),a instanceof Uint8Array&&(a=Ht(a.buffer)),new Uint8Array(a)));return kr.verify(i,s,f)}}Hr=new WeakMap,Gr=new WeakMap;class ho extends Error{constructor(e){super(e),this.message=e,Object.setPrototypeOf(this,ho.prototype)}}function ya(t){if(typeof global<"u"&&global.crypto&&global.crypto.subtle)return global.crypto.subtle;if(t)return t;if(typeof crypto<"u"&&crypto.subtle)return crypto.subtle;throw new ho("Global crypto was not available and none was provided. Please inlcude a SubtleCrypto implementation. See https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto")}class Ui extends io{constructor(e,r,n){super(),this._keyPair=e,this._derKey=r,this._subtleCrypto=n}static async generate(e){const{extractable:r=!1,keyUsages:n=["sign","verify"],subtleCrypto:i}=e??{},s=ya(i),f=await s.generateKey({name:"ECDSA",namedCurve:"P-256"},r,n),a=await s.exportKey("spki",f.publicKey);return new this(f,a,s)}static async fromKeyPair(e,r){const n=ya(r),i=await n.exportKey("spki",e.publicKey);return new Ui(e,i,n)}getKeyPair(){return this._keyPair}getPublicKey(){const e=this._derKey,r=Object.create(this._keyPair.publicKey);return r.toDer=function(){return e},r}async sign(e){const r={name:"ECDSA",hash:{name:"SHA-256"}};return await this._subtleCrypto.sign(r,this._keyPair.privateKey,e)}}var Xh=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},$r=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},kt;class Jh{constructor(e){kt.set(this,void 0),Xh(this,kt,e,"f")}get rawKey(){return $r(this,kt,"f").rawKey}get derKey(){return $r(this,kt,"f").derKey}toDer(){return $r(this,kt,"f").toDer()}getPublicKey(){return $r(this,kt,"f")}getPrincipal(){if(!$r(this,kt,"f").rawKey)throw new Error("Cannot get principal from a public key without a raw key.");return ve.fromUint8Array(new Uint8Array($r(this,kt,"f").rawKey))}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}}kt=new WeakMap;var Qh=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},ed=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},td=globalThis&&globalThis.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},mi;const rd=new TextEncoder().encode("ic-request-auth-delegation"),nd=new TextEncoder().encode(`
ic-request`);function _s(t){if(typeof t!="string"||t.length<64)throw new Error("Invalid public key.");return Kt(t)}class po{constructor(e,r,n){this.pubkey=e,this.expiration=r,this.targets=n}toCBOR(){return ft.value.map(Object.assign({pubkey:ft.value.bytes(this.pubkey),expiration:ft.value.u64(this.expiration.toString(16),16)},this.targets&&{targets:ft.value.array(this.targets.map(e=>ft.value.bytes(Ar(e.toUint8Array()))))}))}toJSON(){return Object.assign({expiration:this.expiration.toString(16),pubkey:ke(this.pubkey)},this.targets&&{targets:this.targets.map(e=>e.toHex())})}}async function id(t,e,r,n){const i=new po(e.toDer(),BigInt(+r)*BigInt(1e6),n),s=new Uint8Array([...rd,...new Uint8Array(En(Object.assign({},i)))]),f=await t.sign(Ar(s));return{delegation:i,signature:f}}class Fi{constructor(e,r){this.delegations=e,this.publicKey=r}static async create(e,r,n=new Date(Date.now()+15*60*1e3),i={}){var s,f;const a=await id(e,r,n,i.targets);return new Fi([...((s=i.previous)===null||s===void 0?void 0:s.delegations)||[],a],((f=i.previous)===null||f===void 0?void 0:f.publicKey)||e.getPublicKey().toDer())}static fromJSON(e){const{publicKey:r,delegations:n}=typeof e=="string"?JSON.parse(e):e;if(!Array.isArray(n))throw new Error("Invalid delegations.");const i=n.map(s=>{const{delegation:f,signature:a}=s,{pubkey:d,expiration:g,targets:E}=f;if(E!==void 0&&!Array.isArray(E))throw new Error("Invalid targets.");return{delegation:new po(_s(d),BigInt("0x"+g),E&&E.map(A=>{if(typeof A!="string")throw new Error("Invalid target.");return ve.fromHex(A)})),signature:_s(a)}});return new this(i,_s(r))}static fromDelegations(e,r){return new this(e,r)}toJSON(){return{delegations:this.delegations.map(e=>{const{delegation:r,signature:n}=e,{targets:i}=r;return{delegation:Object.assign({expiration:r.expiration.toString(16),pubkey:ke(r.pubkey)},i&&{targets:i.map(s=>s.toHex())}),signature:ke(n)}}),publicKey:ke(this.publicKey)}}}class ga extends io{constructor(e,r){super(),this._inner=e,this._delegation=r}static fromDelegation(e,r){return new this(e,r)}getDelegation(){return this._delegation}getPublicKey(){return{derKey:this._delegation.publicKey,toDer:()=>this._delegation.publicKey}}sign(e){return this._inner.sign(e)}async transformRequest(e){const{body:r}=e,n=td(e,["body"]),i=await En(r);return Object.assign(Object.assign({},n),{body:{content:r,sender_sig:await this.sign(Ar(new Uint8Array([...nd,...new Uint8Array(i)]))),sender_delegation:this._delegation.delegations,sender_pubkey:this._delegation.publicKey}})}}class Pi extends Jh{constructor(e,r){super(e),mi.set(this,void 0),Qh(this,mi,r,"f")}get delegation(){return ed(this,mi,"f")}static fromDelegation(e,r){return new Pi(e,r)}}mi=new WeakMap;function sd(t,e){for(const{delegation:i}of t.delegations)if(+new Date(Number(i.expiration/BigInt(1e6)))<=+Date.now())return!1;const r=[],n=e==null?void 0:e.scope;n&&(Array.isArray(n)?r.push(...n.map(i=>typeof i=="string"?ve.fromText(i):i)):r.push(typeof n=="string"?ve.fromText(n):n));for(const i of r){const s=i.toText();for(const{delegation:f}of t.delegations){if(f.targets===void 0)continue;let a=!0;for(const d of f.targets)if(d.toText()===s){a=!1;break}if(a)return!1}}return!0}var wa;(function(t){t[t.ECDSA_WITH_SHA256=-7]="ECDSA_WITH_SHA256"})(wa||(wa={}));const ma=["mousedown","mousemove","keydown","touchstart","wheel"];class ba{constructor(e={}){var r;this.callbacks=[],this.idleTimeout=10*60*1e3,this.timeoutID=void 0;const{onIdle:n,idleTimeout:i=10*60*1e3}=e||{};this.callbacks=n?[n]:[],this.idleTimeout=i;const s=this._resetTimer.bind(this);window.addEventListener("load",s,!0),ma.forEach(function(a){document.addEventListener(a,s,!0)});const f=(a,d)=>{let g;return(...E)=>{const A=this,S=function(){g=void 0,a.apply(A,E)};clearTimeout(g),g=window.setTimeout(S,d)}};if(e!=null&&e.captureScroll){const a=f(s,(r=e==null?void 0:e.scrollDebounce)!==null&&r!==void 0?r:100);window.addEventListener("scroll",a,!0)}s()}static create(e={}){return new this(e)}registerCallback(e){this.callbacks.push(e)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);const e=this._resetTimer.bind(this);ma.forEach(function(r){document.removeEventListener(r,e,!0)}),this.callbacks.forEach(r=>r())}_resetTimer(){const e=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(e,this.idleTimeout)}}const od=(t,e)=>e.some(r=>t instanceof r);let _a,xa;function ad(){return _a||(_a=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cd(){return xa||(xa=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Tu=new WeakMap,Zs=new WeakMap,Su=new WeakMap,xs=new WeakMap,yo=new WeakMap;function ud(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",f)},s=()=>{r(fr(t.result)),i()},f=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",f)});return e.then(r=>{r instanceof IDBCursor&&Tu.set(r,t)}).catch(()=>{}),yo.set(e,t),e}function fd(t){if(Zs.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",f),t.removeEventListener("abort",f)},s=()=>{r(),i()},f=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",f),t.addEventListener("abort",f)});Zs.set(t,e)}let Ls={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Zs.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Su.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return fr(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function ld(t){Ls=t(Ls)}function hd(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Es(this),e,...r);return Su.set(n,e.sort?e.sort():[e]),fr(n)}:cd().includes(t)?function(...e){return t.apply(Es(this),e),fr(Tu.get(this))}:function(...e){return fr(t.apply(Es(this),e))}}function dd(t){return typeof t=="function"?hd(t):(t instanceof IDBTransaction&&fd(t),od(t,ad())?new Proxy(t,Ls):t)}function fr(t){if(t instanceof IDBRequest)return ud(t);if(xs.has(t))return xs.get(t);const e=dd(t);return e!==t&&(xs.set(t,e),yo.set(e,t)),e}const Es=t=>yo.get(t);function pd(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const f=indexedDB.open(t,e),a=fr(f);return n&&f.addEventListener("upgradeneeded",d=>{n(fr(f.result),d.oldVersion,d.newVersion,fr(f.transaction),d)}),r&&f.addEventListener("blocked",d=>r(d.oldVersion,d.newVersion,d)),a.then(d=>{s&&d.addEventListener("close",()=>s()),i&&d.addEventListener("versionchange",g=>i(g.oldVersion,g.newVersion,g))}).catch(()=>{}),a}const yd=["get","getKey","getAll","getAllKeys","count"],gd=["put","add","delete","clear"],vs=new Map;function Ea(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(vs.get(e))return vs.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=gd.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||yd.includes(r)))return;const s=async function(f,...a){const d=this.transaction(f,i?"readwrite":"readonly");let g=d.store;return n&&(g=g.index(a.shift())),(await Promise.all([g[r](...a),i&&d.done]))[0]};return vs.set(e,s),s}ld(t=>({...t,get:(e,r,n)=>Ea(e,r)||t.get(e,r,n),has:(e,r)=>!!Ea(e,r)||t.has(e,r)}));const Nu="auth-client-db",Iu="ic-keyval",wd=async(t=Nu,e=Iu,r)=>(Ru&&(localStorage!=null&&localStorage.getItem(ar))&&(localStorage.removeItem(ar),localStorage.removeItem(nr)),await pd(t,r,{upgrade:n=>{n.objectStoreNames.contains(e)&&n.clear(e),n.createObjectStore(e)}}));async function md(t,e,r){return await t.get(e,r)}async function bd(t,e,r,n){return await t.put(e,n,r)}async function _d(t,e,r){return await t.delete(e,r)}class go{constructor(e,r){this._db=e,this._storeName=r}static async create(e){const{dbName:r=Nu,storeName:n=Iu,version:i=Ad}=e??{},s=await wd(r,n,i);return new go(s,n)}async set(e,r){return await bd(this._db,this._storeName,e,r)}async get(e){var r;return(r=await md(this._db,this._storeName,e))!==null&&r!==void 0?r:null}async remove(e){return await _d(this._db,this._storeName,e)}}var xd=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Ed=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},bi;const nr="identity",ar="delegation",vd="iv",Ad=1,Ru=typeof window<"u";class Bd{constructor(e="ic-",r){this.prefix=e,this._localStorage=r}get(e){return Promise.resolve(this._getLocalStorage().getItem(this.prefix+e))}set(e,r){return this._getLocalStorage().setItem(this.prefix+e,r),Promise.resolve()}remove(e){return this._getLocalStorage().removeItem(this.prefix+e),Promise.resolve()}_getLocalStorage(){if(this._localStorage)return this._localStorage;const e=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.localStorage:global.localStorage:window.localStorage;if(!e)throw new Error("Could not find local storage.");return e}}class Td{constructor(e){bi.set(this,void 0),xd(this,bi,e??{},"f")}get _db(){return new Promise(e=>{if(this.initializedDb){e(this.initializedDb);return}go.create(Ed(this,bi,"f")).then(r=>{this.initializedDb=r,e(r)})})}async get(e){return await(await this._db).get(e)}async set(e,r){await(await this._db).set(e,r)}async remove(e){await(await this._db).remove(e)}}bi=new WeakMap;const Sd="https://identity.internetcomputer.org",Nd="#authorize",As="ECDSA",Bs="Ed25519",Id=500,Rd="UserInterrupt";class Od{constructor(e,r,n,i,s,f,a,d){this._identity=e,this._key=r,this._chain=n,this._storage=i,this.idleManager=s,this._createOptions=f,this._idpWindow=a,this._eventHandler=d,this._registerDefaultIdleCallback()}static async create(e={}){var r,n,i;const s=(r=e.storage)!==null&&r!==void 0?r:new Td,f=(n=e.keyType)!==null&&n!==void 0?n:As;let a=null;if(e.identity)a=e.identity;else{let A=await s.get(nr);if(!A&&Ru)try{const S=new Bd,B=await S.get(ar),w=await S.get(nr);B&&w&&f===As&&(console.log("Discovered an identity stored in localstorage. Migrating to IndexedDB"),await s.set(ar,B),await s.set(nr,w),A=B,await S.remove(ar),await S.remove(nr))}catch(S){console.error("error while attempting to recover localstorage: "+S)}if(A)try{typeof A=="object"?f===Bs&&typeof A=="string"?a=await cr.fromJSON(A):a=await Ui.fromKeyPair(A):typeof A=="string"&&(a=cr.fromJSON(A))}catch{}}let d=new Bi,g=null;if(a)try{const A=await s.get(ar);if(typeof A=="object"&&A!==null)throw new Error("Delegation chain is incorrectly stored. A delegation chain should be stored as a string.");e.identity?d=e.identity:A&&(g=Fi.fromJSON(A),sd(g)?"toDer"in a?d=Pi.fromDelegation(a,g):d=ga.fromDelegation(a,g):(await Ts(s),a=null))}catch(A){console.error(A),await Ts(s),a=null}let E;return!((i=e.idleOptions)===null||i===void 0)&&i.disableIdle?E=void 0:(g||e.identity)&&(E=ba.create(e.idleOptions)),a||(f===Bs?(a=await cr.generate(),await s.set(nr,JSON.stringify(a.toJSON()))):(e.storage&&f===As&&console.warn(`You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '${Bs}' as the key type, as it can serialize to a string`),a=await Ui.generate(),await s.set(nr,a.getKeyPair()))),new this(d,a,g,s,E,e)}_registerDefaultIdleCallback(){var e,r;const n=(e=this._createOptions)===null||e===void 0?void 0:e.idleOptions;!(n!=null&&n.onIdle)&&!(n!=null&&n.disableDefaultIdleCallback)&&((r=this.idleManager)===null||r===void 0||r.registerCallback(()=>{this.logout(),location.reload()}))}async _handleSuccess(e,r){var n,i;const s=e.delegations.map(g=>({delegation:new po(g.delegation.pubkey,g.delegation.expiration,g.delegation.targets),signature:g.signature.buffer})),f=Fi.fromDelegations(s,e.userPublicKey.buffer),a=this._key;if(!a)return;this._chain=f,"toDer"in a?this._identity=Pi.fromDelegation(a,this._chain):this._identity=ga.fromDelegation(a,this._chain),(n=this._idpWindow)===null||n===void 0||n.close();const d=(i=this._createOptions)===null||i===void 0?void 0:i.idleOptions;!this.idleManager&&!(d!=null&&d.disableIdle)&&(this.idleManager=ba.create(d),this._registerDefaultIdleCallback()),this._removeEventListener(),delete this._idpWindow,this._chain&&await this._storage.set(ar,JSON.stringify(this._chain.toJSON())),r==null||r(e)}getIdentity(){return this._identity}async isAuthenticated(){return!this.getIdentity().getPrincipal().isAnonymous()&&this._chain!==null}async login(e){var r,n,i,s;const f=BigInt(8)*BigInt(36e11),a=new URL(((r=e==null?void 0:e.identityProvider)===null||r===void 0?void 0:r.toString())||Sd);a.hash=Nd,(n=this._idpWindow)===null||n===void 0||n.close(),this._removeEventListener(),this._eventHandler=this._getEventHandler(a,Object.assign({maxTimeToLive:(i=e==null?void 0:e.maxTimeToLive)!==null&&i!==void 0?i:f},e)),window.addEventListener("message",this._eventHandler),this._idpWindow=(s=window.open(a.toString(),"idpWindow",e==null?void 0:e.windowOpenerFeatures))!==null&&s!==void 0?s:void 0;const d=()=>{this._idpWindow&&(this._idpWindow.closed?this._handleFailure(Rd,e==null?void 0:e.onError):setTimeout(d,Id))};d()}_getEventHandler(e,r){return async n=>{var i,s,f;if(n.origin!==e.origin)return;const a=n.data;switch(a.kind){case"authorize-ready":{const d=Object.assign({kind:"authorize-client",sessionPublicKey:new Uint8Array((i=this._key)===null||i===void 0?void 0:i.getPublicKey().toDer()),maxTimeToLive:r==null?void 0:r.maxTimeToLive,allowPinAuthentication:r==null?void 0:r.allowPinAuthentication,derivationOrigin:(s=r==null?void 0:r.derivationOrigin)===null||s===void 0?void 0:s.toString()},r==null?void 0:r.customValues);(f=this._idpWindow)===null||f===void 0||f.postMessage(d,e.origin);break}case"authorize-client-success":try{await this._handleSuccess(a,r==null?void 0:r.onSuccess)}catch(d){this._handleFailure(d.message,r==null?void 0:r.onError)}break;case"authorize-client-failure":this._handleFailure(a.text,r==null?void 0:r.onError);break}}}_handleFailure(e,r){var n;(n=this._idpWindow)===null||n===void 0||n.close(),r==null||r(e),this._removeEventListener(),delete this._idpWindow}_removeEventListener(){this._eventHandler&&window.removeEventListener("message",this._eventHandler),this._eventHandler=void 0}async logout(e={}){if(await Ts(this._storage),this._identity=new Bi,this._chain=null,e.returnTo)try{window.history.pushState({},"",e.returnTo)}catch{window.location.href=e.returnTo}}}async function Ts(t){await t.remove(nr),await t.remove(ar),await t.remove(vd)}const Ud=document.getElementById("connectButton"),Fd=document.getElementById("principalDisplay");Ud.addEventListener("click",async()=>{const t=await Od.create();t.login({identityProvider:"https://identity.ic0.app",onSuccess:async()=>{const r=t.getIdentity().getPrincipal().toText();Fd.textContent=`Connected Principal: ${r}`}})});
