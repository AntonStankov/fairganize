import{t as q,C as D,l as O,R as T,P as f,I as Qe,g as M,h as X,d as Xe,i as Ye,j as Ze,k as Ie,H as De}from"./proxy-fe1d1820.js";function Y(){const e=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.ic.agent:global.ic.agent:window.ic.agent;if(!e)throw new Error("No Agent could be found.");return e}const Le=5*60*1e3;function L(){return rt(tt(et(),1e3),nt(1e3,1.2),st(Le))}function et(){let e=!0;return async()=>e?(e=!1,!0):!1}function tt(e,s){return async(t,r,n)=>{if(await e(t,r,n))return new Promise(c=>setTimeout(c,s))}}function st(e){const s=Date.now()+e;return async(t,r,n)=>{if(Date.now()>s)throw new Error(`Request timed out after ${e} msec:
  Request ID: ${q(r)}
  Request status: ${n}
`)}}function nt(e,s){let t=e;return()=>new Promise(r=>setTimeout(()=>{t*=s,r()},t))}function rt(...e){return async(s,t,r)=>{for(const n of e)await n(s,t,r)}}async function ee(e,s,t,r=L(),n,c){var a;const i=[new TextEncoder().encode("request_status"),t],d=n??await((a=e.createReadStateRequest)===null||a===void 0?void 0:a.call(e,{paths:[i]})),l=await e.readState(s,{paths:[i]},void 0,d);if(e.rootKey==null)throw new Error("Agent root key not initialized before polling");const _=await D.create({certificate:l.certificate,rootKey:e.rootKey,canisterId:s,blsVerify:c}),b=O(_.lookup([...i,new TextEncoder().encode("status")]));let m;switch(typeof b>"u"?m=T.Unknown:m=new TextDecoder().decode(b),m){case T.Replied:return{reply:O(_.lookup([...i,"reply"])),certificate:_};case T.Received:case T.Unknown:case T.Processing:return await r(s,t,m),ee(e,s,t,r,d,c);case T.Rejected:{const p=new Uint8Array(O(_.lookup([...i,"reject_code"])))[0],N=new TextDecoder().decode(O(_.lookup([...i,"reject_message"])));throw new Error(`Call was rejected:
  Request ID: ${q(t)}
  Reject code: ${p}
  Reject text: ${N}
`)}case T.Done:throw new Error(`Call was marked as done but we never saw the reply:
  Request ID: ${q(t)}
`)}throw new Error("unreachable")}const at=({IDL:e})=>{const s=e.Variant({mainnet:e.Null,testnet:e.Null}),t=e.Text,r=e.Record({network:s,address:t,min_confirmations:e.Opt(e.Nat32)}),n=e.Nat64,c=n,a=e.Nat32,i=e.Record({start_height:a,end_height:e.Opt(a),network:s}),d=e.Vec(e.Nat8),l=e.Record({tip_height:a,block_headers:e.Vec(d)}),_=e.Record({network:s}),b=e.Nat64,m=e.Vec(b),p=e.Record({network:s,filter:e.Opt(e.Variant({page:e.Vec(e.Nat8),min_confirmations:e.Nat32})),address:t}),N=e.Vec(e.Nat8),F=e.Record({txid:e.Vec(e.Nat8),vout:e.Nat32}),S=e.Record({height:e.Nat32,value:n,outpoint:F}),V=e.Record({next_page:e.Opt(e.Vec(e.Nat8)),tip_height:a,tip_block_hash:N,utxos:e.Vec(S)}),u=e.Record({transaction:e.Vec(e.Nat8),network:s}),o=e.Principal,w=e.Record({canister_id:o,num_requested_changes:e.Opt(e.Nat64)}),y=e.Variant({from_user:e.Record({user_id:e.Principal}),from_canister:e.Record({canister_version:e.Opt(e.Nat64),canister_id:e.Principal})}),R=e.Vec(e.Nat8),C=e.Variant({creation:e.Record({controllers:e.Vec(e.Principal)}),code_deployment:e.Record({mode:e.Variant({reinstall:e.Null,upgrade:e.Null,install:e.Null}),module_hash:e.Vec(e.Nat8)}),load_snapshot:e.Record({canister_version:e.Nat64,taken_at_timestamp:e.Nat64,snapshot_id:R}),controllers_change:e.Record({controllers:e.Vec(e.Principal)}),code_uninstall:e.Null}),P=e.Record({timestamp_nanos:e.Nat64,canister_version:e.Nat64,origin:y,details:C}),v=e.Record({controllers:e.Vec(e.Principal),module_hash:e.Opt(e.Vec(e.Nat8)),recent_changes:e.Vec(P),total_num_changes:e.Nat64}),g=e.Record({canister_id:o}),j=e.Variant({controllers:e.Null,public:e.Null,allowed_viewers:e.Vec(e.Principal)}),$=e.Record({freezing_threshold:e.Nat,controllers:e.Vec(e.Principal),reserved_cycles_limit:e.Nat,log_visibility:j,wasm_memory_limit:e.Nat,memory_allocation:e.Nat,compute_allocation:e.Nat}),U=e.Record({status:e.Variant({stopped:e.Null,stopping:e.Null,running:e.Null}),memory_size:e.Nat,cycles:e.Nat,settings:$,query_stats:e.Record({response_payload_bytes_total:e.Nat,num_instructions_total:e.Nat,num_calls_total:e.Nat,request_payload_bytes_total:e.Nat}),idle_cycles_burned_per_day:e.Nat,module_hash:e.Opt(e.Vec(e.Nat8)),reserved_cycles:e.Nat}),A=e.Record({canister_id:o}),x=e.Record({freezing_threshold:e.Opt(e.Nat),controllers:e.Opt(e.Vec(e.Principal)),reserved_cycles_limit:e.Opt(e.Nat),log_visibility:e.Opt(j),wasm_memory_limit:e.Opt(e.Nat),memory_allocation:e.Opt(e.Nat),compute_allocation:e.Opt(e.Nat)}),re=e.Record({settings:e.Opt(x),sender_canister_version:e.Opt(e.Nat64)}),ae=e.Record({canister_id:o}),ce=e.Record({canister_id:o}),oe=e.Record({canister_id:o,snapshot_id:R}),ie=e.Record({canister_id:o}),K=e.Variant({secp256k1:e.Null}),le=e.Record({key_id:e.Record({name:e.Text,curve:K}),canister_id:e.Opt(o),derivation_path:e.Vec(e.Vec(e.Nat8))}),_e=e.Record({public_key:e.Vec(e.Nat8),chain_code:e.Vec(e.Nat8)}),de=e.Record({canister_id:o}),ue=e.Record({idx:e.Nat64,timestamp_nanos:e.Nat64,content:e.Vec(e.Nat8)}),pe=e.Record({canister_log_records:e.Vec(ue)}),W=e.Record({value:e.Text,name:e.Text}),H=e.Record({status:e.Nat,body:e.Vec(e.Nat8),headers:e.Vec(W)}),ge=e.Record({url:e.Text,method:e.Variant({get:e.Null,head:e.Null,post:e.Null}),max_response_bytes:e.Opt(e.Nat64),body:e.Opt(e.Vec(e.Nat8)),transform:e.Opt(e.Record({function:e.Func([e.Record({context:e.Vec(e.Nat8),response:H})],[H],["query"]),context:e.Vec(e.Nat8)})),headers:e.Vec(W)}),G=e.Variant({reinstall:e.Null,upgrade:e.Opt(e.Record({wasm_memory_persistence:e.Opt(e.Variant({keep:e.Null,replace:e.Null})),skip_pre_upgrade:e.Opt(e.Bool)})),install:e.Null}),z=e.Record({hash:e.Vec(e.Nat8)}),he=e.Record({arg:e.Vec(e.Nat8),wasm_module_hash:e.Vec(e.Nat8),mode:G,chunk_hashes_list:e.Vec(z),target_canister:o,store_canister:e.Opt(o),sender_canister_version:e.Opt(e.Nat64)}),fe=e.Vec(e.Nat8),me=e.Record({arg:e.Vec(e.Nat8),wasm_module:fe,mode:G,canister_id:o,sender_canister_version:e.Opt(e.Nat64)}),ye=e.Record({canister_id:o}),J=e.Record({id:R,total_size:e.Nat64,taken_at_timestamp:e.Nat64}),be=e.Vec(J),Ne=e.Record({canister_id:o,sender_canister_version:e.Opt(e.Nat64),snapshot_id:R}),we=e.Record({start_at_timestamp_nanos:e.Nat64,subnet_id:e.Principal}),Re=e.Record({num_block_failures_total:e.Nat64,node_id:e.Principal,num_blocks_proposed_total:e.Nat64}),Oe=e.Vec(e.Record({timestamp_nanos:e.Nat64,node_metrics:e.Vec(Re)})),ve=e.Record({settings:e.Opt(x),specified_id:e.Opt(o),amount:e.Opt(e.Nat),sender_canister_version:e.Opt(e.Nat64)}),Te=e.Record({canister_id:o}),Ve=e.Record({canister_id:o,amount:e.Nat}),ke=e.Vec(e.Nat8),Q=e.Variant({ed25519:e.Null,bip340secp256k1:e.Null}),je=e.Record({key_id:e.Record({algorithm:Q,name:e.Text}),canister_id:e.Opt(o),derivation_path:e.Vec(e.Vec(e.Nat8))}),xe=e.Record({public_key:e.Vec(e.Nat8),chain_code:e.Vec(e.Nat8)}),Fe=e.Record({key_id:e.Record({name:e.Text,curve:K}),derivation_path:e.Vec(e.Vec(e.Nat8)),message_hash:e.Vec(e.Nat8)}),Ce=e.Record({signature:e.Vec(e.Nat8)}),Pe=e.Variant({bip341:e.Record({merkle_root_hash:e.Vec(e.Nat8)})}),Ae=e.Record({aux:e.Opt(Pe),key_id:e.Record({algorithm:Q,name:e.Text}),derivation_path:e.Vec(e.Vec(e.Nat8)),message:e.Vec(e.Nat8)}),qe=e.Record({signature:e.Vec(e.Nat8)}),Ee=e.Record({canister_id:o}),Se=e.Record({canister_id:o}),$e=e.Record({canister_id:o}),Ue=e.Vec(z),He=e.Record({subnet_id:e.Principal}),ze=e.Record({replica_version:e.Text}),Me=e.Record({replace_snapshot:e.Opt(R),canister_id:o}),Be=J,Ke=e.Record({canister_id:o,sender_canister_version:e.Opt(e.Nat64)}),We=e.Record({canister_id:e.Principal,settings:x,sender_canister_version:e.Opt(e.Nat64)}),Ge=e.Record({chunk:e.Vec(e.Nat8),canister_id:e.Principal}),Je=z;return e.Service({bitcoin_get_balance:e.Func([r],[c],[]),bitcoin_get_block_headers:e.Func([i],[l],[]),bitcoin_get_current_fee_percentiles:e.Func([_],[m],[]),bitcoin_get_utxos:e.Func([p],[V],[]),bitcoin_send_transaction:e.Func([u],[],[]),canister_info:e.Func([w],[v],[]),canister_status:e.Func([g],[U],[]),clear_chunk_store:e.Func([A],[],[]),create_canister:e.Func([re],[ae],[]),delete_canister:e.Func([ce],[],[]),delete_canister_snapshot:e.Func([oe],[],[]),deposit_cycles:e.Func([ie],[],[]),ecdsa_public_key:e.Func([le],[_e],[]),fetch_canister_logs:e.Func([de],[pe],["query"]),http_request:e.Func([ge],[H],[]),install_chunked_code:e.Func([he],[],[]),install_code:e.Func([me],[],[]),list_canister_snapshots:e.Func([ye],[be],[]),load_canister_snapshot:e.Func([Ne],[],[]),node_metrics_history:e.Func([we],[Oe],[]),provisional_create_canister_with_cycles:e.Func([ve],[Te],[]),provisional_top_up_canister:e.Func([Ve],[],[]),raw_rand:e.Func([],[ke],[]),schnorr_public_key:e.Func([je],[xe],[]),sign_with_ecdsa:e.Func([Fe],[Ce],[]),sign_with_schnorr:e.Func([Ae],[qe],[]),start_canister:e.Func([Ee],[],[]),stop_canister:e.Func([Se],[],[]),stored_chunks:e.Func([$e],[Ue],[]),subnet_info:e.Func([He],[ze],[]),take_canister_snapshot:e.Func([Me],[Be],[]),uninstall_code:e.Func([Ke],[],[]),update_settings:e.Func([We],[],[]),upload_chunk:e.Func([Ge],[Je],[])})};class te extends M{constructor(s,t,r,n){super(["Call failed:",`  Canister: ${s.toText()}`,`  Method: ${t} (${r})`,...Object.getOwnPropertyNames(n).map(c=>`  "${c}": ${JSON.stringify(n[c])}`)].join(`
`)),this.canisterId=s,this.methodName=t,this.type=r,this.props=n}}class ct extends te{constructor(s,t,r){var n;super(s,t,"query",{Status:r.status,Code:(n=Ye[r.reject_code])!==null&&n!==void 0?n:`Unknown Code "${r.reject_code}"`,Message:r.reject_message}),this.result=r}}class Z extends te{constructor(s,t,r,n,c,a,i){super(s,t,"update",Object.assign({"Request ID":q(r)},n.body?Object.assign(Object.assign({},i?{"Error code":i}:{}),{"Reject code":String(c),"Reject message":a}):{"HTTP status code":n.status.toString(),"HTTP status text":n.statusText})),this.requestId=r,this.response=n,this.reject_code=c,this.reject_message=a,this.error_code=i}}const h=Symbol.for("ic-agent-metadata");class E{constructor(s){this[h]=Object.freeze(s)}static agentOf(s){return s[h].config.agent}static interfaceOf(s){return s[h].service}static canisterIdOf(s){return f.from(s[h].config.canisterId)}static async install(s,t){const r=s.mode===void 0?{install:null}:s.mode,n=s.arg?[...new Uint8Array(s.arg)]:[],c=[...new Uint8Array(s.module)],a=typeof t.canisterId=="string"?f.fromText(t.canisterId):t.canisterId;await I(t).install_code({mode:r,arg:n,wasm_module:c,canister_id:a,sender_canister_version:[]})}static async createCanister(s,t){function r(c){return[{controllers:c.controllers?[c.controllers]:[],compute_allocation:c.compute_allocation?[c.compute_allocation]:[],freezing_threshold:c.freezing_threshold?[c.freezing_threshold]:[],memory_allocation:c.memory_allocation?[c.memory_allocation]:[],reserved_cycles_limit:[],log_visibility:[],wasm_memory_limit:[]}]}const{canister_id:n}=await I(s||{}).provisional_create_canister_with_cycles({amount:[],settings:r(t||{}),specified_id:[],sender_canister_version:[]});return n}static async createAndInstallCanister(s,t,r){const n=await this.createCanister(r);return await this.install(Object.assign({},t),Object.assign(Object.assign({},r),{canisterId:n})),this.createActor(s,Object.assign(Object.assign({},r),{canisterId:n}))}static createActorClass(s,t){const r=s({IDL:Qe});class n extends E{constructor(a){if(!a.canisterId)throw new M(`Canister ID is required, but received ${typeof a.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);const i=typeof a.canisterId=="string"?f.fromText(a.canisterId):a.canisterId;super({config:Object.assign(Object.assign(Object.assign({},se),a),{canisterId:i}),service:r});for(const[d,l]of r._fields)t!=null&&t.httpDetails&&l.annotations.push(B),t!=null&&t.certificate&&l.annotations.push(ne),this[d]=ot(this,d,l,a.blsVerify)}}return n}static createActor(s,t){if(!t.canisterId)throw new M(`Canister ID is required, but received ${typeof t.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);return new(this.createActorClass(s))(t)}static createActorWithHttpDetails(s,t){return new(this.createActorClass(s,{httpDetails:!0}))(t)}static createActorWithExtendedDetails(s,t,r={httpDetails:!0,certificate:!0}){return new(this.createActorClass(s,r))(t)}}function k(e,s){const t=Ze(e,Ie.Buffer.from(s));switch(t.length){case 0:return;case 1:return t[0];default:return t}}const se={pollingStrategyFactory:L},B="http-details",ne="certificate";function ot(e,s,t,r){let n;t.annotations.includes("query")||t.annotations.includes("composite_query")?n=async(a,...i)=>{var d,l;a=Object.assign(Object.assign({},a),(l=(d=e[h].config).queryTransform)===null||l===void 0?void 0:l.call(d,s,i,Object.assign(Object.assign({},e[h].config),a)));const _=a.agent||e[h].config.agent||Y(),b=f.from(a.canisterId||e[h].config.canisterId),m=X(t.argTypes,i),p=await _.query(b,{methodName:s,arg:m,effectiveCanisterId:a.effectiveCanisterId}),N=Object.assign(Object.assign({},p.httpDetails),{requestDetails:p.requestDetails});switch(p.status){case"rejected":throw new ct(b,s,p);case"replied":return t.annotations.includes(B)?{httpDetails:N,result:k(t.retTypes,p.reply.arg)}:k(t.retTypes,p.reply.arg)}}:n=async(a,...i)=>{var d,l;a=Object.assign(Object.assign({},a),(l=(d=e[h].config).callTransform)===null||l===void 0?void 0:l.call(d,s,i,Object.assign(Object.assign({},e[h].config),a)));const _=a.agent||e[h].config.agent||Y(),{canisterId:b,effectiveCanisterId:m,pollingStrategyFactory:p}=Object.assign(Object.assign(Object.assign({},se),e[h].config),a),N=f.from(b),F=m!==void 0?f.from(m):N,S=X(t.argTypes,i),{requestId:V,response:u,requestDetails:o}=await _.call(N,{methodName:s,arg:S,effectiveCanisterId:F});let w,y;if(u.body&&u.body.certificate){if(_.rootKey==null)throw new Error("Agent is missing root key");const v=u.body.certificate;y=await D.create({certificate:Xe(v),rootKey:_.rootKey,canisterId:f.from(b),blsVerify:r});const g=[new TextEncoder().encode("request_status"),V];switch(new TextDecoder().decode(O(y.lookup([...g,"status"])))){case"replied":w=O(y.lookup([...g,"reply"]));break;case"rejected":{const $=new Uint8Array(O(y.lookup([...g,"reject_code"])))[0],U=new TextDecoder().decode(O(y.lookup([...g,"reject_message"]))),A=O(y.lookup([...g,"error_code"])),x=A?new TextDecoder().decode(A):void 0;throw new Z(N,s,V,u,$,U,x)}}}else if(u.body&&"reject_message"in u.body){const{reject_code:v,reject_message:g,error_code:j}=u.body;throw new Z(N,s,V,u,v,g,j)}if(u.status===202){const v=p(),g=await ee(_,F,V,v,r);y=g.certificate,w=g.reply}const R=t.annotations.includes(B),C=t.annotations.includes(ne),P=Object.assign(Object.assign({},u),{requestDetails:o});if(w!==void 0)return R&&C?{httpDetails:P,certificate:y,result:k(t.retTypes,w)}:C?{certificate:y,result:k(t.retTypes,w)}:R?{httpDetails:P,result:k(t.retTypes,w)}:k(t.retTypes,w);if(t.retTypes.length===0)return R?{httpDetails:u,result:void 0}:void 0;throw new Error(`Call was returned undefined, but type [${t.retTypes.join(",")}].`)};const c=(...a)=>n({},...a);return c.withOptions=a=>(...i)=>n(a,...i),c}function I(e){function s(t,r){if(e.effectiveCanisterId)return{effectiveCanisterId:f.from(e.effectiveCanisterId)};const n=r[0];let c=f.fromHex("");return n&&typeof n=="object"&&n.target_canister&&t==="install_chunked_code"&&(c=f.from(n.target_canister)),n&&typeof n=="object"&&n.canister_id&&(c=f.from(n.canister_id)),{effectiveCanisterId:c}}return E.createActor(at,Object.assign(Object.assign(Object.assign({},e),{canisterId:f.fromHex("")}),{callTransform:s,queryTransform:s}))}const it=({IDL:e})=>{const s=e.Int,t=e.Record({principal:e.Principal,name:e.Text}),r=e.Variant({removeMember:e.Principal,general:e.Null}),n=e.Record({id:e.Nat,status:e.Text,title:e.Text,creator:e.Principal,description:e.Text,deadline:s,voters:e.Vec(e.Tuple(e.Principal,e.Bool)),proposalType:r,votes_for:e.Nat,vote_arguments:e.Vec(e.Tuple(e.Principal,e.Text)),votes_against:e.Nat}),c=e.Record({id:e.Nat,members:e.Vec(e.Principal),owner:e.Principal,name:e.Text,proposals:e.Vec(n),quorum:e.Nat});return e.Service({addMember:e.Func([e.Nat,e.Principal],[e.Text],[]),createMemberRemovalProposal:e.Func([e.Nat,e.Principal,e.Text,s],[e.Nat],[]),createOrganization:e.Func([e.Text],[e.Nat],[]),createProposal:e.Func([e.Nat,e.Text,e.Text,s],[e.Nat],[]),createUser:e.Func([e.Text],[t],[]),createUserForTesting:e.Func([e.Text,e.Principal],[t],[]),finalizeProposal:e.Func([e.Nat,e.Nat],[e.Text],[]),getAllOrganizations:e.Func([],[e.Vec(c)],["query"]),getOrganization:e.Func([e.Nat],[e.Opt(c)],["query"]),getUserByPrincipal:e.Func([e.Principal],[e.Opt(t)],["query"]),voteOnProposal:e.Func([e.Nat,e.Nat,e.Bool,e.Text],[e.Text],[])})},lt="bw4dl-smaaa-aaaaa-qaacq-cai",_t=(e,s={})=>{const t=s.agent||new De({...s.agentOptions});return s.agent&&s.agentOptions&&console.warn("Detected both agent and agentOptions passed to createActor. Ignoring agentOptions and proceeding with the provided agent."),t.fetchRootKey().catch(r=>{console.warn("Unable to fetch root key. Check to ensure that your local replica is running"),console.error(r)}),E.createActor(it,{agent:t,canisterId:e,...s.actorOptions})};_t(lt);export{E as A,lt as c,it as i};
